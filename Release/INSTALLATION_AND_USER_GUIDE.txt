CLMS (Comprehensive Library Management System)

Installation (Librarian PC)
1) Install Docker Desktop (Windows) with WSL2
2) Unzip CLMS_Release.zip to C:\CLMS
3) Open C:\CLMS\.env.production and set:
   - FRONTEND_URL=http://<your-computer-ip>:8080
   - ALLOWED_ORIGINS=http://<your-computer-ip>:8080
   - PUBLIC_API_URL=http://<your-computer-ip>:3001
   - PUBLIC_WS_URL=ws://<your-computer-ip>:3001
   - JWT_SECRET and JWT_REFRESH_SECRET to long random values
4) Ask IT to open firewall:
   - Allow inbound TCP 8080 and 3001 on Private network, Local Subnet only
5) Start CLMS:
   - Open PowerShell, run:
     cd C:\CLMS
     docker compose --env-file .env.production -f docker-compose.prod.yml up -d --build
6) Access the app from your computer:
   - http://<your-computer-ip>:8080
7) Access from kiosk/other computers on the same Wi‑Fi/LAN:
   - http://<your-computer-ip>:8080

Update
1) Stop dev servers if any (only use Docker for production)
2) Rebuild and restart:
   docker compose --env-file .env.production -f docker-compose.prod.yml build --no-cache
   docker compose --env-file .env.production -f docker-compose.prod.yml up -d --force-recreate
3) The app shows a refresh banner when a new version is detected; click Refresh

Backup
1) MySQL backup (run on librarian PC):
   docker exec clms-mysql-prod mysqldump -uroot -p<root-password> clms_database > C:\Backups\clms_YYYYMMDD.sql

Screens and What They Do
1) Dashboard
   - System Health: shows Internet, Backend connection, Redis/DB status, versions
   - Real‑time Cards: attendance, activity, and kiosk status live via WebSocket
   - Kiosk Management: generate kiosk display tokens and revoke them

2) Students
   - Search: find students by name/ID
   - Details: view grade, section, barcode
   - Attendance: scan student barcode to record presence; kiosk display reflects live updates

3) Books
   - Search: by accession (Barcode), title, author, category
   - Details: availability, total/available copies, metadata (ISBN, publisher, year)

4) Checkout / Return
   - Checkout: scan student barcode first, then book accession to borrow
   - Return: scan book accession or select from active loans to return; copies are updated

5) Import
   - Students (Enhanced): upload CSV/Excel, map headers, submit; “User ID” becomes the scan barcode
   - Books (Enhanced): upload CSV/Excel; auto‑maps Barcode→accession_no, Title, Author, ISBN, Publisher, Collection Code→category, Year
   - Preview: check headers/rows before importing

6) Announcements
   - Post notices to users; rate limits protect from spam

7) Analytics
   - Summary charts of activity, borrowing, attendance; auto‑refresh with debounce to avoid overload

8) Equipment / Printing (if enabled)
   - Equipment: track items, check‑in/out
   - Printing: manage print requests and quotas

9) Settings
   - Users & Roles: manage librarian/admin accounts
   - Policies: borrowing durations, fines
   - Sections/Categories: library taxonomy

10) Logs
   - Error logs: recent errors for troubleshooting
   - Request logs: per‑request “correlation‑id” to trace

Kiosk Display
1) On Dashboard, generate a kiosk token (KIOSK_DISPLAY)
2) On the kiosk computer, open http://<your-computer-ip>:8080 and sign in with the kiosk token
3) Attendance events update live on the kiosk and dashboard via WebSocket

Troubleshooting
1) Health endpoint: http://<your-computer-ip>:3001/health
2) If app is not reachable from other PCs: add Windows Firewall inbound rules for TCP 8080 and 3001 (Private profile, Local Subnet)
3) If backend restarts repeatedly: ensure ports 3001/8080 are not in use by dev servers; use Docker only
4) Data checks:
   - Students count: docker exec clms-mysql-prod mysql -uroot -p<root> -e "SELECT COUNT(*) FROM students;" clms_database
   - Books count: docker exec clms-mysql-prod mysql -uroot -p<root> -e "SELECT COUNT(*) FROM books;" clms_database

Security Tips
1) Keep secrets private (do not email JWT/DB passwords)
2) Restrict CORS origins to your frontend URL
3) Rotate librarian passwords periodically
4) Back up MySQL regularly and store off the machine