[{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ErrorBoundary.class.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ErrorBoundary.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":15,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":15,"endColumn":20},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":16,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":16,"endColumn":19},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":24,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":24,"endColumn":18},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":25,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":25,"endColumn":18},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":26,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":26,"endColumn":25},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":27,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":27,"endColumn":18},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":28,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":28,"endColumn":25},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":29,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":29,"endColumn":14},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":30,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":30,"endColumn":9},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":31,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":31,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * ErrorBoundary - React 19 compatible functional error boundary\n *\n * This file replaces the original class-based ErrorBoundary with a functional\n * implementation using react-error-boundary. It maintains full backward compatibility\n * with the existing API while providing React 19 compatibility and modern hooks.\n *\n * Migration completed: Class component -> Functional component with react-error-boundary\n * Original class component backed up as: ErrorBoundary.class.tsx\n */\n\nexport {\n  ErrorBoundaryWrapper as default,\n  ErrorBoundaryWrapper as ErrorBoundary,\n  withErrorBoundary,\n  useErrorBoundary,\n} from './ErrorBoundaryWrapper';\n\n// Re-export fallback component for direct usage\nexport { ErrorBoundaryFallback } from './ErrorBoundaryFallback';\n\n// Re-export error utilities for external usage\nexport {\n  categorizeError,\n  generateErrorId,\n  reportApplicationError,\n  checkConnection,\n  handleReauthentication,\n  refreshPage,\n  goHome,\n  sendDetailedReport,\n  type ErrorType,\n  type ErrorReport,\n  type RecoverySuggestion,\n} from '@/utils/error-utils';\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ErrorBoundaryFallback.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'error'. Either exclude it or remove the dependency array.","line":67,"column":52,"nodeType":"ArrayExpression","endLine":67,"endColumn":59,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[2059,2066],"text":"[]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleRetry'. Either include it or remove the dependency array.","line":85,"column":6,"nodeType":"ArrayExpression","endLine":85,"endColumn":52,"suggestions":[{"desc":"Update the dependencies array to be: [errorType, autoRetry, retryCount, maxRetries, handleRetry]","fix":{"range":[2464,2510],"text":"[errorType, autoRetry, retryCount, maxRetries, handleRetry]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ErrorBoundaryFallback - Functional fallback component for react-error-boundary\r\n * React 19 compatible with modern hooks and error handling patterns\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport type { FallbackProps } from 'react-error-boundary';\r\nimport {\r\n  AlertTriangle,\r\n  RefreshCw,\r\n  Home,\r\n  Bug,\r\n  Wifi,\r\n  WifiOff,\r\n  Clock,\r\n  Send,\r\n  CheckCircle,\r\n  XCircle,\r\n} from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card } from '@/components/ui/card';\r\nimport {\r\n  categorizeError,\r\n  generateErrorId,\r\n  reportApplicationError,\r\n  checkConnection,\r\n  handleReauthentication,\r\n  refreshPage,\r\n  goHome,\r\n  sendDetailedReport,\r\n  type ErrorType,\r\n  type RecoverySuggestion,\r\n} from '@/utils/error-utils';\r\n\r\n/**\r\n * Props for ErrorBoundaryFallback component extending react-error-boundary's FallbackProps\r\n */\r\ninterface ErrorBoundaryFallbackProps extends FallbackProps {\r\n  /** Maximum number of retry attempts before disabling auto-retry */\r\n  maxRetries?: number;\r\n  /** Enable/disable retry functionality */\r\n  enableRetry?: boolean;\r\n  /** Custom error handler callback */\r\n  onError?: (error: Error, errorId: string, errorType: ErrorType) => void;\r\n}\r\n\r\n/**\r\n * Functional ErrorBoundary fallback component with comprehensive error handling\r\n * Supports automatic recovery, retry logic, and detailed error reporting\r\n */\r\nexport function ErrorBoundaryFallback({\r\n  error,\r\n  resetErrorBoundary,\r\n  maxRetries = 3,\r\n  enableRetry = true,\r\n  onError,\r\n}: ErrorBoundaryFallbackProps) {\r\n  // State management using React hooks\r\n  const [retryCount, setRetryCount] = useState(0);\r\n  const [isRecovering, setIsRecovering] = useState(false);\r\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\r\n  const [autoRetry, setAutoRetry] = useState(true);\r\n  // Remove unused lastRetry variable\r\n\r\n  // Memoized error categorization and ID generation\r\n  const errorType = useMemo(() => categorizeError(error), [error]);\r\n  const errorId = useMemo(() => generateErrorId(), [error]);\r\n\r\n  /**\r\n   * Handle online/offline status changes\r\n   */\r\n  const handleOnlineChange = useCallback(() => {\r\n    const online = navigator.onLine;\r\n    setIsOnline(online);\r\n\r\n    // Auto-retry network errors when coming back online\r\n    if (\r\n      online &&\r\n      errorType === 'NETWORK_ERROR' &&\r\n      autoRetry &&\r\n      retryCount < maxRetries\r\n    ) {\r\n      handleRetry();\r\n    }\r\n  }, [errorType, autoRetry, retryCount, maxRetries]);\r\n\r\n  /**\r\n   * Handle retry attempts with exponential backoff\r\n   */\r\n  const handleRetry = useCallback(() => {\r\n    if (retryCount >= maxRetries) {\r\n      setAutoRetry(false);\r\n      return;\r\n    }\r\n\r\n    setRetryCount((prev) => prev + 1);\r\n    setIsRecovering(true);\r\n\r\n    // Exponential backoff: 1s, 2s, 4s, etc.\r\n    const delay = Math.min(1000 * Math.pow(2, retryCount), 5000);\r\n\r\n    setTimeout(() => {\r\n      setIsRecovering(false);\r\n      resetErrorBoundary();\r\n    }, delay);\r\n  }, [retryCount, maxRetries, resetErrorBoundary]);\r\n\r\n  /**\r\n   * Handle manual reset\r\n   */\r\n  const handleReset = useCallback(() => {\r\n    setRetryCount(0);\r\n    setIsRecovering(false);\r\n    setAutoRetry(true);\r\n    resetErrorBoundary();\r\n  }, [resetErrorBoundary]);\r\n\r\n  /**\r\n   * Check connection and retry if successful\r\n   */\r\n  const handleCheckConnection = useCallback(async () => {\r\n    setIsRecovering(true);\r\n\r\n    try {\r\n      const isConnected = await checkConnection();\r\n      if (isConnected) {\r\n        handleRetry();\r\n      } else {\r\n        alert('Connection test failed. Please check your internet connection.');\r\n        setIsRecovering(false);\r\n      }\r\n    } catch {\r\n      alert(\r\n        'Unable to test connection. Please check your internet connection.'\r\n      );\r\n      setIsRecovering(false);\r\n    }\r\n  }, [handleRetry]);\r\n\r\n  /**\r\n   * Send detailed error report via email\r\n   */\r\n  const handleSendReport = useCallback(() => {\r\n    sendDetailedReport(errorId, error, null);\r\n  }, [errorId, error]);\r\n\r\n  /**\r\n   * Generate recovery suggestions based on error type\r\n   */\r\n  const recoverySuggestions = useMemo((): RecoverySuggestion[] => {\r\n    const suggestions: RecoverySuggestion[] = [];\r\n\r\n    switch (errorType) {\r\n      case 'NETWORK_ERROR':\r\n        suggestions.push({\r\n          id: 'check_connection',\r\n          title: 'Check Internet Connection',\r\n          description: 'Verify your internet connection is working properly',\r\n          action: handleCheckConnection,\r\n          icon: <Wifi className=\"h-4 w-4\" />,\r\n          auto: false,\r\n        });\r\n        suggestions.push({\r\n          id: 'refresh_page',\r\n          title: 'Refresh Page',\r\n          description: 'Reload the page to restore connection',\r\n          action: refreshPage,\r\n          icon: <RefreshCw className=\"h-4 w-4\" />,\r\n          auto: true,\r\n        });\r\n        break;\r\n\r\n      case 'AUTHENTICATION_ERROR':\r\n        suggestions.push({\r\n          id: 'relogin',\r\n          title: 'Sign In Again',\r\n          description: 'Your session may have expired. Please sign in again.',\r\n          action: handleReauthentication,\r\n          icon: <CheckCircle className=\"h-4 w-4\" />,\r\n          auto: false,\r\n        });\r\n        break;\r\n\r\n      case 'VALIDATION_ERROR':\r\n        suggestions.push({\r\n          id: 'check_input',\r\n          title: 'Check Input Data',\r\n          description: 'Please verify your input and try again',\r\n          action: handleReset,\r\n          icon: <AlertTriangle className=\"h-4 w-4\" />,\r\n          auto: false,\r\n        });\r\n        break;\r\n\r\n      case 'TIMEOUT_ERROR':\r\n        suggestions.push({\r\n          id: 'retry_later',\r\n          title: 'Try Again',\r\n          description: 'The operation timed out. Please try again.',\r\n          action: handleRetry,\r\n          icon: <Clock className=\"h-4 w-4\" />,\r\n          auto: true,\r\n        });\r\n        break;\r\n\r\n      default:\r\n        suggestions.push({\r\n          id: 'refresh_page',\r\n          title: 'Refresh Page',\r\n          description: 'Reload the page to clear temporary issues',\r\n          action: refreshPage,\r\n          icon: <RefreshCw className=\"h-4 w-4\" />,\r\n          auto: false,\r\n        });\r\n        suggestions.push({\r\n          id: 'report_bug',\r\n          title: 'Report Issue',\r\n          description: 'Send an error report to help us fix this issue',\r\n          action: handleSendReport,\r\n          icon: <Send className=\"h-4 w-4\" />,\r\n          auto: false,\r\n        });\r\n    }\r\n\r\n    return suggestions;\r\n  }, [\r\n    errorType,\r\n    handleCheckConnection,\r\n    handleRetry,\r\n    handleReset,\r\n    handleSendReport,\r\n  ]);\r\n\r\n  /**\r\n   * Get appropriate icon for error type\r\n   */\r\n  const getErrorIcon = useCallback(() => {\r\n    switch (errorType) {\r\n      case 'NETWORK_ERROR':\r\n        return isOnline ? (\r\n          <Wifi className=\"h-8 w-8\" />\r\n        ) : (\r\n          <WifiOff className=\"h-8 w-8\" />\r\n        );\r\n      case 'AUTHENTICATION_ERROR':\r\n        return <XCircle className=\"h-8 w-8\" />;\r\n      case 'VALIDATION_ERROR':\r\n        return <AlertTriangle className=\"h-8 w-8\" />;\r\n      case 'TIMEOUT_ERROR':\r\n        return <Clock className=\"h-8 w-8\" />;\r\n      default:\r\n        return <Bug className=\"h-8 w-8\" />;\r\n    }\r\n  }, [errorType, isOnline]);\r\n\r\n  /**\r\n   * Get error title based on type\r\n   */\r\n  const getErrorTitle = useCallback(() => {\r\n    switch (errorType) {\r\n      case 'NETWORK_ERROR':\r\n        return 'Connection Error';\r\n      case 'AUTHENTICATION_ERROR':\r\n        return 'Authentication Required';\r\n      case 'VALIDATION_ERROR':\r\n        return 'Validation Error';\r\n      case 'TIMEOUT_ERROR':\r\n        return 'Request Timeout';\r\n      default:\r\n        return 'Something Went Wrong';\r\n    }\r\n  }, [errorType]);\r\n\r\n  /**\r\n   * Get error description based on type\r\n   */\r\n  const getErrorDescription = useCallback(() => {\r\n    switch (errorType) {\r\n      case 'NETWORK_ERROR':\r\n        return 'Unable to connect to the server';\r\n      case 'AUTHENTICATION_ERROR':\r\n        return 'Please sign in to continue';\r\n      case 'VALIDATION_ERROR':\r\n        return 'Please check your input and try again';\r\n      case 'TIMEOUT_ERROR':\r\n        return 'The request took too long to complete';\r\n      default:\r\n        return 'The application encountered an unexpected error';\r\n    }\r\n  }, [errorType]);\r\n\r\n  /**\r\n   * Get gradient colors based on error type\r\n   */\r\n  const getGradientColors = useCallback(() => {\r\n    switch (errorType) {\r\n      case 'NETWORK_ERROR':\r\n        return 'from-orange-500 to-orange-600 dark:from-orange-600 dark:to-orange-700';\r\n      case 'AUTHENTICATION_ERROR':\r\n        return 'from-yellow-500 to-yellow-600 dark:from-yellow-600 dark:to-yellow-700';\r\n      case 'VALIDATION_ERROR':\r\n        return 'from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700';\r\n      case 'TIMEOUT_ERROR':\r\n        return 'from-purple-500 to-purple-600 dark:from-purple-600 dark:to-purple-700';\r\n      default:\r\n        return 'from-red-500 to-red-600 dark:from-red-600 dark:to-red-700';\r\n    }\r\n  }, [errorType]);\r\n\r\n  // Effect for setting up event listeners\r\n  useEffect(() => {\r\n    window.addEventListener('online', handleOnlineChange);\r\n    window.addEventListener('offline', handleOnlineChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('online', handleOnlineChange);\r\n      window.removeEventListener('offline', handleOnlineChange);\r\n    };\r\n  }, [handleOnlineChange]);\r\n\r\n  // Effect for error reporting\r\n  useEffect(() => {\r\n    reportApplicationError(error, null, errorId, errorType, retryCount);\r\n\r\n    if (onError) {\r\n      onError(error, errorId, errorType);\r\n    }\r\n  }, [error, errorId, errorType, retryCount, onError]);\r\n\r\n  // Effect for automatic retry\r\n  useEffect(() => {\r\n    const autoRecoverySuggestions = recoverySuggestions.filter((s) => s.auto);\r\n\r\n    const suggestion = autoRecoverySuggestions[0];\r\n    if (suggestion && retryCount < maxRetries) {\r\n      const delay = Math.min(2000 * Math.pow(1.5, retryCount), 10000); // Progressive delay\r\n\r\n      const timer = setTimeout(() => {\r\n        console.debug(\r\n          `Auto-recovery attempt ${retryCount + 1}/${maxRetries}: ${suggestion.title}`\r\n        );\r\n        setIsRecovering(true);\r\n\r\n        try {\r\n          suggestion.action();\r\n        } catch (recoveryError) {\r\n          console.error('Auto-recovery failed:', recoveryError);\r\n        } finally {\r\n          setIsRecovering(false);\r\n        }\r\n      }, delay);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n    return undefined;\r\n  }, [recoverySuggestions, autoRetry, retryCount, maxRetries, enableRetry]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-slate-50 to-blue-50/30 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 p-4\">\r\n      <div className=\"max-w-3xl w-full space-y-6\">\r\n        {/* Main Error Card */}\r\n        <Card className=\"bg-white dark:bg-slate-900 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden\">\r\n          {/* Header */}\r\n          <div className={`bg-gradient-to-r p-6 ${getGradientColors()}`}>\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"bg-white/20 backdrop-blur-sm rounded-full p-3 text-white\">\r\n                {getErrorIcon()}\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h1 className=\"text-2xl font-bold text-white\">\r\n                  {getErrorTitle()}\r\n                </h1>\r\n                <p className=\"text-white/80 mt-1\">{getErrorDescription()}</p>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                {isOnline ? (\r\n                  <Wifi className=\"h-5 w-5 text-green-400\" />\r\n                ) : (\r\n                  <WifiOff className=\"h-5 w-5 text-red-400\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"p-6 space-y-6\">\r\n            {/* Auto-recovery status */}\r\n            {isRecovering && (\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <RefreshCw className=\"h-5 w-5 text-blue-600 dark:text-blue-400 animate-spin\" />\r\n                  <div>\r\n                    <h3 className=\"text-sm font-semibold text-blue-900 dark:text-blue-100\">\r\n                      Attempting Automatic Recovery\r\n                    </h3>\r\n                    <p className=\"text-sm text-blue-700 dark:text-blue-300\">\r\n                      Trying to resolve the issue automatically... (Attempt{' '}\r\n                      {retryCount + 1}/{maxRetries})\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Error Details */}\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 rounded-lg p-4 border border-slate-200 dark:border-slate-700\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <h2 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">\r\n                  Error Details\r\n                </h2>\r\n                <span className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                  ID: {errorId}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-slate-700 dark:text-slate-300 font-mono break-all\">\r\n                {error.toString()}\r\n              </p>\r\n              {retryCount > 0 && (\r\n                <p className=\"text-xs text-slate-500 dark:text-slate-400 mt-2\">\r\n                  Retry attempts: {retryCount}/{maxRetries}\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Recovery Suggestions */}\r\n            {recoverySuggestions.length > 0 && (\r\n              <div className=\"space-y-3\">\r\n                <h3 className=\"text-sm font-semibold text-slate-900 dark:text-slate-100\">\r\n                  Suggested Actions\r\n                </h3>\r\n                <div className=\"grid gap-2\">\r\n                  {recoverySuggestions.map((suggestion) => (\r\n                    <Button\r\n                      key={suggestion.id}\r\n                      onClick={suggestion.action}\r\n                      variant=\"outline\"\r\n                      className=\"justify-start h-auto p-4 gap-3\"\r\n                      disabled={isRecovering}\r\n                    >\r\n                      {suggestion.icon}\r\n                      <div className=\"text-left\">\r\n                        <div className=\"font-medium\">{suggestion.title}</div>\r\n                        <div className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                          {suggestion.description}\r\n                        </div>\r\n                      </div>\r\n                    </Button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Development Info */}\r\n            {import.meta.env.DEV && error.stack && (\r\n              <details className=\"bg-slate-50 dark:bg-slate-800/50 rounded-lg p-4 border border-slate-200 dark:border-slate-700\">\r\n                <summary className=\"text-sm font-semibold text-slate-900 dark:text-slate-100 cursor-pointer mb-2\">\r\n                  Stack Trace (Development Only)\r\n                </summary>\r\n                <pre className=\"text-xs text-slate-600 dark:text-slate-400 overflow-auto max-h-64 whitespace-pre-wrap font-mono\">\r\n                  {error.stack}\r\n                </pre>\r\n              </details>\r\n            )}\r\n\r\n            {/* Main Actions */}\r\n            <div className=\"flex flex-col sm:flex-row gap-3 pt-4 border-t border-slate-200 dark:border-slate-700\">\r\n              <Button\r\n                onClick={handleRetry}\r\n                className=\"flex-1 gap-2\"\r\n                variant=\"default\"\r\n                disabled={\r\n                  isRecovering || retryCount >= maxRetries || !enableRetry\r\n                }\r\n              >\r\n                <RefreshCw className=\"h-4 w-4\" />\r\n                {isRecovering\r\n                  ? 'Recovering...'\r\n                  : retryCount >= maxRetries\r\n                    ? 'Max Retries Reached'\r\n                    : 'Try Again'}\r\n              </Button>\r\n              <Button\r\n                onClick={goHome}\r\n                className=\"flex-1 gap-2\"\r\n                variant=\"outline\"\r\n              >\r\n                <Home className=\"h-4 w-4\" />\r\n                Go to Dashboard\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Help Text */}\r\n            <div className=\"flex flex-col items-center gap-2 text-center\">\r\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                Error ID: {errorId}\r\n              </p>\r\n              <p className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                If this problem persists, please contact the system\r\n                administrator\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </Card>\r\n\r\n        {/* Auto-retry disabled notice */}\r\n        {!autoRetry && retryCount >= maxRetries && (\r\n          <Card className=\"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800\">\r\n            <div className=\"p-4\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <AlertTriangle className=\"h-5 w-5 text-amber-600 dark:text-amber-400\" />\r\n                <div>\r\n                  <h3 className=\"text-sm font-semibold text-amber-900 dark:text-amber-100\">\r\n                    Automatic Retry Disabled\r\n                  </h3>\r\n                  <p className=\"text-sm text-amber-700 dark:text-amber-300\">\r\n                    Maximum retry attempts reached. Please try one of the\r\n                    suggested actions above.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ErrorBoundaryWrapper.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1219,1222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1219,1222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1244,1247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1244,1247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1361,1364],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1361,1364],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3204,3207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3204,3207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3247,3250],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3247,3250],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3272,3275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3272,3275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":193,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":193,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":197,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6179,6182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6179,6182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":198,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6249,6252],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6249,6252],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":218,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":218,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * ErrorBoundaryWrapper - React 19 compatible functional error boundary\r\n * Replaces the class-based ErrorBoundary with react-error-boundary integration\r\n */\r\n\r\nimport React, { useCallback, type ReactNode, type ErrorInfo } from 'react';\r\nimport { ErrorBoundary, type FallbackProps } from 'react-error-boundary';\r\nimport { ErrorBoundaryFallback } from './ErrorBoundaryFallback';\r\nimport {\r\n  reportApplicationError,\r\n  categorizeError,\r\n  generateErrorId,\r\n  type ErrorType,\r\n} from '@/utils/error-utils';\r\n\r\n/**\r\n * Props for ErrorBoundaryWrapper component\r\n */\r\ninterface ErrorBoundaryWrapperProps {\r\n  /** Child components to wrap with error boundary */\r\n  children?: ReactNode;\r\n  /** Maximum number of retry attempts before disabling auto-retry */\r\n  maxRetries?: number;\r\n  /** Enable/disable retry functionality */\r\n  enableRetry?: boolean;\r\n  /** Custom fallback component (defaults to ErrorBoundaryFallback) */\r\n  fallback?: React.ComponentType<FallbackProps>;\r\n  /** Custom error handler callback */\r\n  onError?: (error: Error, errorInfo: React.ErrorInfo) => void;\r\n  /** Custom reset handler callback */\r\n  onReset?: (\r\n    details:\r\n      | { reason: 'imperative-api' }\r\n      | { reason: 'keys'; prev: any[] | undefined; next: any[] | undefined }\r\n  ) => void;\r\n  /** Reset keys - when these change, the error boundary resets */\r\n  resetKeys?: any[];\r\n  /** Reset on props change */\r\n  resetOnPropsChange?: boolean;\r\n  /** Isolate error boundary (double-wrap for extra protection) */\r\n  isolate?: boolean;\r\n}\r\n\r\n/**\r\n * Enhanced ErrorBoundary wrapper with comprehensive error handling\r\n * Provides a functional interface over react-error-boundary with enhanced features\r\n */\r\nexport function ErrorBoundaryWrapper({\r\n  children,\r\n  maxRetries = 3,\r\n  enableRetry = true,\r\n  fallback: CustomFallback,\r\n  onError,\r\n  onReset,\r\n  resetKeys,\r\n  resetOnPropsChange: _resetOnPropsChange = true,\r\n  isolate = false,\r\n}: ErrorBoundaryWrapperProps) {\r\n  /**\r\n   * Enhanced error handler that maintains compatibility with react-error-boundary\r\n   */\r\n  const handleError = useCallback(\r\n    (error: Error, info: ErrorInfo) => {\r\n      // Generate error metadata\r\n      const errorId = generateErrorId();\r\n      const errorType = categorizeError(error);\r\n\r\n      // Report error using the centralized error reporting system\r\n      reportApplicationError(error, info, errorId, errorType, 0);\r\n\r\n      // Log error details for debugging\r\n      console.group(`≡ƒÜ¿ ErrorBoundary: ${errorType}`);\r\n      console.error('Error:', error);\r\n      console.error('Error ID:', errorId);\r\n      console.error(\r\n        'Component Stack:',\r\n        info.componentStack || 'No component stack available'\r\n      );\r\n      console.error('Error Type:', errorType);\r\n      console.groupEnd();\r\n\r\n      // Call custom error handler if provided\r\n      if (onError) {\r\n        try {\r\n          onError(error, info);\r\n        } catch (handlerError) {\r\n          console.error('Error in custom error handler:', handlerError);\r\n        }\r\n      }\r\n    },\r\n    [onError]\r\n  );\r\n\r\n  /**\r\n   * Enhanced reset handler\r\n   */\r\n  const handleReset = useCallback(\r\n    (\r\n      details:\r\n        | { reason: 'imperative-api'; args: any[] }\r\n        | { reason: 'keys'; prev: any[] | undefined; next: any[] | undefined }\r\n    ) => {\r\n      console.debug(`≡ƒöä ErrorBoundary Reset: ${details.reason}`, details);\r\n\r\n      // Call custom reset handler if provided\r\n      if (onReset) {\r\n        try {\r\n          // Convert the details to match our interface\r\n          const convertedDetails =\r\n            details.reason === 'imperative-api'\r\n              ? { reason: 'imperative-api' as const }\r\n              : {\r\n                  reason: 'keys' as const,\r\n                  prev: details.prev,\r\n                  next: details.next,\r\n                };\r\n          onReset(convertedDetails);\r\n        } catch (resetError) {\r\n          console.error('Error in custom reset handler:', resetError);\r\n        }\r\n      }\r\n    },\r\n    [onReset]\r\n  );\r\n\r\n  /**\r\n   * Fallback component renderer\r\n   */\r\n  const renderFallback = useCallback(\r\n    (props: FallbackProps) => {\r\n      const FallbackComponent = CustomFallback || ErrorBoundaryFallback;\r\n\r\n      // Create a wrapper for the onError prop to match ErrorBoundaryFallback's expected signature\r\n      const fallbackOnError = (\r\n        _error: Error,\r\n        _errorId: string,\r\n        _errorType: ErrorType\r\n      ) => {\r\n        // We don't need to do anything here as the error is already handled by handleError\r\n        // This is just to satisfy the ErrorBoundaryFallback component's interface\r\n      };\r\n\r\n      return (\r\n        <FallbackComponent\r\n          {...props}\r\n          maxRetries={maxRetries}\r\n          enableRetry={enableRetry}\r\n          onError={fallbackOnError}\r\n        />\r\n      );\r\n    },\r\n    [CustomFallback, maxRetries, enableRetry]\r\n  );\r\n\r\n  // If isolation is enabled, wrap in an additional error boundary\r\n  if (isolate) {\r\n    return (\r\n      <ErrorBoundary\r\n        FallbackComponent={renderFallback}\r\n        onError={handleError}\r\n        onReset={handleReset}\r\n        resetKeys={resetKeys || []}\r\n        // Note: react-error-boundary v6 does not support resetOnPropsChange; kept for wrapper API compatibility\r\n      >\r\n        <ErrorBoundary\r\n          FallbackComponent={renderFallback}\r\n          onError={handleError}\r\n          onReset={handleReset}\r\n          resetKeys={resetKeys || []}\r\n        >\r\n          {children}\r\n        </ErrorBoundary>\r\n      </ErrorBoundary>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ErrorBoundary\r\n      FallbackComponent={renderFallback}\r\n      onError={handleError}\r\n      onReset={handleReset}\r\n      resetKeys={resetKeys || []}\r\n      // Note: react-error-boundary v6 does not support resetOnPropsChange; kept for wrapper API compatibility\r\n    >\r\n      {children}\r\n    </ErrorBoundary>\r\n  );\r\n}\r\n\r\n/**\r\n * Higher-order component version for class component compatibility\r\n */\r\nexport function withErrorBoundary<P extends object>(\r\n  Component: React.ComponentType<P>,\r\n  errorBoundaryProps?: Omit<ErrorBoundaryWrapperProps, 'children'>\r\n) {\r\n  const WrappedComponent = React.forwardRef<any, P>((props, ref) => {\r\n    const componentProps = { ...props } as any;\r\n    if (ref) {\r\n      componentProps.ref = ref;\r\n    }\r\n\r\n    return (\r\n      <ErrorBoundaryWrapper {...(errorBoundaryProps || {})}>\r\n        <Component {...componentProps} />\r\n      </ErrorBoundaryWrapper>\r\n    );\r\n  });\r\n\r\n  WrappedComponent.displayName = `withErrorBoundary(${Component.displayName || Component.name})`;\r\n\r\n  return WrappedComponent;\r\n}\r\n\r\n/**\r\n * Hook for manual error boundary triggering\r\n */\r\nexport function useErrorBoundary() {\r\n  const [error, setError] = React.useState<Error | null>(null);\r\n\r\n  const resetError = React.useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  const captureError = React.useCallback((error: Error) => {\r\n    setError(error);\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    if (error) {\r\n      throw error;\r\n    }\r\n  }, [error]);\r\n\r\n  return {\r\n    captureError,\r\n    resetError,\r\n  };\r\n}\r\n\r\n// Export the ErrorBoundary from react-error-boundary for convenience\r\nexport { ErrorBoundary } from 'react-error-boundary';\r\n\r\n// Default export\r\nexport default ErrorBoundaryWrapper;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ImportData.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\Import\\EnhancedImportManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1508,1511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1508,1511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2256,2259],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2256,2259],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2988,2991],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2988,2991],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4035,4038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4035,4038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4074,4077],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4074,4077],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4423,4426],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4423,4426],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4485,4488],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4485,4488],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4540,4543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4540,4543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8260,8263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8260,8263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8268,8271],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8268,8271],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":290,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8347,8350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8347,8350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-non-null-assertion","severity":1,"message":"Forbidden non-null assertion.","line":358,"column":46,"nodeType":"TSNonNullExpression","messageId":"noNonNull","endLine":358,"endColumn":66},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":594,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":594,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18711,18714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18711,18714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, useRef } from 'react';\r\nimport Papa from 'papaparse';\r\nimport * as XLSX from 'xlsx';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogDescription,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Upload,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  Info,\r\n  Loader2,\r\n  FileText,\r\n  Users,\r\n  BookOpen,\r\n  Eye,\r\n  FileSpreadsheet,\r\n  FileDown,\r\n  ArrowRight,\r\n  ArrowLeft,\r\n  RefreshCw,\r\n  Database,\r\n  Zap,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport axios from 'axios';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\nconst API_BASE_URL = 'http://localhost:3001/api';\r\n\r\ninterface ImportResult {\r\n  success: boolean;\r\n  totalRecords: number;\r\n  importedRecords: number;\r\n  skippedRecords: number;\r\n  errorRecords: number;\r\n  errors: string[];\r\n}\r\n\r\ninterface FieldMapping {\r\n  source: string;\r\n  target: string;\r\n  required: boolean;\r\n}\r\n\r\ninterface PreviewData {\r\n  headers: string[];\r\n  rows: any[][];\r\n  totalRows: number;\r\n}\r\n\r\nexport default function EnhancedImportManager() {\r\n  const [activeTab, setActiveTab] = useState('students');\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [result, setResult] = useState<ImportResult | null>(null);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n  const [previewData, setPreviewData] = useState<PreviewData | null>(null);\r\n  const [fieldMapping, setFieldMapping] = useState<FieldMapping[]>([]);\r\n  const [importProgress, setImportProgress] = useState(0);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const parseFile = useCallback(\r\n    (\r\n      file: File\r\n    ): Promise<{ headers: string[]; rows: any[]; totalRows: number }> => {\r\n      return new Promise((resolve, reject) => {\r\n        const fileExtension = file.name.split('.').pop()?.toLowerCase();\r\n\r\n        if (fileExtension === 'csv') {\r\n          Papa.parse(file, {\r\n            header: true,\r\n            preview: 10,\r\n            complete: (results) => {\r\n              if (results.errors.length > 0) {\r\n                const firstError = results.errors[0];\r\n                reject(\r\n                  new Error(\r\n                    `CSV parsing error: ${firstError?.message || 'Unknown error'}`\r\n                  )\r\n                );\r\n              } else {\r\n                const headers = results.meta.fields || [];\r\n                const rows = results.data as any[];\r\n                resolve({\r\n                  headers,\r\n                  rows: rows.slice(0, 10),\r\n                  totalRows: results.data.length,\r\n                });\r\n              }\r\n            },\r\n            error: (error) => reject(error),\r\n          });\r\n        } else if (['xlsx', 'xls'].includes(fileExtension || '')) {\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => {\r\n            try {\r\n              const result = e.target?.result;\r\n              if (!result) {\r\n                reject(new Error('Failed to read file'));\r\n                return;\r\n              }\r\n              const data = new Uint8Array(result as ArrayBuffer);\r\n              const workbook = XLSX.read(data, { type: 'array' });\r\n              const sheetName = workbook.SheetNames[0];\r\n              if (!sheetName) {\r\n                reject(new Error('No sheets found in Excel file'));\r\n                return;\r\n              }\r\n              const worksheet = workbook.Sheets[sheetName];\r\n              const jsonData: any[][] = (XLSX.utils.sheet_to_json as any)(\r\n                worksheet,\r\n                { header: 1 }\r\n              );\r\n\r\n              if (jsonData.length === 0) {\r\n                reject(new Error('Excel file is empty'));\r\n                return;\r\n              }\r\n\r\n              const headers = (jsonData[0] as string[]) || [];\r\n              const dataRows = jsonData.slice(1) as any[][];\r\n              const objectRows = dataRows.map((row: any[]) => {\r\n                const obj: Record<string, any> = {};\r\n                headers.forEach((header, index) => {\r\n                  obj[header] = row[index] || '';\r\n                });\r\n                return obj;\r\n              });\r\n\r\n              resolve({\r\n                headers,\r\n                rows: objectRows.slice(0, 10),\r\n                totalRows: dataRows.length,\r\n              });\r\n            } catch (error) {\r\n              reject(\r\n                new Error(\r\n                  `Excel parsing error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n                )\r\n              );\r\n            }\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        } else {\r\n          reject(\r\n            new Error(\r\n              'Unsupported file format. Please use CSV, XLS, or XLSX files.'\r\n            )\r\n          );\r\n        }\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const handleFileChange = async (\r\n    event: React.ChangeEvent<HTMLInputElement>\r\n  ) => {\r\n    const selectedFile = event.target.files?.[0];\r\n    if (!selectedFile) {\r\n      return;\r\n    }\r\n\r\n    setFile(selectedFile);\r\n    setResult(null);\r\n    setPreviewData(null);\r\n    setFieldMapping([]);\r\n\r\n    try {\r\n      setLoading(true);\r\n      const data = await parseFile(selectedFile);\r\n      setPreviewData(data);\r\n\r\n      // Auto-detect field mapping based on headers\r\n      const detectedMapping = detectFieldMapping(data.headers, activeTab);\r\n      setFieldMapping(detectedMapping);\r\n      setShowPreview(true);\r\n    } catch (error) {\r\n      toast.error(`Failed to parse file: ${(error as Error).message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const detectFieldMapping = (\r\n    headers: string[],\r\n    type: string\r\n  ): FieldMapping[] => {\r\n    const availableFields = headers.map((h) => h.toLowerCase().trim());\r\n\r\n    if (type === 'students') {\r\n      const studentFields = [\r\n        'name',\r\n        'firstname',\r\n        'lastname',\r\n        'studentid',\r\n        'gradelevel',\r\n        'gradecategory',\r\n        'section',\r\n        'email',\r\n        'phone',\r\n      ];\r\n      const mapping: FieldMapping[] = [];\r\n\r\n      availableFields.forEach((header) => {\r\n        if (studentFields.includes(header)) {\r\n          let target = header;\r\n          if (header === 'firstname') {\r\n            target = 'firstName';\r\n          }\r\n          if (header === 'lastname') {\r\n            target = 'lastName';\r\n          }\r\n          if (header === 'studentid') {\r\n            target = 'studentId';\r\n          }\r\n          if (header === 'gradelevel') {\r\n            target = 'gradeLevel';\r\n          }\r\n          if (header === 'gradecategory') {\r\n            target = 'gradeCategory';\r\n          }\r\n\r\n          mapping.push({\r\n            source: header,\r\n            target,\r\n            required: ['name', 'firstname', 'lastname', 'gradelevel'].includes(\r\n              header\r\n            ),\r\n          });\r\n        }\r\n      });\r\n\r\n      return mapping;\r\n    } else if (type === 'books') {\r\n      const bookFields = [\r\n        'accessionno',\r\n        'title',\r\n        'author',\r\n        'isbn',\r\n        'edition',\r\n        'category',\r\n        'publisher',\r\n        'year',\r\n      ];\r\n      const mapping: FieldMapping[] = [];\r\n\r\n      availableFields.forEach((header) => {\r\n        if (bookFields.includes(header)) {\r\n          let target = header;\r\n          if (header === 'accessionno') {\r\n            target = 'accessionNo';\r\n          }\r\n\r\n          mapping.push({\r\n            source: header,\r\n            target,\r\n            required: ['accessionno', 'title', 'author'].includes(header),\r\n          });\r\n        }\r\n      });\r\n\r\n      return mapping;\r\n    }\r\n\r\n    return [];\r\n  };\r\n\r\n  const applyFieldMapping = (rows: any[]): any[] => {\r\n    return rows.map((row) => {\r\n      const mapped: Record<string, any> = {};\r\n\r\n      fieldMapping.forEach((mapping) => {\r\n        const sourceValue = row[mapping.source];\r\n        if (sourceValue !== undefined && sourceValue !== '') {\r\n          mapped[mapping.target] = sourceValue;\r\n        }\r\n      });\r\n\r\n      // Special handling for name field\r\n      if (mapped.name && !mapped.firstName && !mapped.lastName) {\r\n        const nameParts = mapped.name.split(',').map((p: string) => p.trim());\r\n        if (nameParts.length >= 2) {\r\n          mapped.lastName = nameParts[0];\r\n          mapped.firstName = nameParts[1];\r\n        } else if (nameParts.length === 1) {\r\n          const spaceParts = nameParts[0].split(' ');\r\n          if (spaceParts.length >= 2) {\r\n            mapped.firstName = spaceParts[0];\r\n            mapped.lastName = spaceParts.slice(1).join(' ');\r\n          } else {\r\n            mapped.firstName = nameParts[0];\r\n          }\r\n        }\r\n      }\r\n\r\n      return mapped;\r\n    });\r\n  };\r\n\r\n  const handleImport = async () => {\r\n    if (!file || !fieldMapping.length) {\r\n      toast.error('Please select a file and configure field mapping');\r\n      return;\r\n    }\r\n\r\n    const token = localStorage.getItem('clms_token');\r\n    if (!token) {\r\n      toast.error('Please login first to import data');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setImportProgress(0);\r\n    setResult(null);\r\n\r\n    try {\r\n      // Parse the complete file\r\n      const completeData = await parseFile(file);\r\n      applyFieldMapping(completeData.rows);\r\n\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      formData.append('mapping', JSON.stringify(fieldMapping));\r\n\r\n      const endpoint =\r\n        activeTab === 'students' ? '/import/students' : '/import/books';\r\n\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}${endpoint}`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          onUploadProgress: (progressEvent) => {\r\n            const progress = Math.round(\r\n              (progressEvent.loaded * 100) / progressEvent.total!\r\n            );\r\n            setImportProgress(progress);\r\n          },\r\n        }\r\n      );\r\n\r\n      setResult(response.data.data);\r\n      setFile(null);\r\n      setPreviewData(null);\r\n      setFieldMapping([]);\r\n      setShowPreview(false);\r\n\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n\r\n      toast.success(\r\n        `Import completed: ${response.data.data.importedRecords} ${activeTab} imported`\r\n      );\r\n    } catch (err: unknown) {\r\n      toast.error(getErrorMessage(err, 'Failed to import data'));\r\n    } finally {\r\n      setLoading(false);\r\n      setImportProgress(0);\r\n    }\r\n  };\r\n\r\n  const downloadTemplate = async (\r\n    type: 'students' | 'books',\r\n    format: 'csv' | 'xlsx'\r\n  ) => {\r\n    const token = localStorage.getItem('clms_token');\r\n    if (!token) {\r\n      toast.error('Please login first to download templates');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      let data: string;\r\n      let filename: string;\r\n      let mimeType: string;\r\n\r\n      if (type === 'students') {\r\n        const headers = ['name', 'gradeLevel', 'section', 'email', 'phone'];\r\n        const sampleData = [\r\n          ['Doe, John', '10', 'A', 'john.doe@school.edu', '555-0123'],\r\n          ['Smith, Jane', '11', 'B', 'jane.smith@school.edu', '555-0124'],\r\n          ['Johnson, Mike', '9', 'A', 'mike.johnson@school.edu', '555-0125'],\r\n        ];\r\n\r\n        data = [headers, ...sampleData].map((row) => row.join(',')).join('\\n');\r\n        filename = `students-template.${format}`;\r\n        mimeType =\r\n          format === 'csv'\r\n            ? 'text/csv'\r\n            : 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\r\n\r\n        if (format === 'xlsx') {\r\n          const worksheet = XLSX.utils.aoa_to_sheet([headers, ...sampleData]);\r\n          const workbook = XLSX.utils.book_new();\r\n          XLSX.utils.book_append_sheet(workbook, worksheet, 'Students');\r\n          data = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\r\n        }\r\n      } else {\r\n        const headers = [\r\n          'accessionNo',\r\n          'title',\r\n          'author',\r\n          'isbn',\r\n          'category',\r\n          'publisher',\r\n          'year',\r\n        ];\r\n        const sampleData = [\r\n          [\r\n            'B001',\r\n            'To Kill a Mockingbird',\r\n            'Harper Lee',\r\n            '9780061120084',\r\n            'Fiction',\r\n            'J.B. Lippincott & Co.',\r\n            '1960',\r\n          ],\r\n          [\r\n            'B002',\r\n            '1984',\r\n            'George Orwell',\r\n            '9780451524935',\r\n            'Fiction',\r\n            'Secker & Warburg',\r\n            '1949',\r\n          ],\r\n          [\r\n            'B003',\r\n            'The Great Gatsby',\r\n            'F. Scott Fitzgerald',\r\n            '9780743273565',\r\n            'Fiction',\r\n            \"Charles Scribner's Sons\",\r\n            '1925',\r\n          ],\r\n        ];\r\n\r\n        data = [headers, ...sampleData].map((row) => row.join(',')).join('\\n');\r\n        filename = `books-template.${format}`;\r\n        mimeType =\r\n          format === 'csv'\r\n            ? 'text/csv'\r\n            : 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\r\n\r\n        if (format === 'xlsx') {\r\n          const worksheet = XLSX.utils.aoa_to_sheet([headers, ...sampleData]);\r\n          const workbook = XLSX.utils.book_new();\r\n          XLSX.utils.book_append_sheet(workbook, worksheet, 'Books');\r\n          data = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\r\n        }\r\n      }\r\n\r\n      const blob = new Blob([data], { type: mimeType });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = filename;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success(`${format.toUpperCase()} template downloaded`);\r\n    } catch (err) {\r\n      toast.error('Failed to download template');\r\n    }\r\n  };\r\n\r\n  const renderPreview = () => {\r\n    if (!previewData) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Dialog open={showPreview} onOpenChange={setShowPreview}>\r\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Eye className=\"h-5 w-5\" />\r\n              File Preview - {file?.name}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              Preview of first 10 rows from {previewData.totalRows} total\r\n              records\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            {/* File Info */}\r\n            <div className=\"flex items-center gap-4 p-4 bg-gray-50 rounded-lg\">\r\n              <FileText className=\"h-5 w-5 text-gray-600\" />\r\n              <div>\r\n                <p className=\"font-medium\">{file?.name}</p>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {previewData.totalRows} rows ΓÇó {previewData.headers.length}{' '}\r\n                  columns\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Field Mapping */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">\r\n                  Field Mapping Configuration\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-2\">\r\n                  {fieldMapping.length === 0 ? (\r\n                    <Alert>\r\n                      <AlertCircle className=\"h-4 w-4\" />\r\n                      <AlertTitle>No fields detected</AlertTitle>\r\n                      <AlertDescription>\r\n                        Please ensure your file contains recognizable column\r\n                        headers.\r\n                      </AlertDescription>\r\n                    </Alert>\r\n                  ) : (\r\n                    fieldMapping.map((mapping, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"flex items-center gap-2 p-2 border rounded\"\r\n                      >\r\n                        <ArrowRight className=\"h-4 w-4 text-gray-400\" />\r\n                        <span className=\"font-mono text-sm bg-gray-100 px-2 py-1 rounded\">\r\n                          {mapping.source}\r\n                        </span>\r\n                        <span className=\"text-gray-500\">ΓåÆ</span>\r\n                        <span className=\"font-mono text-sm bg-blue-100 px-2 py-1 rounded\">\r\n                          {mapping.target}\r\n                        </span>\r\n                        {mapping.required && (\r\n                          <Badge variant=\"destructive\" className=\"text-xs\">\r\n                            Required\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    ))\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Data Preview */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">Data Preview</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        {previewData.headers.map((header, index) => (\r\n                          <TableHead key={index} className=\"font-mono text-xs\">\r\n                            {header}\r\n                          </TableHead>\r\n                        ))}\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {previewData.rows.map((row, rowIndex) => (\r\n                        <TableRow key={rowIndex}>\r\n                          {previewData.headers.map((header, colIndex) => (\r\n                            <TableCell\r\n                              key={colIndex}\r\n                              className=\"font-mono text-xs\"\r\n                            >\r\n                              {(row as Record<string, any>)[header] || '-'}\r\n                            </TableCell>\r\n                          ))}\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 pt-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowPreview(false)}\r\n              className=\"flex-1\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              Back\r\n            </Button>\r\n            <Button\r\n              onClick={handleImport}\r\n              disabled={loading || fieldMapping.length === 0}\r\n              className=\"flex-1\"\r\n            >\r\n              {loading ? (\r\n                <>\r\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                  Importing...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Upload className=\"h-4 w-4 mr-2\" />\r\n                  Import {activeTab === 'students' ? 'Students' : 'Books'}\r\n                </>\r\n              )}\r\n            </Button>\r\n          </div>\r\n\r\n          {loading && (\r\n            <div className=\"space-y-2\">\r\n              <Progress value={importProgress} />\r\n              <p className=\"text-sm text-center text-gray-600\">\r\n                {importProgress}% complete\r\n              </p>\r\n            </div>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  };\r\n\r\n  const renderImportResult = () => {\r\n    if (!result) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <Card className=\"mt-6\">\r\n        <CardContent className=\"pt-6 space-y-4\">\r\n          <div className=\"flex items-center gap-2 text-lg font-semibold\">\r\n            <Database className=\"h-5 w-5\" />\r\n            Import Results\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            <Badge variant=\"secondary\" className=\"justify-center py-2\">\r\n              <Info className=\"h-4 w-4 mr-1\" />\r\n              Total: {result.totalRecords}\r\n            </Badge>\r\n            <Badge className=\"justify-center py-2 bg-green-500 hover:bg-green-600\">\r\n              <CheckCircle className=\"h-4 w-4 mr-1\" />\r\n              Imported: {result.importedRecords}\r\n            </Badge>\r\n            <Badge\r\n              variant=\"outline\"\r\n              className=\"justify-center py-2 border-yellow-500 text-yellow-600\"\r\n            >\r\n              <AlertCircle className=\"h-4 w-4 mr-1\" />\r\n              Skipped: {result.skippedRecords}\r\n            </Badge>\r\n            <Badge variant=\"destructive\" className=\"justify-center py-2\">\r\n              <AlertCircle className=\"h-4 w-4 mr-1\" />\r\n              Errors: {result.errorRecords}\r\n            </Badge>\r\n          </div>\r\n\r\n          {result.errors.length > 0 && (\r\n            <Alert variant=\"destructive\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <AlertTitle>Error Details ({result.errors.length})</AlertTitle>\r\n              <AlertDescription>\r\n                <div className=\"mt-2 max-h-40 overflow-y-auto space-y-1\">\r\n                  {result.errors.slice(0, 10).map((error, index) => (\r\n                    <div key={index} className=\"text-sm\">\r\n                      ΓÇó {error}\r\n                    </div>\r\n                  ))}\r\n                  {result.errors.length > 10 && (\r\n                    <div className=\"text-sm italic\">\r\n                      ... and {result.errors.length - 10} more\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setResult(null)}\r\n              className=\"flex-1\"\r\n            >\r\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n              Import Another File\r\n            </Button>\r\n            <Button onClick={() => window.location.reload()} className=\"flex-1\">\r\n              <Zap className=\"h-4 w-4 mr-2\" />\r\n              Start Fresh\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h2 className=\"text-3xl font-bold tracking-tight\">\r\n          Enhanced Import Manager\r\n        </h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Import students and books from CSV or Excel files with intelligent\r\n          field mapping\r\n        </p>\r\n      </div>\r\n\r\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n        <TabsList className=\"grid w-full md:w-auto grid-cols-2\">\r\n          <TabsTrigger value=\"students\">\r\n            <Users className=\"h-4 w-4 mr-2\" />\r\n            Students\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"books\">\r\n            <BookOpen className=\"h-4 w-4 mr-2\" />\r\n            Books\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"students\" className=\"space-y-4 mt-6\">\r\n          <Alert>\r\n            <Info className=\"h-4 w-4\" />\r\n            <AlertTitle>Enhanced Student Import</AlertTitle>\r\n            <AlertDescription>\r\n              <strong>Supported formats:</strong> CSV, XLS, XLSX\r\n              <br />\r\n              <strong>Auto-detects:</strong> Name format, field mapping, data\r\n              types\r\n              <br />\r\n              <strong>Template formats:</strong> Standard (name, grade, section)\r\n              or Detailed (separate first/last names)\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <FileSpreadsheet className=\"h-5 w-5\" />\r\n                Import Configuration\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              {/* Template Downloads */}\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-sm font-medium\">Download Templates:</p>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => downloadTemplate('students', 'csv')}\r\n                  >\r\n                    <FileDown className=\"h-4 w-4 mr-2\" />\r\n                    CSV Template\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => downloadTemplate('students', 'xlsx')}\r\n                  >\r\n                    <FileDown className=\"h-4 w-4 mr-2\" />\r\n                    Excel Template\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* File Upload */}\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-sm font-medium\">Select File:</p>\r\n                <input\r\n                  ref={fileInputRef}\r\n                  accept=\".csv,.xlsx,.xls\"\r\n                  style={{ display: 'none' }}\r\n                  id=\"student-file-upload\"\r\n                  type=\"file\"\r\n                  onChange={handleFileChange}\r\n                />\r\n                <label htmlFor=\"student-file-upload\">\r\n                  <Button variant=\"secondary\" asChild disabled={loading}>\r\n                    <span className=\"cursor-pointer\">\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Select CSV or Excel File\r\n                    </span>\r\n                  </Button>\r\n                </label>\r\n                {file && (\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Selected: {file.name} ({(file.size / 1024).toFixed(1)} KB)\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Quick Actions */}\r\n              <div className=\"flex gap-2\">\r\n                <Button\r\n                  onClick={() => setShowPreview(true)}\r\n                  disabled={!file || !previewData}\r\n                  variant=\"outline\"\r\n                  className=\"flex-1\"\r\n                >\r\n                  <Eye className=\"h-4 w-4 mr-2\" />\r\n                  Preview & Configure\r\n                </Button>\r\n                <Button\r\n                  onClick={handleImport}\r\n                  disabled={!file || !fieldMapping.length || loading}\r\n                  className=\"flex-1\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                      Importing...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Import Students\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n\r\n              {loading && (\r\n                <div className=\"space-y-2\">\r\n                  <Progress value={importProgress} />\r\n                  <p className=\"text-sm text-center text-gray-600\">\r\n                    Processing: {importProgress}%\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {renderImportResult()}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"books\" className=\"space-y-4 mt-6\">\r\n          <Alert>\r\n            <Info className=\"h-4 w-4\" />\r\n            <AlertTitle>Enhanced Book Import</AlertTitle>\r\n            <AlertDescription>\r\n              <strong>Supported formats:</strong> CSV, XLS, XLSX\r\n              <br />\r\n              <strong>Auto-detects:</strong> Field mapping, data types,\r\n              categories\r\n              <br />\r\n              <strong>Template formats:</strong> Basic (accession, title,\r\n              author) or Detailed (complete metadata)\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <FileSpreadsheet className=\"h-5 w-5\" />\r\n                Import Configuration\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              {/* Template Downloads */}\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-sm font-medium\">Download Templates:</p>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => downloadTemplate('books', 'csv')}\r\n                  >\r\n                    <FileDown className=\"h-4 w-4 mr-2\" />\r\n                    CSV Template\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => downloadTemplate('books', 'xlsx')}\r\n                  >\r\n                    <FileDown className=\"h-4 w-4 mr-2\" />\r\n                    Excel Template\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* File Upload */}\r\n              <div className=\"space-y-2\">\r\n                <p className=\"text-sm font-medium\">Select File:</p>\r\n                <input\r\n                  accept=\".csv,.xlsx,.xls\"\r\n                  style={{ display: 'none' }}\r\n                  id=\"book-file-upload\"\r\n                  type=\"file\"\r\n                  onChange={handleFileChange}\r\n                />\r\n                <label htmlFor=\"book-file-upload\">\r\n                  <Button variant=\"secondary\" asChild disabled={loading}>\r\n                    <span className=\"cursor-pointer\">\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Select CSV or Excel File\r\n                    </span>\r\n                  </Button>\r\n                </label>\r\n                {file && (\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Selected: {file.name} ({(file.size / 1024).toFixed(1)} KB)\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Quick Actions */}\r\n              <div className=\"flex gap-2\">\r\n                <Button\r\n                  onClick={() => setShowPreview(true)}\r\n                  disabled={!file || !previewData}\r\n                  variant=\"outline\"\r\n                  className=\"flex-1\"\r\n                >\r\n                  <Eye className=\"h-4 w-4 mr-2\" />\r\n                  Preview & Configure\r\n                </Button>\r\n                <Button\r\n                  onClick={handleImport}\r\n                  disabled={!file || !fieldMapping.length || loading}\r\n                  className=\"flex-1\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                      Importing...\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Upload className=\"h-4 w-4 mr-2\" />\r\n                      Import Books\r\n                    </>\r\n                  )}\r\n                </Button>\r\n              </div>\r\n\r\n              {loading && (\r\n                <div className=\"space-y-2\">\r\n                  <Progress value={importProgress} />\r\n                  <p className=\"text-sm text-center text-gray-600\">\r\n                    Processing: {importProgress}%\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {renderImportResult()}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {renderPreview()}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\LoadingStates.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\NotificationCenter.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1221,1224],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1221,1224],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2433,2436],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2433,2436],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4708,4711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4708,4711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Bell,\r\n  Check,\r\n  CheckCheck,\r\n  Trash2,\r\n  X,\r\n  AlertTriangle,\r\n  Info,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  Clock,\r\n  ExternalLink,\r\n  Settings,\r\n  RefreshCw,\r\n  Filter,\r\n} from 'lucide-react';\r\nimport notificationApi, {\r\n  type AppNotification,\r\n} from '../services/notificationApi';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { useNotificationWebSocket } from '@/hooks/useWebSocket';\r\nimport { toast } from 'sonner';\r\n\r\nconst NotificationCenter: React.FC = () => {\r\n  const { token, user } = useAuth();\r\n  const [notifications, setNotifications] = useState<AppNotification[]>([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filter, setFilter] = useState<'all' | 'unread'>('all');\r\n  const [typeFilter, setTypeFilter] = useState<string>('all');\r\n  const [showPreferences, setShowPreferences] = useState(false);\r\n\r\n  // Real-time WebSocket integration\r\n  const { isConnected } = useNotificationWebSocket();\r\n\r\n  // Handle real-time notifications\r\n  const handleRealTimeNotification = useCallback((message: any) => {\r\n    if (message.type === 'notification') {\r\n      const newNotification = message.payload;\r\n\r\n      // Add to notifications list\r\n      setNotifications((prev) => [newNotification, ...prev.slice(0, 49)]);\r\n\r\n      // Update unread count\r\n      setUnreadCount((prev) => prev + 1);\r\n\r\n      // Show toast notification\r\n      const priority = newNotification.priority;\r\n      const toastConfig = {\r\n        duration:\r\n          priority === 'URGENT' ? 10000 : priority === 'HIGH' ? 5000 : 3000,\r\n      };\r\n\r\n      if (priority === 'URGENT') {\r\n        toast.error(newNotification.title, {\r\n          description: newNotification.message,\r\n          ...toastConfig,\r\n        });\r\n      } else if (priority === 'HIGH') {\r\n        toast.warning(newNotification.title, {\r\n          description: newNotification.message,\r\n          ...toastConfig,\r\n        });\r\n      } else {\r\n        toast.info(newNotification.title, {\r\n          description: newNotification.message,\r\n          ...toastConfig,\r\n        });\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Initialize WebSocket listener\r\n  useEffect(() => {\r\n    if (isConnected && user) {\r\n      // Subscribe to real-time notifications\r\n      const socket = (window as any).socket;\r\n      if (socket) {\r\n        socket.emit('notification:subscribe');\r\n\r\n        // Listen for real-time notifications\r\n        socket.on('notification', handleRealTimeNotification);\r\n\r\n        return () => {\r\n          socket.off('notification', handleRealTimeNotification);\r\n          socket.emit('notification:unsubscribe');\r\n        };\r\n      }\r\n    }\r\n    // Return undefined for cases where cleanup is not needed\r\n    return undefined;\r\n  }, [isConnected, user, handleRealTimeNotification]);\r\n\r\n  const fetchNotifications = useCallback(async () => {\r\n    // Don't fetch if not authenticated\r\n    if (!token) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const params: Record<string, unknown> = {\r\n        unreadOnly: filter === 'unread',\r\n        limit: 50,\r\n      };\r\n\r\n      if (typeFilter !== 'all') {\r\n        params.type = typeFilter;\r\n      }\r\n\r\n      const response = await notificationApi.getNotifications(params);\r\n      setNotifications(response.data.notifications);\r\n      setUnreadCount(response.data.unreadCount);\r\n    } catch (error) {\r\n      console.error('Error fetching notifications:', error);\r\n      // Silently handle errors for non-existent endpoint\r\n      // Don't show toast errors to avoid rendering error objects\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filter, typeFilter, token]);\r\n\r\n  useEffect(() => {\r\n    // Only fetch if authenticated\r\n    if (!token) {\r\n      return;\r\n    }\r\n\r\n    // Initial fetch\r\n    fetchNotifications();\r\n\r\n    // Poll for new notifications every 30 seconds\r\n    const interval = setInterval(() => {\r\n      fetchNotifications();\r\n    }, 30000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [filter, typeFilter, token, fetchNotifications]); // fetchNotifications will be captured by closure when effect re-runs\r\n\r\n  const handleMarkAsRead = async (notificationId: string) => {\r\n    try {\r\n      // Update UI optimistically\r\n      setNotifications((prev) =>\r\n        prev.map((n) =>\r\n          n.id === notificationId\r\n            ? { ...n, read: true, readAt: new Date().toISOString() }\r\n            : n\r\n        )\r\n      );\r\n      setUnreadCount((prev) => Math.max(0, prev - 1));\r\n\r\n      // Mark via WebSocket if available\r\n      const socket = (window as any).socket;\r\n      if (socket && isConnected) {\r\n        socket.emit('notification:mark-read', { notificationId });\r\n      }\r\n\r\n      // Fallback to API call\r\n      await notificationApi.markAsRead(notificationId);\r\n    } catch (error) {\r\n      console.error('Error marking notification as read:', error);\r\n      toast.error('Failed to mark as read');\r\n    }\r\n  };\r\n\r\n  const handleMarkAllAsRead = async () => {\r\n    try {\r\n      await notificationApi.markAllAsRead();\r\n      await fetchNotifications();\r\n    } catch (error) {\r\n      console.error('Error marking all as read:', error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (notificationId: string) => {\r\n    try {\r\n      await notificationApi.deleteNotification(notificationId);\r\n      await fetchNotifications();\r\n    } catch (error) {\r\n      console.error('Error deleting notification:', error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteRead = async () => {\r\n    try {\r\n      await notificationApi.deleteReadNotifications();\r\n      await fetchNotifications();\r\n    } catch (error) {\r\n      console.error('Error deleting read notifications:', error);\r\n    }\r\n  };\r\n\r\n  const getNotificationIcon = (\r\n    type: AppNotification['type'],\r\n    priority: AppNotification['priority']\r\n  ) => {\r\n    const iconClass = `w-5 h-5 ${\r\n      priority === 'URGENT'\r\n        ? 'text-red-600'\r\n        : priority === 'HIGH'\r\n          ? 'text-orange-600'\r\n          : priority === 'NORMAL'\r\n            ? 'text-blue-600'\r\n            : 'text-gray-600'\r\n    }`;\r\n\r\n    switch (type) {\r\n      case 'ERROR':\r\n        return <AlertCircle className={iconClass} />;\r\n      case 'WARNING':\r\n        return <AlertTriangle className={iconClass} />;\r\n      case 'SUCCESS':\r\n        return <CheckCircle className={iconClass} />;\r\n      case 'INFO':\r\n        return <Info className={iconClass} />;\r\n      case 'OVERDUE_BOOK':\r\n      case 'BOOK_DUE_SOON':\r\n      case 'EQUIPMENT_EXPIRING':\r\n        return <Clock className={iconClass} />;\r\n      default:\r\n        return <Bell className={iconClass} />;\r\n    }\r\n  };\r\n\r\n  const getPriorityColor = (priority: AppNotification['priority']) => {\r\n    switch (priority) {\r\n      case 'URGENT':\r\n        return 'border-l-red-600 bg-red-50';\r\n      case 'HIGH':\r\n        return 'border-l-orange-600 bg-orange-50';\r\n      case 'NORMAL':\r\n        return 'border-l-blue-600 bg-blue-50';\r\n      case 'LOW':\r\n        return 'border-l-gray-600 bg-gray-50';\r\n      default:\r\n        return 'border-l-gray-600 bg-gray-50';\r\n    }\r\n  };\r\n\r\n  const formatTime = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    const now = new Date();\r\n    const diffMs = now.getTime() - date.getTime();\r\n    const diffMins = Math.floor(diffMs / 60000);\r\n    const diffHours = Math.floor(diffMins / 60);\r\n    const diffDays = Math.floor(diffHours / 24);\r\n\r\n    if (diffMins < 1) {\r\n      return 'Just now';\r\n    }\r\n    if (diffMins < 60) {\r\n      return `${diffMins}m ago`;\r\n    }\r\n    if (diffHours < 24) {\r\n      return `${diffHours}h ago`;\r\n    }\r\n    if (diffDays < 7) {\r\n      return `${diffDays}d ago`;\r\n    }\r\n    return date.toLocaleDateString();\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      {/* Bell Icon with Badge and Status Indicator */}\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"relative p-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\r\n        title={isConnected ? 'Connected' : 'Disconnected'}\r\n        data-testid=\"notification-center\"\r\n      >\r\n        <Bell className=\"w-6 h-6\" />\r\n\r\n        {/* Connection Status Indicator */}\r\n        <div\r\n          className={`absolute bottom-0 right-0 w-2 h-2 rounded-full ${\r\n            isConnected ? 'bg-green-500' : 'bg-red-500'\r\n          }`}\r\n        />\r\n\r\n        {/* Unread Count Badge */}\r\n        {unreadCount > 0 && (\r\n          <span className=\"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full\">\r\n            {unreadCount > 99 ? '99+' : unreadCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {/* Notification Panel */}\r\n      {isOpen && (\r\n        <>\r\n          {/* Backdrop */}\r\n          <div\r\n            className=\"fixed inset-0 z-40\"\r\n            onClick={() => setIsOpen(false)}\r\n          />\r\n\r\n          {/* Panel */}\r\n          <div className=\"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl z-50 border border-gray-200 max-h-[600px] flex flex-col\">\r\n            {/* Header */}\r\n            <div className=\"p-4 border-b border-gray-200\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\r\n                  Notifications\r\n                  <div\r\n                    className={`w-2 h-2 rounded-full ${\r\n                      isConnected ? 'bg-green-500' : 'bg-red-500'\r\n                    }`}\r\n                    title={\r\n                      isConnected\r\n                        ? 'Real-time connected'\r\n                        : 'Real-time disconnected'\r\n                    }\r\n                  />\r\n                </h3>\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    onClick={fetchNotifications}\r\n                    className=\"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors\"\r\n                    title=\"Refresh notifications\"\r\n                  >\r\n                    <RefreshCw className=\"w-4 h-4\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setShowPreferences(!showPreferences)}\r\n                    className=\"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors\"\r\n                    title=\"Notification preferences\"\r\n                  >\r\n                    <Settings className=\"w-4 h-4\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setIsOpen(false)}\r\n                    className=\"text-gray-500 hover:text-gray-700\"\r\n                  >\r\n                    <X className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Filter Tabs */}\r\n              <div className=\"flex gap-2 mb-3\">\r\n                <button\r\n                  onClick={() => setFilter('all')}\r\n                  className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                    filter === 'all'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  All\r\n                </button>\r\n                <button\r\n                  onClick={() => setFilter('unread')}\r\n                  className={`px-3 py-1 text-sm rounded-md transition-colors ${\r\n                    filter === 'unread'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  Unread ({unreadCount})\r\n                </button>\r\n              </div>\r\n\r\n              {/* Type Filter */}\r\n              <div className=\"flex items-center gap-2 mb-3\">\r\n                <Filter className=\"w-4 h-4 text-gray-500\" />\r\n                <select\r\n                  value={typeFilter}\r\n                  onChange={(e) => setTypeFilter(e.target.value)}\r\n                  className=\"text-sm border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                >\r\n                  <option value=\"all\">All Types</option>\r\n                  <option value=\"OVERDUE_BOOK\">Overdue Books</option>\r\n                  <option value=\"BOOK_DUE_SOON\">Due Soon</option>\r\n                  <option value=\"FINE_ADDED\">Fines</option>\r\n                  <option value=\"EQUIPMENT_EXPIRING\">Equipment</option>\r\n                  <option value=\"SYSTEM_ALERT\">System Alerts</option>\r\n                  <option value=\"INFO\">Information</option>\r\n                  <option value=\"WARNING\">Warnings</option>\r\n                  <option value=\"ERROR\">Errors</option>\r\n                  <option value=\"SUCCESS\">Success</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Action Buttons */}\r\n              {notifications.length > 0 && (\r\n                <div className=\"flex gap-2\">\r\n                  {unreadCount > 0 && (\r\n                    <button\r\n                      onClick={handleMarkAllAsRead}\r\n                      className=\"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                    >\r\n                      <CheckCheck className=\"w-3 h-3\" />\r\n                      Mark all read\r\n                    </button>\r\n                  )}\r\n                  <button\r\n                    onClick={handleDeleteRead}\r\n                    className=\"flex items-center gap-1 px-2 py-1 text-xs text-red-600 hover:bg-red-50 rounded transition-colors\"\r\n                  >\r\n                    <Trash2 className=\"w-3 h-3\" />\r\n                    Clear read\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Notification List */}\r\n            <div className=\"overflow-y-auto flex-1\">\r\n              {loading ? (\r\n                <div className=\"flex items-center justify-center p-8\">\r\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n                </div>\r\n              ) : notifications.length === 0 ? (\r\n                <div className=\"flex flex-col items-center justify-center p-8 text-gray-500\">\r\n                  <Bell className=\"w-12 h-12 mb-2 text-gray-400\" />\r\n                  <p className=\"text-sm\">No notifications</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"divide-y divide-gray-100\">\r\n                  {notifications.map((notification) => (\r\n                    <div\r\n                      key={notification.id}\r\n                      className={`p-4 hover:bg-gray-50 transition-colors border-l-4 ${\r\n                        notification.read ? 'opacity-75' : ''\r\n                      } ${getPriorityColor(notification.priority)}`}\r\n                    >\r\n                      <div className=\"flex gap-3\">\r\n                        {/* Icon */}\r\n                        <div className=\"flex-shrink-0 mt-0.5\">\r\n                          {getNotificationIcon(\r\n                            notification.type,\r\n                            notification.priority\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* Content */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-start justify-between gap-2\">\r\n                            <h4 className=\"text-sm font-semibold text-gray-900\">\r\n                              {notification.title}\r\n                            </h4>\r\n                            <span className=\"text-xs text-gray-500 whitespace-nowrap\">\r\n                              {formatTime(notification.createdAt)}\r\n                            </span>\r\n                          </div>\r\n\r\n                          <p className=\"mt-1 text-sm text-gray-600 line-clamp-2\">\r\n                            {notification.message}\r\n                          </p>\r\n\r\n                          {/* Actions */}\r\n                          <div className=\"flex items-center gap-2 mt-2\">\r\n                            {!notification.read && (\r\n                              <button\r\n                                onClick={() =>\r\n                                  handleMarkAsRead(notification.id)\r\n                                }\r\n                                className=\"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:bg-blue-100 rounded transition-colors\"\r\n                                title=\"Mark as read\"\r\n                              >\r\n                                <Check className=\"w-3 h-3\" />\r\n                                Read\r\n                              </button>\r\n                            )}\r\n                            {notification.actionUrl && (\r\n                              <a\r\n                                href={notification.actionUrl}\r\n                                className=\"flex items-center gap-1 px-2 py-1 text-xs text-green-600 hover:bg-green-100 rounded transition-colors\"\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                              >\r\n                                <ExternalLink className=\"w-3 h-3\" />\r\n                                View\r\n                              </a>\r\n                            )}\r\n                            <button\r\n                              onClick={() => handleDelete(notification.id)}\r\n                              className=\"flex items-center gap-1 px-2 py-1 text-xs text-red-600 hover:bg-red-100 rounded transition-colors ml-auto\"\r\n                              title=\"Delete\"\r\n                            >\r\n                              <Trash2 className=\"w-3 h-3\" />\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationCenter;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\NotificationPreferences.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\OptimizedLazyLoad.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[187,190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[187,190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":152,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":152,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3787,3790],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3787,3790],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":162,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":162,"endColumn":40},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has a missing dependency: 'options'. Either include it or remove the dependency array.","line":192,"column":6,"nodeType":"ArrayExpression","endLine":192,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [ref, options.threshold, options.rootMargin, options]","fix":{"range":[4653,4697],"text":"[ref, options.threshold, options.rootMargin, options]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":198,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":198,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4875,4878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4875,4878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4997,5000],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4997,5000],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":264,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":264,"endColumn":32},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":271,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":271,"endColumn":31},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":327,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":327,"endColumn":37}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { Suspense, lazy, type ComponentType } from 'react';\r\nimport { Loader2 } from 'lucide-react';\r\n\r\ninterface LazyLoadProps {\r\n  loader: () => Promise<{ default: ComponentType<any> }>;\r\n  fallback?: React.ReactNode;\r\n  error?: React.ReactNode;\r\n  delay?: number;\r\n  className?: string;\r\n}\r\n\r\ninterface LoadingSpinnerProps {\r\n  size?: 'sm' | 'md' | 'lg';\r\n  message?: string;\r\n  className?: string;\r\n}\r\n\r\nexport function LoadingSpinner({\r\n  size = 'md',\r\n  message = 'Loading...',\r\n  className = '',\r\n}: LoadingSpinnerProps) {\r\n  const sizeClasses = {\r\n    sm: 'w-4 h-4',\r\n    md: 'w-6 h-6',\r\n    lg: 'w-8 h-8',\r\n  };\r\n\r\n  return (\r\n    <div className={`flex items-center justify-center p-4 ${className}`}>\r\n      <div className=\"flex flex-col items-center space-y-2\">\r\n        <Loader2 className={`animate-spin ${sizeClasses[size]} text-primary`} />\r\n        <span className=\"text-sm text-muted-foreground\">{message}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function ErrorFallback({\r\n  message = 'Failed to load component',\r\n  onRetry,\r\n}: {\r\n  message?: string;\r\n  onRetry?: () => void;\r\n}) {\r\n  return (\r\n    <div className=\"flex items-center justify-center p-4\">\r\n      <div className=\"text-center\">\r\n        <div className=\"text-red-500 mb-2\">ΓÜá∩╕Å</div>\r\n        <p className=\"text-sm text-muted-foreground mb-2\">{message}</p>\r\n        {onRetry && (\r\n          <button\r\n            onClick={onRetry}\r\n            className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors\"\r\n          >\r\n            Retry\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nclass ErrorBoundary extends React.Component<\r\n  { children: React.ReactNode; fallback?: React.ReactNode },\r\n  { hasError: boolean; error?: Error }\r\n> {\r\n  constructor(props: {\r\n    children: React.ReactNode;\r\n    fallback?: React.ReactNode;\r\n  }) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error) {\r\n    return { hasError: true, error };\r\n  }\r\n\r\n  override componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    console.error('LazyLoad Error Boundary:', error, errorInfo);\r\n  }\r\n\r\n  override render() {\r\n    if (this.state.hasError) {\r\n      const errorMessage = this.state.error?.message;\r\n      return (\r\n        this.props.fallback || (\r\n          <ErrorFallback {...(errorMessage && { message: errorMessage })} />\r\n        )\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport function OptimizedLazyLoad({\r\n  loader,\r\n  fallback,\r\n  error,\r\n  delay = 200,\r\n  className = '',\r\n}: LazyLoadProps) {\r\n  const LazyComponent = lazy(() => {\r\n    return loader().catch((err) => {\r\n      console.error('Failed to load component:', err);\r\n      // Return a default error component\r\n      return {\r\n        default: () =>\r\n          error || <ErrorFallback message=\"Failed to load component\" />,\r\n      };\r\n    });\r\n  });\r\n\r\n  const [showFallback, setShowFallback] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setShowFallback(true);\r\n    }, delay);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [delay]);\r\n\r\n  const defaultFallback = (\r\n    <LoadingSpinner\r\n      size=\"lg\"\r\n      message=\"Loading component...\"\r\n      className={className}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <ErrorBoundary fallback={error}>\r\n      <Suspense\r\n        fallback={\r\n          showFallback ? (\r\n            fallback || defaultFallback\r\n          ) : (\r\n            <div className={className} />\r\n          )\r\n        }\r\n      >\r\n        <LazyComponent />\r\n      </Suspense>\r\n    </ErrorBoundary>\r\n  );\r\n}\r\n\r\n// Preload utilities\r\nexport function preloadComponent(\r\n  loader: () => Promise<{ default: ComponentType<any> }>\r\n) {\r\n  // Start loading the component in the background\r\n  loader().catch(() => {\r\n    // Ignore errors during preloading\r\n  });\r\n}\r\n\r\n// Intersection Observer for lazy loading\r\nexport function useIntersectionObserver(\r\n  ref: React.RefObject<Element | null>,\r\n  options: IntersectionObserverInit = {}\r\n) {\r\n  const [isIntersecting, setIsIntersecting] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    const element = ref.current;\r\n    if (!element) {\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => {\r\n        if (entry) {\r\n          setIsIntersecting(entry.isIntersecting);\r\n        }\r\n      },\r\n      {\r\n        threshold: 0.1,\r\n        rootMargin: '50px',\r\n        ...options,\r\n      }\r\n    );\r\n\r\n    observer.observe(element);\r\n\r\n    return () => {\r\n      observer.unobserve(element);\r\n    };\r\n  }, [ref, options.threshold, options.rootMargin]);\r\n\r\n  return isIntersecting;\r\n}\r\n\r\n// Hook for lazy loading components when they come into view\r\nexport function useLazyLoad(\r\n  loader: () => Promise<{ default: ComponentType<any> }>,\r\n  options: IntersectionObserverInit = {}\r\n) {\r\n  const [Component, setComponent] = React.useState<ComponentType<any> | null>(\r\n    null\r\n  );\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [error, setError] = React.useState<Error | null>(null);\r\n  const ref = React.useRef<HTMLDivElement>(null);\r\n  const isIntersecting = useIntersectionObserver(ref, options);\r\n\r\n  React.useEffect(() => {\r\n    if (isIntersecting && !Component && !loading) {\r\n      setLoading(true);\r\n      loader()\r\n        .then(({ default: LoadedComponent }) => {\r\n          setComponent(() => LoadedComponent);\r\n          setError(null);\r\n        })\r\n        .catch((err) => {\r\n          setError(err);\r\n          setComponent(null);\r\n        })\r\n        .finally(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [isIntersecting, loader, Component, loading]);\r\n\r\n  return { Component, loading, error, ref };\r\n}\r\n\r\n// Component for lazy loading with intersection observer\r\nexport function LazyLoadOnIntersection({\r\n  loader,\r\n  fallback,\r\n  error,\r\n  className = '',\r\n}: Omit<LazyLoadProps, 'delay'> & { className?: string }) {\r\n  const { Component, loading, error: loadError, ref } = useLazyLoad(loader);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div ref={ref} className={className}>\r\n        {fallback || <LoadingSpinner size=\"md\" />}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loadError) {\r\n    return (\r\n      <div ref={ref} className={className}>\r\n        {error || <ErrorFallback message={loadError.message} />}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (Component) {\r\n    return <Component />;\r\n  }\r\n\r\n  return <div ref={ref} className={className} />;\r\n}\r\n\r\n// Resource hint utilities\r\nexport function addPrefetchLink(href: string) {\r\n  const link = document.createElement('link');\r\n  link.rel = 'prefetch';\r\n  link.href = href;\r\n  document.head.appendChild(link);\r\n}\r\n\r\nexport function addPreloadLink(href: string, as: string) {\r\n  const link = document.createElement('link');\r\n  link.rel = 'preload';\r\n  link.href = href;\r\n  link.as = as;\r\n  document.head.appendChild(link);\r\n}\r\n\r\n// Image lazy loading component\r\nexport function LazyImage({\r\n  src,\r\n  alt,\r\n  className = '',\r\n  placeholder = '/placeholder.svg',\r\n  ...props\r\n}: React.ImgHTMLAttributes<HTMLImageElement> & { placeholder?: string }) {\r\n  const [isLoaded, setIsLoaded] = React.useState(false);\r\n  const [isInView, setIsInView] = React.useState(false);\r\n  const imgRef = React.useRef<HTMLImageElement>(null);\r\n\r\n  React.useEffect(() => {\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => {\r\n        if (entry && entry.isIntersecting) {\r\n          setIsInView(true);\r\n          observer.disconnect();\r\n        }\r\n      },\r\n      { threshold: 0.1 }\r\n    );\r\n\r\n    if (imgRef.current) {\r\n      observer.observe(imgRef.current);\r\n    }\r\n\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      <img\r\n        ref={imgRef}\r\n        src={isInView ? src : placeholder}\r\n        alt={alt}\r\n        className={`transition-opacity duration-300 ${\r\n          isLoaded ? 'opacity-100' : 'opacity-70'\r\n        } ${className}`}\r\n        onLoad={() => setIsLoaded(true)}\r\n        loading=\"lazy\"\r\n        {...props}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\n// Bundle size monitoring\r\nexport function useBundleSizeMonitor() {\r\n  const [bundleSize, setBundleSize] = React.useState<number | null>(null);\r\n\r\n  React.useEffect(() => {\r\n    // Monitor performance entries for bundle loading\r\n    const observer = new PerformanceObserver((list) => {\r\n      const entries = list.getEntries();\r\n      for (const entry of entries) {\r\n        if (entry.name.includes('chunk') || entry.name.includes('bundle')) {\r\n          const resource = entry as PerformanceResourceTiming;\r\n          if (resource.transferSize) {\r\n            setBundleSize((prev) => (prev || 0) + resource.transferSize);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    try {\r\n      observer.observe({ entryTypes: ['resource'] });\r\n    } catch (error) {\r\n      console.debug('Performance observer not supported');\r\n    }\r\n\r\n    return () => observer.disconnect();\r\n  }, []);\r\n\r\n  return bundleSize;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\PerformanceMonitor.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'collectPerformanceMetrics'. Either include it or remove the dependency array.","line":35,"column":6,"nodeType":"ArrayExpression","endLine":35,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [collectPerformanceMetrics]","fix":{"range":[966,968],"text":"[collectPerformanceMetrics]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1784,1787],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1784,1787],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  Activity,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  BarChart3,\r\n  Clock,\r\n  Zap,\r\n  Timer,\r\n} from 'lucide-react';\r\n\r\ninterface PerformanceMetrics {\r\n  loadTime: number;\r\n  firstContentfulPaint: number;\r\n  largestContentfulPaint: number;\r\n  cumulativeLayoutShift: number;\r\n  firstInputDelay: number;\r\n  bundleSize: number;\r\n  memoryUsage: number;\r\n  renderTime: number;\r\n}\r\n\r\nexport default function PerformanceMonitor() {\r\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Only run in development or when manually enabled\r\n    if (process.env.NODE_ENV === 'development') {\r\n      collectPerformanceMetrics();\r\n    }\r\n  }, []);\r\n\r\n  const collectPerformanceMetrics = () => {\r\n    if (!window.performance) {\r\n      return;\r\n    }\r\n\r\n    const navigation = performance.getEntriesByType(\r\n      'navigation'\r\n    )[0] as PerformanceNavigationTiming;\r\n    const paint = performance.getEntriesByType('paint');\r\n    const fcp =\r\n      paint.find((entry) => entry.name === 'first-contentful-paint')\r\n        ?.startTime || 0;\r\n\r\n    // Simulate LCP (in real implementation, you'd use the PerformanceObserver)\r\n    const lcp = Math.max(fcp + 1000, Math.random() * 2000 + 1000);\r\n\r\n    // Simulate CLS and FID\r\n    const cls = Math.random() * 0.1;\r\n    const fid = Math.random() * 100;\r\n\r\n    // Estimate bundle size (simplified)\r\n    const bundleSize = estimateBundleSize();\r\n\r\n    // Memory usage (if available)\r\n    const memory = (performance as any).memory;\r\n    const memoryUsage = memory ? memory.usedJSHeapSize / 1024 / 1024 : 0;\r\n\r\n    // Calculate render time\r\n    const renderTime =\r\n      navigation.loadEventEnd - navigation.domContentLoadedEventStart;\r\n\r\n    setMetrics({\r\n      loadTime: navigation.loadEventEnd - navigation.startTime,\r\n      firstContentfulPaint: fcp,\r\n      largestContentfulPaint: lcp,\r\n      cumulativeLayoutShift: cls,\r\n      firstInputDelay: fid,\r\n      bundleSize,\r\n      memoryUsage,\r\n      renderTime,\r\n    });\r\n  };\r\n\r\n  const estimateBundleSize = () => {\r\n    // This is a simplified estimation\r\n    // In a real implementation, you would get this from build tools\r\n    return Math.random() * 500000 + 1000000; // 1-1.5MB estimate\r\n  };\r\n\r\n  const getPerformanceGrade = (value: number, type: string) => {\r\n    switch (type) {\r\n      case 'loadTime':\r\n        if (value < 3000) {\r\n          return { grade: 'A', color: 'text-green-600' };\r\n        }\r\n        if (value < 5000) {\r\n          return { grade: 'B', color: 'text-yellow-600' };\r\n        }\r\n        return { grade: 'C', color: 'text-red-600' };\r\n\r\n      case 'fcp':\r\n        if (value < 1800) {\r\n          return { grade: 'A', color: 'text-green-600' };\r\n        }\r\n        if (value < 3000) {\r\n          return { grade: 'B', color: 'text-yellow-600' };\r\n        }\r\n        return { grade: 'C', color: 'text-red-600' };\r\n\r\n      case 'lcp':\r\n        if (value < 2500) {\r\n          return { grade: 'A', color: 'text-green-600' };\r\n        }\r\n        if (value < 4000) {\r\n          return { grade: 'B', color: 'text-yellow-600' };\r\n        }\r\n        return { grade: 'C', color: 'text-red-600' };\r\n\r\n      case 'cls':\r\n        if (value < 0.1) {\r\n          return { grade: 'A', color: 'text-green-600' };\r\n        }\r\n        if (value < 0.25) {\r\n          return { grade: 'B', color: 'text-yellow-600' };\r\n        }\r\n        return { grade: 'C', color: 'text-red-600' };\r\n\r\n      case 'fid':\r\n        if (value < 100) {\r\n          return { grade: 'A', color: 'text-green-600' };\r\n        }\r\n        if (value < 300) {\r\n          return { grade: 'B', color: 'text-yellow-600' };\r\n        }\r\n        return { grade: 'C', color: 'text-red-600' };\r\n\r\n      default:\r\n        return { grade: 'N/A', color: 'text-gray-600' };\r\n    }\r\n  };\r\n\r\n  const formatTime = (ms: number) => {\r\n    return `${ms.toFixed(0)}ms`;\r\n  };\r\n\r\n  const formatSize = (bytes: number) => {\r\n    if (bytes < 1024 * 1024) {\r\n      return `${(bytes / 1024).toFixed(1)}KB`;\r\n    }\r\n    return `${(bytes / 1024 / 1024).toFixed(1)}MB`;\r\n  };\r\n\r\n  const refreshMetrics = () => {\r\n    collectPerformanceMetrics();\r\n  };\r\n\r\n  if (!isVisible && process.env.NODE_ENV !== 'development') {\r\n    return (\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        onClick={() => setIsVisible(true)}\r\n        className=\"fixed bottom-4 right-4 z-50\"\r\n      >\r\n        <BarChart3 className=\"w-4 h-4 mr-2\" />\r\n        Performance\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  if (!metrics) {\r\n    return (\r\n      <Card className=\"w-full max-w-2xl\">\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"flex items-center justify-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n            <span className=\"ml-2\">Collecting performance metrics...</span>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  const metricsData = [\r\n    {\r\n      icon: Clock,\r\n      label: 'Load Time',\r\n      value: formatTime(metrics.loadTime),\r\n      grade: getPerformanceGrade(metrics.loadTime, 'loadTime'),\r\n      description: 'Total page load time',\r\n    },\r\n    {\r\n      icon: Zap,\r\n      label: 'First Contentful Paint',\r\n      value: formatTime(metrics.firstContentfulPaint),\r\n      grade: getPerformanceGrade(metrics.firstContentfulPaint, 'fcp'),\r\n      description: 'Time to first meaningful content',\r\n    },\r\n    {\r\n      icon: Timer,\r\n      label: 'Largest Contentful Paint',\r\n      value: formatTime(metrics.largestContentfulPaint),\r\n      grade: getPerformanceGrade(metrics.largestContentfulPaint, 'lcp'),\r\n      description: 'Time to load largest element',\r\n    },\r\n    {\r\n      icon: Activity,\r\n      label: 'Cumulative Layout Shift',\r\n      value: metrics.cumulativeLayoutShift.toFixed(3),\r\n      grade: getPerformanceGrade(metrics.cumulativeLayoutShift, 'cls'),\r\n      description: 'Visual stability score',\r\n    },\r\n    {\r\n      icon: BarChart3,\r\n      label: 'First Input Delay',\r\n      value: formatTime(metrics.firstInputDelay),\r\n      grade: getPerformanceGrade(metrics.firstInputDelay, 'fid'),\r\n      description: 'Responsiveness to user input',\r\n    },\r\n    {\r\n      icon: Zap,\r\n      label: 'Bundle Size',\r\n      value: formatSize(metrics.bundleSize),\r\n      grade: {\r\n        grade:\r\n          metrics.bundleSize < 1500000\r\n            ? 'A'\r\n            : metrics.bundleSize < 2000000\r\n              ? 'B'\r\n              : 'C',\r\n        color:\r\n          metrics.bundleSize < 1500000\r\n            ? 'text-green-600'\r\n            : metrics.bundleSize < 2000000\r\n              ? 'text-yellow-600'\r\n              : 'text-red-600',\r\n      },\r\n      description: 'JavaScript bundle size',\r\n    },\r\n    {\r\n      icon: Activity,\r\n      label: 'Memory Usage',\r\n      value: `${metrics.memoryUsage.toFixed(1)}MB`,\r\n      grade: {\r\n        grade:\r\n          metrics.memoryUsage < 50\r\n            ? 'A'\r\n            : metrics.memoryUsage < 100\r\n              ? 'B'\r\n              : 'C',\r\n        color:\r\n          metrics.memoryUsage < 50\r\n            ? 'text-green-600'\r\n            : metrics.memoryUsage < 100\r\n              ? 'text-yellow-600'\r\n              : 'text-red-600',\r\n      },\r\n      description: 'Current memory consumption',\r\n    },\r\n    {\r\n      icon: Clock,\r\n      label: 'Render Time',\r\n      value: formatTime(metrics.renderTime),\r\n      grade: getPerformanceGrade(metrics.renderTime, 'loadTime'),\r\n      description: 'Time to render the page',\r\n    },\r\n  ];\r\n\r\n  const averageGrade =\r\n    metricsData.reduce((acc, metric) => {\r\n      const grade = metric.grade.grade;\r\n      if (grade === 'A') {\r\n        return acc + 3;\r\n      }\r\n      if (grade === 'B') {\r\n        return acc + 2;\r\n      }\r\n      if (grade === 'C') {\r\n        return acc + 1;\r\n      }\r\n      return acc;\r\n    }, 0) / metricsData.length;\r\n\r\n  const overallGrade =\r\n    averageGrade >= 2.5 ? 'A' : averageGrade >= 1.5 ? 'B' : 'C';\r\n  const overallColor =\r\n    overallGrade === 'A'\r\n      ? 'text-green-600'\r\n      : overallGrade === 'B'\r\n        ? 'text-yellow-600'\r\n        : 'text-red-600';\r\n\r\n  return (\r\n    <Card className=\"w-full max-w-4xl\">\r\n      <CardHeader className=\"flex flex-row items-center justify-between\">\r\n        <div>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Activity className=\"w-5 h-5\" />\r\n            Performance Metrics\r\n          </CardTitle>\r\n          <p className=\"text-sm text-muted-foreground mt-1\">\r\n            Real-time performance monitoring and optimization insights\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Badge\r\n            variant=\"outline\"\r\n            className={`text-lg font-bold ${overallColor}`}\r\n          >\r\n            Grade {overallGrade}\r\n          </Badge>\r\n          <Button variant=\"outline\" size=\"sm\" onClick={refreshMetrics}>\r\n            Refresh\r\n          </Button>\r\n          {process.env.NODE_ENV !== 'development' && (\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() => setIsVisible(false)}\r\n            >\r\n              Hide\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {metricsData.map((metric, index) => {\r\n            const Icon = metric.icon;\r\n            return (\r\n              <div key={index} className=\"p-4 border rounded-lg\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <Icon className=\"w-4 h-4 text-muted-foreground\" />\r\n                  <Badge\r\n                    variant=\"outline\"\r\n                    className={`text-xs ${metric.grade.color}`}\r\n                  >\r\n                    {metric.grade.grade}\r\n                  </Badge>\r\n                </div>\r\n                <div className=\"text-2xl font-bold\">{metric.value}</div>\r\n                <div className=\"text-sm font-medium text-foreground mt-1\">\r\n                  {metric.label}\r\n                </div>\r\n                <div className=\"text-xs text-muted-foreground mt-1\">\r\n                  {metric.description}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        <div className=\"mt-6 p-4 bg-muted rounded-lg\">\r\n          <h4 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n            <CheckCircle className=\"w-4 h-4\" />\r\n            Performance Recommendations\r\n          </h4>\r\n          <ul className=\"text-sm space-y-1\">\r\n            {metrics.loadTime > 3000 && (\r\n              <li className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-3 h-3 text-yellow-500\" />\r\n                Consider lazy loading non-critical components to improve load\r\n                time\r\n              </li>\r\n            )}\r\n            {metrics.bundleSize > 1500000 && (\r\n              <li className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-3 h-3 text-yellow-500\" />\r\n                Bundle size is large. Consider code splitting and tree shaking\r\n              </li>\r\n            )}\r\n            {metrics.cumulativeLayoutShift > 0.1 && (\r\n              <li className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-3 h-3 text-yellow-500\" />\r\n                High layout shift detected. Reserve space for dynamic content\r\n              </li>\r\n            )}\r\n            {metrics.firstInputDelay > 100 && (\r\n              <li className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-3 h-3 text-yellow-500\" />\r\n                High input delay. Consider optimizing JavaScript execution\r\n              </li>\r\n            )}\r\n            {metrics.loadTime < 3000 &&\r\n              metrics.bundleSize < 1500000 &&\r\n              metrics.cumulativeLayoutShift < 0.1 && (\r\n                <li className=\"flex items-center gap-2 text-green-600\">\r\n                  <CheckCircle className=\"w-3 h-3\" />\r\n                  Great performance! All key metrics are within recommended\r\n                  ranges\r\n                </li>\r\n              )}\r\n          </ul>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\Toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ToastContainer.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":27,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":27,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useCallback, createContext, useContext } from 'react';\nimport Toast, { type ToastType } from './Toast';\n\ninterface ToastData {\n  id: string;\n  type: ToastType;\n  title: string;\n  message: string;\n  duration?: number;\n}\n\ninterface ToastContextType {\n  showToast: (\n    type: ToastType,\n    title: string,\n    message: string,\n    duration?: number\n  ) => void;\n  success: (title: string, message: string, duration?: number) => void;\n  error: (title: string, message: string, duration?: number) => void;\n  warning: (title: string, message: string, duration?: number) => void;\n  info: (title: string, message: string, duration?: number) => void;\n}\n\nconst ToastContext = createContext<ToastContextType | undefined>(undefined);\n\nexport const useToast = () => {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n  return context;\n};\n\nexport const ToastProvider: React.FC<{ children: React.ReactNode }> = ({\n  children,\n}) => {\n  const [toasts, setToasts] = useState<ToastData[]>([]);\n\n  const showToast = useCallback(\n    (type: ToastType, title: string, message: string, duration = 5000) => {\n      const id = `toast-${Date.now()}-${Math.random()}`;\n      setToasts((prev) => [...prev, { id, type, title, message, duration }]);\n    },\n    []\n  );\n\n  const removeToast = useCallback((id: string) => {\n    setToasts((prev) => prev.filter((toast) => toast.id !== id));\n  }, []);\n\n  const success = useCallback(\n    (title: string, message: string, duration?: number) => {\n      showToast('success', title, message, duration);\n    },\n    [showToast]\n  );\n\n  const error = useCallback(\n    (title: string, message: string, duration?: number) => {\n      showToast('error', title, message, duration);\n    },\n    [showToast]\n  );\n\n  const warning = useCallback(\n    (title: string, message: string, duration?: number) => {\n      showToast('warning', title, message, duration);\n    },\n    [showToast]\n  );\n\n  const info = useCallback(\n    (title: string, message: string, duration?: number) => {\n      showToast('info', title, message, duration);\n    },\n    [showToast]\n  );\n\n  return (\n    <ToastContext.Provider value={{ showToast, success, error, warning, info }}>\n      {children}\n      <div className=\"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none\">\n        <div className=\"flex flex-col gap-2 pointer-events-auto\">\n          {toasts.map((toast) => (\n            <Toast\n              key={toast.id}\n              id={toast.id}\n              type={toast.type}\n              title={toast.title}\n              message={toast.message}\n              duration={toast.duration ?? 5000}\n              onClose={removeToast}\n            />\n          ))}\n        </div>\n      </div>\n    </ToastContext.Provider>\n  );\n};\n\nexport default ToastProvider;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\BookCirculationAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[788,791],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[788,791],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'processCirculationData'. Either include it or remove the dependency array.","line":97,"column":6,"nodeType":"ArrayExpression","endLine":97,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [data, processCirculationData, timeframe]","fix":{"range":[1999,2016],"text":"[data, processCirculationData, timeframe]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2071,2074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2071,2074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2332,2335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2332,2335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2737,2740],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2737,2740],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":464,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":464,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15282,15285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15282,15285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":564,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":564,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18816,18819],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18816,18819],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  Area,\r\n  AreaChart,\r\n} from 'recharts';\r\nimport {\r\n  BookOpen,\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Users,\r\n  Filter,\r\n  Download,\r\n} from 'lucide-react';\r\n\r\ninterface BookCirculationAnalyticsProps {\r\n  timeframe: 'day' | 'week' | 'month';\r\n  data?: any;\r\n  isLoading?: boolean;\r\n}\r\n\r\ninterface CirculationTrend {\r\n  date: string;\r\n  borrowed: number;\r\n  returned: number;\r\n  overdue: number;\r\n}\r\n\r\ninterface CategoryData {\r\n  category: string;\r\n  count: number;\r\n  percentage: number;\r\n  color: string;\r\n}\r\n\r\ninterface PopularBook {\r\n  id: string;\r\n  title: string;\r\n  author: string;\r\n  category: string;\r\n  circulationCount: number;\r\n  popularity: number;\r\n  availableCopies: number;\r\n  totalCopies: number;\r\n  overdueCount?: number;\r\n}\r\n\r\nconst COLORS = [\r\n  '#0088FE',\r\n  '#00C49F',\r\n  '#FFBB28',\r\n  '#FF8042',\r\n  '#8884D8',\r\n  '#82CA9D',\r\n  '#FFC658',\r\n  '#FF7C7C',\r\n];\r\n\r\nexport function BookCirculationAnalytics({\r\n  timeframe,\r\n  data,\r\n  isLoading = false,\r\n}: BookCirculationAnalyticsProps) {\r\n  const [selectedView, setSelectedView] = useState<\r\n    'overview' | 'trends' | 'categories' | 'popular'\r\n  >('overview');\r\n  const [circulationTrends, setCirculationTrends] = useState<\r\n    CirculationTrend[]\r\n  >([]);\r\n  const [categoryData, setCategoryData] = useState<CategoryData[]>([]);\r\n  const [popularBooks, setPopularBooks] = useState<PopularBook[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      processCirculationData(data);\r\n    }\r\n  }, [data, timeframe]);\r\n\r\n  const processCirculationData = (analyticsData: any) => {\r\n    // Process circulation trends\r\n    const trends: CirculationTrend[] = generateMockTrends(timeframe);\r\n    setCirculationTrends(trends);\r\n\r\n    // Process category data\r\n    const categories =\r\n      analyticsData.circulationByCategory?.map((cat: any, index: number) => ({\r\n        category: cat.category,\r\n        count: cat.count,\r\n        percentage: calculatePercentage(\r\n          cat.count,\r\n          analyticsData.totalCirculation\r\n        ),\r\n        color: COLORS[index % COLORS.length],\r\n      })) || [];\r\n    setCategoryData(categories);\r\n\r\n    // Process popular books\r\n    const books =\r\n      analyticsData.mostBorrowedBooks?.map((book: any) => ({\r\n        ...book,\r\n        overdueCount: Math.floor(Math.random() * 5), // Mock overdue count\r\n      })) || [];\r\n    setPopularBooks(books);\r\n  };\r\n\r\n  const generateMockTrends = (tf: string): CirculationTrend[] => {\r\n    const dataPoints = tf === 'day' ? 24 : tf === 'week' ? 7 : 30;\r\n    const trends: CirculationTrend[] = [];\r\n\r\n    for (let i = 0; i < dataPoints; i++) {\r\n      const baseValue = tf === 'day' ? 15 : tf === 'week' ? 100 : 400;\r\n      const variation = Math.random() * 0.4 - 0.2; // ┬▒20% variation\r\n\r\n      trends.push({\r\n        date:\r\n          tf === 'day'\r\n            ? `${i}:00`\r\n            : tf === 'week'\r\n              ? (['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'][i] ??\r\n                `Day ${i}`)\r\n              : `Day ${i + 1}`,\r\n        borrowed: Math.round(baseValue * (1 + variation)),\r\n        returned: Math.round(baseValue * 0.8 * (1 + variation * 0.5)),\r\n        overdue: Math.round(baseValue * 0.1 * (1 + variation * 0.3)),\r\n      });\r\n    }\r\n\r\n    return trends;\r\n  };\r\n\r\n  const calculatePercentage = (value: number, total: number): number => {\r\n    return total > 0 ? Math.round((value / total) * 100) : 0;\r\n  };\r\n\r\n  const getPopularityBadge = (popularity: number) => {\r\n    if (popularity >= 80) {\r\n      return <Badge className=\"bg-green-500\">High</Badge>;\r\n    }\r\n    if (popularity >= 50) {\r\n      return <Badge className=\"bg-yellow-500\">Medium</Badge>;\r\n    }\r\n    return <Badge variant=\"outline\">Low</Badge>;\r\n  };\r\n\r\n  const CirculationOverview = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Key Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Circulation\r\n            </CardTitle>\r\n            <BookOpen className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.totalCirculation || 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {data?.trends?.growthRate > 0 ? '+' : ''}\r\n              {data?.trends?.growthRate?.toFixed(1) || 0}% from last period\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Circulation Rate\r\n            </CardTitle>\r\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.circulation?.circulationRate?.toFixed(1) || 0}%\r\n            </div>\r\n            <Progress\r\n              value={data?.circulation?.circulationRate || 0}\r\n              className=\"mt-2\"\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Return Rate</CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.circulation?.returnRate?.toFixed(1) || 0}%\r\n            </div>\r\n            <Progress\r\n              value={data?.circulation?.returnRate || 0}\r\n              className=\"mt-2\"\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Overdue Rate</CardTitle>\r\n            <AlertTriangle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.circulation?.overdueRate?.toFixed(1) || 0}%\r\n            </div>\r\n            <Progress\r\n              value={data?.circulation?.overdueRate || 0}\r\n              className=\"mt-2\"\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Circulation Trends Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Circulation Trends</CardTitle>\r\n          <CardDescription>\r\n            Book borrowing, returns, and overdue trends over time\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <AreaChart data={circulationTrends}>\r\n              <CartesianGrid\r\n                strokeDasharray=\"3 3\"\r\n                stroke=\"hsl(var(--border))\"\r\n                opacity={0.3}\r\n              />\r\n              <XAxis\r\n                dataKey=\"date\"\r\n                tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n                tickFormatter={(value) =>\r\n                  timeframe === 'month' ? `Day ${value}` : value\r\n                }\r\n              />\r\n              <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                  color: 'hsl(var(--foreground))',\r\n                }}\r\n              />\r\n              <Legend />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"borrowed\"\r\n                stackId=\"1\"\r\n                stroke=\"#0088FE\"\r\n                fill=\"#0088FE\"\r\n                fillOpacity={0.6}\r\n                name=\"Borrowed\"\r\n              />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"returned\"\r\n                stackId=\"2\"\r\n                stroke=\"#00C49F\"\r\n                fill=\"#00C49F\"\r\n                fillOpacity={0.6}\r\n                name=\"Returned\"\r\n              />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"overdue\"\r\n                stackId=\"3\"\r\n                stroke=\"#FF8042\"\r\n                fill=\"#FF8042\"\r\n                fillOpacity={0.6}\r\n                name=\"Overdue\"\r\n              />\r\n            </AreaChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const CategoryAnalysis = () => (\r\n    <div className=\"grid gap-6 lg:grid-cols-2\">\r\n      {/* Category Distribution Pie Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Circulation by Category</CardTitle>\r\n          <CardDescription>\r\n            Distribution of book circulation across categories\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <PieChart>\r\n              <Pie\r\n                data={categoryData}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                labelLine={false}\r\n                label={({ category, percentage }) =>\r\n                  `${category} ${percentage}%`\r\n                }\r\n                outerRadius={80}\r\n                fill=\"#8884d8\"\r\n                dataKey=\"count\"\r\n              >\r\n                {categoryData.map((entry, index) => (\r\n                  <Cell key={`cell-${index}`} fill={entry.color} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                }}\r\n              />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Category Stats */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Category Performance</CardTitle>\r\n          <CardDescription>\r\n            Detailed statistics for each book category\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {categoryData.map((category) => (\r\n              <div key={category.category} className=\"space-y-2\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <span className=\"text-sm font-medium\">\r\n                    {category.category}\r\n                  </span>\r\n                  <span className=\"text-sm text-muted-foreground\">\r\n                    {category.count} books ({category.percentage}%)\r\n                  </span>\r\n                </div>\r\n                <Progress value={category.percentage} className=\"h-2\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const PopularBooks = () => (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>Most Popular Books</CardTitle>\r\n        <CardDescription>\r\n          Top borrowed books with circulation statistics\r\n        </CardDescription>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-4\">\r\n          {popularBooks.map((book, index) => (\r\n            <div\r\n              key={book.id}\r\n              className=\"flex items-center justify-between p-4 border rounded-lg\"\r\n            >\r\n              <div className=\"flex-1\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <span className=\"text-lg font-semibold\">#{index + 1}</span>\r\n                  <h4 className=\"font-medium\">{book.title}</h4>\r\n                  {getPopularityBadge(book.popularity)}\r\n                </div>\r\n                <p className=\"text-sm text-muted-foreground mb-2\">\r\n                  by {book.author} ΓÇó {book.category}\r\n                </p>\r\n                <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <BookOpen className=\"h-3 w-3\" />\r\n                    {book.circulationCount} circulations\r\n                  </span>\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <Users className=\"h-3 w-3\" />\r\n                    {book.availableCopies}/{book.totalCopies} available\r\n                  </span>\r\n                  {book.overdueCount && book.overdueCount > 0 && (\r\n                    <span className=\"flex items-center gap-1 text-red-500\">\r\n                      <AlertTriangle className=\"h-3 w-3\" />\r\n                      {book.overdueCount} overdue\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <div className=\"text-2xl font-bold\">{book.popularity}%</div>\r\n                <div className=\"text-xs text-muted-foreground\">popularity</div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  const OverdueAnalysis = () => {\r\n    const overdueData = data?.overdueAnalysis;\r\n\r\n    return (\r\n      <div className=\"grid gap-6 lg:grid-cols-2\">\r\n        {/* Overdue Statistics */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Overdue Analysis</CardTitle>\r\n            <CardDescription>\r\n              Statistics and patterns for overdue books\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"text-center p-4 bg-muted rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-red-600\">\r\n                    {overdueData?.totalOverdue || 0}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Total Overdue\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-center p-4 bg-muted rounded-lg\">\r\n                  <div className=\"text-2xl font-bold text-yellow-600\">\r\n                    {overdueData?.averageOverdueDays?.toFixed(1) || 0}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Avg Days Overdue\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Overdue by Category */}\r\n              <div className=\"space-y-2\">\r\n                <h4 className=\"font-medium\">Overdue by Category</h4>\r\n                {overdueData?.overdueByCategory?.map((cat: any) => (\r\n                  <div\r\n                    key={cat.category}\r\n                    className=\"flex justify-between items-center p-2 bg-muted rounded\"\r\n                  >\r\n                    <span className=\"text-sm\">{cat.category}</span>\r\n                    <span className=\"text-sm font-medium\">\r\n                      {cat.count} books ({cat.averageDays} days)\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Recommendations */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Recommendations</CardTitle>\r\n            <CardDescription>\r\n              Automated suggestions to reduce overdue rates\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium\">Automated Reminders</p>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Send email/SMS reminders 2 days before due date\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium\">Grace Period Policy</p>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Implement 2-day grace period for first-time offenders\r\n                  </p>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium\">Flexible Loan Periods</p>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Adjust loan periods based on book category and user history\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"h-6 w-48 bg-muted rounded animate-pulse\"></div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"h-64 bg-muted rounded animate-pulse\"></div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">Book Circulation Analytics</h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Comprehensive analysis of book borrowing patterns and trends\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <Filter className=\"h-4 w-4 mr-2\" />\r\n            Filter\r\n          </Button>\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Analytics Tabs */}\r\n      <Tabs\r\n        value={selectedView}\r\n        onValueChange={(value: any) => setSelectedView(value)}\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"trends\">Trends</TabsTrigger>\r\n          <TabsTrigger value=\"categories\">Categories</TabsTrigger>\r\n          <TabsTrigger value=\"popular\">Popular Books</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <CirculationOverview />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"trends\" className=\"space-y-4\">\r\n          <CirculationOverview />\r\n          <OverdueAnalysis />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"categories\" className=\"space-y-4\">\r\n          <CategoryAnalysis />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"popular\" className=\"space-y-4\">\r\n          <PopularBooks />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BookCirculationAnalytics;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\EquipmentUtilizationAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[909,912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[909,912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'processEquipmentData'. Either include it or remove the dependency array.","line":93,"column":6,"nodeType":"ArrayExpression","endLine":93,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [data, processEquipmentData, timeframe]","fix":{"range":[2086,2103],"text":"[data, processEquipmentData, timeframe]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2156,2159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2156,2159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2303,2306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2303,2306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2963,2966],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2963,2966],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3459,3462],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3459,3462],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  Area,\r\n  AreaChart,\r\n  RadialBarChart,\r\n  RadialBar,\r\n  PolarAngleAxis,\r\n} from 'recharts';\r\nimport {\r\n  Monitor,\r\n  Clock,\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Settings,\r\n  Users,\r\n  Activity,\r\n  Calendar,\r\n  Zap,\r\n  Thermometer,\r\n  Wrench,\r\n  BarChart3,\r\n} from 'lucide-react';\r\n\r\ninterface EquipmentUtilizationAnalyticsProps {\r\n  timeframe: 'day' | 'week' | 'month';\r\n  data?: any;\r\n  isLoading?: boolean;\r\n}\r\n\r\ninterface UtilizationData {\r\n  type: string;\r\n  total: number;\r\n  inUse: number;\r\n  utilizationRate: number;\r\n  status: 'high' | 'medium' | 'low';\r\n  avgSessionDuration: number;\r\n  maintenanceAlerts: number;\r\n}\r\n\r\ninterface PeakUsageTime {\r\n  hour: number;\r\n  sessions: number;\r\n  timeRange: string;\r\n  utilizationRate: number;\r\n}\r\n\r\ninterface MaintenanceInsight {\r\n  equipmentId: string;\r\n  nextMaintenance: string;\r\n  type: 'Preventive' | 'Corrective';\r\n  urgency: 'high' | 'medium' | 'low';\r\n  description: string;\r\n}\r\n\r\nexport function EquipmentUtilizationAnalytics({\r\n  timeframe,\r\n  data,\r\n  isLoading = false,\r\n}: EquipmentUtilizationAnalyticsProps) {\r\n  const [selectedView, setSelectedView] = useState<\r\n    'overview' | 'utilization' | 'patterns' | 'maintenance'\r\n  >('overview');\r\n  const [utilizationData, setUtilizationData] = useState<UtilizationData[]>([]);\r\n  const [peakUsageTimes, setPeakUsageTimes] = useState<PeakUsageTime[]>([]);\r\n  const [maintenanceInsights, setMaintenanceInsights] = useState<\r\n    MaintenanceInsight[]\r\n  >([]);\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      processEquipmentData(data);\r\n    }\r\n  }, [data, timeframe]);\r\n\r\n  const processEquipmentData = (analyticsData: any) => {\r\n    // Process utilization data with safe defaults\r\n    const utilization = (analyticsData?.utilizationByType ?? []).map(\r\n      (item: any) => {\r\n        const rate = Number(item?.utilizationRate ?? 0);\r\n        return {\r\n          type: String(item?.type ?? 'Unknown'),\r\n          total: Number(item?.total ?? 0),\r\n          inUse: Number(item?.inUse ?? 0),\r\n          utilizationRate: rate,\r\n          status: getUtilizationStatus(rate),\r\n          avgSessionDuration: Math.random() * 60 + 15, // Mock 15-75 min\r\n          maintenanceAlerts: Math.floor(Math.random() * 3),\r\n        } as UtilizationData;\r\n      }\r\n    );\r\n    setUtilizationData(utilization);\r\n\r\n    // Process peak usage times with safe defaults\r\n    const peakTimes = (analyticsData?.peakUsageTimes ?? []).map(\r\n      (time: any) => ({\r\n        hour: Number(time?.hour ?? 0),\r\n        sessions: Number(time?.sessions ?? 0),\r\n        timeRange: String(time?.timeRange ?? ''),\r\n        utilizationRate: Math.random() * 40 + 60, // Mock 60-100% during peak\r\n      })\r\n    ) as PeakUsageTime[];\r\n    setPeakUsageTimes(peakTimes);\r\n\r\n    // Process maintenance insights with safe defaults\r\n    const schedule =\r\n      analyticsData?.maintenanceInsights?.maintenanceSchedule ?? [];\r\n    const maintenance = schedule.map((item: any) => ({\r\n      equipmentId: String(item?.equipmentId ?? 'UNKNOWN'),\r\n      nextMaintenance: String(item?.nextMaintenance ?? ''),\r\n      type:\r\n        item?.type === 'Preventive' || item?.type === 'Corrective'\r\n          ? item.type\r\n          : 'Preventive',\r\n      urgency:\r\n        Math.random() > 0.7 ? 'high' : Math.random() > 0.4 ? 'medium' : 'low',\r\n      description: generateMaintenanceDescription(\r\n        String(item?.type ?? 'Preventive')\r\n      ),\r\n    })) as MaintenanceInsight[];\r\n    setMaintenanceInsights(maintenance);\r\n  };\r\n\r\n  const getUtilizationStatus = (rate: number): 'high' | 'medium' | 'low' => {\r\n    if (rate > 80) {\r\n      return 'high';\r\n    }\r\n    if (rate > 50) {\r\n      return 'medium';\r\n    }\r\n    return 'low';\r\n  };\r\n\r\n  const generateMaintenanceDescription = (type: string): string => {\r\n    const descriptions = {\r\n      Preventive: [\r\n        'Routine performance check and calibration',\r\n        'Software updates and security patches',\r\n        'Hardware inspection and cleaning',\r\n        'Component wear assessment',\r\n      ],\r\n      Corrective: [\r\n        'Performance issue resolution',\r\n        'Hardware replacement required',\r\n        'Software malfunction fix',\r\n        'Component repair needed',\r\n      ],\r\n    };\r\n\r\n    const typeDesc = descriptions[type as keyof typeof descriptions] || [];\r\n    return (\r\n      typeDesc[Math.floor(Math.random() * typeDesc.length)] ||\r\n      'Maintenance required'\r\n    );\r\n  };\r\n\r\n  const getUrgencyColor = (urgency: string) => {\r\n    switch (urgency) {\r\n      case 'high':\r\n        return 'bg-red-500';\r\n      case 'medium':\r\n        return 'bg-yellow-500';\r\n      case 'low':\r\n        return 'bg-green-500';\r\n      default:\r\n        return 'bg-gray-500';\r\n    }\r\n  };\r\n\r\n  const EquipmentOverview = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Key Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Overall Utilization\r\n            </CardTitle>\r\n            <Activity className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.overallUtilization?.toFixed(1) || 0}%\r\n            </div>\r\n            <Progress value={data?.overallUtilization || 0} className=\"mt-2\" />\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              {data?.overallUtilization > 80\r\n                ? 'High demand'\r\n                : data?.overallUtilization > 50\r\n                  ? 'Optimal'\r\n                  : 'Underutilized'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Sessions\r\n            </CardTitle>\r\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.equipment?.totalSessions || 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Avg: {data?.equipment?.averageSessionDuration?.toFixed(0) || 0}{' '}\r\n              min per session\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Active Equipment\r\n            </CardTitle>\r\n            <Monitor className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {utilizationData.reduce((sum, item) => sum + item.inUse, 0)}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              of {utilizationData.reduce((sum, item) => sum + item.total, 0)}{' '}\r\n              total\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">System Health</CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">98.5%</div>\r\n            <Progress value={98.5} className=\"mt-2\" />\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              Excellent performance\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Utilization by Type */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Equipment Utilization by Type</CardTitle>\r\n          <CardDescription>\r\n            Current utilization rates across different equipment categories\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <BarChart data={utilizationData}>\r\n              <CartesianGrid\r\n                strokeDasharray=\"3 3\"\r\n                stroke=\"hsl(var(--border))\"\r\n                opacity={0.3}\r\n              />\r\n              <XAxis\r\n                dataKey=\"type\"\r\n                tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n                angle={-45}\r\n                textAnchor=\"end\"\r\n                height={80}\r\n              />\r\n              <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                  color: 'hsl(var(--foreground))',\r\n                }}\r\n              />\r\n              <Legend />\r\n              <Bar\r\n                dataKey=\"utilizationRate\"\r\n                name=\"Utilization %\"\r\n                fill=\"#3b82f6\"\r\n                radius={[8, 8, 0, 0]}\r\n              />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const UtilizationAnalysis = () => (\r\n    <div className=\"grid gap-6 lg:grid-cols-2\">\r\n      {/* Utilization Details */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Utilization Details</CardTitle>\r\n          <CardDescription>\r\n            Detailed breakdown of equipment usage\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {utilizationData.map((equipment) => (\r\n              <div key={equipment.type} className=\"space-y-2\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Monitor className=\"h-4 w-4\" />\r\n                    <span className=\"text-sm font-medium\">\r\n                      {equipment.type}\r\n                    </span>\r\n                    <Badge\r\n                      variant=\"outline\"\r\n                      className={`${getUrgencyColor(equipment.status)} text-white border-0`}\r\n                    >\r\n                      {equipment.status}\r\n                    </Badge>\r\n                  </div>\r\n                  <span className=\"text-sm text-muted-foreground\">\r\n                    {equipment.inUse}/{equipment.total} active\r\n                  </span>\r\n                </div>\r\n                <Progress value={equipment.utilizationRate} className=\"h-2\" />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>{equipment.utilizationRate.toFixed(1)}% utilized</span>\r\n                  <span>\r\n                    Avg session: {equipment.avgSessionDuration.toFixed(0)} min\r\n                  </span>\r\n                </div>\r\n                {equipment.maintenanceAlerts > 0 && (\r\n                  <div className=\"flex items-center gap-1 text-xs text-yellow-600\">\r\n                    <AlertTriangle className=\"h-3 w-3\" />\r\n                    {equipment.maintenanceAlerts} maintenance alert(s)\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Utilization Radial Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Utilization Distribution</CardTitle>\r\n          <CardDescription>\r\n            Visual representation of equipment usage patterns\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <RadialBarChart\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              innerRadius=\"10%\"\r\n              outerRadius=\"90%\"\r\n              data={utilizationData}\r\n            >\r\n              <PolarAngleAxis type=\"number\" domain={[0, 100]} tick={false} />\r\n              <RadialBar\r\n                dataKey=\"utilizationRate\"\r\n                cornerRadius={10}\r\n                fill=\"#8884d8\"\r\n              />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                }}\r\n              />\r\n            </RadialBarChart>\r\n          </ResponsiveContainer>\r\n          <div className=\"flex flex-wrap gap-2 mt-4\">\r\n            {utilizationData.map((item) => (\r\n              <Badge key={item.type} variant=\"outline\" className=\"text-xs\">\r\n                {item.type}\r\n              </Badge>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const UsagePatterns = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Peak Usage Times */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Peak Usage Patterns</CardTitle>\r\n          <CardDescription>\r\n            Busiest times and usage patterns throughout the day\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <AreaChart data={peakUsageTimes}>\r\n              <CartesianGrid\r\n                strokeDasharray=\"3 3\"\r\n                stroke=\"hsl(var(--border))\"\r\n                opacity={0.3}\r\n              />\r\n              <XAxis\r\n                dataKey=\"timeRange\"\r\n                tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n              />\r\n              <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                  color: 'hsl(var(--foreground))',\r\n                }}\r\n              />\r\n              <Legend />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"sessions\"\r\n                stroke=\"#0088FE\"\r\n                fill=\"#0088FE\"\r\n                fillOpacity={0.6}\r\n                name=\"Sessions\"\r\n              />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"utilizationRate\"\r\n                stroke=\"#00C49F\"\r\n                fill=\"#00C49F\"\r\n                fillOpacity={0.6}\r\n                name=\"Utilization %\"\r\n              />\r\n            </AreaChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Usage Insights */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Clock className=\"h-4 w-4\" />\r\n              Peak Hours\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              {peakUsageTimes.slice(0, 3).map((time, index) => (\r\n                <div key={index} className=\"flex justify-between text-sm\">\r\n                  <span>{time.timeRange}</span>\r\n                  <span className=\"font-medium\">{time.sessions} sessions</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Thermometer className=\"h-4 w-4\" />\r\n              High Demand Periods\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2 text-sm\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\r\n                <span>2:00 PM - 4:00 PM (85%+ usage)</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\r\n                <span>10:00 AM - 12:00 PM (70% usage)</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\r\n                <span>After 6:00 PM (Low usage)</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Zap className=\"h-4 w-4\" />\r\n              Usage Efficiency\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Session Efficiency</span>\r\n                <span className=\"font-medium\">87%</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Resource Allocation</span>\r\n                <span className=\"font-medium\">92%</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>User Satisfaction</span>\r\n                <span className=\"font-medium\">94%</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const MaintenanceView = () => (\r\n    <div className=\"grid gap-6 lg:grid-cols-2\">\r\n      {/* Maintenance Schedule */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Maintenance Schedule</CardTitle>\r\n          <CardDescription>\r\n            Upcoming maintenance tasks and equipment status\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {maintenanceInsights.map((insight) => (\r\n              <div\r\n                key={insight.equipmentId}\r\n                className=\"flex items-start gap-3 p-3 border rounded-lg\"\r\n              >\r\n                <Wrench\r\n                  className={`h-5 w-5 mt-0.5 ${\r\n                    insight.urgency === 'high'\r\n                      ? 'text-red-500'\r\n                      : insight.urgency === 'medium'\r\n                        ? 'text-yellow-500'\r\n                        : 'text-green-500'\r\n                  }`}\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2 mb-1\">\r\n                    <h4 className=\"text-sm font-medium\">\r\n                      {insight.equipmentId}\r\n                    </h4>\r\n                    <Badge\r\n                      variant=\"outline\"\r\n                      className={getUrgencyColor(insight.urgency)}\r\n                    >\r\n                      {insight.urgency}\r\n                    </Badge>\r\n                  </div>\r\n                  <p className=\"text-xs text-muted-foreground mb-1\">\r\n                    {insight.description}\r\n                  </p>\r\n                  <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\r\n                    <span className=\"flex items-center gap-1\">\r\n                      <Calendar className=\"h-3 w-3\" />\r\n                      {insight.nextMaintenance}\r\n                    </span>\r\n                    <span className=\"flex items-center gap-1\">\r\n                      <Settings className=\"h-3 w-3\" />\r\n                      {insight.type}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Maintenance Analytics */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Maintenance Analytics</CardTitle>\r\n          <CardDescription>\r\n            Equipment health and maintenance performance metrics\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-green-600\">\r\n                  {data?.maintenanceInsights?.averageUptime?.toFixed(1) || 98.5}\r\n                  %\r\n                </div>\r\n                <div className=\"text-sm text-muted-foreground\">\r\n                  Average Uptime\r\n                </div>\r\n              </div>\r\n              <div className=\"text-center p-4 bg-muted rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-yellow-600\">\r\n                  {data?.maintenanceInsights?.equipmentNeedingMaintenance || 3}\r\n                </div>\r\n                <div className=\"text-sm text-muted-foreground\">\r\n                  Need Maintenance\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Maintenance Recommendations */}\r\n            <div className=\"space-y-3\">\r\n              <h4 className=\"font-medium\">Recommendations</h4>\r\n              {data?.recommendations\r\n                ?.slice(0, 3)\r\n                .map((rec: string, index: number) => (\r\n                  <div key={index} className=\"flex items-start gap-2\">\r\n                    <CheckCircle className=\"h-4 w-4 text-green-500 mt-0.5\" />\r\n                    <p className=\"text-sm\">{rec}</p>\r\n                  </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Performance Trend */}\r\n            <div className=\"space-y-2\">\r\n              <h4 className=\"font-medium\">Performance Trend</h4>\r\n              <div className=\"flex items-center gap-2\">\r\n                <TrendingUp className=\"h-4 w-4 text-green-500\" />\r\n                <span className=\"text-sm\">5% improvement from last month</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Activity className=\"h-4 w-4 text-blue-500\" />\r\n                <span className=\"text-sm\">\r\n                  Stable performance over past week\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"h-6 w-48 bg-muted rounded animate-pulse\"></div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"h-64 bg-muted rounded animate-pulse\"></div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">\r\n            Equipment Utilization Analytics\r\n          </h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Detailed analysis of equipment usage patterns and efficiency\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Badge\r\n            variant={\r\n              data?.overallUtilization > 80\r\n                ? 'destructive'\r\n                : data?.overallUtilization > 50\r\n                  ? 'default'\r\n                  : 'secondary'\r\n            }\r\n          >\r\n            {data?.overallUtilization > 80\r\n              ? 'High Demand'\r\n              : data?.overallUtilization > 50\r\n                ? 'Optimal'\r\n                : 'Available'}\r\n          </Badge>\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <BarChart3 className=\"h-4 w-4 mr-2\" />\r\n            Export Report\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Analytics Tabs */}\r\n      <Tabs\r\n        value={selectedView}\r\n        onValueChange={(value: string) =>\r\n          setSelectedView(\r\n            value as 'overview' | 'utilization' | 'patterns' | 'maintenance'\r\n          )\r\n        }\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"utilization\">Utilization</TabsTrigger>\r\n          <TabsTrigger value=\"patterns\">Patterns</TabsTrigger>\r\n          <TabsTrigger value=\"maintenance\">Maintenance</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <EquipmentOverview />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"utilization\" className=\"space-y-4\">\r\n          <UtilizationAnalysis />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"patterns\" className=\"space-y-4\">\r\n          <UsagePatterns />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"maintenance\" className=\"space-y-4\">\r\n          <MaintenanceView />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EquipmentUtilizationAnalytics;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\ExportAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\FineCollectionAnalytics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[885,888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[885,888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'processFineData'. Either include it or remove the dependency array.","line":92,"column":6,"nodeType":"ArrayExpression","endLine":92,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [data, processFineData, timeframe]","fix":{"range":[1859,1876],"text":"[data, processFineData, timeframe]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1924,1927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1924,1927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2033,2036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2033,2036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2399,2402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2399,2402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":506,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":506,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16953,16956],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16953,16956],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":632,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":632,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21469,21472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21469,21472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  Area,\r\n  AreaChart,\r\n} from 'recharts';\r\nimport {\r\n  DollarSign,\r\n  TrendingUp,\r\n  CreditCard,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Users,\r\n  Receipt,\r\n  Target,\r\n  Clock,\r\n  ArrowUpRight,\r\n  ArrowDownRight,\r\n  Activity,\r\n} from 'lucide-react';\r\n\r\ninterface FineCollectionAnalyticsProps {\r\n  timeframe: 'day' | 'week' | 'month';\r\n  data?: any;\r\n  isLoading?: boolean;\r\n}\r\n\r\ninterface PaymentTrend {\r\n  period: string;\r\n  amount: number;\r\n  transactions: number;\r\n  averagePayment: number;\r\n  collectionRate: number;\r\n}\r\n\r\ninterface FineCategory {\r\n  category: string;\r\n  amount: number;\r\n  count: number;\r\n  percentage: number;\r\n  color: string;\r\n  trend: 'up' | 'down' | 'stable';\r\n}\r\n\r\nconst FINE_COLORS = [\r\n  '#0088FE',\r\n  '#00C49F',\r\n  '#FFBB28',\r\n  '#FF8042',\r\n  '#8884D8',\r\n  '#82CA9D',\r\n  '#FFC658',\r\n  '#FF7C7C',\r\n];\r\n\r\nexport function FineCollectionAnalytics({\r\n  timeframe,\r\n  data,\r\n  isLoading = false,\r\n}: FineCollectionAnalyticsProps) {\r\n  const [selectedView, setSelectedView] = useState<\r\n    'overview' | 'trends' | 'categories' | 'patterns'\r\n  >('overview');\r\n  const [paymentTrends, setPaymentTrends] = useState<PaymentTrend[]>([]);\r\n  const [fineCategories, setFineCategories] = useState<FineCategory[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      processFineData(data);\r\n    }\r\n  }, [data, timeframe]);\r\n\r\n  const processFineData = (analyticsData: any) => {\r\n    // Process payment trends\r\n    const trends =\r\n      analyticsData.paymentTrends?.map((trend: any) => ({\r\n        ...trend,\r\n        averagePayment:\r\n          trend.transactions > 0 ? trend.amount / trend.transactions : 0,\r\n        collectionRate: Math.random() * 30 + 70, // Mock 70-100% collection rate\r\n      })) || [];\r\n    setPaymentTrends(trends);\r\n\r\n    // Process fine categories\r\n    const categories =\r\n      analyticsData.fineCategories?.map((cat: any, index: number) => ({\r\n        ...cat,\r\n        percentage: calculatePercentage(cat.amount, analyticsData.totalFines),\r\n        color: FINE_COLORS[index % FINE_COLORS.length],\r\n        trend:\r\n          Math.random() > 0.5 ? 'up' : Math.random() > 0.5 ? 'down' : 'stable',\r\n      })) || [];\r\n    setFineCategories(categories);\r\n\r\n    // Process overdue patterns\r\n    // Note: overduePatterns state not implemented yet\r\n  };\r\n\r\n  const calculatePercentage = (value: number, total: number): number => {\r\n    return total > 0 ? Math.round((value / total) * 100) : 0;\r\n  };\r\n\r\n  const getTrendIcon = (trend: string) => {\r\n    switch (trend) {\r\n      case 'up':\r\n        return <ArrowUpRight className=\"h-4 w-4 text-red-500\" />;\r\n      case 'down':\r\n        return <ArrowDownRight className=\"h-4 w-4 text-green-500\" />;\r\n      default:\r\n        return <Activity className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const FineOverview = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Key Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Fines</CardTitle>\r\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              ${data?.totalFines?.toFixed(2) || 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {fineCategories.reduce((sum, cat) => sum + cat.count, 0)} total\r\n              fines issued\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Collected</CardTitle>\r\n            <CreditCard className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              ${data?.collectedFines?.toFixed(2) || 0}\r\n            </div>\r\n            <Progress value={data?.collectionRate || 0} className=\"mt-2\" />\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              {data?.collectionRate?.toFixed(1) || 0}% collection rate\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Outstanding</CardTitle>\r\n            <AlertTriangle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              ${data?.outstandingFines?.toFixed(2) || 0}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {(\r\n                ((data?.outstandingFines || 0) / (data?.totalFines || 1)) *\r\n                100\r\n              ).toFixed(1)}\r\n              % of total\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Collection Rate\r\n            </CardTitle>\r\n            <Target className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {data?.collectionRate?.toFixed(1) || 0}%\r\n            </div>\r\n            <Progress value={data?.collectionRate || 0} className=\"mt-2\" />\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              {data?.collectionRate > 80\r\n                ? 'Excellent'\r\n                : data?.collectionRate > 60\r\n                  ? 'Good'\r\n                  : 'Needs Improvement'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Payment Trends Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Payment Trends</CardTitle>\r\n          <CardDescription>\r\n            Fine collection patterns and payment trends over time\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <AreaChart data={paymentTrends}>\r\n              <CartesianGrid\r\n                strokeDasharray=\"3 3\"\r\n                stroke=\"hsl(var(--border))\"\r\n                opacity={0.3}\r\n              />\r\n              <XAxis\r\n                dataKey=\"period\"\r\n                tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n              />\r\n              <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                  color: 'hsl(var(--foreground))',\r\n                }}\r\n              />\r\n              <Legend />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"amount\"\r\n                stroke=\"#0088FE\"\r\n                fill=\"#0088FE\"\r\n                fillOpacity={0.6}\r\n                name=\"Amount Collected ($)\"\r\n              />\r\n              <Area\r\n                type=\"monotone\"\r\n                dataKey=\"transactions\"\r\n                stroke=\"#00C49F\"\r\n                fill=\"#00C49F\"\r\n                fillOpacity={0.6}\r\n                name=\"Transactions\"\r\n              />\r\n            </AreaChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const CategoryAnalysis = () => (\r\n    <div className=\"grid gap-6 lg:grid-cols-2\">\r\n      {/* Fine Categories Pie Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Fines by Category</CardTitle>\r\n          <CardDescription>\r\n            Distribution of fines across different violation types\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <PieChart>\r\n              <Pie\r\n                data={fineCategories}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                labelLine={false}\r\n                label={({ category, amount }) =>\r\n                  `${category}: $${amount.toFixed(0)}`\r\n                }\r\n                outerRadius={80}\r\n                fill=\"#8884d8\"\r\n                dataKey=\"amount\"\r\n              >\r\n                {fineCategories.map((entry, index) => (\r\n                  <Cell key={`cell-${index}`} fill={entry.color} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                }}\r\n                formatter={(value: number, name: string) => [\r\n                  `$${value.toFixed(2)}`,\r\n                  name === 'amount' ? 'Fine Amount' : name,\r\n                ]}\r\n              />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Category Details */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Category Performance</CardTitle>\r\n          <CardDescription>\r\n            Detailed breakdown of fine categories with trends\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {fineCategories.map((category) => (\r\n              <div key={category.category} className=\"space-y-2\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-sm font-medium\">\r\n                      {category.category}\r\n                    </span>\r\n                    {getTrendIcon(category.trend)}\r\n                  </div>\r\n                  <span className=\"text-sm text-muted-foreground\">\r\n                    ${category.amount.toFixed(2)} ({category.count} cases)\r\n                  </span>\r\n                </div>\r\n                <Progress value={category.percentage} className=\"h-2\" />\r\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                  <span>{category.percentage}% of total fines</span>\r\n                  <span>\r\n                    Avg: ${(category.amount / category.count).toFixed(2)} per\r\n                    case\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n\r\n  const PaymentTrends = () => (\r\n    <div className=\"space-y-6\">\r\n      {/* Payment Trend Analysis */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Payment Trend Analysis</CardTitle>\r\n          <CardDescription>\r\n            Detailed payment patterns and collection efficiency\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <LineChart data={paymentTrends}>\r\n              <CartesianGrid\r\n                strokeDasharray=\"3 3\"\r\n                stroke=\"hsl(var(--border))\"\r\n                opacity={0.3}\r\n              />\r\n              <XAxis\r\n                dataKey=\"period\"\r\n                tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n              />\r\n              <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  backgroundColor: 'hsl(var(--card))',\r\n                  border: '1px solid hsl(var(--border))',\r\n                  borderRadius: '8px',\r\n                  color: 'hsl(var(--foreground))',\r\n                }}\r\n              />\r\n              <Legend />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"amount\"\r\n                stroke=\"#0088FE\"\r\n                strokeWidth={2}\r\n                name=\"Amount ($)\"\r\n                dot={{ fill: '#0088FE' }}\r\n              />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"collectionRate\"\r\n                stroke=\"#00C49F\"\r\n                strokeWidth={2}\r\n                name=\"Collection Rate (%)\"\r\n                dot={{ fill: '#00C49F' }}\r\n              />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Payment Metrics */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <TrendingUp className=\"h-4 w-4\" />\r\n              Collection Performance\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Average Payment</span>\r\n                <span className=\"font-medium\">\r\n                  $\r\n                  {(\r\n                    paymentTrends.reduce(\r\n                      (sum, t) => sum + t.averagePayment,\r\n                      0\r\n                    ) / paymentTrends.length || 0\r\n                  ).toFixed(2)}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Peak Collection Day</span>\r\n                <span className=\"font-medium\">Wednesday</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Payment Frequency</span>\r\n                <span className=\"font-medium\">Every 3.2 days</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Users className=\"h-4 w-4\" />\r\n              User Behavior\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Active Fine Accounts</span>\r\n                <span className=\"font-medium\">45</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Repeat Offenders</span>\r\n                <span className=\"font-medium\">12</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Payment Compliance</span>\r\n                <span className=\"font-medium text-green-600\">87%</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Clock className=\"h-4 w-4\" />\r\n              Collection Timeline\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Avg. Payment Time</span>\r\n                <span className=\"font-medium\">5.3 days</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Fastest Payment</span>\r\n                <span className=\"font-medium\">Same day</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Oldest Outstanding</span>\r\n                <span className=\"font-medium text-red-600\">45 days</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const OverduePatterns = () => {\r\n    const patterns = data?.overdueAnalysis?.patterns || [];\r\n\r\n    return (\r\n      <div className=\"grid gap-6 lg:grid-cols-2\">\r\n        {/* Overdue Pattern Analysis */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Overdue Pattern Analysis</CardTitle>\r\n            <CardDescription>\r\n              Analysis of overdue patterns and delay behaviors\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {patterns.map((pattern: any, index: number) => (\r\n                <div key={index} className=\"space-y-2\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <span className=\"text-sm font-medium\">{pattern.type}</span>\r\n                    <Badge\r\n                      variant={\r\n                        pattern.overdueRate > 15 ? 'destructive' : 'outline'\r\n                      }\r\n                    >\r\n                      {pattern.overdueRate}% overdue\r\n                    </Badge>\r\n                  </div>\r\n                  <Progress value={pattern.overdueRate} className=\"h-2\" />\r\n                  <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n                    <span>Avg delay: {pattern.averageDelay} days</span>\r\n                    <span>Volume: High</span>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Recommendations */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Collection Recommendations</CardTitle>\r\n            <CardDescription>\r\n              Automated suggestions to improve fine collection\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              {data?.overdueAnalysis?.recommendations?.map(\r\n                (rec: string, index: number) => (\r\n                  <div key={index} className=\"flex items-start gap-3\">\r\n                    <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">\r\n                        Strategy #{index + 1}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">{rec}</p>\r\n                    </div>\r\n                  </div>\r\n                )\r\n              )}\r\n\r\n              {/* Additional Recommendations */}\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium\">Payment Plans</p>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Offer installment plans for large fines to improve\r\n                    collection rates\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-start gap-3\">\r\n                <CheckCircle className=\"h-5 w-5 text-green-500 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium\">Automated Reminders</p>\r\n                  <p className=\"text-xs text-muted-foreground\">\r\n                    Schedule automated payment reminders at 7, 14, and 30 days\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"h-6 w-48 bg-muted rounded animate-pulse\"></div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"h-64 bg-muted rounded animate-pulse\"></div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">Fine Collection Analytics</h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Comprehensive analysis of fine collection patterns and effectiveness\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Badge\r\n            variant={\r\n              data?.collectionRate > 80\r\n                ? 'default'\r\n                : data?.collectionRate > 60\r\n                  ? 'secondary'\r\n                  : 'destructive'\r\n            }\r\n          >\r\n            {data?.collectionRate > 80\r\n              ? 'Excellent'\r\n              : data?.collectionRate > 60\r\n                ? 'Good'\r\n                : 'Needs Attention'}\r\n          </Badge>\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <Receipt className=\"h-4 w-4 mr-2\" />\r\n            Export Report\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Analytics Tabs */}\r\n      <Tabs\r\n        value={selectedView}\r\n        onValueChange={(value: any) => setSelectedView(value)}\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"trends\">Trends</TabsTrigger>\r\n          <TabsTrigger value=\"categories\">Categories</TabsTrigger>\r\n          <TabsTrigger value=\"patterns\">Patterns</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <FineOverview />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"trends\" className=\"space-y-4\">\r\n          <PaymentTrends />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"categories\" className=\"space-y-4\">\r\n          <CategoryAnalysis />\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"patterns\" className=\"space-y-4\">\r\n          <OverduePatterns />\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FineCollectionAnalytics;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\MetricsCards.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":24,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[592,595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[592,595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'generateMetrics'. Either include it or remove the dependency array.","line":57,"column":6,"nodeType":"ArrayExpression","endLine":57,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [data, generateMetrics, timeframe]","fix":{"range":[1458,1475],"text":"[data, generateMetrics, timeframe]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1529,1532],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1529,1532],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, type ComponentType } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport {\r\n  TrendingUp,\r\n  TrendingDown,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Activity,\r\n  BarChart,\r\n  Target,\r\n  Calendar,\r\n  Users,\r\n  BookOpen,\r\n  Monitor,\r\n  DollarSign,\r\n  Clock,\r\n} from 'lucide-react';\r\n\r\ninterface MetricsCardsProps {\r\n  timeframe: 'day' | 'week' | 'month';\r\n  data?: any;\r\n  isLoading?: boolean;\r\n  onRefresh?: () => void;\r\n}\r\n\r\ninterface MetricCard {\r\n  title: string;\r\n  value: string | number;\r\n  change?: number;\r\n  changeType?: 'increase' | 'decrease' | 'neutral';\r\n  icon: ComponentType<{ className?: string }>;\r\n  description: string;\r\n  status?: 'success' | 'warning' | 'error' | 'info';\r\n  progress?: number;\r\n  trend?: Array<{ time: string; value: number }>;\r\n  footer?: string;\r\n}\r\n\r\nexport function MetricsCards({\r\n  timeframe,\r\n  data,\r\n  isLoading = false,\r\n  onRefresh,\r\n}: MetricsCardsProps) {\r\n  const [metrics, setMetrics] = useState<MetricCard[]>([]);\r\n  const [lastUpdated, setLastUpdated] = useState<Date>(new Date());\r\n\r\n  useEffect(() => {\r\n    if (data) {\r\n      const calculatedMetrics = generateMetrics(data, timeframe);\r\n      setMetrics(calculatedMetrics);\r\n      setLastUpdated(new Date());\r\n    }\r\n  }, [data, timeframe]);\r\n\r\n  const generateMetrics = (\r\n    analyticsData: any,\r\n    selectedTimeframe: string\r\n  ): MetricCard[] => {\r\n    const { overview, circulation, equipment, fines, trends } = analyticsData;\r\n\r\n    return [\r\n      {\r\n        title: 'Total Students',\r\n        value: overview?.totalStudents || 0,\r\n        change: trends?.dailyGrowth || 0,\r\n        changeType: trends?.dailyGrowth > 0 ? 'increase' : 'decrease',\r\n        icon: Users,\r\n        description: `${overview?.activeStudents || 0} active students`,\r\n        status: 'success',\r\n        footer: `${overview?.studentActivationRate?.toFixed(1) || 0}% activation rate`,\r\n      },\r\n      {\r\n        title: 'Book Circulation',\r\n        value: circulation?.totalCirculation || 0,\r\n        change: circulation?.trends?.growthRate || 0,\r\n        changeType:\r\n          circulation?.trends?.trendDirection === 'increasing'\r\n            ? 'increase'\r\n            : 'decrease',\r\n        icon: BookOpen,\r\n        description: `${circulation?.mostBorrowedBooks?.[0]?.title || 'N/A'} most popular`,\r\n        status: circulation?.overdueRate > 15 ? 'warning' : 'success',\r\n        progress: circulation?.circulationRate || 0,\r\n        footer: `${circulation?.overdueRate?.toFixed(1) || 0}% overdue rate`,\r\n      },\r\n      {\r\n        title: 'Equipment Utilization',\r\n        value: `${equipment?.overallUtilization?.toFixed(1) || 0}%`,\r\n        change: equipment?.overallUtilization > 80 ? 5 : -2,\r\n        changeType:\r\n          equipment?.overallUtilization > 80 ? 'increase' : 'decrease',\r\n        icon: Monitor,\r\n        description: `${equipment?.totalSessions || 0} total sessions`,\r\n        status:\r\n          equipment?.overallUtilization > 85\r\n            ? 'warning'\r\n            : equipment?.overallUtilization > 60\r\n              ? 'success'\r\n              : 'info',\r\n        progress: equipment?.overallUtilization || 0,\r\n        footer: `${equipment?.recommendations?.[0] || 'Optimal utilization'}`,\r\n      },\r\n      {\r\n        title: 'Fine Collection',\r\n        value: `$${fines?.collectedFines?.toFixed(2) || 0}`,\r\n        change: fines?.collectionRate || 0,\r\n        changeType: fines?.collectionRate > 70 ? 'increase' : 'decrease',\r\n        icon: DollarSign,\r\n        description: `${fines?.collectionRate?.toFixed(1) || 0}% collection rate`,\r\n        status:\r\n          fines?.collectionRate > 80\r\n            ? 'success'\r\n            : fines?.collectionRate > 60\r\n              ? 'warning'\r\n              : 'error',\r\n        progress: fines?.collectionRate || 0,\r\n        footer: `$${fines?.outstandingFines?.toFixed(2) || 0} outstanding`,\r\n      },\r\n      {\r\n        title: 'Peak Usage Time',\r\n        value: trends?.peakUsageHours?.[0]?.timeRange || 'N/A',\r\n        icon: Clock,\r\n        description: `${trends?.peakUsageHours?.[0]?.count || 0} students during peak`,\r\n        status: 'info',\r\n        footer: `Avg session: ${equipment?.averageSessionDuration?.toFixed(0) || 0} min`,\r\n      },\r\n      {\r\n        title: 'System Health',\r\n        value: 'Good',\r\n        icon: Activity,\r\n        description: 'All systems operational',\r\n        status: 'success',\r\n        progress: 95,\r\n        footer: `Last check: ${lastUpdated.toLocaleTimeString()}`,\r\n      },\r\n      {\r\n        title: 'Book Availability',\r\n        value: `${overview?.bookAvailabilityRate?.toFixed(1) || 0}%`,\r\n        change: overview?.bookAvailabilityRate > 90 ? 2 : -1,\r\n        changeType:\r\n          overview?.bookAvailabilityRate > 90 ? 'increase' : 'decrease',\r\n        icon: Target,\r\n        description: `${overview?.availableBooks || 0} of ${overview?.totalBooks || 0} books available`,\r\n        status:\r\n          overview?.bookAvailabilityRate > 85\r\n            ? 'success'\r\n            : overview?.bookAvailabilityRate > 70\r\n              ? 'warning'\r\n              : 'error',\r\n        progress: overview?.bookAvailabilityRate || 0,\r\n      },\r\n      {\r\n        title: 'Growth Rate',\r\n        value: `${trends?.dailyGrowth?.toFixed(1) || 0}%`,\r\n        change: trends?.dailyGrowth || 0,\r\n        changeType: trends?.dailyGrowth > 0 ? 'increase' : 'decrease',\r\n        icon: TrendingUp,\r\n        description: `${selectedTimeframe === 'day' ? 'Daily' : selectedTimeframe === 'week' ? 'Weekly' : 'Monthly'} growth`,\r\n        status:\r\n          trends?.dailyGrowth > 5\r\n            ? 'success'\r\n            : trends?.dailyGrowth > 0\r\n              ? 'info'\r\n              : 'warning',\r\n        footer: `Next period forecast: ${circulation?.trends?.forecastNextPeriod || 'N/A'}`,\r\n      },\r\n    ];\r\n  };\r\n\r\n  const getChangeIcon = (changeType?: 'increase' | 'decrease' | 'neutral') => {\r\n    switch (changeType) {\r\n      case 'increase':\r\n        return <TrendingUp className=\"h-4 w-4 text-green-500\" />;\r\n      case 'decrease':\r\n        return <TrendingDown className=\"h-4 w-4 text-red-500\" />;\r\n      default:\r\n        return <Activity className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (\r\n    status?: 'success' | 'warning' | 'error' | 'info'\r\n  ) => {\r\n    switch (status) {\r\n      case 'success':\r\n        return 'text-green-600 bg-green-50 border-green-200 dark:bg-green-950 dark:text-green-400 dark:border-green-800';\r\n      case 'warning':\r\n        return 'text-yellow-600 bg-yellow-50 border-yellow-200 dark:bg-yellow-950 dark:text-yellow-400 dark:border-yellow-800';\r\n      case 'error':\r\n        return 'text-red-600 bg-red-50 border-red-200 dark:bg-red-950 dark:text-red-400 dark:border-red-800';\r\n      case 'info':\r\n        return 'text-blue-600 bg-blue-50 border-blue-200 dark:bg-blue-950 dark:text-blue-400 dark:border-blue-800';\r\n      default:\r\n        return 'text-gray-600 bg-gray-50 border-gray-200 dark:bg-gray-950 dark:text-gray-400 dark:border-gray-800';\r\n    }\r\n  };\r\n\r\n  const MetricCard = ({ metric }: { metric: MetricCard }) => (\r\n    <Card\r\n      className={`relative overflow-hidden transition-all duration-200 hover:shadow-lg ${getStatusColor(metric.status)} border`}\r\n    >\r\n      <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n        <CardTitle className=\"text-sm font-medium\">{metric.title}</CardTitle>\r\n        <metric.icon className=\"h-4 w-4 text-muted-foreground\" />\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-2xl font-bold\">{metric.value}</div>\r\n          {metric.change !== undefined && (\r\n            <div className=\"flex items-center gap-1\">\r\n              {getChangeIcon(metric.changeType)}\r\n              <span\r\n                className={`text-sm font-medium ${\r\n                  metric.changeType === 'increase'\r\n                    ? 'text-green-600'\r\n                    : metric.changeType === 'decrease'\r\n                      ? 'text-red-600'\r\n                      : 'text-gray-600'\r\n                }`}\r\n              >\r\n                {Math.abs(metric.change)}%\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <p className=\"text-xs text-muted-foreground mt-1\">\r\n          {metric.description}\r\n        </p>\r\n\r\n        {metric.progress !== undefined && (\r\n          <div className=\"mt-3\">\r\n            <Progress value={metric.progress} className=\"h-2\" />\r\n          </div>\r\n        )}\r\n\r\n        {metric.footer && (\r\n          <p className=\"text-xs text-muted-foreground mt-2\">{metric.footer}</p>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        {[...Array(8)].map((_, i) => (\r\n          <Card key={i} className=\"animate-pulse\">\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <div className=\"h-4 w-20 bg-muted rounded\"></div>\r\n              <div className=\"h-4 w-4 bg-muted rounded\"></div>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"h-8 w-16 bg-muted rounded mb-2\"></div>\r\n              <div className=\"h-3 w-24 bg-muted rounded\"></div>\r\n              <div className=\"h-2 w-full bg-muted rounded mt-3\"></div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Header with refresh */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">Library Metrics</h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Real-time insights for{' '}\r\n            {timeframe === 'day'\r\n              ? 'today'\r\n              : timeframe === 'week'\r\n                ? 'this week'\r\n                : 'this month'}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            Last updated: {lastUpdated.toLocaleTimeString()}\r\n          </Badge>\r\n          <Button variant=\"outline\" size=\"sm\" onClick={onRefresh}>\r\n            <Activity className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Metrics Grid */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        {metrics.map((metric, index) => (\r\n          <MetricCard key={index} metric={metric} />\r\n        ))}\r\n      </div>\r\n\r\n      {/* Summary Stats */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <BarChart className=\"h-4 w-4\" />\r\n              Performance Summary\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>System Efficiency</span>\r\n                <span className=\"font-medium\">94%</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>User Satisfaction</span>\r\n                <span className=\"font-medium\">87%</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>Resource Optimization</span>\r\n                <span className=\"font-medium\">82%</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Target className=\"h-4 w-4\" />\r\n              Active Goals\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                <span className=\"text-sm\">Increase circulation by 15%</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />\r\n                <span className=\"text-sm\">Reduce overdue rate below 10%</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Activity className=\"h-4 w-4 text-blue-500\" />\r\n                <span className=\"text-sm\">Maintain equipment uptime 95%+</span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Calendar className=\"h-4 w-4\" />\r\n              Upcoming Events\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"text-sm\">\r\n                <span className=\"font-medium\">Today:</span> Staff meeting at\r\n                3:00 PM\r\n              </div>\r\n              <div className=\"text-sm\">\r\n                <span className=\"font-medium\">Tomorrow:</span> Book fair setup\r\n              </div>\r\n              <div className=\"text-sm\">\r\n                <span className=\"font-medium\">This Week:</span> Inventory audit\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MetricsCards;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\PredictiveInsights.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[782,785],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[782,785],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3326,3329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3326,3329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  AlertTriangle,\r\n  TrendingUp,\r\n  Target,\r\n  Activity,\r\n  Clock,\r\n  ChevronRight,\r\n  Info,\r\n  AlertCircle,\r\n  CheckCircle,\r\n} from 'lucide-react';\r\n\r\ninterface PredictiveInsight {\r\n  type:\r\n    | 'demand_forecast'\r\n    | 'peak_prediction'\r\n    | 'resource_optimization'\r\n    | 'anomaly_detection';\r\n  title: string;\r\n  description: string;\r\n  confidence: number;\r\n  impact: 'low' | 'medium' | 'high';\r\n  recommendations: string[];\r\n  data: any;\r\n  validUntil: Date;\r\n}\r\n\r\ninterface PredictiveInsightsProps {\r\n  insights: PredictiveInsight[];\r\n  timeframe: 'day' | 'week' | 'month';\r\n  onTimeframeChange: (timeframe: 'day' | 'week' | 'month') => void;\r\n  onInsightAction?: (insight: PredictiveInsight, action: string) => void;\r\n}\r\n\r\nexport function PredictiveInsights({\r\n  insights,\r\n  timeframe,\r\n  onTimeframeChange,\r\n  onInsightAction,\r\n}: PredictiveInsightsProps) {\r\n  const [selectedInsight, setSelectedInsight] =\r\n    useState<PredictiveInsight | null>(null);\r\n  const [filterType, setFilterType] = useState<string>('all');\r\n\r\n  const getImpactColor = (impact: string) => {\r\n    switch (impact) {\r\n      case 'high':\r\n        return 'bg-red-100 text-red-800 border-red-200';\r\n      case 'medium':\r\n        return 'bg-yellow-100 text-yellow-800 border-yellow-200';\r\n      case 'low':\r\n        return 'bg-green-100 text-green-800 border-green-200';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 border-gray-200';\r\n    }\r\n  };\r\n\r\n  const getInsightIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'demand_forecast':\r\n        return <TrendingUp className=\"h-5 w-5\" />;\r\n      case 'peak_prediction':\r\n        return <Clock className=\"h-5 w-5\" />;\r\n      case 'resource_optimization':\r\n        return <Target className=\"h-5 w-5\" />;\r\n      case 'anomaly_detection':\r\n        return <AlertTriangle className=\"h-5 w-5\" />;\r\n      default:\r\n        return <Activity className=\"h-5 w-5\" />;\r\n    }\r\n  };\r\n\r\n  const getConfidenceColor = (confidence: number) => {\r\n    if (confidence >= 0.8) {\r\n      return 'text-green-600';\r\n    }\r\n    if (confidence >= 0.6) {\r\n      return 'text-yellow-600';\r\n    }\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const filteredInsights =\r\n    filterType === 'all'\r\n      ? insights\r\n      : insights.filter((insight) => insight.type === filterType);\r\n\r\n  const highImpactInsights = insights.filter((i) => i.impact === 'high');\r\n  const actionableInsights = insights.filter(\r\n    (i) => i.recommendations.length > 0\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">Predictive Analytics</h3>\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            AI-powered insights and forecasts for library management\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Tabs\r\n            value={timeframe}\r\n            onValueChange={(value: any) => onTimeframeChange(value)}\r\n          >\r\n            <TabsList>\r\n              <TabsTrigger value=\"day\">Day</TabsTrigger>\r\n              <TabsTrigger value=\"week\">Week</TabsTrigger>\r\n              <TabsTrigger value=\"month\">Month</TabsTrigger>\r\n            </TabsList>\r\n          </Tabs>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Summary Stats */}\r\n      <div className=\"grid gap-4 md:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Insights\r\n            </CardTitle>\r\n            <Activity className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{insights.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Generated this period\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">High Priority</CardTitle>\r\n            <AlertTriangle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {highImpactInsights.length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Require immediate attention\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Actionable</CardTitle>\r\n            <Target className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-blue-600\">\r\n              {actionableInsights.length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              With recommendations\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Avg Confidence\r\n            </CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {Math.round(\r\n                (insights.reduce((sum, i) => sum + i.confidence, 0) /\r\n                  insights.length) *\r\n                  100\r\n              )}\r\n              %\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Prediction accuracy</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filter Tabs */}\r\n      <Tabs value={filterType} onValueChange={setFilterType}>\r\n        <TabsList className=\"grid w-full grid-cols-5\">\r\n          <TabsTrigger value=\"all\">All Insights</TabsTrigger>\r\n          <TabsTrigger value=\"demand_forecast\">Demand</TabsTrigger>\r\n          <TabsTrigger value=\"peak_prediction\">Peaks</TabsTrigger>\r\n          <TabsTrigger value=\"resource_optimization\">Resources</TabsTrigger>\r\n          <TabsTrigger value=\"anomaly_detection\">Anomalies</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value={filterType} className=\"space-y-4\">\r\n          {/* Insights Grid */}\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            {filteredInsights.map((insight, index) => (\r\n              <Card\r\n                key={index}\r\n                className=\"cursor-pointer hover:shadow-md transition-shadow\"\r\n                onClick={() => setSelectedInsight(insight)}\r\n              >\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {getInsightIcon(insight.type)}\r\n                      <CardTitle className=\"text-sm font-medium\">\r\n                        {insight.title}\r\n                      </CardTitle>\r\n                    </div>\r\n                    <Badge className={getImpactColor(insight.impact)}>\r\n                      {insight.impact}\r\n                    </Badge>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <p className=\"text-sm text-muted-foreground mb-3\">\r\n                    {insight.description}\r\n                  </p>\r\n\r\n                  <div className=\"flex items-center justify-between text-xs\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <span>Confidence:</span>\r\n                      <span\r\n                        className={`font-medium ${getConfidenceColor(insight.confidence)}`}\r\n                      >\r\n                        {Math.round(insight.confidence * 100)}%\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-1 text-muted-foreground\">\r\n                      <Info className=\"h-3 w-3\" />\r\n                      <span>{insight.recommendations.length} actions</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {insight.recommendations.length > 0 && (\r\n                    <div className=\"mt-3 pt-3 border-t\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <span className=\"text-xs text-muted-foreground\">\r\n                          {insight.recommendations[0]?.substring(0, 60)}...\r\n                        </span>\r\n                        <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n\r\n          {filteredInsights.length === 0 && (\r\n            <Card>\r\n              <CardContent className=\"py-8 text-center\">\r\n                <AlertCircle className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n                <h3 className=\"text-lg font-medium mb-2\">No insights found</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  No {filterType === 'all' ? '' : filterType.replace('_', ' ')}{' '}\r\n                  insights available for the selected period.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Selected Insight Detail */}\r\n      {selectedInsight && (\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                {getInsightIcon(selectedInsight.type)}\r\n                <div>\r\n                  <CardTitle>{selectedInsight.title}</CardTitle>\r\n                  <CardDescription>\r\n                    {selectedInsight.description}\r\n                  </CardDescription>\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Badge className={getImpactColor(selectedInsight.impact)}>\r\n                  {selectedInsight.impact}\r\n                </Badge>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setSelectedInsight(null)}\r\n                >\r\n                  ├ù\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            {/* Confidence Score */}\r\n            <div className=\"flex items-center justify-between p-3 bg-muted/50 rounded\">\r\n              <span className=\"text-sm font-medium\">Prediction Confidence</span>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <div className=\"w-24 bg-muted rounded-full h-2\">\r\n                  <div\r\n                    className=\"bg-primary h-2 rounded-full transition-all duration-300\"\r\n                    style={{ width: `${selectedInsight.confidence * 100}%` }}\r\n                  />\r\n                </div>\r\n                <span\r\n                  className={`text-sm font-medium ${getConfidenceColor(selectedInsight.confidence)}`}\r\n                >\r\n                  {Math.round(selectedInsight.confidence * 100)}%\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Validity Period */}\r\n            <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\r\n              <span>Valid until:</span>\r\n              <span>\r\n                {new Date(selectedInsight.validUntil).toLocaleDateString()}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Recommendations */}\r\n            {selectedInsight.recommendations.length > 0 && (\r\n              <div>\r\n                <h4 className=\"text-sm font-medium mb-3\">\r\n                  Recommended Actions\r\n                </h4>\r\n                <div className=\"space-y-2\">\r\n                  {selectedInsight.recommendations.map(\r\n                    (recommendation, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"flex items-start space-x-3 p-3 bg-muted/30 rounded\"\r\n                      >\r\n                        <div className=\"w-6 h-6 bg-primary/10 text-primary rounded-full flex items-center justify-center text-xs font-medium mt-0.5\">\r\n                          {index + 1}\r\n                        </div>\r\n                        <p className=\"text-sm flex-1\">{recommendation}</p>\r\n                        {onInsightAction && (\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              onInsightAction(\r\n                                selectedInsight,\r\n                                `implement_${index}`\r\n                              );\r\n                            }}\r\n                          >\r\n                            Implement\r\n                          </Button>\r\n                        )}\r\n                      </div>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Raw Data (for advanced users) */}\r\n            <details className=\"group\">\r\n              <summary className=\"cursor-pointer text-sm font-medium text-muted-foreground hover:text-foreground\">\r\n                View Technical Details\r\n              </summary>\r\n              <div className=\"mt-3 p-3 bg-muted/50 rounded text-xs font-mono\">\r\n                <pre>{JSON.stringify(selectedInsight.data, null, 2)}</pre>\r\n              </div>\r\n            </details>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PredictiveInsights;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\TimeSeriesForecast.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":159,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4061,4064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4061,4064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4333,4336],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4333,4336],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  Area,\r\n  AreaChart,\r\n  ReferenceLine,\r\n} from 'recharts';\r\nimport {\r\n  TrendingUp,\r\n  TrendingDown,\r\n  Activity,\r\n  Calendar,\r\n  Download,\r\n  Settings,\r\n  Eye,\r\n  EyeOff,\r\n} from 'lucide-react';\r\n\r\ninterface TimeSeriesData {\r\n  timestamp: Date;\r\n  value: number;\r\n  predicted?: number;\r\n  upperBound?: number;\r\n  lowerBound?: number;\r\n}\r\n\r\ninterface TimeSeriesForecastProps {\r\n  data: TimeSeriesData[];\r\n  title?: string;\r\n  description?: string;\r\n  metric?: 'student_visits' | 'equipment_usage' | 'book_circulation';\r\n  timeframe?: 'day' | 'week' | 'month';\r\n  onMetricChange?: (\r\n    metric: 'student_visits' | 'equipment_usage' | 'book_circulation'\r\n  ) => void;\r\n  onTimeframeChange?: (timeframe: 'day' | 'week' | 'month') => void;\r\n  showConfidence?: boolean;\r\n  showPredictions?: boolean;\r\n}\r\n\r\nconst METRIC_CONFIG = {\r\n  student_visits: {\r\n    label: 'Student Visits',\r\n    color: '#3b82f6',\r\n    icon: Activity,\r\n    unit: 'visits',\r\n  },\r\n  equipment_usage: {\r\n    label: 'Equipment Usage',\r\n    color: '#10b981',\r\n    icon: Activity,\r\n    unit: 'sessions',\r\n  },\r\n  book_circulation: {\r\n    label: 'Book Circulation',\r\n    color: '#f59e0b',\r\n    icon: Activity,\r\n    unit: 'transactions',\r\n  },\r\n};\r\n\r\nexport function TimeSeriesForecast({\r\n  data,\r\n  title,\r\n  description,\r\n  metric = 'student_visits',\r\n  timeframe = 'week',\r\n  onMetricChange,\r\n  onTimeframeChange,\r\n  showConfidence = true,\r\n  showPredictions = true,\r\n}: TimeSeriesForecastProps) {\r\n  const [showHistorical, setShowHistorical] = useState(true);\r\n  const [showBounds, setShowBounds] = useState(true);\r\n\r\n  const config = METRIC_CONFIG[metric];\r\n\r\n  // Process data for chart\r\n  const chartData = useMemo(() => {\r\n    return data.map((d) => ({\r\n      ...d,\r\n      date: new Date(d.timestamp).toLocaleDateString(),\r\n      timestamp: d.timestamp.getTime(),\r\n      hasPrediction: d.predicted !== undefined,\r\n    }));\r\n  }, [data]);\r\n\r\n  // Calculate statistics\r\n  const stats = useMemo(() => {\r\n    const historicalData = data.filter((d) => d.predicted === undefined);\r\n    const predictedData = data.filter((d) => d.predicted !== undefined);\r\n\r\n    const historicalValues = historicalData.map((d) => d.value);\r\n    const predictedValues = predictedData.map((d) => d.predicted || 0);\r\n\r\n    const lastHistorical = historicalValues[historicalValues.length - 1] || 0;\r\n    const avgHistorical =\r\n      historicalValues.reduce((sum, val) => sum + val, 0) /\r\n        historicalValues.length || 0;\r\n    const avgPredicted =\r\n      predictedValues.reduce((sum, val) => sum + val, 0) /\r\n        predictedValues.length || 0;\r\n\r\n    const trend =\r\n      avgPredicted > avgHistorical\r\n        ? 'increasing'\r\n        : avgPredicted < avgHistorical\r\n          ? 'decreasing'\r\n          : 'stable';\r\n    const trendPercent =\r\n      avgHistorical > 0\r\n        ? Math.round(((avgPredicted - avgHistorical) / avgHistorical) * 100)\r\n        : 0;\r\n\r\n    return {\r\n      lastHistorical,\r\n      avgHistorical: Math.round(avgHistorical),\r\n      avgPredicted: Math.round(avgPredicted),\r\n      trend,\r\n      trendPercent,\r\n      totalHistorical: historicalData.length,\r\n      totalPredicted: predictedData.length,\r\n      maxValue: Math.max(\r\n        ...data.map((d) =>\r\n          Math.max(d.value, d.predicted || d.value, d.upperBound || d.value)\r\n        )\r\n      ),\r\n      minValue: Math.min(\r\n        ...data.map((d) =>\r\n          Math.min(d.value, d.predicted || d.value, d.lowerBound || d.value)\r\n        )\r\n      ),\r\n    };\r\n  }, [data]);\r\n\r\n  // Custom tooltip\r\n  const CustomTooltip = ({ active, payload, label }: any) => {\r\n    if (active && payload?.length) {\r\n      const data = payload[0].payload;\r\n      return (\r\n        <div className=\"bg-background border rounded-lg shadow-lg p-3\">\r\n          <p className=\"text-sm font-medium mb-2\">{label}</p>\r\n          {payload.map((entry: any, index: number) => (\r\n            <p key={index} className=\"text-sm\" style={{ color: entry.color }}>\r\n              {entry.name}: {entry.value} {config.unit}\r\n            </p>\r\n          ))}\r\n          {data.hasPrediction && (\r\n            <div className=\"mt-2 pt-2 border-t text-xs text-muted-foreground\">\r\n              <p>\r\n                Confidence Range: {data.lowerBound} - {data.upperBound}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <CardTitle className=\"flex items-center space-x-2\">\r\n              <config.icon className=\"h-5 w-5\" />\r\n              <span>{title || `${config.label} Forecast`}</span>\r\n            </CardTitle>\r\n            <CardDescription>\r\n              {description ||\r\n                `Time series analysis and prediction for ${config.label.toLowerCase()}`}\r\n            </CardDescription>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            {onMetricChange && (\r\n              <Select value={metric} onValueChange={onMetricChange}>\r\n                <SelectTrigger className=\"w-40\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {Object.entries(METRIC_CONFIG).map(([key, config]) => (\r\n                    <SelectItem key={key} value={key}>\r\n                      {config.label}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            )}\r\n\r\n            {onTimeframeChange && (\r\n              <Select value={timeframe} onValueChange={onTimeframeChange}>\r\n                <SelectTrigger className=\"w-32\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"day\">Daily</SelectItem>\r\n                  <SelectItem value=\"week\">Weekly</SelectItem>\r\n                  <SelectItem value=\"month\">Monthly</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            )}\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowHistorical(!showHistorical)}\r\n            >\r\n              {showHistorical ? (\r\n                <EyeOff className=\"h-4 w-4\" />\r\n              ) : (\r\n                <Eye className=\"h-4 w-4\" />\r\n              )}\r\n            </Button>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowBounds(!showBounds)}\r\n            >\r\n              <Settings className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-6\">\r\n          {/* Statistics Summary */}\r\n          <div className=\"grid gap-4 md:grid-cols-5\">\r\n            <div className=\"p-3 bg-muted/30 rounded\">\r\n              <div className=\"text-2xl font-bold\">{stats.avgHistorical}</div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Current Average\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-3 bg-muted/30 rounded\">\r\n              <div className=\"text-2xl font-bold\">{stats.avgPredicted}</div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Predicted Average\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-3 bg-muted/30 rounded\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                {stats.trend === 'increasing' ? (\r\n                  <TrendingUp className=\"h-4 w-4 text-green-600\" />\r\n                ) : stats.trend === 'decreasing' ? (\r\n                  <TrendingDown className=\"h-4 w-4 text-red-600\" />\r\n                ) : (\r\n                  <Activity className=\"h-4 w-4 text-blue-600\" />\r\n                )}\r\n                <div className=\"text-2xl font-bold\">\r\n                  {stats.trendPercent > 0 ? '+' : ''}\r\n                  {stats.trendPercent}%\r\n                </div>\r\n              </div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                {stats.trend === 'increasing'\r\n                  ? 'Increasing'\r\n                  : stats.trend === 'decreasing'\r\n                    ? 'Decreasing'\r\n                    : 'Stable'}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-3 bg-muted/30 rounded\">\r\n              <div className=\"text-2xl font-bold\">{stats.totalHistorical}</div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Historical Points\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-3 bg-muted/30 rounded\">\r\n              <div className=\"text-2xl font-bold\">{stats.totalPredicted}</div>\r\n              <div className=\"text-xs text-muted-foreground\">\r\n                Predicted Points\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Chart */}\r\n          <div className=\"h-80\">\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n              <AreaChart data={chartData}>\r\n                <CartesianGrid\r\n                  strokeDasharray=\"3 3\"\r\n                  stroke=\"hsl(var(--border))\"\r\n                  opacity={0.3}\r\n                />\r\n                <XAxis\r\n                  dataKey=\"date\"\r\n                  tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }}\r\n                  tickFormatter={(value) => {\r\n                    const date = new Date(value);\r\n                    return date.toLocaleDateString('en-US', {\r\n                      month: 'short',\r\n                      day: 'numeric',\r\n                    });\r\n                  }}\r\n                />\r\n                <YAxis\r\n                  tick={{ fill: 'hsl(var(--muted-foreground))', fontSize: 12 }}\r\n                  domain={[stats.minValue * 0.9, stats.maxValue * 1.1]}\r\n                />\r\n                <Tooltip content={<CustomTooltip />} />\r\n                <Legend />\r\n\r\n                {/* Confidence bounds */}\r\n                {showPredictions && showBounds && showConfidence && (\r\n                  <>\r\n                    <Area\r\n                      type=\"monotone\"\r\n                      dataKey=\"upperBound\"\r\n                      stackId=\"bounds\"\r\n                      stroke=\"none\"\r\n                      fill={config.color}\r\n                      fillOpacity={0.1}\r\n                      name=\"Upper Bound\"\r\n                    />\r\n                    <Area\r\n                      type=\"monotone\"\r\n                      dataKey=\"lowerBound\"\r\n                      stackId=\"bounds\"\r\n                      stroke=\"none\"\r\n                      fill=\"white\"\r\n                      fillOpacity={0.8}\r\n                      name=\"Lower Bound\"\r\n                    />\r\n                  </>\r\n                )}\r\n\r\n                {/* Historical data */}\r\n                {showHistorical && (\r\n                  <Line\r\n                    type=\"monotone\"\r\n                    dataKey=\"value\"\r\n                    stroke={config.color}\r\n                    strokeWidth={2}\r\n                    dot={{ fill: config.color, r: 3 }}\r\n                    activeDot={{ r: 5 }}\r\n                    name=\"Historical\"\r\n                    connectNulls={false}\r\n                  />\r\n                )}\r\n\r\n                {/* Predicted data */}\r\n                {showPredictions && (\r\n                  <Line\r\n                    type=\"monotone\"\r\n                    dataKey=\"predicted\"\r\n                    stroke={config.color}\r\n                    strokeWidth={2}\r\n                    strokeDasharray=\"5 5\"\r\n                    dot={{ fill: config.color, r: 3 }}\r\n                    activeDot={{ r: 5 }}\r\n                    name=\"Predicted\"\r\n                    connectNulls={false}\r\n                  />\r\n                )}\r\n\r\n                {/* Reference line between historical and predicted */}\r\n                {showHistorical && showPredictions && (\r\n                  <ReferenceLine\r\n                    x={chartData.find((d) => d.hasPrediction)?.date || ''}\r\n                    stroke=\"hsl(var(--border))\"\r\n                    strokeDasharray=\"3 3\"\r\n                    strokeWidth={1}\r\n                  />\r\n                )}\r\n              </AreaChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Forecast Information */}\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"p-4 bg-muted/30 rounded-lg\">\r\n              <h4 className=\"text-sm font-medium mb-2\">Forecast Details</h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Time Period:</span>\r\n                  <span className=\"font-medium\">{timeframe}ly</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Prediction Method:</span>\r\n                  <span className=\"font-medium\">Exponential Smoothing</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Confidence Level:</span>\r\n                  <span className=\"font-medium\">95%</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Data Points:</span>\r\n                  <span className=\"font-medium\">{chartData.length}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-4 bg-muted/30 rounded-lg\">\r\n              <h4 className=\"text-sm font-medium mb-2\">Trend Analysis</h4>\r\n              <div className=\"space-y-2 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Current Trend:</span>\r\n                  <Badge\r\n                    variant={\r\n                      stats.trend === 'increasing'\r\n                        ? 'default'\r\n                        : stats.trend === 'decreasing'\r\n                          ? 'destructive'\r\n                          : 'secondary'\r\n                    }\r\n                  >\r\n                    {stats.trend}\r\n                  </Badge>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Change Rate:</span>\r\n                  <span className=\"font-medium\">{stats.trendPercent}%</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Peak Value:</span>\r\n                  <span className=\"font-medium\">\r\n                    {Math.round(stats.maxValue)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Min Value:</span>\r\n                  <span className=\"font-medium\">\r\n                    {Math.round(stats.minValue)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex items-center justify-between pt-4 border-t\">\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              Forecast generated using historical data and statistical analysis\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Button variant=\"outline\" size=\"sm\">\r\n                <Download className=\"h-4 w-4 mr-2\" />\r\n                Export Data\r\n              </Button>\r\n              <Button variant=\"outline\" size=\"sm\">\r\n                <Calendar className=\"h-4 w-4 mr-2\" />\r\n                Schedule Report\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default TimeSeriesForecast;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\analytics\\UsageHeatMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\attendance\\AttendanceReports.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\auth\\LoginForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1917,1920],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1917,1920],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface LoginFormData {\r\n  username: string;\r\n  password: string;\r\n  rememberMe: boolean;\r\n}\r\n\r\ninterface LoginFormProps {\r\n  onLoginSuccess: (user: {\r\n    id: string;\r\n    username: string;\r\n    role: string;\r\n  }) => void;\r\n}\r\n\r\nexport default function LoginForm({ onLoginSuccess }: LoginFormProps) {\r\n  const { login } = useAuth();\r\n  const [formData, setFormData] = useState<LoginFormData>({\r\n    username: '',\r\n    password: '',\r\n    rememberMe: false,\r\n  });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n    // Clear error when user starts typing\r\n    if (error) {\r\n      setError('');\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    // Basic validation\r\n    if (!formData.username.trim() || !formData.password.trim()) {\r\n      setError('Please enter both username and password');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      const success = await login(\r\n        formData.username,\r\n        formData.password,\r\n        formData.rememberMe\r\n      );\r\n\r\n      if (success) {\r\n        // Login was successful, the AuthContext will handle the rest\r\n        onLoginSuccess({} as any); // We don't need the user data here since AuthContext handles it\r\n      } else {\r\n        setError('Login failed');\r\n      }\r\n    } catch (err) {\r\n      const errorMessage = 'An error occurred during login';\r\n      setError(errorMessage);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-background px-4\">\r\n      {/* Background Image with Opacity */}\r\n      <div\r\n        className=\"fixed inset-0 bg-cover bg-center bg-no-repeat opacity-[0.35] dark:opacity-[0.08] pointer-events-none z-0\"\r\n        style={{ backgroundImage: `url('/Background.png')` }}\r\n      />\r\n\r\n      <Card className=\"w-full max-w-md relative z-10\">\r\n        <CardHeader className=\"text-center\">\r\n          <div className=\"flex justify-center mb-4\">\r\n            <img\r\n              src=\"/src/assets/School_logo.png\"\r\n              alt=\"Sacred Heart of Jesus Catholic School Logo\"\r\n              className=\"w-16 h-16 object-contain\"\r\n            />\r\n          </div>\r\n          <CardTitle className=\"text-2xl\">Administrator Login</CardTitle>\r\n          <CardDescription>\r\n            Sacred Heart of Jesus Catholic School Library\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form\r\n            onSubmit={handleSubmit}\r\n            className=\"space-y-4\"\r\n            data-testid=\"login-form\"\r\n          >\r\n            {error && (\r\n              <Alert variant=\"destructive\" data-testid=\"error-message\">\r\n                <AlertDescription>{error}</AlertDescription>\r\n              </Alert>\r\n            )}\r\n\r\n            <div className=\"space-y-2\">\r\n              <label htmlFor=\"username\" className=\"text-sm font-medium\">\r\n                Username\r\n              </label>\r\n              <Input\r\n                id=\"username\"\r\n                name=\"username\"\r\n                type=\"text\"\r\n                value={formData.username}\r\n                onChange={handleInputChange}\r\n                placeholder=\"Enter your username\"\r\n                required\r\n                disabled={isLoading}\r\n                autoComplete=\"username\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label htmlFor=\"password\" className=\"text-sm font-medium\">\r\n                Password\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"password\"\r\n                  name=\"password\"\r\n                  type={showPassword ? 'text' : 'password'}\r\n                  value={formData.password}\r\n                  onChange={handleInputChange}\r\n                  placeholder=\"Enter your password\"\r\n                  required\r\n                  disabled={isLoading}\r\n                  autoComplete=\"current-password\"\r\n                  className=\"pr-10\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(!showPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700\"\r\n                  tabIndex={-1}\r\n                >\r\n                  {showPassword ? (\r\n                    <svg\r\n                      xmlns=\"http://www.w3.org/2000/svg\"\r\n                      width=\"20\"\r\n                      height=\"20\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      fill=\"none\"\r\n                      stroke=\"currentColor\"\r\n                      strokeWidth=\"2\"\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                    >\r\n                      <path d=\"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24\" />\r\n                      <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\r\n                    </svg>\r\n                  ) : (\r\n                    <svg\r\n                      xmlns=\"http://www.w3.org/2000/svg\"\r\n                      width=\"20\"\r\n                      height=\"20\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      fill=\"none\"\r\n                      stroke=\"currentColor\"\r\n                      strokeWidth=\"2\"\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                    >\r\n                      <path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\" />\r\n                      <circle cx=\"12\" cy=\"12\" r=\"3\" />\r\n                    </svg>\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"remember-me\"\r\n                checked={formData.rememberMe}\r\n                onCheckedChange={(checked) =>\r\n                  setFormData((prev) => ({\r\n                    ...prev,\r\n                    rememberMe: checked as boolean,\r\n                  }))\r\n                }\r\n              />\r\n              <label\r\n                htmlFor=\"remember-me\"\r\n                className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\r\n              >\r\n                Remember me\r\n              </label>\r\n            </div>\r\n\r\n            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\r\n              {isLoading ? 'Signing in...' : 'Sign In'}\r\n            </Button>\r\n          </form>\r\n\r\n          <div className=\"mt-6 text-center text-sm text-muted-foreground\">\r\n            <p>Authorized personnel only</p>\r\n            <p className=\"text-xs mt-1\">\r\n              Contact library administrator for access\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\auth\\ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\backup\\BackupManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":317,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":317,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10192,10195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10192,10195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":517,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":517,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18879,18882],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18879,18882],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":532,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":532,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19558,19561],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19558,19561],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Database,\r\n  Download,\r\n  Upload,\r\n  RefreshCw,\r\n  Trash2,\r\n  CheckCircle,\r\n  XCircle,\r\n  Clock,\r\n  HardDrive,\r\n  Shield,\r\n  AlertTriangle,\r\n  FileArchive,\r\n  History as HistoryIcon,\r\n  Play,\r\n} from 'lucide-react';\r\nimport backupApi, {\r\n  type BackupMetadata,\r\n  type BackupStatistics,\r\n} from '../../services/backupApi';\r\nimport { useToast } from '../ToastContainer';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\nconst BackupManagement: React.FC = () => {\r\n  const [backups, setBackups] = useState<BackupMetadata[]>([]);\r\n  const [statistics, setStatistics] = useState<BackupStatistics | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [creating, setCreating] = useState(false);\r\n  const [typeFilter, setTypeFilter] = useState<'ALL' | 'FULL' | 'INCREMENTAL'>(\r\n    'ALL'\r\n  );\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showRestoreModal, setShowRestoreModal] = useState(false);\r\n  const [selectedBackup, setSelectedBackup] = useState<BackupMetadata | null>(\r\n    null\r\n  );\r\n\r\n  const toast = useToast();\r\n\r\n  const fetchBackups = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params: Record<string, unknown> = {};\r\n\r\n      if (typeFilter !== 'ALL') {\r\n        params.type = typeFilter;\r\n      }\r\n\r\n      const response = await backupApi.listBackups(params);\r\n      setBackups(response.data);\r\n    } catch (error) {\r\n      toast.error('Error', 'Failed to fetch backups');\r\n      console.error('Error fetching backups:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [typeFilter, toast]);\r\n\r\n  const fetchStatistics = useCallback(async () => {\r\n    try {\r\n      const response = await backupApi.getStatistics();\r\n      setStatistics(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching statistics:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchBackups();\r\n    fetchStatistics();\r\n  }, [fetchBackups, fetchStatistics]);\r\n\r\n  const handleCreateBackup = async (\r\n    type: 'FULL' | 'INCREMENTAL',\r\n    description?: string\r\n  ) => {\r\n    try {\r\n      setCreating(true);\r\n\r\n      if (type === 'FULL') {\r\n        await backupApi.createFullBackup(description);\r\n        toast.success('Success', 'Full backup created successfully');\r\n      } else {\r\n        await backupApi.createIncrementalBackup(description);\r\n        toast.success('Success', 'Incremental backup created successfully');\r\n      }\r\n\r\n      setShowCreateModal(false);\r\n      fetchBackups();\r\n      fetchStatistics();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to create backup'));\r\n    } finally {\r\n      setCreating(false);\r\n    }\r\n  };\r\n\r\n  const handleVerifyBackup = async (backup: BackupMetadata) => {\r\n    try {\r\n      const response = await backupApi.verifyBackup(backup.id);\r\n\r\n      if (response.data.valid) {\r\n        toast.success('Success', 'Backup verified successfully');\r\n      } else {\r\n        toast.error('Error', 'Backup verification failed');\r\n      }\r\n\r\n      fetchBackups();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to verify backup'));\r\n    }\r\n  };\r\n\r\n  const handleRestoreBackup = async (\r\n    backup: BackupMetadata,\r\n    dryRun: boolean = false\r\n  ) => {\r\n    if (!dryRun) {\r\n      const confirmed = window.confirm(\r\n        `ΓÜá∩╕Å WARNING: This will restore the database to the state at ${formatDateTime(backup.createdAt)}.\\n\\nAll current data will be replaced with the backup data.\\n\\nAre you absolutely sure you want to proceed?`\r\n      );\r\n\r\n      if (!confirmed) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      await backupApi.restoreBackup(backup.id, dryRun);\r\n\r\n      if (dryRun) {\r\n        toast.success('Success', 'Dry run completed successfully');\r\n      } else {\r\n        toast.success('Success', 'Database restored successfully');\r\n        window.location.reload(); // Reload to reflect changes\r\n      }\r\n\r\n      setShowRestoreModal(false);\r\n      setSelectedBackup(null);\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to restore backup'));\r\n    }\r\n  };\r\n\r\n  const handleDeleteBackup = async (backup: BackupMetadata) => {\r\n    if (\r\n      !window.confirm(\r\n        `Are you sure you want to delete backup \"${backup.filename}\"?`\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await backupApi.deleteBackup(backup.id);\r\n      toast.success('Success', 'Backup deleted successfully');\r\n      fetchBackups();\r\n      fetchStatistics();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to delete backup'));\r\n    }\r\n  };\r\n\r\n  const formatSize = (bytes: number): string => {\r\n    if (bytes === 0) {\r\n      return '0 B';\r\n    }\r\n    const k = 1024;\r\n    const sizes = ['B', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return `${(bytes / Math.pow(k, i)).toFixed(2)} ${sizes[i]}`;\r\n  };\r\n\r\n  const formatDateTime = (dateString: string): string => {\r\n    return new Date(dateString).toLocaleString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  const getStatusBadge = (status: BackupMetadata['status']) => {\r\n    const badges = {\r\n      COMPLETED: {\r\n        color: 'bg-green-100 text-green-800 border-green-300',\r\n        icon: <CheckCircle className=\"w-3 h-3\" />,\r\n        text: 'Completed',\r\n      },\r\n      FAILED: {\r\n        color: 'bg-red-100 text-red-800 border-red-300',\r\n        icon: <XCircle className=\"w-3 h-3\" />,\r\n        text: 'Failed',\r\n      },\r\n      IN_PROGRESS: {\r\n        color: 'bg-blue-100 text-blue-800 border-blue-300',\r\n        icon: <RefreshCw className=\"w-3 h-3 animate-spin\" />,\r\n        text: 'In Progress',\r\n      },\r\n      PENDING: {\r\n        color: 'bg-gray-100 text-gray-800 border-gray-300',\r\n        icon: <Clock className=\"w-3 h-3\" />,\r\n        text: 'Pending',\r\n      },\r\n    };\r\n\r\n    const badge = badges[status];\r\n\r\n    return (\r\n      <span\r\n        className={`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border ${badge.color}`}\r\n      >\r\n        {badge.icon}\r\n        {badge.text}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Backup & Restore</h1>\r\n          <p className=\"text-gray-600 mt-1\">\r\n            Manage database backups and restore points\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowCreateModal(true)}\r\n          disabled={creating}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\r\n        >\r\n          <Download className=\"w-5 h-5\" />\r\n          Create Backup\r\n        </button>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      {statistics && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total Backups</p>\r\n                <p className=\"text-2xl font-bold text-gray-900\">\r\n                  {statistics.total}\r\n                </p>\r\n              </div>\r\n              <Database className=\"w-8 h-8 text-blue-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Full Backups</p>\r\n                <p className=\"text-2xl font-bold text-purple-600\">\r\n                  {statistics.fullBackups}\r\n                </p>\r\n              </div>\r\n              <FileArchive className=\"w-8 h-8 text-purple-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Incremental</p>\r\n                <p className=\"text-2xl font-bold text-green-600\">\r\n                  {statistics.incrementalBackups}\r\n                </p>\r\n              </div>\r\n              <HistoryIcon className=\"w-8 h-8 text-green-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total Size</p>\r\n                <p className=\"text-2xl font-bold text-orange-600\">\r\n                  {formatSize(statistics.totalSize)}\r\n                </p>\r\n              </div>\r\n              <HardDrive className=\"w-8 h-8 text-orange-600\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Last Backup Info */}\r\n      {statistics?.lastBackup && (\r\n        <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <Clock className=\"w-5 h-5 text-blue-600\" />\r\n            <div>\r\n              <p className=\"text-sm font-medium text-gray-900\">\r\n                Last backup: {formatDateTime(statistics.lastBackup.createdAt)}\r\n              </p>\r\n              <p className=\"text-sm text-gray-600\">\r\n                {statistics.lastBackup.type} backup ΓÇó{' '}\r\n                {formatSize(statistics.lastBackup.size)}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <select\r\n            value={typeFilter}\r\n            onChange={(e) => setTypeFilter(e.target.value as any)}\r\n            className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          >\r\n            <option value=\"ALL\">All Types</option>\r\n            <option value=\"FULL\">Full Backups</option>\r\n            <option value=\"INCREMENTAL\">Incremental Backups</option>\r\n          </select>\r\n\r\n          <button\r\n            onClick={fetchBackups}\r\n            disabled={loading}\r\n            className=\"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\r\n          >\r\n            <RefreshCw className={`w-5 h-5 ${loading ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Backups Table */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 overflow-hidden\">\r\n        {loading ? (\r\n          <div className=\"flex items-center justify-center p-12\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n          </div>\r\n        ) : backups.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center p-12\">\r\n            <Database className=\"w-16 h-16 text-gray-400 mb-4\" />\r\n            <p className=\"text-gray-600\">No backups found</p>\r\n            <button\r\n              onClick={() => setShowCreateModal(true)}\r\n              className=\"mt-4 text-blue-600 hover:text-blue-700 text-sm\"\r\n            >\r\n              Create your first backup\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead className=\"bg-gray-50 border-b border-gray-200\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Backup\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Type\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Status\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Size\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Created\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {backups.map((backup) => (\r\n                  <tr key={backup.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-6 py-4\">\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900\">\r\n                          {backup.filename}\r\n                        </div>\r\n                        {backup.description && (\r\n                          <div className=\"text-sm text-gray-500\">\r\n                            {backup.description}\r\n                          </div>\r\n                        )}\r\n                        {backup.verified && (\r\n                          <div className=\"flex items-center gap-1 text-xs text-green-600 mt-1\">\r\n                            <Shield className=\"w-3 h-3\" />\r\n                            Verified\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <span\r\n                        className={`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border ${\r\n                          backup.type === 'FULL'\r\n                            ? 'bg-purple-100 text-purple-800 border-purple-300'\r\n                            : 'bg-green-100 text-green-800 border-green-300'\r\n                        }`}\r\n                      >\r\n                        {backup.type === 'FULL' ? (\r\n                          <Database className=\"w-3 h-3\" />\r\n                        ) : (\r\n                          <HistoryIcon className=\"w-3 h-3\" />\r\n                        )}\r\n                        {backup.type}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      {getStatusBadge(backup.status)}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-sm text-gray-600\">\r\n                      {formatSize(backup.size)}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-sm text-gray-600\">\r\n                      {formatDateTime(backup.createdAt)}\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <div className=\"flex items-center justify-end gap-2\">\r\n                        {backup.status === 'COMPLETED' && (\r\n                          <>\r\n                            <button\r\n                              onClick={() => handleVerifyBackup(backup)}\r\n                              className=\"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                              title=\"Verify backup\"\r\n                            >\r\n                              <Shield className=\"w-4 h-4\" />\r\n                            </button>\r\n                            <button\r\n                              onClick={() => {\r\n                                setSelectedBackup(backup);\r\n                                setShowRestoreModal(true);\r\n                              }}\r\n                              className=\"p-1.5 text-green-600 hover:bg-green-50 rounded transition-colors\"\r\n                              title=\"Restore backup\"\r\n                            >\r\n                              <Upload className=\"w-4 h-4\" />\r\n                            </button>\r\n                          </>\r\n                        )}\r\n                        <button\r\n                          onClick={() => handleDeleteBackup(backup)}\r\n                          className=\"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors\"\r\n                          title=\"Delete backup\"\r\n                        >\r\n                          <Trash2 className=\"w-4 h-4\" />\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Create Backup Modal */}\r\n      {showCreateModal && (\r\n        <CreateBackupModal\r\n          onClose={() => setShowCreateModal(false)}\r\n          onCreate={handleCreateBackup}\r\n          creating={creating}\r\n        />\r\n      )}\r\n\r\n      {/* Restore Backup Modal */}\r\n      {showRestoreModal && selectedBackup && (\r\n        <RestoreBackupModal\r\n          backup={selectedBackup}\r\n          onClose={() => {\r\n            setShowRestoreModal(false);\r\n            setSelectedBackup(null);\r\n          }}\r\n          onRestore={handleRestoreBackup}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Create Backup Modal\r\nconst CreateBackupModal: React.FC<{\r\n  onClose: () => void;\r\n  onCreate: (type: 'FULL' | 'INCREMENTAL', description?: string) => void;\r\n  creating: boolean;\r\n}> = ({ onClose, onCreate, creating }) => {\r\n  const [type, setType] = useState<'FULL' | 'INCREMENTAL'>('FULL');\r\n  const [description, setDescription] = useState('');\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onCreate(type, description || undefined);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Create New Backup</h2>\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              Backup Type *\r\n            </label>\r\n            <div className=\"space-y-2\">\r\n              <label className=\"flex items-center gap-3 p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50\">\r\n                <input\r\n                  type=\"radio\"\r\n                  value=\"FULL\"\r\n                  checked={type === 'FULL'}\r\n                  onChange={(e) => setType(e.target.value as any)}\r\n                  className=\"text-blue-600\"\r\n                />\r\n                <div>\r\n                  <div className=\"font-medium\">Full Backup</div>\r\n                  <div className=\"text-sm text-gray-500\">\r\n                    Complete database snapshot\r\n                  </div>\r\n                </div>\r\n              </label>\r\n              <label className=\"flex items-center gap-3 p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50\">\r\n                <input\r\n                  type=\"radio\"\r\n                  value=\"INCREMENTAL\"\r\n                  checked={type === 'INCREMENTAL'}\r\n                  onChange={(e) => setType(e.target.value as any)}\r\n                  className=\"text-blue-600\"\r\n                />\r\n                <div>\r\n                  <div className=\"font-medium\">Incremental Backup</div>\r\n                  <div className=\"text-sm text-gray-500\">\r\n                    Changes since last backup\r\n                  </div>\r\n                </div>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Description (Optional)\r\n            </label>\r\n            <textarea\r\n              value={description}\r\n              onChange={(e) => setDescription(e.target.value)}\r\n              rows={3}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n              placeholder=\"Add a description for this backup...\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 justify-end mt-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              disabled={creating}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={creating}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2\"\r\n            >\r\n              {creating ? (\r\n                <>\r\n                  <RefreshCw className=\"w-4 h-4 animate-spin\" />\r\n                  Creating...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Download className=\"w-4 h-4\" />\r\n                  Create Backup\r\n                </>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Restore Backup Modal\r\nconst RestoreBackupModal: React.FC<{\r\n  backup: BackupMetadata;\r\n  onClose: () => void;\r\n  onRestore: (backup: BackupMetadata, dryRun: boolean) => void;\r\n}> = ({ backup, onClose, onRestore }) => {\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n        <div className=\"flex items-center gap-3 mb-4\">\r\n          <AlertTriangle className=\"w-8 h-8 text-orange-600\" />\r\n          <h2 className=\"text-xl font-bold\">Restore Backup</h2>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"bg-orange-50 border border-orange-200 rounded-lg p-4\">\r\n            <p className=\"text-sm text-orange-800\">\r\n              <strong>Warning:</strong> This action will replace all current\r\n              data with the backup data from{' '}\r\n              <strong>{new Date(backup.createdAt).toLocaleString()}</strong>.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"bg-gray-50 rounded-lg p-4 space-y-2\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Backup:</span>\r\n              <span className=\"font-medium\">{backup.filename}</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Type:</span>\r\n              <span className=\"font-medium\">{backup.type}</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Size:</span>\r\n              <span className=\"font-medium\">\r\n                {(backup.size / (1024 * 1024)).toFixed(2)} MB\r\n              </span>\r\n            </div>\r\n            {backup.description && (\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-600\">Description:</span>\r\n                <span className=\"font-medium\">{backup.description}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex flex-col gap-2 mt-6\">\r\n            <button\r\n              onClick={() => onRestore(backup, true)}\r\n              className=\"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center justify-center gap-2\"\r\n            >\r\n              <Play className=\"w-4 h-4\" />\r\n              Dry Run (Test Only)\r\n            </button>\r\n            <button\r\n              onClick={() => onRestore(backup, false)}\r\n              className=\"w-full px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 flex items-center justify-center gap-2\"\r\n            >\r\n              <Upload className=\"w-4 h-4\" />\r\n              Restore Database\r\n            </button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\r\n            >\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BackupManagement;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\base\\BaseComponent.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":31,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":31,"endColumn":34},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":175,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":175,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":182,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4139,4142],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4139,4142],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":191,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":191,"endColumn":26},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":201,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":201,"endColumn":27},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":213,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":213,"endColumn":27},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":225,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":225,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { type ComponentType, type ReactNode } from 'react';\r\nimport { cn } from '@/lib/utils';\r\n\r\n/**\r\n * Base component props that all components should extend\r\n */\r\nexport interface BaseComponentProps {\r\n  /** CSS class name */\r\n  className?: string;\r\n  /** Test ID for testing */\r\n  testId?: string;\r\n  /** ARIA label for accessibility */\r\n  ariaLabel?: string;\r\n  /** Additional ARIA attributes */\r\n  aria?: Record<string, string>;\r\n  /** Children components */\r\n  children?: ReactNode;\r\n  /** Whether the component is disabled */\r\n  disabled?: boolean;\r\n  /** Whether the component is loading */\r\n  loading?: boolean;\r\n  /** Size variant */\r\n  size?: 'sm' | 'md' | 'lg';\r\n  /** Color variant */\r\n  variant?: 'primary' | 'secondary' | 'success' | 'warning' | 'error';\r\n}\r\n\r\n/**\r\n * Higher-order component that adds base functionality to any component\r\n */\r\nexport function withBaseComponent<T extends BaseComponentProps>(\r\n  WrappedComponent: ComponentType<T>\r\n): ComponentType<T> {\r\n  const WithBaseComponent = (props: T) => {\r\n    const {\r\n      className,\r\n      testId,\r\n      ariaLabel,\r\n      aria,\r\n      disabled,\r\n      loading,\r\n      size = 'md',\r\n      variant = 'primary',\r\n      ...rest\r\n    } = props;\r\n\r\n    const baseClasses = cn(\r\n      'base-component',\r\n      disabled && 'opacity-50 cursor-not-allowed',\r\n      loading && 'animate-pulse',\r\n      size && `size-${size}`,\r\n      variant && `variant-${variant}`,\r\n      className\r\n    );\r\n\r\n    const baseAria = {\r\n      'aria-label': ariaLabel,\r\n      'aria-disabled': disabled,\r\n      'aria-busy': loading,\r\n      ...aria,\r\n    };\r\n\r\n    return (\r\n      <WrappedComponent\r\n        {...(rest as T)}\r\n        className={baseClasses}\r\n        data-testid={testId}\r\n        {...baseAria}\r\n      />\r\n    );\r\n  };\r\n\r\n  WithBaseComponent.displayName = `withBaseComponent(${WrappedComponent.displayName || WrappedComponent.name})`;\r\n\r\n  return WithBaseComponent;\r\n}\r\n\r\n/**\r\n * Base component class that provides common functionality\r\n */\r\nexport abstract class BaseComponent<\r\n  P extends BaseComponentProps = BaseComponentProps,\r\n> {\r\n  protected props: P;\r\n  protected element?: HTMLElement | undefined;\r\n\r\n  constructor(props: P) {\r\n    this.props = props;\r\n  }\r\n\r\n  /**\r\n   * Mount the component\r\n   */\r\n  mount(element: HTMLElement): void {\r\n    this.element = element;\r\n    this.onMount();\r\n  }\r\n\r\n  /**\r\n   * Unmount the component\r\n   */\r\n  unmount(): void {\r\n    this.onUnmount();\r\n    this.element = undefined;\r\n  }\r\n\r\n  /**\r\n   * Update component props\r\n   */\r\n  update(props: Partial<P>): void {\r\n    this.props = { ...this.props, ...props };\r\n    this.onUpdate();\r\n  }\r\n\r\n  /**\r\n   * Get computed CSS classes\r\n   */\r\n  protected getClasses(): string {\r\n    const { className, disabled, loading, size, variant } = this.props;\r\n\r\n    return cn(\r\n      'base-component',\r\n      disabled && 'disabled',\r\n      loading && 'loading',\r\n      size && `size-${size}`,\r\n      variant && `variant-${variant}`,\r\n      className\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get ARIA attributes\r\n   */\r\n  protected getAriaAttributes(): Record<string, string> {\r\n    const { ariaLabel, aria, disabled, loading } = this.props;\r\n\r\n    return {\r\n      'aria-label': ariaLabel || '',\r\n      'aria-disabled': disabled ? 'true' : 'false',\r\n      'aria-busy': loading ? 'true' : 'false',\r\n      ...aria,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Lifecycle hook for when component mounts\r\n   */\r\n  protected onMount(): void {\r\n    // Override in subclasses\r\n  }\r\n\r\n  /**\r\n   * Lifecycle hook for when component unmounts\r\n   */\r\n  protected onUnmount(): void {\r\n    // Override in subclasses\r\n  }\r\n\r\n  /**\r\n   * Lifecycle hook for when component updates\r\n   */\r\n  protected onUpdate(): void {\r\n    // Override in subclasses\r\n  }\r\n\r\n  /**\r\n   * Render the component\r\n   */\r\n  abstract render(): string | HTMLElement;\r\n}\r\n\r\n/**\r\n * Utility function to create consistent component variants\r\n */\r\nexport function createComponentVariants<T extends Record<string, string>>(\r\n  base: string,\r\n  variants: T\r\n): T {\r\n  const result = {} as T;\r\n\r\n  Object.entries(variants).forEach(([key, value]) => {\r\n    (result as any)[key] = `${base} ${value}`;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Size variants for components\r\n */\r\nexport const sizeVariants = {\r\n  sm: 'size-sm',\r\n  md: 'size-md',\r\n  lg: 'size-lg',\r\n  xl: 'size-xl',\r\n} as const;\r\n\r\n/**\r\n * Color variants for components\r\n */\r\nexport const colorVariants = {\r\n  primary: 'variant-primary',\r\n  secondary: 'variant-secondary',\r\n  success: 'variant-success',\r\n  warning: 'variant-warning',\r\n  error: 'variant-error',\r\n  info: 'variant-info',\r\n} as const;\r\n\r\n/**\r\n * State variants for components\r\n */\r\nexport const stateVariants = {\r\n  default: 'state-default',\r\n  hover: 'state-hover',\r\n  active: 'state-active',\r\n  focus: 'state-focus',\r\n  disabled: 'state-disabled',\r\n  loading: 'state-loading',\r\n} as const;\r\n\r\n/**\r\n * Common component patterns\r\n */\r\nexport const ComponentPatterns = {\r\n  /**\r\n   * Create a clickable component that handles keyboard and mouse events\r\n   */\r\n  clickable: (onClick: () => void) => ({\r\n    role: 'button',\r\n    tabIndex: 0,\r\n    onKeyDown: (e: React.KeyboardEvent) => {\r\n      if (e.key === 'Enter' || e.key === ' ') {\r\n        e.preventDefault();\r\n        onClick();\r\n      }\r\n    },\r\n    onClick,\r\n  }),\r\n\r\n  /**\r\n   * Create a focusable component with proper focus management\r\n   */\r\n  focusable: (onFocus?: () => void, onBlur?: () => void) => ({\r\n    tabIndex: 0,\r\n    onFocus,\r\n    onBlur,\r\n  }),\r\n\r\n  /**\r\n   * Create a loading state component\r\n   */\r\n  loading: (isLoading: boolean, children: ReactNode) => ({\r\n    'aria-busy': isLoading,\r\n    children: isLoading ? (\r\n      <div className=\"loading-spinner\" role=\"status\" aria-label=\"Loading\">\r\n        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-current\" />\r\n      </div>\r\n    ) : (\r\n      children\r\n    ),\r\n  }),\r\n\r\n  /**\r\n   * Create an error boundary component\r\n   */\r\n  errorBoundary: (error: Error | null, errorComponent?: ReactNode) => {\r\n    if (error) {\r\n      return (\r\n        errorComponent || (\r\n          <div className=\"error-boundary\" role=\"alert\">\r\n            <p>Something went wrong.</p>\r\n            <details>\r\n              <summary>Error details</summary>\r\n              <pre>{error.message}</pre>\r\n            </details>\r\n          </div>\r\n        )\r\n      );\r\n    }\r\n    return null;\r\n  },\r\n};\r\n\r\nexport default BaseComponent;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\client\\BookCatalogClient.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":390,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":390,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12229,12232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12229,12232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { BookCard } from '@/components/ui/BookCard';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  BookOpen,\r\n  Search,\r\n  RefreshCw,\r\n  ArrowUpDown,\r\n  Grid3X3,\r\n  List,\r\n} from 'lucide-react';\r\nimport { useDebounce } from '@/hooks/useDebounce';\r\nimport { useLocalStorage } from '@/hooks/useLocalStorage';\r\n\r\ninterface Book {\r\n  id: string;\r\n  isbn?: string;\r\n  accessionNo: string;\r\n  title: string;\r\n  author: string;\r\n  publisher?: string;\r\n  category: string;\r\n  subcategory?: string;\r\n  location?: string;\r\n  totalCopies: number;\r\n  availableCopies: number;\r\n  isActive: boolean;\r\n  barcodeImage?: string;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\ninterface BookCatalogClientProps {\r\n  initialBooks?: Book[];\r\n  categories?: string[];\r\n}\r\n\r\nconst DEFAULT_CATEGORIES = [\r\n  'Fiction',\r\n  'Non-Fiction',\r\n  'Reference',\r\n  'Science',\r\n  'Mathematics',\r\n  'History',\r\n  'Literature',\r\n  'Technology',\r\n  'Arts',\r\n  'Biography',\r\n  'Children',\r\n  'Young Adult',\r\n];\r\n\r\nexport function BookCatalogClient({\r\n  initialBooks = [],\r\n  categories = DEFAULT_CATEGORIES,\r\n}: BookCatalogClientProps) {\r\n  // Modern hooks for state management\r\n  const [books, setBooks] = useState<Book[]>(initialBooks);\r\n  const [filteredBooks, setFilteredBooks] = useState<Book[]>(initialBooks);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // _Search and filter state\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedCategory, setSelectedCategory] = useState<string>('all');\r\n  const [sortBy, setSortBy] = useState<'title' | 'author' | 'created_at'>(\r\n    'title'\r\n  );\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\r\n  const [availableOnly, setAvailableOnly] = useState(false);\r\n\r\n  // UI state with localStorage persistence\r\n  const [viewMode, setViewMode] = useLocalStorage<'grid' | 'list'>(\r\n    'book-view-mode',\r\n    'grid'\r\n  );\r\n  const [booksPerPage] = useLocalStorage('books-per-page', 20);\r\n\r\n  // Debounced _search query\r\n  const debouncedSearchQuery = useDebounce(searchQuery, 300);\r\n\r\n  // Memoized filter and sort logic\r\n  const filteredAndSortedBooks = useMemo(() => {\r\n    let filtered = books;\r\n\r\n    // Apply _search filter\r\n    if (debouncedSearchQuery) {\r\n      const query = debouncedSearchQuery.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (book) =>\r\n          book.title.toLowerCase().includes(query) ||\r\n          book.author.toLowerCase().includes(query) ||\r\n          book.isbn?.toLowerCase().includes(query) ||\r\n          book.accessionNo.toLowerCase().includes(query) ||\r\n          book.category.toLowerCase().includes(query)\r\n      );\r\n    }\r\n\r\n    // Apply category filter\r\n    if (selectedCategory !== 'all') {\r\n      filtered = filtered.filter((book) => book.category === selectedCategory);\r\n    }\r\n\r\n    // Apply availability filter\r\n    if (availableOnly) {\r\n      filtered = filtered.filter((book) => book.availableCopies > 0);\r\n    }\r\n\r\n    // Apply sorting\r\n    filtered.sort((a, b) => {\r\n      let aValue: string | number;\r\n      let bValue: string | number;\r\n\r\n      switch (sortBy) {\r\n        case 'author':\r\n          aValue = a.author.toLowerCase();\r\n          bValue = b.author.toLowerCase();\r\n          break;\r\n        case 'created_at':\r\n          aValue = new Date(a.createdAt).getTime();\r\n          bValue = new Date(b.createdAt).getTime();\r\n          break;\r\n        case 'title':\r\n        default:\r\n          aValue = a.title.toLowerCase();\r\n          bValue = b.title.toLowerCase();\r\n          break;\r\n      }\r\n\r\n      if (sortOrder === 'desc') {\r\n        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;\r\n      } else {\r\n        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0;\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [\r\n    books,\r\n    debouncedSearchQuery,\r\n    selectedCategory,\r\n    sortBy,\r\n    sortOrder,\r\n    availableOnly,\r\n  ]);\r\n\r\n  // Update filtered books when memoized result changes\r\n  useEffect(() => {\r\n    setFilteredBooks(filteredAndSortedBooks);\r\n  }, [filteredAndSortedBooks]);\r\n\r\n  // Fetch books from API\r\n  const fetchBooks = useCallback(async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await fetch('/api/books', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch books');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setBooks(data.data.books || []);\r\n      } else {\r\n        setError(data.error || 'Failed to load books');\r\n      }\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error';\r\n      setError(errorMessage);\r\n      toast.error('Failed to load books. Please try again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Handle book checkout\r\n  const handleCheckout = useCallback(async (bookId: string) => {\r\n    try {\r\n      const response = await fetch(`/api/books/${bookId}/checkout`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to checkout book');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        // Update local state to reflect checkout\r\n        setBooks((prev) =>\r\n          prev.map((book) =>\r\n            book.id === bookId\r\n              ? { ...book, availableCopies: book.availableCopies - 1 }\r\n              : book\r\n          )\r\n        );\r\n      } else {\r\n        throw new Error(data.error || 'Checkout failed');\r\n      }\r\n    } catch (err) {\r\n      const errorMessage =\r\n        err instanceof Error ? err.message : 'Checkout failed';\r\n      throw new Error(errorMessage);\r\n    }\r\n  }, []);\r\n\r\n  // Handle view details\r\n  const handleViewDetails = useCallback((book: Book) => {\r\n    // This would typically open a dialog or navigate to a detail page\r\n    toast.info(`Viewing details for \"${book.title}\"`);\r\n    console.debug('Book details:', book);\r\n  }, []);\r\n\r\n  // Reset filters\r\n  const resetFilters = useCallback(() => {\r\n    setSearchQuery('');\r\n    setSelectedCategory('all');\r\n    setSortBy('title');\r\n    setSortOrder('asc');\r\n    setAvailableOnly(false);\r\n  }, []);\r\n\r\n  // Stats calculation\r\n  const stats = useMemo(() => {\r\n    const total = books.length;\r\n    const available = books.filter((book) => book.availableCopies > 0).length;\r\n    const checkedOut = books.reduce(\r\n      (sum, book) => sum + (book.totalCopies - book.availableCopies),\r\n      0\r\n    );\r\n    const uniqueCategories = new Set(books.map((book) => book.category)).size;\r\n\r\n    return { total, available, checkedOut, categories: uniqueCategories };\r\n  }, [books]);\r\n\r\n  // Pagination\r\n  const totalPages = Math.ceil(filteredBooks.length / booksPerPage);\r\n  const paginatedBooks = useMemo(() => {\r\n    const startIndex = 0; // Could add page state later\r\n    return filteredBooks.slice(startIndex, startIndex + booksPerPage);\r\n  }, [filteredBooks, booksPerPage]);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with stats */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold tracking-tight\">Book Catalog</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Browse and manage your library collection\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={fetchBooks}\r\n            disabled={isLoading}\r\n          >\r\n            <RefreshCw\r\n              className={`h-4 w-4 mr-2 ${isLoading ? 'animate-spin' : ''}`}\r\n            />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid gap-4 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4\">\r\n        <div className=\"bg-background border rounded-lg p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                Total Books\r\n              </p>\r\n              <p className=\"text-2xl font-bold\">{stats.total}</p>\r\n            </div>\r\n            <BookOpen className=\"h-8 w-8 text-muted-foreground\" />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-background border rounded-lg p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                Available\r\n              </p>\r\n              <p className=\"text-2xl font-bold text-green-600\">\r\n                {stats.available}\r\n              </p>\r\n            </div>\r\n            <div className=\"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center\">\r\n              <div className=\"h-4 w-4 bg-green-500 rounded-full\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-background border rounded-lg p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                Checked Out\r\n              </p>\r\n              <p className=\"text-2xl font-bold text-blue-600\">\r\n                {stats.checkedOut}\r\n              </p>\r\n            </div>\r\n            <div className=\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center\">\r\n              <div className=\"h-4 w-4 bg-blue-500 rounded-full\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"bg-background border rounded-lg p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                Categories\r\n              </p>\r\n              <p className=\"text-2xl font-bold text-purple-600\">\r\n                {stats.categories}\r\n              </p>\r\n            </div>\r\n            <div className=\"h-8 w-8 bg-purple-100 rounded-full flex items-center justify-center\">\r\n              <div className=\"h-4 w-4 bg-purple-500 rounded-full\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* _Search and Filters */}\r\n      <div className=\"bg-background border rounded-lg p-4 space-y-4\">\r\n        <div className=\"flex flex-col sm:flex-row gap-4\">\r\n          {/* _Search */}\r\n          <div className=\"relative flex-1\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder=\"_Search books...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <div className=\"flex gap-2\">\r\n            <Select\r\n              value={selectedCategory}\r\n              onValueChange={setSelectedCategory}\r\n            >\r\n              <SelectTrigger className=\"w-40\">\r\n                <SelectValue placeholder=\"Category\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Categories</SelectItem>\r\n                {categories.map((category) => (\r\n                  <SelectItem key={category} value={category}>\r\n                    {category}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <Select\r\n              value={sortBy}\r\n              onValueChange={(value: any) => setSortBy(value)}\r\n            >\r\n              <SelectTrigger className=\"w-32\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"title\">Title</SelectItem>\r\n                <SelectItem value=\"author\">Author</SelectItem>\r\n                <SelectItem value=\"created_at\">Date Added</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"icon\"\r\n              onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}\r\n            >\r\n              <ArrowUpDown className=\"h-4 w-4\" />\r\n            </Button>\r\n\r\n            <Button\r\n              variant={availableOnly ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setAvailableOnly(!availableOnly)}\r\n            >\r\n              Available Only\r\n            </Button>\r\n\r\n            <Button variant=\"outline\" size=\"sm\" onClick={resetFilters}>\r\n              Reset\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* View controls */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-sm text-muted-foreground\">\r\n            Showing {filteredBooks.length} of {books.length} books\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant={viewMode === 'grid' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setViewMode('grid')}\r\n            >\r\n              <Grid3X3 className=\"h-4 w-4\" />\r\n            </Button>\r\n            <Button\r\n              variant={viewMode === 'list' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setViewMode('list')}\r\n            >\r\n              <List className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Error state */}\r\n      {error && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertDescription>{error}</AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Loading state */}\r\n      {isLoading && (\r\n        <div className=\"flex items-center justify-center py-12\">\r\n          <RefreshCw className=\"h-8 w-8 animate-spin\" />\r\n          <span className=\"ml-2\">Loading books...</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Books display */}\r\n      {!isLoading && paginatedBooks.length === 0 ? (\r\n        <div className=\"text-center py-12\">\r\n          <BookOpen className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n          <h3 className=\"text-lg font-semibold mb-2\">No books found</h3>\r\n          <p className=\"text-muted-foreground\">\r\n            {debouncedSearchQuery || selectedCategory !== 'all'\r\n              ? 'Try adjusting your _search or filters'\r\n              : 'No books available in the catalog'}\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div\r\n          className={\r\n            viewMode === 'grid'\r\n              ? 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6'\r\n              : 'space-y-4'\r\n          }\r\n        >\r\n          {paginatedBooks.map((book) => (\r\n            <BookCard\r\n              key={book.id}\r\n              book={book}\r\n              onCheckout={handleCheckout}\r\n              onViewDetails={handleViewDetails}\r\n              compact={viewMode === 'list'}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Pagination footer */}\r\n      {totalPages > 1 && (\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-sm text-muted-foreground\">\r\n            Page 1 of {totalPages}\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Button variant=\"outline\" size=\"sm\" disabled>\r\n              Previous\r\n            </Button>\r\n            <Button variant=\"outline\" size=\"sm\" disabled={totalPages <= 1}>\r\n              Next\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BookCatalogClient;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\AddStudentDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1560,1563],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1560,1563],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1641,1644],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1641,1644],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":84,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":87,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1685,1688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1685,1688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { utilitiesApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n\r\ninterface AddStudentDialogProps {\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n  trigger?: React.ReactNode;\r\n}\r\n\r\nexport function AddStudentDialog({\r\n  open: externalOpen,\r\n  onOpenChange,\r\n  trigger,\r\n}: AddStudentDialogProps = {}) {\r\n  const [internalOpen, setInternalOpen] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    firstName: '',\r\n    lastName: '',\r\n    grade: '',\r\n    section: '',\r\n  });\r\n\r\n  // Use external open state if provided, otherwise use internal\r\n  const open = externalOpen !== undefined ? externalOpen : internalOpen;\r\n  const setOpen = onOpenChange !== undefined ? onOpenChange : setInternalOpen;\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { id, value } = e.target;\r\n    setFormData((prev) => ({ ...prev, [id]: value }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsSubmitting(true);\r\n    try {\r\n      const response = await utilitiesApi.quickAddStudent(formData);\r\n      if (response.success && (response.data as any)?.student) {\r\n        toast.success(\r\n          `Student ${(response.data as any).student.firstName} ${(response.data as any).student.lastName} added successfully!`\r\n        );\r\n        setOpen(false);\r\n        window.location.reload();\r\n      } else {\r\n        toast.error(response.error || 'Failed to add student');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding student:', error);\r\n      toast.error('Failed to add student. Please try again.');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      {trigger && <DialogTrigger asChild>{trigger}</DialogTrigger>}\r\n      {!trigger && (\r\n        <DialogTrigger asChild>\r\n          <Button>Add Student</Button>\r\n        </DialogTrigger>\r\n      )}\r\n      <DialogContent className=\"sm:max-w-[425px]\">\r\n        <DialogHeader>\r\n          <DialogTitle>Add New Student</DialogTitle>\r\n          <DialogDescription>\r\n            Enter the details of the new student below.\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n        <form onSubmit={handleSubmit}>\r\n          <div className=\"grid gap-4 py-4\">\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"firstName\" className=\"text-right\">\r\n                First Name\r\n              </Label>\r\n              <Input\r\n                id=\"firstName\"\r\n                value={formData.firstName}\r\n                onChange={handleInputChange}\r\n                className=\"col-span-3\"\r\n              />\r\n            </div>\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"lastName\" className=\"text-right\">\r\n                Last Name\r\n              </Label>\r\n              <Input\r\n                id=\"lastName\"\r\n                value={formData.lastName}\r\n                onChange={handleInputChange}\r\n                className=\"col-span-3\"\r\n              />\r\n            </div>\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"grade\" className=\"text-right\">\r\n                Grade\r\n              </Label>\r\n              <Input\r\n                id=\"grade\"\r\n                value={formData.grade}\r\n                onChange={handleInputChange}\r\n                className=\"col-span-3\"\r\n              />\r\n            </div>\r\n            <div className=\"grid grid-cols-4 items-center gap-4\">\r\n              <Label htmlFor=\"section\" className=\"text-right\">\r\n                Section\r\n              </Label>\r\n              <Input\r\n                id=\"section\"\r\n                value={formData.section}\r\n                onChange={handleInputChange}\r\n                className=\"col-span-3\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button type=\"submit\" disabled={isSubmitting}>\r\n              {isSubmitting ? 'Adding...' : 'Add Student'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\AdvancedReporting.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'mockAlerts' and 'mockReports'. Either include them or remove the dependency array.","line":395,"column":6,"nodeType":"ArrayExpression","endLine":395,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [mockAlerts, mockReports]","fix":{"range":[10205,10207],"text":"[mockAlerts, mockReports]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { ButtonLoading } from '@/components/LoadingStates';\r\nimport {\r\n  FileText,\r\n  Download,\r\n  TrendingUp,\r\n  BarChart3,\r\n  Target,\r\n  Users,\r\n  Settings,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Clock,\r\n  Plus,\r\n  Trash2,\r\n  Edit,\r\n} from 'lucide-react';\r\n\r\ninterface ReportTemplate {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  category:\r\n    | 'operational'\r\n    | 'strategic'\r\n    | 'administrative'\r\n    | 'financial'\r\n    | 'performance';\r\n  type: 'daily' | 'weekly' | 'monthly' | 'quarterly' | 'yearly' | 'on_demand';\r\n  sections: ReportSection[];\r\n  includeInsights: boolean;\r\n  includeForecasts: boolean;\r\n  includeHeatMaps: boolean;\r\n  includeROI: boolean;\r\n  includeBenchmarks: boolean;\r\n  includeReadingPatterns: boolean;\r\n  includeSpaceUtilization: boolean;\r\n}\r\n\r\ninterface ReportSection {\r\n  id: string;\r\n  type:\r\n    | 'overview'\r\n    | 'kpi'\r\n    | 'chart'\r\n    | 'table'\r\n    | 'insights'\r\n    | 'heatmap'\r\n    | 'forecast'\r\n    | 'roi'\r\n    | 'benchmark'\r\n    | 'reading_patterns'\r\n    | 'space_utilization';\r\n  title: string;\r\n  enabled: boolean;\r\n  order: number;\r\n}\r\n\r\ninterface ReportConfig {\r\n  id?: string | undefined;\r\n  name: string;\r\n  description?: string | undefined;\r\n  type: string;\r\n  category: string;\r\n  recipients: string[];\r\n  format: 'html' | 'pdf' | 'excel' | 'csv' | 'json';\r\n  is_active: boolean;\r\n  schedule?: string | undefined;\r\n  sections: ReportSection[];\r\n}\r\n\r\ninterface GeneratedReport {\r\n  id: string;\r\n  name: string;\r\n  type: string;\r\n  format: string;\r\n  generated_at: string;\r\n  status: 'generating' | 'completed' | 'failed';\r\n  summary: string;\r\n  filePath?: string;\r\n}\r\n\r\ninterface AlertConfig {\r\n  id: string;\r\n  name: string;\r\n  type: string;\r\n  threshold: number;\r\n  operators: string;\r\n  recipients: string[];\r\n  is_active: boolean;\r\n  cooldownPeriod: number;\r\n  lastTriggered?: string;\r\n}\r\n\r\nexport function AdvancedReporting() {\r\n  const [activeTab, setActiveTab] = useState('templates');\r\n  const [reportConfigs, setReportConfigs] = useState<ReportConfig[]>([]);\r\n  const [generatedReports, setGeneratedReports] = useState<GeneratedReport[]>(\r\n    []\r\n  );\r\n  const [alertConfigs, setAlertConfigs] = useState<AlertConfig[]>([]);\r\n  const [showConfigDialog, setShowConfigDialog] = useState(false);\r\n  const [editingConfig, setEditingConfig] = useState<ReportConfig | null>(null);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n\r\n  // Mock data for demonstration\r\n  const reportTemplates: ReportTemplate[] = [\r\n    {\r\n      id: 'weekly_operational',\r\n      name: 'Weekly Operational Report',\r\n      description:\r\n        'Comprehensive weekly operational overview with KPIs and insights',\r\n      category: 'operational',\r\n      type: 'weekly',\r\n      sections: [\r\n        {\r\n          id: 'overview',\r\n          type: 'overview',\r\n          title: 'Library Overview',\r\n          enabled: true,\r\n          order: 1,\r\n        },\r\n        {\r\n          id: 'kpi',\r\n          type: 'kpi',\r\n          title: 'Key Performance Indicators',\r\n          enabled: true,\r\n          order: 2,\r\n        },\r\n        {\r\n          id: 'activities',\r\n          type: 'table',\r\n          title: 'Recent Activities',\r\n          enabled: true,\r\n          order: 3,\r\n        },\r\n        {\r\n          id: 'insights',\r\n          type: 'insights',\r\n          title: 'Predictive Insights',\r\n          enabled: true,\r\n          order: 4,\r\n        },\r\n      ],\r\n      includeInsights: true,\r\n      includeForecasts: false,\r\n      includeHeatMaps: false,\r\n      includeROI: false,\r\n      includeBenchmarks: false,\r\n      includeReadingPatterns: false,\r\n      includeSpaceUtilization: false,\r\n    },\r\n    {\r\n      id: 'monthly_strategic',\r\n      name: 'Monthly Strategic Report',\r\n      description:\r\n        'Strategic analysis with ROI, benchmarks, and long-term trends',\r\n      category: 'strategic',\r\n      type: 'monthly',\r\n      sections: [\r\n        {\r\n          id: 'overview',\r\n          type: 'overview',\r\n          title: 'Executive Summary',\r\n          enabled: true,\r\n          order: 1,\r\n        },\r\n        {\r\n          id: 'kpi',\r\n          type: 'kpi',\r\n          title: 'Performance Metrics',\r\n          enabled: true,\r\n          order: 2,\r\n        },\r\n        {\r\n          id: 'roi',\r\n          type: 'roi',\r\n          title: 'Return on Investment',\r\n          enabled: true,\r\n          order: 3,\r\n        },\r\n        {\r\n          id: 'benchmarks',\r\n          type: 'benchmark',\r\n          title: 'Industry Benchmarks',\r\n          enabled: true,\r\n          order: 4,\r\n        },\r\n        {\r\n          id: 'insights',\r\n          type: 'insights',\r\n          title: 'Strategic Insights',\r\n          enabled: true,\r\n          order: 5,\r\n        },\r\n      ],\r\n      includeInsights: true,\r\n      includeForecasts: true,\r\n      includeHeatMaps: true,\r\n      includeROI: true,\r\n      includeBenchmarks: true,\r\n      includeReadingPatterns: false,\r\n      includeSpaceUtilization: false,\r\n    },\r\n    {\r\n      id: 'reading_analytics',\r\n      name: 'Student Reading Analytics',\r\n      description:\r\n        'Detailed analysis of student reading patterns and engagement',\r\n      category: 'administrative',\r\n      type: 'monthly',\r\n      sections: [\r\n        {\r\n          id: 'overview',\r\n          type: 'overview',\r\n          title: 'Reading Program Overview',\r\n          enabled: true,\r\n          order: 1,\r\n        },\r\n        {\r\n          id: 'reading_patterns',\r\n          type: 'reading_patterns',\r\n          title: 'Reading Patterns',\r\n          enabled: true,\r\n          order: 2,\r\n        },\r\n        {\r\n          id: 'activities',\r\n          type: 'table',\r\n          title: 'Top Readers',\r\n          enabled: true,\r\n          order: 3,\r\n        },\r\n        {\r\n          id: 'insights',\r\n          type: 'insights',\r\n          title: 'Reading Insights',\r\n          enabled: true,\r\n          order: 4,\r\n        },\r\n      ],\r\n      includeInsights: true,\r\n      includeForecasts: false,\r\n      includeHeatMaps: false,\r\n      includeROI: false,\r\n      includeBenchmarks: true,\r\n      includeReadingPatterns: true,\r\n      includeSpaceUtilization: false,\r\n    },\r\n    {\r\n      id: 'space_utilization',\r\n      name: 'Space Utilization Report',\r\n      description:\r\n        'Analysis of library space usage and optimization recommendations',\r\n      category: 'operational',\r\n      type: 'weekly',\r\n      sections: [\r\n        {\r\n          id: 'overview',\r\n          type: 'overview',\r\n          title: 'Space Overview',\r\n          enabled: true,\r\n          order: 1,\r\n        },\r\n        {\r\n          id: 'space_utilization',\r\n          type: 'space_utilization',\r\n          title: 'Area Utilization',\r\n          enabled: true,\r\n          order: 2,\r\n        },\r\n        {\r\n          id: 'heatmap',\r\n          type: 'heatmap',\r\n          title: 'Usage Heat Map',\r\n          enabled: true,\r\n          order: 3,\r\n        },\r\n        {\r\n          id: 'insights',\r\n          type: 'insights',\r\n          title: 'Space Optimization Insights',\r\n          enabled: true,\r\n          order: 4,\r\n        },\r\n      ],\r\n      includeInsights: true,\r\n      includeForecasts: false,\r\n      includeHeatMaps: true,\r\n      includeROI: false,\r\n      includeBenchmarks: false,\r\n      includeReadingPatterns: false,\r\n      includeSpaceUtilization: true,\r\n    },\r\n  ];\r\n\r\n  const mockReports: GeneratedReport[] = [\r\n    {\r\n      id: '1',\r\n      name: 'Weekly Operational Report',\r\n      type: 'weekly',\r\n      format: 'html',\r\n      generated_at: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),\r\n      status: 'completed',\r\n      summary:\r\n        'Library performance shows 15% increase in student engagement this week.',\r\n      filePath: '/reports/weekly_operational_1.html',\r\n    },\r\n    {\r\n      id: '2',\r\n      name: 'Monthly Strategic Report',\r\n      type: 'monthly',\r\n      format: 'pdf',\r\n      generated_at: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),\r\n      status: 'completed',\r\n      summary:\r\n        'ROI analysis shows 23.3% return on investment with positive trends in technology adoption.',\r\n      filePath: '/reports/monthly_strategic_2.pdf',\r\n    },\r\n    {\r\n      id: '3',\r\n      name: 'Space Utilization Report',\r\n      type: 'weekly',\r\n      format: 'excel',\r\n      generated_at: new Date(Date.now() - 30 * 60 * 1000).toISOString(),\r\n      status: 'generating',\r\n      summary: 'Currently generating space utilization analysis...',\r\n    },\r\n  ];\r\n\r\n  const mockAlerts: AlertConfig[] = [\r\n    {\r\n      id: '1',\r\n      name: 'High Usage Alert',\r\n      type: 'usage_spike',\r\n      threshold: 100,\r\n      operators: 'greater_than',\r\n      recipients: ['admin@library.edu'],\r\n      is_active: true,\r\n      cooldownPeriod: 30,\r\n      lastTriggered: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),\r\n    },\r\n    {\r\n      id: '2',\r\n      name: 'Resource Shortage Alert',\r\n      type: 'resource_shortage',\r\n      threshold: 80,\r\n      operators: 'greater_than',\r\n      recipients: ['admin@library.edu', 'manager@library.edu'],\r\n      is_active: true,\r\n      cooldownPeriod: 15,\r\n      lastTriggered: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),\r\n    },\r\n    {\r\n      id: '3',\r\n      name: 'System Health Monitor',\r\n      type: 'system_health',\r\n      threshold: 85,\r\n      operators: 'greater_than',\r\n      recipients: ['admin@library.edu'],\r\n      is_active: false,\r\n      cooldownPeriod: 60,\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    setGeneratedReports(mockReports);\r\n    setAlertConfigs(mockAlerts);\r\n  }, []);\r\n\r\n  const handleGenerateReport = async (\r\n    template: ReportTemplate,\r\n    format: string\r\n  ) => {\r\n    setIsGenerating(true);\r\n    try {\r\n      // Mock API call\r\n      await new Promise((resolve) => setTimeout(resolve, 2000));\r\n\r\n      const newReport: GeneratedReport = {\r\n        id: Date.now().toString(),\r\n        name: template.name,\r\n        type: template.type,\r\n        format,\r\n        generated_at: new Date().toISOString(),\r\n        status: 'completed',\r\n        summary: `Generated ${template.name} in ${format} format successfully.`,\r\n        filePath: `/reports/${template.name}_${Date.now()}.${format}`,\r\n      };\r\n\r\n      setGeneratedReports((prev) => [newReport, ...prev]);\r\n    } catch (error) {\r\n      console.error('Failed to generate report:', error);\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveConfig = (config: ReportConfig) => {\r\n    if (editingConfig) {\r\n      setReportConfigs((prev) =>\r\n        prev.map((c) =>\r\n          c.id === editingConfig.id ? { ...config, id: editingConfig.id } : c\r\n        )\r\n      );\r\n    } else {\r\n      const newConfig: ReportConfig = { ...config, id: Date.now().toString() };\r\n      setReportConfigs((prev) => [...prev, newConfig]);\r\n    }\r\n    setShowConfigDialog(false);\r\n    setEditingConfig(null);\r\n  };\r\n\r\n  const handleDeleteConfig = (id: string) => {\r\n    setReportConfigs((prev) => prev.filter((c) => c.id !== id));\r\n  };\r\n\r\n  const handleToggleAlert = (id: string) => {\r\n    setAlertConfigs((prev) =>\r\n      prev.map((a) => (a.id === id ? { ...a, is_active: !a.is_active } : a))\r\n    );\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'operational':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'strategic':\r\n        return 'bg-purple-100 text-purple-800';\r\n      case 'administrative':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'financial':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'performance':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'generating':\r\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'failed':\r\n        return <AlertTriangle className=\"h-4 w-4 text-red-500\" />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl sm:text-3xl font-bold tracking-tight\">\r\n            Advanced Reporting\r\n          </h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Generate comprehensive reports with advanced analytics and insights.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowConfigDialog(true)}\r\n          >\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Custom Report\r\n          </Button>\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <Settings className=\"h-4 w-4 mr-2\" />\r\n            Settings\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Tabs\r\n        value={activeTab}\r\n        onValueChange={setActiveTab}\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-4 lg:grid-cols-6\">\r\n          <TabsTrigger value=\"templates\">Templates</TabsTrigger>\r\n          <TabsTrigger value=\"reports\">Reports</TabsTrigger>\r\n          <TabsTrigger value=\"configs\">Configs</TabsTrigger>\r\n          <TabsTrigger value=\"alerts\">Alerts</TabsTrigger>\r\n          <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\r\n          <TabsTrigger value=\"export\">Export</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Templates Tab */}\r\n        <TabsContent value=\"templates\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {reportTemplates.map((template) => (\r\n              <Card\r\n                key={template.id}\r\n                className=\"hover:shadow-md transition-shadow\"\r\n              >\r\n                <CardHeader>\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <CardTitle className=\"text-lg\">{template.name}</CardTitle>\r\n                      <CardDescription className=\"mt-1\">\r\n                        {template.description}\r\n                      </CardDescription>\r\n                    </div>\r\n                    <Badge className={getCategoryColor(template.category)}>\r\n                      {template.category}\r\n                    </Badge>\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                      <Clock className=\"h-4 w-4\" />\r\n                      <span>{template.type}</span>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-wrap gap-1\">\r\n                      {template.includeInsights && (\r\n                        <Badge variant=\"secondary\">Insights</Badge>\r\n                      )}\r\n                      {template.includeROI && (\r\n                        <Badge variant=\"secondary\">ROI</Badge>\r\n                      )}\r\n                      {template.includeBenchmarks && (\r\n                        <Badge variant=\"secondary\">Benchmarks</Badge>\r\n                      )}\r\n                      {template.includeReadingPatterns && (\r\n                        <Badge variant=\"secondary\">Reading</Badge>\r\n                      )}\r\n                      {template.includeSpaceUtilization && (\r\n                        <Badge variant=\"secondary\">Space</Badge>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"flex gap-2 pt-2\">\r\n                      <Select\r\n                        onValueChange={(format) =>\r\n                          handleGenerateReport(template, format)\r\n                        }\r\n                        disabled={isGenerating}\r\n                      >\r\n                        <SelectTrigger className=\"flex-1\">\r\n                          <SelectValue\r\n                            placeholder={\r\n                              isGenerating ? 'Generating...' : 'Generate'\r\n                            }\r\n                          />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"html\">HTML</SelectItem>\r\n                          <SelectItem value=\"pdf\">PDF</SelectItem>\r\n                          <SelectItem value=\"excel\">Excel</SelectItem>\r\n                          <SelectItem value=\"csv\">CSV</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Reports Tab */}\r\n        <TabsContent value=\"reports\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Generated Reports</CardTitle>\r\n              <CardDescription>\r\n                View and download your generated reports.\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {generatedReports.map((report) => (\r\n                  <div\r\n                    key={report.id}\r\n                    className=\"flex items-center justify-between p-4 border rounded-lg\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {getStatusIcon(report.status)}\r\n                      <div>\r\n                        <h4 className=\"font-medium\">{report.name}</h4>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {new Date(report.generated_at).toLocaleString()} ΓÇó{' '}\r\n                          {report.format.toUpperCase()}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge variant=\"outline\">{report.type}</Badge>\r\n                      {report.status === 'completed' && report.filePath && (\r\n                        <Button variant=\"outline\" size=\"sm\">\r\n                          <Download className=\"h-4 w-4 mr-2\" />\r\n                          Download\r\n                        </Button>\r\n                      )}\r\n                      {report.status === 'generating' && (\r\n                        <ButtonLoading text=\"Generating...\" />\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Configs Tab */}\r\n        <TabsContent value=\"configs\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Report Configurations</CardTitle>\r\n              <CardDescription>\r\n                Manage your scheduled and custom report configurations.\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {reportConfigs.length === 0 ? (\r\n                  <div className=\"text-center py-8\">\r\n                    <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n                    <h3 className=\"text-lg font-medium\">\r\n                      No Report Configurations\r\n                    </h3>\r\n                    <p className=\"text-muted-foreground mb-4\">\r\n                      Create your first custom report configuration.\r\n                    </p>\r\n                    <Button onClick={() => setShowConfigDialog(true)}>\r\n                      <Plus className=\"h-4 w-4 mr-2\" />\r\n                      Create Configuration\r\n                    </Button>\r\n                  </div>\r\n                ) : (\r\n                  reportConfigs.map((config) => (\r\n                    <div\r\n                      key={config.id}\r\n                      className=\"flex items-center justify-between p-4 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <h4 className=\"font-medium\">{config.name}</h4>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {config.type} ΓÇó {config.format.toUpperCase()} ΓÇó{' '}\r\n                          {config.recipients.length} recipients\r\n                        </p>\r\n                        {config.schedule && (\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            Schedule: {config.schedule}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Badge\r\n                          variant={config.is_active ? 'default' : 'secondary'}\r\n                        >\r\n                          {config.is_active ? 'Active' : 'Inactive'}\r\n                        </Badge>\r\n                        <Button variant=\"ghost\" size=\"sm\">\r\n                          <Edit className=\"h-4 w-4\" />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() =>\r\n                            config.id && handleDeleteConfig(config.id)\r\n                          }\r\n                        >\r\n                          <Trash2 className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Alerts Tab */}\r\n        <TabsContent value=\"alerts\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Alert Configurations</CardTitle>\r\n              <CardDescription>\r\n                Manage automated alerts for system monitoring.\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {alertConfigs.map((alert) => (\r\n                  <div\r\n                    key={alert.id}\r\n                    className=\"flex items-center justify-between p-4 border rounded-lg\"\r\n                  >\r\n                    <div className=\"flex-1\">\r\n                      <h4 className=\"font-medium\">{alert.name}</h4>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        {alert.type.replace('_', ' ')} ΓÇó Threshold:{' '}\r\n                        {alert.threshold} ΓÇó {alert.recipients.length} recipients\r\n                      </p>\r\n                      {alert.lastTriggered && (\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          Last triggered:{' '}\r\n                          {new Date(alert.lastTriggered).toLocaleString()}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Button\r\n                        variant={alert.is_active ? 'default' : 'outline'}\r\n                        size=\"sm\"\r\n                        onClick={() => handleToggleAlert(alert.id)}\r\n                      >\r\n                        {alert.is_active ? 'Active' : 'Inactive'}\r\n                      </Button>\r\n                      <Button variant=\"ghost\" size=\"sm\">\r\n                        <Edit className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Analytics Tab */}\r\n        <TabsContent value=\"analytics\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <TrendingUp className=\"h-5 w-5\" />\r\n                  ROI Analysis\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Financial performance and return on investment metrics.\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Total Investment</span>\r\n                    <span className=\"font-medium\">$150,000</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Total Value</span>\r\n                    <span className=\"font-medium text-green-600\">$185,000</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>ROI</span>\r\n                    <span className=\"font-medium text-green-600\">+23.3%</span>\r\n                  </div>\r\n                  <Button variant=\"outline\" className=\"w-full mt-4\">\r\n                    View Details\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Users className=\"h-5 w-5\" />\r\n                  Reading Patterns\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Student engagement and reading behavior analysis.\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Total Books Read</span>\r\n                    <span className=\"font-medium\">1,250</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Active Readers</span>\r\n                    <span className=\"font-medium\">85</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Avg Reading Streak</span>\r\n                    <span className=\"font-medium\">4.2 days</span>\r\n                  </div>\r\n                  <Button variant=\"outline\" className=\"w-full mt-4\">\r\n                    View Details\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <BarChart3 className=\"h-5 w-5\" />\r\n                  Space Utilization\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Library space usage and optimization insights.\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Computer Lab</span>\r\n                    <span className=\"font-medium\">73.3%</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Reading Lounge</span>\r\n                    <span className=\"font-medium text-yellow-600\">30.0%</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Gaming Zone</span>\r\n                    <span className=\"font-medium\">85.2%</span>\r\n                  </div>\r\n                  <Button variant=\"outline\" className=\"w-full mt-4\">\r\n                    View Details\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Target className=\"h-5 w-5\" />\r\n                  Benchmarks\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Industry comparison and performance metrics.\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Visits per Student</span>\r\n                    <span className=\"font-medium text-yellow-600\">\r\n                      7.2 (8.5)\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Book Circulation</span>\r\n                    <span className=\"font-medium text-green-600\">\r\n                      18.5 (15.2)\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span>Computer Usage</span>\r\n                    <span className=\"font-medium text-green-600\">\r\n                      71.3% (65.0%)\r\n                    </span>\r\n                  </div>\r\n                  <Button variant=\"outline\" className=\"w-full mt-4\">\r\n                    View Details\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Export Tab */}\r\n        <TabsContent value=\"export\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Data Export</CardTitle>\r\n              <CardDescription>\r\n                Export data in various formats for external analysis.\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <div className=\"space-y-4\">\r\n                  <h3 className=\"text-lg font-medium\">Export Type</h3>\r\n                  <Select>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select data type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"activities\">Activities</SelectItem>\r\n                      <SelectItem value=\"students\">Students</SelectItem>\r\n                      <SelectItem value=\"equipment\">Equipment</SelectItem>\r\n                      <SelectItem value=\"reading-patterns\">\r\n                        Reading Patterns\r\n                      </SelectItem>\r\n                      <SelectItem value=\"space-utilization\">\r\n                        Space Utilization\r\n                      </SelectItem>\r\n                      <SelectItem value=\"roi-data\">ROI Analysis</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <h3 className=\"text-lg font-medium\">Format</h3>\r\n                  <Select>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select format\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"csv\">CSV</SelectItem>\r\n                      <SelectItem value=\"excel\">Excel</SelectItem>\r\n                      <SelectItem value=\"json\">JSON</SelectItem>\r\n                      <SelectItem value=\"pdf\">PDF Report</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4 mt-6\">\r\n                <h3 className=\"text-lg font-medium\">Date Range</h3>\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">Start Date</label>\r\n                    <Input type=\"date\" />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">End Date</label>\r\n                    <Input type=\"date\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end mt-6\">\r\n                <Button>\r\n                  <Download className=\"h-4 w-4 mr-2\" />\r\n                  Export Data\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Custom Report Config Dialog */}\r\n      <Dialog open={showConfigDialog} onOpenChange={setShowConfigDialog}>\r\n        <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingConfig\r\n                ? 'Edit Report Configuration'\r\n                : 'Create Custom Report'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              Configure a custom report with specific sections and delivery\r\n              options.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6 py-4\">\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Report Name</label>\r\n                <Input placeholder=\"Enter report name\" />\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Category</label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select category\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"operational\">Operational</SelectItem>\r\n                    <SelectItem value=\"strategic\">Strategic</SelectItem>\r\n                    <SelectItem value=\"administrative\">\r\n                      Administrative\r\n                    </SelectItem>\r\n                    <SelectItem value=\"financial\">Financial</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Description</label>\r\n              <Input placeholder=\"Enter report description\" />\r\n            </div>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Format</label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select format\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"html\">HTML</SelectItem>\r\n                    <SelectItem value=\"pdf\">PDF</SelectItem>\r\n                    <SelectItem value=\"excel\">Excel</SelectItem>\r\n                    <SelectItem value=\"csv\">CSV</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Schedule</label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select schedule\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"daily\">Daily</SelectItem>\r\n                    <SelectItem value=\"weekly\">Weekly</SelectItem>\r\n                    <SelectItem value=\"monthly\">Monthly</SelectItem>\r\n                    <SelectItem value=\"on_demand\">On Demand</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Recipients</label>\r\n              <Input placeholder=\"Enter email addresses (comma separated)\" />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Include Sections</label>\r\n              <div className=\"grid gap-2 mt-2\">\r\n                {[\r\n                  { id: 'overview', label: 'Overview' },\r\n                  { id: 'kpi', label: 'Key Performance Indicators' },\r\n                  { id: 'insights', label: 'Predictive Insights' },\r\n                  { id: 'roi', label: 'ROI Analysis' },\r\n                  { id: 'benchmarks', label: 'Industry Benchmarks' },\r\n                  { id: 'reading_patterns', label: 'Reading Patterns' },\r\n                  { id: 'space_utilization', label: 'Space Utilization' },\r\n                ].map((section) => (\r\n                  <div key={section.id} className=\"flex items-center space-x-2\">\r\n                    <Checkbox id={section.id} />\r\n                    <label htmlFor={section.id} className=\"text-sm\">\r\n                      {section.label}\r\n                    </label>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowConfigDialog(false)}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={() =>\r\n                handleSaveConfig(editingConfig || ({} as ReportConfig))\r\n              }\r\n            >\r\n              {editingConfig ? 'Update' : 'Create'} Configuration\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdvancedReporting;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\AnalyticsDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'selectedMetric' and 'selectedPeriod'. Either exclude them or remove the dependency array.","line":236,"column":6,"nodeType":"ArrayExpression","endLine":245,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [comprehensiveDataFetcher, insightsDataFetcher, heatMapDataFetcher, forecastDataFetcher, loadingActions.data, setLastRefresh]","fix":{"range":[8232,8435],"text":"[comprehensiveDataFetcher, insightsDataFetcher, heatMapDataFetcher, forecastDataFetcher, loadingActions.data, setLastRefresh]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":302,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9945,9948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9945,9948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":330,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":330,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10877,10880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10877,10880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":457,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":457,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15711,15714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15711,15714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\n\r\nimport {\r\n  DashboardCardSkeleton,\r\n  LoadingSpinner,\r\n} from '@/components/LoadingStates';\r\nimport { useBreakpoint } from '@/hooks/useBreakpoint';\r\nimport { useMultipleLoadingStates, useAsyncData, useForm } from '@/hooks';\r\nimport PredictiveInsights from '@/components/analytics/PredictiveInsights';\r\nimport UsageHeatMap from '@/components/analytics/UsageHeatMap';\r\nimport TimeSeriesForecast from '@/components/analytics/TimeSeriesForecast';\r\nimport AdvancedReporting from '@/components/dashboard/AdvancedReporting';\r\nimport MetricsCards from '@/components/analytics/MetricsCards';\r\nimport BookCirculationAnalytics from '@/components/analytics/BookCirculationAnalytics';\r\nimport EquipmentUtilizationAnalytics from '@/components/analytics/EquipmentUtilizationAnalytics';\r\nimport FineCollectionAnalytics from '@/components/analytics/FineCollectionAnalytics';\r\nimport ExportAnalytics from '@/components/analytics/ExportAnalytics';\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  LineChart,\r\n  Line,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from 'recharts';\r\nimport { Clock, Activity, RefreshCw } from 'lucide-react';\r\n\r\nexport function AnalyticsDashboard() {\r\n  // Simplified UI state management\r\n  const [selectedPeriod, setSelectedPeriod] = useState<\r\n    'day' | 'week' | 'month'\r\n  >('week');\r\n  const [selectedChart, setSelectedChart] = useState('overview');\r\n  const [selectedMetric, setSelectedMetric] = useState<\r\n    'student_visits' | 'equipment_usage' | 'book_circulation'\r\n  >('student_visits');\r\n\r\n  // Consolidated loading states\r\n  const [loadingStates, loadingActions] = useMultipleLoadingStates({\r\n    data: { isLoading: false },\r\n    export: { isLoading: false },\r\n    refresh: { isLoading: false },\r\n  });\r\n\r\n  // Consolidated analytics data states\r\n  const [analyticsStates, analyticsActions] = useMultipleLoadingStates({\r\n    insights: { data: [] },\r\n    heatmap: { data: [] },\r\n    forecast: { data: [] },\r\n    comprehensive: { data: null },\r\n  });\r\n\r\n  // Export form management\r\n  const [_exportForm, _exportFormActions] = useForm({\r\n    initialValues: {\r\n      format: 'csv',\r\n      timeframe: selectedPeriod,\r\n      sections: [],\r\n    },\r\n    onSubmit: async (values) => {\r\n      await handleExport(values.format, values.sections);\r\n    },\r\n  });\r\n\r\n  // Last refresh timestamp\r\n  const [lastRefresh, setLastRefresh] = useState<Date>(new Date());\r\n\r\n  const isLargeScreen = useBreakpoint('lg');\r\n\r\n  // Mock data for charts\r\n  const mockUsageData = {\r\n    day: [\r\n      { time: '8AM', students: 5, computers: 3, gaming: 2 },\r\n      { time: '9AM', students: 12, computers: 8, gaming: 4 },\r\n      { time: '10AM', students: 18, computers: 12, gaming: 6 },\r\n      { time: '11AM', students: 15, computers: 10, gaming: 5 },\r\n      { time: '12PM', students: 8, computers: 5, gaming: 3 },\r\n      { time: '1PM', students: 22, computers: 15, gaming: 7 },\r\n      { time: '2PM', students: 25, computers: 18, gaming: 7 },\r\n      { time: '3PM', students: 20, computers: 14, gaming: 6 },\r\n      { time: '4PM', students: 12, computers: 8, gaming: 4 },\r\n      { time: '5PM', students: 6, computers: 4, gaming: 2 },\r\n    ],\r\n    week: [\r\n      { day: 'Mon', students: 45, computers: 30, gaming: 15 },\r\n      { day: 'Tue', students: 52, computers: 35, gaming: 17 },\r\n      { day: 'Wed', students: 48, computers: 32, gaming: 16 },\r\n      { day: 'Thu', students: 55, computers: 38, gaming: 17 },\r\n      { day: 'Fri', students: 58, computers: 40, gaming: 18 },\r\n      { day: 'Sat', students: 35, computers: 24, gaming: 11 },\r\n      { day: 'Sun', students: 20, computers: 14, gaming: 6 },\r\n    ],\r\n    month: [\r\n      { week: 'Week 1', students: 220, computers: 150, gaming: 70 },\r\n      { week: 'Week 2', students: 245, computers: 168, gaming: 77 },\r\n      { week: 'Week 3', students: 238, computers: 163, gaming: 75 },\r\n      { week: 'Week 4', students: 252, computers: 173, gaming: 79 },\r\n    ],\r\n  };\r\n\r\n  const mockActivityData = [\r\n    { name: 'Computer Use', value: 45, color: 'hsl(var(--primary))' },\r\n    { name: 'Gaming', value: 20, color: '#8b5cf6' },\r\n    { name: 'Book Borrowing', value: 25, color: '#10b981' },\r\n    { name: 'Book Return', value: 20, color: '#f59e0b' },\r\n    { name: 'VR Sessions', value: 5, color: '#ef4444' },\r\n    { name: 'Study', value: 15, color: '#6366f1' },\r\n  ];\r\n\r\n  const mockGradeDistribution = [\r\n    { grade: 'Primary', students: 25, percentage: 20 },\r\n    { grade: 'Grade School', students: 50, percentage: 40 },\r\n    { grade: 'Junior High', students: 35, percentage: 28 },\r\n    { grade: 'Senior High', students: 15, percentage: 12 },\r\n  ];\r\n\r\n  const currentUsageData = mockUsageData[selectedPeriod];\r\n  const overviewChartHeight = isLargeScreen ? 400 : 280;\r\n  const activityChartHeight = isLargeScreen ? 300 : 240;\r\n\r\n  // Async data fetching hooks\r\n  const comprehensiveDataFetcher = useAsyncData(\r\n    async () => {\r\n      const response = await fetch(\r\n        `${import.meta.env.VITE_API_URL}/analytics/library-metrics?timeframe=${selectedPeriod}`\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch comprehensive data');\r\n      }\r\n      const result = await response.json();\r\n      return result.data;\r\n    },\r\n    {\r\n      immediate: false,\r\n      onSuccess: (data) => analyticsActions.comprehensive.finish(data),\r\n      onError: (error) => analyticsActions.comprehensive.error(error.message),\r\n    }\r\n  );\r\n\r\n  const insightsDataFetcher = useAsyncData(\r\n    async () => {\r\n      const response = await fetch(\r\n        `${import.meta.env.VITE_API_URL}/analytics/insights?timeframe=${selectedPeriod}`\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch insights');\r\n      }\r\n      const result = await response.json();\r\n      return result.data.insights || [];\r\n    },\r\n    {\r\n      immediate: false,\r\n      onSuccess: (data) => analyticsActions.insights.finish(data),\r\n      onError: (error) => analyticsActions.insights.error(error.message),\r\n    }\r\n  );\r\n\r\n  const heatMapDataFetcher = useAsyncData(\r\n    async () => {\r\n      const response = await fetch(\r\n        `${import.meta.env.VITE_API_URL}/analytics/heatmap?timeframe=${selectedPeriod}`\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch heat map data');\r\n      }\r\n      const result = await response.json();\r\n      return result.data.heatMapData || [];\r\n    },\r\n    {\r\n      immediate: false,\r\n      onSuccess: (data) => analyticsActions.heatmap.finish(data),\r\n      onError: (error) => analyticsActions.heatmap.error(error.message),\r\n    }\r\n  );\r\n\r\n  const forecastDataFetcher = useAsyncData(\r\n    async () => {\r\n      const response = await fetch(\r\n        `${import.meta.env.VITE_API_URL}/analytics/forecast?metric=${selectedMetric}&timeframe=${selectedPeriod}&periods=7`\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch forecast data');\r\n      }\r\n      const result = await response.json();\r\n      return result.data.forecastData || [];\r\n    },\r\n    {\r\n      immediate: false,\r\n      onSuccess: (data) => analyticsActions.forecast.finish(data),\r\n      onError: (error) => analyticsActions.forecast.error(error.message),\r\n    }\r\n  );\r\n\r\n  // Main data fetching function\r\n  const fetchAllData = useCallback(async () => {\r\n    loadingActions.data.start();\r\n\r\n    try {\r\n      await Promise.all([\r\n        comprehensiveDataFetcher.refetch(),\r\n        insightsDataFetcher.refetch(),\r\n        heatMapDataFetcher.refetch(),\r\n        forecastDataFetcher.refetch(),\r\n      ]);\r\n\r\n      setLastRefresh(new Date());\r\n    } catch (error) {\r\n      console.error('Failed to fetch analytics data:', error);\r\n    } finally {\r\n      loadingActions.data.finish();\r\n    }\r\n  }, [\r\n    selectedPeriod,\r\n    selectedMetric,\r\n    comprehensiveDataFetcher,\r\n    insightsDataFetcher,\r\n    heatMapDataFetcher,\r\n    forecastDataFetcher,\r\n    loadingActions.data,\r\n    setLastRefresh,\r\n  ]);\r\n\r\n  // Initial data fetch\r\n  useEffect(() => {\r\n    fetchAllData();\r\n  }, [fetchAllData]);\r\n\r\n  // Auto-refresh every 30 seconds\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      fetchAllData();\r\n    }, 30000); // 30 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [fetchAllData]);\r\n\r\n  // Export handler\r\n  const handleExport = async (\r\n    format: 'csv' | 'json' | 'pdf',\r\n    sections: string[]\r\n  ) => {\r\n    try {\r\n      loadingActions.export.start();\r\n\r\n      const response = await fetch(\r\n        `${import.meta.env.VITE_API_URL}/analytics/export`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            format,\r\n            timeframe: selectedPeriod,\r\n            sections,\r\n          }),\r\n        }\r\n      );\r\n\r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `analytics-${selectedPeriod}-${new Date().toISOString().split('T')[0]}.${format}`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n      }\r\n    } catch (error) {\r\n      console.error('Export failed:', error);\r\n    } finally {\r\n      loadingActions.export.finish();\r\n    }\r\n  };\r\n\r\n  const handleInsightAction = async (insight: any, action: string) => {\r\n    console.debug('Insight action:', insight, action);\r\n    // Implement insight action handling\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    loadingActions.refresh.start();\r\n    fetchAllData().finally(() => {\r\n      loadingActions.refresh.finish();\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between\">\r\n        <div>\r\n          <h2 className=\"text-2xl sm:text-3xl font-bold tracking-tight\">\r\n            Advanced Analytics Dashboard\r\n          </h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Comprehensive library analytics with real-time insights and\r\n            reporting.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          <Select\r\n            value={selectedPeriod}\r\n            onValueChange={(value: any) => setSelectedPeriod(value)}\r\n          >\r\n            <SelectTrigger className=\"w-32\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"day\">Today</SelectItem>\r\n              <SelectItem value=\"week\">This Week</SelectItem>\r\n              <SelectItem value=\"month\">This Month</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={handleRefresh}\r\n            disabled={loadingStates.data.isLoading}\r\n          >\r\n            <RefreshCw\r\n              className={`h-4 w-4 mr-2 ${loadingStates.data.isLoading ? 'animate-spin' : ''}`}\r\n            />\r\n            Refresh\r\n          </Button>\r\n          <ExportAnalytics\r\n            timeframe={selectedPeriod}\r\n            onExport={handleExport}\r\n            isExporting={loadingStates.export.isLoading}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Comprehensive Metrics Cards */}\r\n      <MetricsCards\r\n        timeframe={selectedPeriod}\r\n        data={analyticsStates.comprehensive.data}\r\n        isLoading={loadingStates.data.isLoading}\r\n        onRefresh={handleRefresh}\r\n      />\r\n\r\n      {/* Enhanced Analytics with Predictive Insights */}\r\n      <Tabs\r\n        value={selectedChart}\r\n        onValueChange={setSelectedChart}\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-3 lg:grid-cols-8\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"circulation\">Book Circulation</TabsTrigger>\r\n          <TabsTrigger value=\"equipment\">Equipment</TabsTrigger>\r\n          <TabsTrigger value=\"fines\">Fine Collection</TabsTrigger>\r\n          <TabsTrigger value=\"insights\">Predictive Insights</TabsTrigger>\r\n          <TabsTrigger value=\"forecasting\">Forecasting</TabsTrigger>\r\n          <TabsTrigger value=\"heatmap\">Heat Map</TabsTrigger>\r\n          <TabsTrigger value=\"reports\">Reports</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Overview Tab */}\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <BookCirculationAnalytics\r\n            timeframe={selectedPeriod}\r\n            data={analyticsStates.comprehensive.data}\r\n            isLoading={analyticsStates.comprehensive.isLoading}\r\n          />\r\n        </TabsContent>\r\n\r\n        {/* Book Circulation Tab */}\r\n        <TabsContent value=\"circulation\" className=\"space-y-4\">\r\n          <BookCirculationAnalytics\r\n            timeframe={selectedPeriod}\r\n            data={analyticsStates.comprehensive.data}\r\n            isLoading={loadingStates.data.isLoading}\r\n          />\r\n        </TabsContent>\r\n\r\n        {/* Equipment Utilization Tab */}\r\n        <TabsContent value=\"equipment\" className=\"space-y-4\">\r\n          <EquipmentUtilizationAnalytics\r\n            timeframe={selectedPeriod}\r\n            data={analyticsStates.comprehensive.data}\r\n            isLoading={loadingStates.data.isLoading}\r\n          />\r\n        </TabsContent>\r\n\r\n        {/* Fine Collection Tab */}\r\n        <TabsContent value=\"fines\" className=\"space-y-4\">\r\n          <FineCollectionAnalytics\r\n            timeframe={selectedPeriod}\r\n            data={analyticsStates.comprehensive.data}\r\n            isLoading={loadingStates.data.isLoading}\r\n          />\r\n        </TabsContent>\r\n\r\n        {/* Predictive Insights Tab */}\r\n        <TabsContent value=\"insights\" className=\"space-y-4\">\r\n          {loadingStates.data.isLoading ? (\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              {[1, 2, 3, 4].map((i) => (\r\n                <Card key={i}>\r\n                  <CardHeader>\r\n                    <DashboardCardSkeleton />\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <DashboardCardSkeleton />\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <PredictiveInsights\r\n              insights={analyticsStates.insights.data}\r\n              timeframe={selectedPeriod}\r\n              onTimeframeChange={setSelectedPeriod}\r\n              onInsightAction={handleInsightAction}\r\n            />\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Forecasting Tab */}\r\n        <TabsContent value=\"forecasting\" className=\"space-y-4\">\r\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-4\">\r\n            <div>\r\n              <h3 className=\"text-lg font-semibold\">Time Series Forecasting</h3>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Predict future trends based on historical data patterns\r\n              </p>\r\n            </div>\r\n            <Select\r\n              value={selectedMetric}\r\n              onValueChange={(value: any) => setSelectedMetric(value)}\r\n            >\r\n              <SelectTrigger className=\"w-full sm:w-48\">\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"student_visits\">Student Visits</SelectItem>\r\n                <SelectItem value=\"equipment_usage\">Equipment Usage</SelectItem>\r\n                <SelectItem value=\"book_circulation\">\r\n                  Book Circulation\r\n                </SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {loadingStates.data.isLoading ? (\r\n            <Card>\r\n              <CardContent className=\"py-12\">\r\n                <LoadingSpinner />\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <TimeSeriesForecast\r\n              data={analyticsStates.forecast.data}\r\n              metric={selectedMetric}\r\n              timeframe={selectedPeriod}\r\n              onMetricChange={setSelectedMetric}\r\n              onTimeframeChange={setSelectedPeriod}\r\n            />\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Heat Map Tab */}\r\n        <TabsContent value=\"heatmap\" className=\"space-y-4\">\r\n          {loadingStates.data.isLoading ? (\r\n            <Card>\r\n              <CardContent className=\"py-12\">\r\n                <LoadingSpinner />\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <UsageHeatMap\r\n              data={analyticsStates.heatmap.data}\r\n              filterType=\"all\"\r\n              onCellClick={(data) =>\r\n                console.debug('Heat map cell clicked:', data)\r\n              }\r\n            />\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Overview Tab */}\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Usage Overview</CardTitle>\r\n              <CardDescription>\r\n                Student traffic and equipment utilization over time\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <ResponsiveContainer width=\"100%\" height={overviewChartHeight}>\r\n                <LineChart data={currentUsageData}>\r\n                  <CartesianGrid\r\n                    strokeDasharray=\"3 3\"\r\n                    stroke=\"hsl(var(--border))\"\r\n                    opacity={0.3}\r\n                  />\r\n                  <XAxis\r\n                    dataKey={\r\n                      selectedPeriod === 'month'\r\n                        ? 'week'\r\n                        : selectedPeriod === 'week'\r\n                          ? 'day'\r\n                          : 'time'\r\n                    }\r\n                    tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n                  />\r\n                  <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n                  <Tooltip\r\n                    contentStyle={{\r\n                      backgroundColor: 'hsl(var(--card))',\r\n                      border: '1px solid hsl(var(--border))',\r\n                      borderRadius: '8px',\r\n                      color: 'hsl(var(--foreground))',\r\n                    }}\r\n                    labelStyle={{ color: 'hsl(var(--foreground))' }}\r\n                  />\r\n                  <Legend />\r\n                  <Line\r\n                    type=\"monotone\"\r\n                    dataKey=\"students\"\r\n                    stroke=\"hsl(var(--primary))\"\r\n                    strokeWidth={2}\r\n                    name=\"Students\"\r\n                  />\r\n                  <Line\r\n                    type=\"monotone\"\r\n                    dataKey=\"computers\"\r\n                    stroke=\"#10b981\"\r\n                    strokeWidth={2}\r\n                    name=\"Computers\"\r\n                  />\r\n                  <Line\r\n                    type=\"monotone\"\r\n                    dataKey=\"gaming\"\r\n                    stroke=\"#8b5cf6\"\r\n                    strokeWidth={2}\r\n                    name=\"Gaming\"\r\n                  />\r\n                </LineChart>\r\n              </ResponsiveContainer>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Activities Tab */}\r\n        <TabsContent value=\"activities\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Activity Distribution</CardTitle>\r\n                <CardDescription>\r\n                  Breakdown of library activities\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={activityChartHeight}>\r\n                  <PieChart>\r\n                    <Pie\r\n                      data={mockActivityData}\r\n                      cx=\"50%\"\r\n                      cy=\"50%\"\r\n                      labelLine={false}\r\n                      label={({ name, percentage }) => `${name} ${percentage}%`}\r\n                      outerRadius={80}\r\n                      fill=\"#8884d8\"\r\n                      dataKey=\"value\"\r\n                    >\r\n                      {mockActivityData.map((entry, index) => (\r\n                        <Cell key={`cell-${index}`} fill={entry.color} />\r\n                      ))}\r\n                    </Pie>\r\n                    <Tooltip\r\n                      contentStyle={{\r\n                        backgroundColor: 'hsl(var(--card))',\r\n                        border: '1px solid hsl(var(--border))',\r\n                        borderRadius: '8px',\r\n                      }}\r\n                      labelStyle={{ color: 'hsl(var(--foreground))' }}\r\n                      itemStyle={{ color: 'hsl(var(--foreground))' }}\r\n                    />\r\n                  </PieChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Popular Times</CardTitle>\r\n                <CardDescription>Busiest hours and activities</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={activityChartHeight}>\r\n                  <BarChart data={currentUsageData}>\r\n                    <CartesianGrid\r\n                      strokeDasharray=\"3 3\"\r\n                      stroke=\"hsl(var(--border))\"\r\n                      opacity={0.3}\r\n                    />\r\n                    <XAxis\r\n                      dataKey={\r\n                        selectedPeriod === 'month'\r\n                          ? 'week'\r\n                          : selectedPeriod === 'week'\r\n                            ? 'day'\r\n                            : 'time'\r\n                      }\r\n                      tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n                    />\r\n                    <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n                    <Tooltip\r\n                      contentStyle={{\r\n                        backgroundColor: 'hsl(var(--card))',\r\n                        border: '1px solid hsl(var(--border))',\r\n                        borderRadius: '8px',\r\n                        color: 'hsl(var(--foreground))',\r\n                      }}\r\n                      labelStyle={{ color: 'hsl(var(--foreground))' }}\r\n                      cursor={{ fill: 'hsl(var(--primary) / 0.1)' }}\r\n                    />\r\n                    <Bar\r\n                      dataKey=\"students\"\r\n                      fill=\"hsl(var(--primary))\"\r\n                      name=\"Students\"\r\n                    />\r\n                  </BarChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Equipment Usage Tab */}\r\n        <TabsContent value=\"equipment\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Equipment Utilization</CardTitle>\r\n              <CardDescription>\r\n                How different equipment types are being used\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <ResponsiveContainer width=\"100%\" height={overviewChartHeight}>\r\n                <BarChart data={currentUsageData}>\r\n                  <CartesianGrid\r\n                    strokeDasharray=\"3 3\"\r\n                    stroke=\"hsl(var(--border))\"\r\n                    opacity={0.3}\r\n                  />\r\n                  <XAxis\r\n                    dataKey={\r\n                      selectedPeriod === 'month'\r\n                        ? 'week'\r\n                        : selectedPeriod === 'week'\r\n                          ? 'day'\r\n                          : 'time'\r\n                    }\r\n                    tick={{ fill: 'hsl(var(--muted-foreground))' }}\r\n                  />\r\n                  <YAxis tick={{ fill: 'hsl(var(--muted-foreground))' }} />\r\n                  <Tooltip\r\n                    contentStyle={{\r\n                      backgroundColor: 'hsl(var(--card))',\r\n                      border: '1px solid hsl(var(--border))',\r\n                      borderRadius: '8px',\r\n                      color: 'hsl(var(--foreground))',\r\n                    }}\r\n                    labelStyle={{ color: 'hsl(var(--foreground))' }}\r\n                    cursor={{ fill: 'hsl(var(--primary) / 0.1)' }}\r\n                  />\r\n                  <Legend />\r\n                  <Bar dataKey=\"computers\" fill=\"#10b981\" name=\"Computers\" />\r\n                  <Bar dataKey=\"gaming\" fill=\"#8b5cf6\" name=\"Gaming\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Demographics Tab */}\r\n        <TabsContent value=\"demographics\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Grade Distribution</CardTitle>\r\n                <CardDescription>Student usage by grade level</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {mockGradeDistribution.map((grade) => (\r\n                    <div key={grade.grade} className=\"space-y-2\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-sm font-medium\">\r\n                          {grade.grade}\r\n                        </span>\r\n                        <span className=\"text-sm text-muted-foreground\">\r\n                          {grade.students} students ({grade.percentage}%)\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"w-full bg-muted rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-primary h-2 rounded-full\"\r\n                          style={{ width: `${grade.percentage}%` }}\r\n                        ></div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Time Limits by Grade</CardTitle>\r\n                <CardDescription>\r\n                  Standard time limits for different grade levels\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex justify-between items-center p-3 bg-muted/50 rounded\">\r\n                    <div>\r\n                      <div className=\"font-medium\">Primary (K-3)</div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        Supervised activities\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"outline\">15 min</Badge>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-muted/50 rounded\">\r\n                    <div>\r\n                      <div className=\"font-medium\">Grade School (4-6)</div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        Basic computer access\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"outline\">30 min</Badge>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-muted/50 rounded\">\r\n                    <div>\r\n                      <div className=\"font-medium\">Junior High (7-10)</div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        Full access + gaming\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"outline\">45 min</Badge>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-muted/50 rounded\">\r\n                    <div>\r\n                      <div className=\"font-medium\">Senior High (11-12)</div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        Premium access\r\n                      </div>\r\n                    </div>\r\n                    <Badge variant=\"outline\">60 min</Badge>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Reports Tab */}\r\n        <TabsContent value=\"reports\" className=\"space-y-4\">\r\n          <AdvancedReporting />\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Footer with status and last refresh */}\r\n      <div className=\"flex items-center justify-between py-4 border-t\">\r\n        <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n          <div className=\"flex items-center gap-1\">\r\n            <Clock className=\"h-4 w-4\" />\r\n            Last updated: {lastRefresh.toLocaleTimeString()}\r\n          </div>\r\n          <div className=\"flex items-center gap-1\">\r\n            <Activity className=\"h-4 w-4\" />\r\n            Auto-refresh: Every 30 seconds\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            {selectedPeriod === 'day'\r\n              ? 'Today'\r\n              : selectedPeriod === 'week'\r\n                ? 'This Week'\r\n                : 'This Month'}\r\n          </Badge>\r\n          <Badge\r\n            variant={\r\n              analyticsStates.comprehensive.data ? 'default' : 'secondary'\r\n            }\r\n            className=\"text-xs\"\r\n          >\r\n            {analyticsStates.comprehensive.data ? 'Live Data' : 'Sample Data'}\r\n          </Badge>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AnalyticsDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\AutomationDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7757,7760],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7757,7760],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8199,8202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8199,8202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":318,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":318,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10523,10526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10523,10526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":322,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":322,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10770,10773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10770,10773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":325,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":325,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10902,10905],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10902,10905],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { useTriggerJob, useGoogleSheetsTest } from '@/hooks/api-hooks';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport {\r\n  Bot,\r\n  Play,\r\n  Square,\r\n  RotateCcw,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  Clock,\r\n  Database,\r\n  FileSpreadsheet,\r\n  Calendar,\r\n  Activity,\r\n  Settings,\r\n  RefreshCw,\r\n} from 'lucide-react';\r\n\r\ninterface AutomationJob {\r\n  id: string;\r\n  name: string;\r\n  type: 'backup' | 'notification' | 'sync' | 'cleanup';\r\n  status: 'running' | 'completed' | 'failed' | 'queued';\r\n  lastRun?: Date;\r\n  nextRun?: Date;\r\n  duration?: number;\r\n  errorMessage?: string;\r\n  progress?: number;\r\n}\r\n\r\nexport function AutomationDashboard() {\r\n  const [selectedTab, setSelectedTab] = useState('jobs');\r\n\r\n  const { automationJobs } = useAppStore();\r\n  const { mutate: triggerJob } = useTriggerJob();\r\n  const { data: googleSheetsStatus } = useGoogleSheetsTest();\r\n\r\n  // Mock automation jobs for now\r\n  const mockJobs: AutomationJob[] = [\r\n    {\r\n      id: 'daily-backup',\r\n      name: 'Daily Backup',\r\n      type: 'backup',\r\n      status: 'completed',\r\n      lastRun: new Date(Date.now() - 2 * 60 * 60 * 1000), // 2 hours ago\r\n      nextRun: new Date(Date.now() + 22 * 60 * 60 * 1000), // 22 hours from now\r\n      duration: 45,\r\n    },\r\n    {\r\n      id: 'teacher-notifications',\r\n      name: 'Teacher Notifications',\r\n      type: 'notification',\r\n      status: 'completed',\r\n      lastRun: new Date(Date.now() - 8 * 60 * 60 * 1000), // 8 hours ago\r\n      nextRun: new Date(Date.now() + 16 * 60 * 60 * 1000), // 16 hours from now\r\n      duration: 12,\r\n    },\r\n    {\r\n      id: 'google-sync',\r\n      name: 'Google Sheets Sync',\r\n      type: 'sync',\r\n      status: 'running',\r\n      progress: 75,\r\n      lastRun: new Date(Date.now() - 5 * 60 * 1000), // 5 minutes ago\r\n    },\r\n    {\r\n      id: 'system-cleanup',\r\n      name: 'System Cleanup',\r\n      type: 'cleanup',\r\n      status: 'queued',\r\n      nextRun: new Date(Date.now() + 30 * 60 * 1000), // 30 minutes from now\r\n    },\r\n  ];\r\n\r\n  const jobs = automationJobs.length > 0 ? automationJobs : mockJobs;\r\n\r\n  const handleTriggerJob = (jobId: string) => {\r\n    triggerJob(jobId);\r\n  };\r\n\r\n  const getJobIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'backup':\r\n        return <Database className=\"h-4 w-4\" />;\r\n      case 'notification':\r\n        return <Calendar className=\"h-4 w-4\" />;\r\n      case 'sync':\r\n        return <FileSpreadsheet className=\"h-4 w-4\" />;\r\n      case 'cleanup':\r\n        return <Settings className=\"h-4 w-4\" />;\r\n      default:\r\n        return <Bot className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'running':\r\n        return 'bg-blue-500';\r\n      case 'completed':\r\n        return 'bg-green-500';\r\n      case 'failed':\r\n        return 'bg-red-500';\r\n      case 'queued':\r\n        return 'bg-yellow-500';\r\n      default:\r\n        return 'bg-gray-500';\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'running':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-blue-500\">\r\n            Running\r\n          </Badge>\r\n        );\r\n      case 'completed':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-green-500\">\r\n            Completed\r\n          </Badge>\r\n        );\r\n      case 'failed':\r\n        return <Badge variant=\"destructive\">Failed</Badge>;\r\n      case 'queued':\r\n        return <Badge variant=\"secondary\">Queued</Badge>;\r\n      default:\r\n        return <Badge variant=\"outline\">Unknown</Badge>;\r\n    }\r\n  };\r\n\r\n  const formatDuration = (seconds: number) => {\r\n    if (seconds < 60) {\r\n      return `${seconds}s`;\r\n    }\r\n    return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;\r\n  };\r\n\r\n  const formatRelativeTime = (date: Date) => {\r\n    const now = new Date();\r\n    const diff = now.getTime() - date.getTime();\r\n    const minutes = Math.floor(diff / 60000);\r\n    const hours = Math.floor(minutes / 60);\r\n    const days = Math.floor(hours / 24);\r\n\r\n    if (days > 0) {\r\n      return `${days} day${days > 1 ? 's' : ''} ago`;\r\n    }\r\n    if (hours > 0) {\r\n      return `${hours} hour${hours > 1 ? 's' : ''} ago`;\r\n    }\r\n    if (minutes > 0) {\r\n      return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;\r\n    }\r\n    return 'Just now';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight\">Automation</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Monitor and control your automated tasks and Google Sheets sync.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Overview */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Jobs</CardTitle>\r\n            <Bot className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{jobs.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">Automated tasks</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Running</CardTitle>\r\n            <Activity className=\"h-4 w-4 text-blue-500\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-blue-600\">\r\n              {jobs.filter((job) => job.status === 'running').length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Currently executing</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Completed Today\r\n            </CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {jobs.filter((job) => job.status === 'completed').length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Successful executions\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Google Sheets</CardTitle>\r\n            <FileSpreadsheet className=\"h-4 w-4 text-green-500\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {googleSheetsStatus &&\r\n              typeof googleSheetsStatus === 'object' &&\r\n              'data' in googleSheetsStatus &&\r\n              (googleSheetsStatus as any).data?.connected\r\n                ? 'Connected'\r\n                : 'Offline'}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Sync status</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Google Sheets Status */}\r\n      <Alert>\r\n        {googleSheetsStatus &&\r\n        typeof googleSheetsStatus === 'object' &&\r\n        'data' in googleSheetsStatus &&\r\n        (googleSheetsStatus as any).data?.connected ? (\r\n          <>\r\n            <CheckCircle className=\"h-4 w-4\" />\r\n            <AlertDescription>\r\n              Google Sheets integration is active and syncing data successfully.\r\n            </AlertDescription>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <AlertCircle className=\"h-4 w-4\" />\r\n            <AlertDescription>\r\n              Google Sheets integration is not connected. Please check your\r\n              configuration.\r\n            </AlertDescription>\r\n          </>\r\n        )}\r\n      </Alert>\r\n\r\n      {/* Main Content */}\r\n      <Tabs\r\n        value={selectedTab}\r\n        onValueChange={setSelectedTab}\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList>\r\n          <TabsTrigger value=\"jobs\">Automation Jobs</TabsTrigger>\r\n          <TabsTrigger value=\"history\">Execution History</TabsTrigger>\r\n          <TabsTrigger value=\"schedule\">Schedule</TabsTrigger>\r\n          <TabsTrigger value=\"logs\">System Logs</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Jobs Tab */}\r\n        <TabsContent value=\"jobs\" className=\"space-y-4\">\r\n          <div className=\"grid gap-4\">\r\n            {jobs.map((job) => (\r\n              <Card key={job.id}>\r\n                <CardHeader>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      {getJobIcon(job.type)}\r\n                      <div>\r\n                        <CardTitle className=\"text-lg\">{job.name}</CardTitle>\r\n                        <CardDescription>\r\n                          {job.type.charAt(0).toUpperCase() + job.type.slice(1)}{' '}\r\n                          Job\r\n                        </CardDescription>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <div\r\n                        className={`h-2 w-2 rounded-full ${getStatusColor(job.status)}`}\r\n                      ></div>\r\n                      {getStatusBadge(job.status)}\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-4\">\r\n                  {/* Progress Bar for Running Jobs */}\r\n                  {job.status === 'running' &&\r\n                    (job as any).progress !== undefined && (\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between text-sm\">\r\n                          <span>Progress</span>\r\n                          <span>{(job as any).progress}%</span>\r\n                        </div>\r\n                        <Progress\r\n                          value={(job as any).progress}\r\n                          className=\"h-2\"\r\n                        />\r\n                      </div>\r\n                    )}\r\n\r\n                  {/* Job Details */}\r\n                  <div className=\"grid gap-2 text-sm\">\r\n                    {job.lastRun && (\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Last Run:</span>\r\n                        <span>{formatRelativeTime(job.lastRun)}</span>\r\n                      </div>\r\n                    )}\r\n                    {job.nextRun && (\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Next Run:</span>\r\n                        <span>{job.nextRun.toLocaleString()}</span>\r\n                      </div>\r\n                    )}\r\n                    {job.duration && (\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Duration:</span>\r\n                        <span>{formatDuration(job.duration)}</span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Error Message */}\r\n                  {job.errorMessage && (\r\n                    <Alert variant=\"destructive\">\r\n                      <AlertCircle className=\"h-4 w-4\" />\r\n                      <AlertDescription>{job.errorMessage}</AlertDescription>\r\n                    </Alert>\r\n                  )}\r\n\r\n                  {/* Action Buttons */}\r\n                  <div className=\"flex space-x-2\">\r\n                    {job.status === 'running' ? (\r\n                      <Button variant=\"destructive\" size=\"sm\">\r\n                        <Square className=\"h-3 w-3 mr-1\" />\r\n                        Stop\r\n                      </Button>\r\n                    ) : (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleTriggerJob(job.id)}\r\n                        disabled={job.status !== 'queued'}\r\n                      >\r\n                        <Play className=\"h-3 w-3 mr-1\" />\r\n                        Run Now\r\n                      </Button>\r\n                    )}\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      <RotateCcw className=\"h-3 w-3 mr-1\" />\r\n                      Restart\r\n                    </Button>\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      <Settings className=\"h-3 w-3 mr-1\" />\r\n                      Configure\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* History Tab */}\r\n        <TabsContent value=\"history\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Execution History</CardTitle>\r\n              <CardDescription>\r\n                Recent execution history for all automation jobs\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                <Clock className=\"h-12 w-12 mx-auto mb-4\" />\r\n                <p>Execution history will appear here</p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Schedule Tab */}\r\n        <TabsContent value=\"schedule\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Schedule Configuration</CardTitle>\r\n              <CardDescription>\r\n                Configure when automation jobs should run\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  <div className=\"p-4 border rounded-lg\">\r\n                    <h4 className=\"font-medium mb-2\">Daily Backup</h4>\r\n                    <p className=\"text-sm text-muted-foreground mb-2\">\r\n                      Runs every day at 11:00 PM\r\n                    </p>\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      Edit Schedule\r\n                    </Button>\r\n                  </div>\r\n                  <div className=\"p-4 border rounded-lg\">\r\n                    <h4 className=\"font-medium mb-2\">Teacher Notifications</h4>\r\n                    <p className=\"text-sm text-muted-foreground mb-2\">\r\n                      Runs every day at 7:00 AM\r\n                    </p>\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      Edit Schedule\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Logs Tab */}\r\n        <TabsContent value=\"logs\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>System Logs</CardTitle>\r\n              <CardDescription>\r\n                Detailed logs from automation system\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                <FileSpreadsheet className=\"h-12 w-12 mx-auto mb-4\" />\r\n                <p>System logs will appear here</p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Quick Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Quick Actions</CardTitle>\r\n          <CardDescription>Common automation tasks</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid gap-4 md:grid-cols-3\">\r\n            <Button variant=\"outline\" className=\"h-16 flex-col\">\r\n              <Database className=\"h-6 w-6 mb-2\" />\r\n              <span>Run Backup Now</span>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"h-16 flex-col\">\r\n              <FileSpreadsheet className=\"h-6 w-6 mb-2\" />\r\n              <span>Sync to Google Sheets</span>\r\n            </Button>\r\n            <Button variant=\"outline\" className=\"h-16 flex-col\">\r\n              <Calendar className=\"h-6 w-6 mb-2\" />\r\n              <span>Send Notifications</span>\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AutomationDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\BarcodeManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1894,1897],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1894,1897],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport {\r\n  ScanLine,\r\n  Download,\r\n  RefreshCw,\r\n  CheckCircle2,\r\n  XCircle,\r\n  Loader2,\r\n  Printer,\r\n  Eye,\r\n  FileText,\r\n  Maximize2,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { utilitiesApi } from '@/lib/api';\r\n\r\ninterface BarcodeGenerationResult {\r\n  studentId: string;\r\n  name: string;\r\n  barcodePath: string;\r\n  barcodeUrl: string;\r\n  success: boolean;\r\n  error?: string;\r\n}\r\n\r\ninterface BarcodeGenerationSummary {\r\n  totalStudents: number;\r\n  successCount: number;\r\n  errorCount: number;\r\n  outputDir: string;\r\n  results: BarcodeGenerationResult[];\r\n  generatedAt: string;\r\n}\r\n\r\nfunction BarcodeManager() {\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [report, setReport] = useState<BarcodeGenerationSummary | null>(null);\r\n  const [showResults, setShowResults] = useState(false);\r\n\r\n  const handleGenerateAll = async () => {\r\n    try {\r\n      setIsGenerating(true);\r\n      toast.info('Starting barcode generation...', {\r\n        duration: 3000,\r\n      });\r\n\r\n      const response = await utilitiesApi.generateBarcodes();\r\n\r\n      if (response.data) {\r\n        const summary = response.data as BarcodeGenerationSummary;\r\n        setReport(summary);\r\n        setShowResults(true);\r\n        toast.success(\r\n          `Γ£à Generated ${summary.successCount} barcodes successfully!`,\r\n          { duration: 5000 }\r\n        );\r\n      } else {\r\n        throw new Error(\r\n          typeof response.error === 'string'\r\n            ? response.error\r\n            : (response as any).error?.message || 'Generation failed'\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Barcode generation error:', error);\r\n      toast.error(\r\n        error instanceof Error ? error.message : 'Failed to generate barcodes'\r\n      );\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleLoadReport = async () => {\r\n    try {\r\n      const response = await utilitiesApi.getBarcodeReport();\r\n\r\n      if (response.data) {\r\n        setReport(response.data as BarcodeGenerationSummary);\r\n        setShowResults(true);\r\n        toast.success('Report loaded');\r\n      } else {\r\n        toast.error('No generation report found. Generate barcodes first.');\r\n      }\r\n    } catch (error) {\r\n      toast.error('Failed to load report');\r\n    }\r\n  };\r\n\r\n  const handleOpenPrintableSheet = () => {\r\n    // Open in new window\r\n    window.open('/api/utilities/barcodes-sheet', '_blank');\r\n    toast.success('Opening printable barcodes sheet...');\r\n  };\r\n\r\n  const successResults = report?.results.filter((r) => r.success) || [];\r\n  const errorResults = report?.results.filter((r) => !r.success) || [];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h2 className=\"text-3xl font-bold tracking-tight\">\r\n          Barcode Management\r\n        </h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Generate and manage student barcodes for scanning and tracking\r\n        </p>\r\n      </div>\r\n\r\n      {/* Action Cards */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        {/* Generate All Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <ScanLine className=\"h-5 w-5\" />\r\n              Generate Barcodes\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Create barcodes for all active students\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button\r\n              onClick={handleGenerateAll}\r\n              disabled={isGenerating}\r\n              className=\"w-full\"\r\n              size=\"lg\"\r\n            >\r\n              {isGenerating ? (\r\n                <>\r\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                  Generating...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <ScanLine className=\"mr-2 h-4 w-4\" />\r\n                  Generate All\r\n                </>\r\n              )}\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* View Report Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <FileText className=\"h-5 w-5\" />\r\n              View Report\r\n            </CardTitle>\r\n            <CardDescription>Load the latest generation report</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button\r\n              onClick={handleLoadReport}\r\n              variant=\"outline\"\r\n              className=\"w-full\"\r\n              size=\"lg\"\r\n            >\r\n              <Eye className=\"mr-2 h-4 w-4\" />\r\n              Load Report\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Printable Sheet Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Printer className=\"h-5 w-5\" />\r\n              Print Sheet\r\n            </CardTitle>\r\n            <CardDescription>Open printable barcode sheet</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Button\r\n              onClick={handleOpenPrintableSheet}\r\n              variant=\"outline\"\r\n              className=\"w-full\"\r\n              size=\"lg\"\r\n            >\r\n              <Printer className=\"mr-2 h-4 w-4\" />\r\n              Open Sheet\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Report Summary */}\r\n      {report && showResults && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Generation Summary</CardTitle>\r\n            <CardDescription>\r\n              Generated on {new Date(report.generatedAt).toLocaleString()}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid gap-4 md:grid-cols-4\">\r\n              <div className=\"flex flex-col gap-1\">\r\n                <span className=\"text-sm text-muted-foreground\">\r\n                  Total Students\r\n                </span>\r\n                <span className=\"text-2xl font-bold\">\r\n                  {report.totalStudents}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex flex-col gap-1\">\r\n                <span className=\"text-sm text-muted-foreground\">\r\n                  Γ£à Success\r\n                </span>\r\n                <span className=\"text-2xl font-bold text-green-600\">\r\n                  {report.successCount}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex flex-col gap-1\">\r\n                <span className=\"text-sm text-muted-foreground\">Γ¥î Errors</span>\r\n                <span className=\"text-2xl font-bold text-red-600\">\r\n                  {report.errorCount}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex flex-col gap-1\">\r\n                <span className=\"text-sm text-muted-foreground\">\r\n                  Success Rate\r\n                </span>\r\n                <span className=\"text-2xl font-bold\">\r\n                  {Math.round(\r\n                    (report.successCount / report.totalStudents) * 100\r\n                  )}\r\n                  %\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {report.errorCount > 0 && (\r\n              <Alert className=\"mt-4\" variant=\"destructive\">\r\n                <XCircle className=\"h-4 w-4\" />\r\n                <AlertDescription>\r\n                  {report.errorCount} barcode(s) failed to generate. Check the\r\n                  results below.\r\n                </AlertDescription>\r\n              </Alert>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Results List */}\r\n      {report && showResults && successResults.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Generated Barcodes</CardTitle>\r\n            <CardDescription>\r\n              Click on any barcode to download it\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ScrollArea className=\"h-[400px] pr-4\">\r\n              <div className=\"space-y-2\">\r\n                {successResults.map((result) => (\r\n                  <div\r\n                    key={result.studentId}\r\n                    className=\"flex items-center justify-between rounded-lg border p-3 hover:bg-accent/50 transition-colors\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\r\n                      <div>\r\n                        <p className=\"font-medium\">{result.name}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          ID: {result.studentId}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge variant=\"outline\">Generated</Badge>\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"ghost\"\r\n                        onClick={() => {\r\n                          const url = `http://localhost:3001${result.barcodeUrl}`;\r\n                          window.open(url, '_blank');\r\n                          toast.success('Opening barcode image...');\r\n                        }}\r\n                      >\r\n                        <Download className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </ScrollArea>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Error Results */}\r\n      {report && showResults && errorResults.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-red-600\">Failed Barcodes</CardTitle>\r\n            <CardDescription>\r\n              These students encountered errors during generation\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ScrollArea className=\"h-[200px] pr-4\">\r\n              <div className=\"space-y-2\">\r\n                {errorResults.map((result) => (\r\n                  <div\r\n                    key={result.studentId}\r\n                    className=\"flex items-center justify-between rounded-lg border border-red-200 bg-red-50 dark:bg-red-950 p-3\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <XCircle className=\"h-5 w-5 text-red-600\" />\r\n                      <div>\r\n                        <p className=\"font-medium\">{result.name}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          ID: {result.studentId}\r\n                        </p>\r\n                        <p className=\"text-sm text-red-600 mt-1\">\r\n                          {result.error}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={async () => {\r\n                        try {\r\n                          await utilitiesApi.regenerateBarcode(\r\n                            result.studentId\r\n                          );\r\n                          toast.success('Barcode regenerated!');\r\n                          handleLoadReport(); // Refresh report\r\n                        } catch (error) {\r\n                          toast.error('Failed to regenerate barcode');\r\n                        }\r\n                      }}\r\n                    >\r\n                      <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                      Retry\r\n                    </Button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </ScrollArea>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Info Cards */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <ScanLine className=\"h-4 w-4\" />\r\n              Code128 Format\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-sm space-y-2\">\r\n              <h4 className=\"font-medium\">High Compatibility</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Code128 barcodes work with all standard USB scanners and are\r\n                widely supported.\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Maximize2 className=\"h-4 w-4\" />\r\n              Compressed Printing\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-sm space-y-2\">\r\n              <h4 className=\"font-medium\">Save Paper</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Use the \"Toggle Compressed Mode\" button on the printable sheet\r\n                to fit 4 barcodes per row instead of 3.\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base flex items-center gap-2\">\r\n              <Printer className=\"h-4 w-4\" />\r\n              Print-Ready\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-sm space-y-2\">\r\n              <h4 className=\"font-medium\">Optimized Layout</h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Printable sheet includes student names and IDs, formatted for\r\n                easy cutting and distribution.\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BarcodeManager;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\BookCatalog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\BookCheckout.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checkoutFormActions'. Either include it or remove the dependency array.","line":131,"column":6,"nodeType":"ArrayExpression","endLine":131,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [checkoutFormActions]","fix":{"range":[3446,3448],"text":"[checkoutFormActions]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, Suspense, useEffect, lazy } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardHeader,\r\n  CardTitle,\r\n  CardDescription,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { useMultipleLoadingStates, useMultipleModals, useForm } from '@/hooks';\r\n\r\n// Lazy load CheckoutHistory component\r\nconst CheckoutHistory = lazy(() => import('./CheckoutHistory'));\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  BookOpen,\r\n  User,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  RotateCcw,\r\n  Scan,\r\n  History as HistoryIcon,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport axios from 'axios';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\nconst API_BASE_URL = 'http://localhost:3001/api';\r\n\r\ninterface Student {\r\n  id: string;\r\n  studentId: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  gradeLevel: string;\r\n  section?: string;\r\n}\r\n\r\ninterface Book {\r\n  id: string;\r\n  accessionNo: string;\r\n  title: string;\r\n  author: string;\r\n  category: string;\r\n  availableCopies: number;\r\n  totalCopies: number;\r\n}\r\n\r\ninterface Checkout {\r\n  id: string;\r\n  bookId: string;\r\n  studentId: string;\r\n  checkoutDate: string;\r\n  dueDate: string;\r\n  returnDate?: string;\r\n  status: string;\r\n  overdueDays: number;\r\n  fineAmount: string;\r\n  book: Book;\r\n  student: Student;\r\n}\r\n\r\nexport default function BookCheckout() {\r\n  // Tab management (keeping simple useState for UI state)\r\n  const [activeTab, setActiveTab] = useState('checkout');\r\n\r\n  // Consolidated loading states for all operations\r\n  const [loadingStates, loadingActions] = useMultipleLoadingStates({\r\n    scanStudent: { isLoading: false },\r\n    scanBook: { isLoading: false },\r\n    confirmCheckout: { isLoading: false },\r\n    scanReturn: { isLoading: false },\r\n    confirmReturn: { isLoading: false },\r\n  });\r\n\r\n  // Consolidated modal states\r\n  const [modalStates, modalActions] = useMultipleModals({\r\n    returnConfirm: false,\r\n  });\r\n\r\n  // Checkout form management\r\n  const [checkoutForm, checkoutFormActions] = useForm({\r\n    initialValues: {\r\n      studentBarcode: '',\r\n      bookBarcode: '',\r\n      selectedStudent: null,\r\n      selectedBook: null,\r\n      dueDate: '',\r\n      checkoutStep: 'student' as 'student' | 'book' | 'confirm',\r\n    },\r\n    validationSchema: {\r\n      studentBarcode: { required: true },\r\n      bookBarcode: { required: true },\r\n      dueDate: { required: true },\r\n    },\r\n  });\r\n\r\n  // Return form management\r\n  const [returnForm, returnFormActions] = useForm({\r\n    initialValues: {\r\n      returnBarcode: '',\r\n      activeCheckout: null,\r\n    },\r\n    validationSchema: {\r\n      returnBarcode: { required: true },\r\n    },\r\n  });\r\n\r\n  // Calculate default due date (7 days from now)\r\n  const getDefaultDueDate = (): string => {\r\n    const date = new Date();\r\n    date.setDate(date.getDate() + 7);\r\n    return date.toISOString().split('T')[0] ?? '';\r\n  };\r\n\r\n  // Initialize due date\r\n  useEffect(() => {\r\n    checkoutFormActions.setValue('dueDate', getDefaultDueDate());\r\n  }, []);\r\n\r\n  // Scan student\r\n  const handleScanStudent = async () => {\r\n    const studentBarcode = checkoutForm.values.studentBarcode;\r\n    if (!studentBarcode.trim()) {\r\n      toast.error('Please enter a student ID or barcode');\r\n      return;\r\n    }\r\n\r\n    loadingActions.scanStudent.start();\r\n    try {\r\n      const token = localStorage.getItem('clms_token');\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/students?_search=${studentBarcode.trim()}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (response.data.success && response.data.data.students.length > 0) {\r\n        const student = response.data.data.students[0];\r\n        checkoutFormActions.setValue('selectedStudent', student);\r\n        checkoutFormActions.setValue('checkoutStep', 'book');\r\n        toast.success(\r\n          `Student found: ${student.firstName} ${student.lastName}`\r\n        );\r\n      } else {\r\n        toast.error('Student not found');\r\n      }\r\n    } catch (error: unknown) {\r\n      toast.error(getErrorMessage(error, 'Failed to find student'));\r\n    } finally {\r\n      loadingActions.scanStudent.finish();\r\n    }\r\n  };\r\n\r\n  // Scan book\r\n  const handleScanBook = async () => {\r\n    const bookBarcode = checkoutForm.values.bookBarcode;\r\n    if (!bookBarcode.trim()) {\r\n      toast.error('Please enter a book accession number or barcode');\r\n      return;\r\n    }\r\n\r\n    loadingActions.scanBook.start();\r\n    try {\r\n      const token = localStorage.getItem('clms_token');\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/books?_search=${bookBarcode.trim()}`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (response.data.success && response.data.data.books.length > 0) {\r\n        const book = response.data.data.books[0];\r\n\r\n        if (book.availableCopies <= 0) {\r\n          toast.error('No copies available for checkout');\r\n          return;\r\n        }\r\n\r\n        checkoutFormActions.setValue('selectedBook', book);\r\n        checkoutFormActions.setValue('checkoutStep', 'confirm');\r\n        toast.success(`Book found: ${book.title}`);\r\n      } else {\r\n        toast.error('Book not found');\r\n      }\r\n    } catch (error: unknown) {\r\n      toast.error(getErrorMessage(error, 'Failed to find book'));\r\n    } finally {\r\n      loadingActions.scanBook.finish();\r\n    }\r\n  };\r\n\r\n  // Confirm checkout\r\n  const handleConfirmCheckout = async () => {\r\n    const { selectedStudent, selectedBook, dueDate } = checkoutForm.values;\r\n    if (!selectedStudent || !selectedBook || !dueDate) {\r\n      toast.error('Missing required information');\r\n      return;\r\n    }\r\n\r\n    loadingActions.confirmCheckout.start();\r\n    try {\r\n      const token = localStorage.getItem('clms_token');\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/books/checkout`,\r\n        {\r\n          bookId: selectedBook.id,\r\n          studentId: selectedStudent.id,\r\n          dueDate: new Date(dueDate).toISOString(),\r\n        },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (response.data.success) {\r\n        toast.success('Book checked out successfully!');\r\n        resetCheckout();\r\n      }\r\n    } catch (error: unknown) {\r\n      toast.error(getErrorMessage(error, 'Failed to checkout book'));\r\n    } finally {\r\n      loadingActions.confirmCheckout.finish();\r\n    }\r\n  };\r\n\r\n  // Reset checkout flow\r\n  const resetCheckout = () => {\r\n    checkoutFormActions.reset({\r\n      studentBarcode: '',\r\n      bookBarcode: '',\r\n      selectedStudent: null,\r\n      selectedBook: null,\r\n      dueDate: getDefaultDueDate(),\r\n      checkoutStep: 'student',\r\n    });\r\n  };\r\n\r\n  // Scan book for return\r\n  const handleScanReturn = async () => {\r\n    const returnBarcode = returnForm.values.returnBarcode;\r\n    if (!returnBarcode.trim()) {\r\n      toast.error('Please enter a book accession number or barcode');\r\n      return;\r\n    }\r\n\r\n    loadingActions.scanReturn.start();\r\n    try {\r\n      const token = localStorage.getItem('clms_token');\r\n\r\n      // Find active checkout for this book\r\n      const response = await axios.get(\r\n        `${API_BASE_URL}/books/checkouts/all?status=ACTIVE`,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (response.data.success) {\r\n        const checkouts = response.data.data.checkouts || [];\r\n        const checkout = checkouts.find(\r\n          (c: Checkout) => c.book.accessionNo === returnBarcode.trim()\r\n        );\r\n\r\n        if (checkout) {\r\n          returnFormActions.setValue('activeCheckout', checkout);\r\n          modalActions.returnConfirm.open();\r\n        } else {\r\n          toast.error('No active checkout found for this book');\r\n        }\r\n      }\r\n    } catch (error: unknown) {\r\n      toast.error(getErrorMessage(error, 'Failed to find checkout'));\r\n    } finally {\r\n      loadingActions.scanReturn.finish();\r\n    }\r\n  };\r\n\r\n  // Confirm return\r\n  const handleConfirmReturn = async () => {\r\n    const { activeCheckout } = returnForm.values;\r\n    if (!activeCheckout) {\r\n      return;\r\n    }\r\n\r\n    loadingActions.confirmReturn.start();\r\n    try {\r\n      const token = localStorage.getItem('clms_token');\r\n      const response = await axios.post(\r\n        `${API_BASE_URL}/books/return`,\r\n        { checkoutId: activeCheckout.id },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n\r\n      if (response.data.success) {\r\n        const fine = parseFloat(activeCheckout.fineAmount);\r\n        if (fine > 0) {\r\n          toast.success(`Book returned! Fine: Γé▒${fine.toFixed(2)}`);\r\n        } else {\r\n          toast.success('Book returned successfully!');\r\n        }\r\n\r\n        returnFormActions.reset({\r\n          returnBarcode: '',\r\n          activeCheckout: null,\r\n        });\r\n        modalActions.returnConfirm.close();\r\n      }\r\n    } catch (error: unknown) {\r\n      toast.error(getErrorMessage(error, 'Failed to return book'));\r\n    } finally {\r\n      loadingActions.confirmReturn.finish();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h2 className=\"text-3xl font-bold tracking-tight\">\r\n          Book Checkout & Return\r\n        </h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Manage book borrowing and returns\r\n        </p>\r\n      </div>\r\n\r\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n        <TabsList className=\"grid w-full grid-cols-3\">\r\n          <TabsTrigger value=\"checkout\">\r\n            <BookOpen className=\"h-4 w-4 mr-2\" />\r\n            Check Out\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"return\">\r\n            <RotateCcw className=\"h-4 w-4 mr-2\" />\r\n            Return Book\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"history\">\r\n            <HistoryIcon className=\"h-4 w-4 mr-2\" />\r\n            History\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* CHECKOUT TAB */}\r\n        <TabsContent value=\"checkout\" className=\"space-y-4 mt-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Book Checkout Process</CardTitle>\r\n              <CardDescription>\r\n                Scan student ID, then scan book to checkout\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-6\">\r\n              {/* Step Indicator */}\r\n              <div className=\"flex items-center justify-between\">\r\n                <div\r\n                  className={`flex items-center gap-2 ${checkoutForm.values.checkoutStep === 'student' ? 'text-primary' : 'text-muted-foreground'}`}\r\n                >\r\n                  <div\r\n                    className={`w-8 h-8 rounded-full flex items-center justify-center ${checkoutForm.values.checkoutStep === 'student' ? 'bg-primary text-primary-foreground' : 'bg-muted'}`}\r\n                  >\r\n                    1\r\n                  </div>\r\n                  <span className=\"font-medium\">Student</span>\r\n                </div>\r\n                <div className=\"flex-1 h-0.5 bg-border mx-4\" />\r\n                <div\r\n                  className={`flex items-center gap-2 ${checkoutForm.values.checkoutStep === 'book' ? 'text-primary' : 'text-muted-foreground'}`}\r\n                >\r\n                  <div\r\n                    className={`w-8 h-8 rounded-full flex items-center justify-center ${checkoutForm.values.checkoutStep === 'book' ? 'bg-primary text-primary-foreground' : 'bg-muted'}`}\r\n                  >\r\n                    2\r\n                  </div>\r\n                  <span className=\"font-medium\">Book</span>\r\n                </div>\r\n                <div className=\"flex-1 h-0.5 bg-border mx-4\" />\r\n                <div\r\n                  className={`flex items-center gap-2 ${checkoutForm.values.checkoutStep === 'confirm' ? 'text-primary' : 'text-muted-foreground'}`}\r\n                >\r\n                  <div\r\n                    className={`w-8 h-8 rounded-full flex items-center justify-center ${checkoutForm.values.checkoutStep === 'confirm' ? 'bg-primary text-primary-foreground' : 'bg-muted'}`}\r\n                  >\r\n                    3\r\n                  </div>\r\n                  <span className=\"font-medium\">Confirm</span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Step 1: Scan Student */}\r\n              {checkoutForm.values.checkoutStep === 'student' && (\r\n                <div className=\"space-y-4\">\r\n                  <Alert>\r\n                    <User className=\"h-4 w-4\" />\r\n                    <AlertTitle>Step 1: Scan Student ID</AlertTitle>\r\n                    <AlertDescription>\r\n                      Enter or scan the student's ID or barcode\r\n                    </AlertDescription>\r\n                  </Alert>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"studentBarcode\">Student ID / Barcode</Label>\r\n                    <div className=\"flex gap-2\">\r\n                      <Input\r\n                        id=\"studentBarcode\"\r\n                        placeholder=\"Enter student ID or scan barcode...\"\r\n                        value={checkoutForm.values.studentBarcode}\r\n                        onChange={(e) =>\r\n                          checkoutFormActions.setValue(\r\n                            'studentBarcode',\r\n                            e.target.value\r\n                          )\r\n                        }\r\n                        onKeyPress={(e) =>\r\n                          e.key === 'Enter' && handleScanStudent()\r\n                        }\r\n                        autoFocus\r\n                      />\r\n                      <Button\r\n                        onClick={handleScanStudent}\r\n                        disabled={loadingStates.scanStudent.isLoading}\r\n                      >\r\n                        {loadingStates.scanStudent.isLoading ? (\r\n                          'Searching...'\r\n                        ) : (\r\n                          <>\r\n                            <Scan className=\"h-4 w-4 mr-2\" />\r\n                            Find\r\n                          </>\r\n                        )}\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Step 2: Scan Book */}\r\n              {checkoutForm.values.checkoutStep === 'book' &&\r\n                checkoutForm.values.selectedStudent && (\r\n                  <div className=\"space-y-4\">\r\n                    <Alert>\r\n                      <CheckCircle className=\"h-4 w-4\" />\r\n                      <AlertTitle>Student Selected</AlertTitle>\r\n                      <AlertDescription>\r\n                        {checkoutForm.values.selectedStudent.firstName}{' '}\r\n                        {checkoutForm.values.selectedStudent.lastName} -{' '}\r\n                        {checkoutForm.values.selectedStudent.gradeLevel}{' '}\r\n                        {checkoutForm.values.selectedStudent.section}\r\n                      </AlertDescription>\r\n                    </Alert>\r\n\r\n                    <Alert>\r\n                      <BookOpen className=\"h-4 w-4\" />\r\n                      <AlertTitle>Step 2: Scan Book</AlertTitle>\r\n                      <AlertDescription>\r\n                        Enter or scan the book's accession number\r\n                      </AlertDescription>\r\n                    </Alert>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"bookBarcode\">Book Accession Number</Label>\r\n                      <div className=\"flex gap-2\">\r\n                        <Input\r\n                          id=\"bookBarcode\"\r\n                          placeholder=\"Enter accession number or scan barcode...\"\r\n                          value={checkoutForm.values.bookBarcode}\r\n                          onChange={(e) =>\r\n                            checkoutFormActions.setValue(\r\n                              'bookBarcode',\r\n                              e.target.value\r\n                            )\r\n                          }\r\n                          onKeyPress={(e) =>\r\n                            e.key === 'Enter' && handleScanBook()\r\n                          }\r\n                          autoFocus\r\n                        />\r\n                        <Button\r\n                          onClick={handleScanBook}\r\n                          disabled={loadingStates.scanBook.isLoading}\r\n                        >\r\n                          {loadingStates.scanBook.isLoading ? (\r\n                            'Searching...'\r\n                          ) : (\r\n                            <>\r\n                              <Scan className=\"h-4 w-4 mr-2\" />\r\n                              Find\r\n                            </>\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      onClick={() =>\r\n                        checkoutFormActions.setValue('checkoutStep', 'student')\r\n                      }\r\n                    >\r\n                      Back to Student Selection\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n\r\n              {/* Step 3: Confirm */}\r\n              {checkoutForm.values.checkoutStep === 'confirm' &&\r\n                checkoutForm.values.selectedStudent &&\r\n                checkoutForm.values.selectedBook && (\r\n                  <div className=\"space-y-4\">\r\n                    <Alert>\r\n                      <CheckCircle className=\"h-4 w-4\" />\r\n                      <AlertTitle>Ready to Checkout</AlertTitle>\r\n                      <AlertDescription>\r\n                        Review the details below and confirm\r\n                      </AlertDescription>\r\n                    </Alert>\r\n\r\n                    <div className=\"grid gap-4\">\r\n                      <Card>\r\n                        <CardHeader>\r\n                          <CardTitle className=\"text-sm flex items-center gap-2\">\r\n                            <User className=\"h-4 w-4\" />\r\n                            Student Information\r\n                          </CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"text-sm space-y-1\">\r\n                          <div>\r\n                            <strong>Name:</strong>{' '}\r\n                            {checkoutForm.values.selectedStudent.firstName}{' '}\r\n                            {checkoutForm.values.selectedStudent.lastName}\r\n                          </div>\r\n                          <div>\r\n                            <strong>ID:</strong>{' '}\r\n                            {checkoutForm.values.selectedStudent.studentId}\r\n                          </div>\r\n                          <div>\r\n                            <strong>Grade:</strong>{' '}\r\n                            {checkoutForm.values.selectedStudent.gradeLevel}{' '}\r\n                            {checkoutForm.values.selectedStudent.section}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n\r\n                      <Card>\r\n                        <CardHeader>\r\n                          <CardTitle className=\"text-sm flex items-center gap-2\">\r\n                            <BookOpen className=\"h-4 w-4\" />\r\n                            Book Information\r\n                          </CardTitle>\r\n                        </CardHeader>\r\n                        <CardContent className=\"text-sm space-y-1\">\r\n                          <div>\r\n                            <strong>Title:</strong>{' '}\r\n                            {checkoutForm.values.selectedBook.title}\r\n                          </div>\r\n                          <div>\r\n                            <strong>Author:</strong>{' '}\r\n                            {checkoutForm.values.selectedBook.author}\r\n                          </div>\r\n                          <div>\r\n                            <strong>Accession No:</strong>{' '}\r\n                            {checkoutForm.values.selectedBook.accessionNo}\r\n                          </div>\r\n                          <div>\r\n                            <Badge\r\n                              variant={\r\n                                checkoutForm.values.selectedBook\r\n                                  .availableCopies > 0\r\n                                  ? 'default'\r\n                                  : 'destructive'\r\n                              }\r\n                            >\r\n                              {checkoutForm.values.selectedBook.availableCopies}{' '}\r\n                              / {checkoutForm.values.selectedBook.totalCopies}{' '}\r\n                              Available\r\n                            </Badge>\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"dueDate\">Due Date</Label>\r\n                        <Input\r\n                          id=\"dueDate\"\r\n                          type=\"date\"\r\n                          value={checkoutForm.values.dueDate}\r\n                          onChange={(e) =>\r\n                            checkoutFormActions.setValue(\r\n                              'dueDate',\r\n                              e.target.value\r\n                            )\r\n                          }\r\n                          min={new Date().toISOString().split('T')[0]}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex gap-2\">\r\n                      <Button\r\n                        onClick={handleConfirmCheckout}\r\n                        disabled={loadingStates.confirmCheckout.isLoading}\r\n                        className=\"flex-1\"\r\n                      >\r\n                        {loadingStates.confirmCheckout.isLoading ? (\r\n                          'Processing...'\r\n                        ) : (\r\n                          <>\r\n                            <CheckCircle className=\"h-4 w-4 mr-2\" />\r\n                            Confirm Checkout\r\n                          </>\r\n                        )}\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        onClick={() =>\r\n                          checkoutFormActions.setValue('checkoutStep', 'book')\r\n                        }\r\n                      >\r\n                        Back\r\n                      </Button>\r\n                      <Button variant=\"ghost\" onClick={resetCheckout}>\r\n                        Cancel\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* RETURN TAB */}\r\n        <TabsContent value=\"return\" className=\"space-y-4 mt-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Return Book</CardTitle>\r\n              <CardDescription>\r\n                Scan the book's barcode to process return\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <Alert>\r\n                <BookOpen className=\"h-4 w-4\" />\r\n                <AlertTitle>Scan Book for Return</AlertTitle>\r\n                <AlertDescription>\r\n                  Enter or scan the book's accession number\r\n                </AlertDescription>\r\n              </Alert>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"returnBarcode\">Book Accession Number</Label>\r\n                <div className=\"flex gap-2\">\r\n                  <Input\r\n                    id=\"returnBarcode\"\r\n                    placeholder=\"Enter accession number or scan barcode...\"\r\n                    value={returnForm.values.returnBarcode}\r\n                    onChange={(e) =>\r\n                      returnFormActions.setValue(\r\n                        'returnBarcode',\r\n                        e.target.value\r\n                      )\r\n                    }\r\n                    onKeyPress={(e) => e.key === 'Enter' && handleScanReturn()}\r\n                    autoFocus\r\n                  />\r\n                  <Button\r\n                    onClick={handleScanReturn}\r\n                    disabled={loadingStates.scanReturn.isLoading}\r\n                  >\r\n                    {loadingStates.scanReturn.isLoading ? (\r\n                      'Searching...'\r\n                    ) : (\r\n                      <>\r\n                        <Scan className=\"h-4 w-4 mr-2\" />\r\n                        Find\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* HISTORY TAB */}\r\n        <TabsContent value=\"history\" className=\"space-y-4 mt-6\">\r\n          <Suspense\r\n            fallback={\r\n              <div className=\"flex items-center justify-center py-8\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\r\n              </div>\r\n            }\r\n          >\r\n            <CheckoutHistory />\r\n          </Suspense>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Return Confirmation Dialog */}\r\n      <Dialog\r\n        open={!!modalStates.returnConfirm}\r\n        onOpenChange={(open) => modalActions.returnConfirm.setState(open)}\r\n      >\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Confirm Book Return</DialogTitle>\r\n            <DialogDescription>\r\n              Review the checkout details below\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {returnForm.values.activeCheckout && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <div>\r\n                  <strong>Book:</strong>{' '}\r\n                  {returnForm.values.activeCheckout.book.title}\r\n                </div>\r\n                <div>\r\n                  <strong>Student:</strong>{' '}\r\n                  {returnForm.values.activeCheckout.student.firstName}{' '}\r\n                  {returnForm.values.activeCheckout.student.lastName}\r\n                </div>\r\n                <div>\r\n                  <strong>Checkout Date:</strong>{' '}\r\n                  {new Date(\r\n                    returnForm.values.activeCheckout.checkoutDate\r\n                  ).toLocaleDateString()}\r\n                </div>\r\n                <div>\r\n                  <strong>Due Date:</strong>{' '}\r\n                  {new Date(\r\n                    returnForm.values.activeCheckout.dueDate\r\n                  ).toLocaleDateString()}\r\n                </div>\r\n\r\n                {returnForm.values.activeCheckout.overdueDays > 0 && (\r\n                  <Alert variant=\"destructive\">\r\n                    <AlertCircle className=\"h-4 w-4\" />\r\n                    <AlertTitle>Overdue</AlertTitle>\r\n                    <AlertDescription>\r\n                      <div>\r\n                        {returnForm.values.activeCheckout.overdueDays} day(s)\r\n                        overdue\r\n                      </div>\r\n                      <div className=\"font-bold\">\r\n                        Fine: Γé▒\r\n                        {parseFloat(\r\n                          returnForm.values.activeCheckout.fineAmount\r\n                        ).toFixed(2)}\r\n                      </div>\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => modalActions.returnConfirm.close()}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleConfirmReturn}\r\n              disabled={loadingStates.confirmReturn.isLoading}\r\n            >\r\n              {loadingStates.confirmReturn.isLoading\r\n                ? 'Processing...'\r\n                : 'Confirm Return'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\CSVImportDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[903,906],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[903,906],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Upload,\r\n  FileText,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  X,\r\n  Download,\r\n  RefreshCw,\r\n  FileUp,\r\n  Table,\r\n} from 'lucide-react';\r\n\r\ninterface CSVImportDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  title?: string;\r\n  description?: string;\r\n  templateColumns: string[];\r\n  onImport: (data: any[]) => Promise<void>;\r\n  entityName?: string;\r\n}\r\n\r\ninterface ImportPreview {\r\n  headers: string[];\r\n  rows: string[][];\r\n  totalRows: number;\r\n}\r\n\r\nexport function CSVImportDialog({\r\n  open,\r\n  onOpenChange,\r\n  title = 'Import CSV Data',\r\n  description = 'Upload a CSV file to import multiple records',\r\n  templateColumns,\r\n  onImport,\r\n  entityName = 'records',\r\n}: CSVImportDialogProps) {\r\n  const { isMobile } = useMobileOptimization();\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [preview, setPreview] = useState<ImportPreview | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [progress, setProgress] = useState(0);\r\n  const [errors, setErrors] = useState<string[]>([]);\r\n  const [validationResult, setValidationResult] = useState<{\r\n    valid: number;\r\n    invalid: number;\r\n    warnings: string[];\r\n  } | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const selectedFile = event.target.files?.[0];\r\n    if (!selectedFile) {\r\n      return;\r\n    }\r\n\r\n    // Validate file type\r\n    if (!selectedFile.name.endsWith('.csv')) {\r\n      toast.error('Please upload a CSV file');\r\n      return;\r\n    }\r\n\r\n    // Validate file size (10MB max)\r\n    if (selectedFile.size > 10 * 1024 * 1024) {\r\n      toast.error('File size must be less than 10MB');\r\n      return;\r\n    }\r\n\r\n    setFile(selectedFile);\r\n    parseCSV(selectedFile);\r\n  };\r\n\r\n  const parseCSV = async (file: File) => {\r\n    setIsProcessing(true);\r\n    setErrors([]);\r\n    setProgress(10);\r\n\r\n    try {\r\n      const text = await file.text();\r\n      setProgress(30);\r\n\r\n      // Parse CSV\r\n      const lines = text.split('\\n').filter((line) => line.trim());\r\n      if (lines.length === 0) {\r\n        throw new Error('CSV file is empty');\r\n      }\r\n\r\n      // Extract headers - we know lines[0] exists because we checked length > 0\r\n      const firstLine = lines[0];\r\n      if (!firstLine) {\r\n        throw new Error('CSV file has no valid header row');\r\n      }\r\n      const headers = firstLine\r\n        .split(',')\r\n        .map((h) => h.trim().replace(/^\"|\"$/g, ''));\r\n      setProgress(50);\r\n\r\n      // Validate headers\r\n      const missingColumns = templateColumns.filter(\r\n        (col) => !headers.includes(col)\r\n      );\r\n      if (missingColumns.length > 0) {\r\n        setErrors([\r\n          `Missing required columns: ${missingColumns.join(', ')}`,\r\n          `Expected columns: ${templateColumns.join(', ')}`,\r\n        ]);\r\n        setProgress(0);\r\n        setIsProcessing(false);\r\n        return;\r\n      }\r\n\r\n      // Parse rows\r\n      const rows = lines.slice(1, Math.min(6, lines.length)).map((line) => {\r\n        const values = line\r\n          .split(',')\r\n          .map((v) => v.trim().replace(/^\"|\"$/g, ''));\r\n        return values;\r\n      });\r\n\r\n      setProgress(70);\r\n\r\n      // Validate data\r\n      const validation = validateData(headers, rows);\r\n      setValidationResult(validation);\r\n\r\n      setPreview({\r\n        headers,\r\n        rows,\r\n        totalRows: lines.length - 1,\r\n      });\r\n\r\n      setProgress(100);\r\n      toast.success(`Parsed ${lines.length - 1} ${entityName} successfully`);\r\n    } catch (error) {\r\n      console.error('CSV parsing error:', error);\r\n      setErrors([\r\n        error instanceof Error ? error.message : 'Failed to parse CSV file',\r\n      ]);\r\n      toast.error('Failed to parse CSV file');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const validateData = (\r\n    headers: string[],\r\n    rows: string[][]\r\n  ): {\r\n    valid: number;\r\n    invalid: number;\r\n    warnings: string[];\r\n  } => {\r\n    let valid = 0;\r\n    let invalid = 0;\r\n    const warnings: string[] = [];\r\n\r\n    rows.forEach((row, index) => {\r\n      // Check for empty required fields\r\n      const hasEmptyRequired = row.some((cell, cellIndex) => {\r\n        const header = headers[cellIndex];\r\n        return header && templateColumns.includes(header) && !cell?.trim();\r\n      });\r\n\r\n      if (hasEmptyRequired) {\r\n        invalid++;\r\n        warnings.push(`Row ${index + 2}: Missing required fields`);\r\n      } else {\r\n        valid++;\r\n      }\r\n\r\n      // Check for data length issues\r\n      if (row.length !== headers.length) {\r\n        warnings.push(`Row ${index + 2}: Column count mismatch`);\r\n      }\r\n    });\r\n\r\n    return { valid, invalid, warnings: warnings.slice(0, 5) };\r\n  };\r\n\r\n  const handleImport = async () => {\r\n    if (!file) {\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setProgress(0);\r\n\r\n    try {\r\n      const text = await file.text();\r\n      const lines = text.split('\\n').filter((line) => line.trim());\r\n      if (lines.length === 0) {\r\n        setPreview(null);\r\n        return;\r\n      }\r\n      const firstLine = lines[0];\r\n      if (!firstLine) {\r\n        setPreview(null);\r\n        return;\r\n      }\r\n      const headers = firstLine\r\n        .split(',')\r\n        .map((h) => h.trim().replace(/^\"|\"$/g, ''));\r\n\r\n      // Parse all rows into objects\r\n      const data = lines.slice(1).map((line) => {\r\n        const values = line\r\n          .split(',')\r\n          .map((v) => v.trim().replace(/^\"|\"$/g, ''));\r\n        const obj = {};\r\n        headers.forEach((header, index) => {\r\n          obj[header] = values[index] || '';\r\n        });\r\n        return obj;\r\n      });\r\n\r\n      // Batch import with progress\r\n      const batchSize = 50;\r\n      for (let i = 0; i < data.length; i += batchSize) {\r\n        const batch = data.slice(i, i + batchSize);\r\n        await onImport(batch);\r\n        setProgress(Math.round(((i + batch.length) / data.length) * 100));\r\n      }\r\n\r\n      toast.success(`Successfully imported ${data.length} ${entityName}`);\r\n      handleClose();\r\n    } catch (error) {\r\n      console.error('Import error:', error);\r\n      toast.error('Failed to import data');\r\n    } finally {\r\n      setIsProcessing(false);\r\n      setProgress(0);\r\n    }\r\n  };\r\n\r\n  const downloadTemplate = () => {\r\n    const csv = templateColumns.join(',') + '\\n';\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `${entityName}-template.csv`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n    toast.success('Template downloaded');\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setFile(null);\r\n    setPreview(null);\r\n    setErrors([]);\r\n    setValidationResult(null);\r\n    setProgress(0);\r\n    onOpenChange(false);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent\r\n        className={\r\n          isMobile\r\n            ? 'w-full max-w-full h-full'\r\n            : 'max-w-3xl max-h-[90vh] overflow-y-auto'\r\n        }\r\n      >\r\n        <DialogHeader>\r\n          <DialogTitle>{title}</DialogTitle>\r\n          <DialogDescription>{description}</DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Template Download */}\r\n          <Card>\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <FileText className=\"h-8 w-8 text-blue-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium\">Download Template</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Get the CSV template with required columns\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={downloadTemplate}>\r\n                  <Download className=\"h-4 w-4 mr-2\" />\r\n                  Template\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* File Upload */}\r\n          {!file && (\r\n            <Card\r\n              className=\"border-2 border-dashed cursor-pointer hover:border-primary/50 transition-colors\"\r\n              onClick={() => fileInputRef.current?.click()}\r\n            >\r\n              <CardContent className=\"p-8\">\r\n                <div className=\"text-center\">\r\n                  <Upload className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                  <p className=\"font-medium mb-2\">Click to upload CSV file</p>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Or drag and drop your file here\r\n                  </p>\r\n                  <Badge variant=\"outline\" className=\"mt-4\">\r\n                    Max size: 10MB\r\n                  </Badge>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Hidden file input */}\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            accept=\".csv\"\r\n            onChange={handleFileSelect}\r\n            className=\"hidden\"\r\n          />\r\n\r\n          {/* Processing */}\r\n          {isProcessing && (\r\n            <Card>\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"space-y-3\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <RefreshCw className=\"h-5 w-5 animate-spin text-blue-500\" />\r\n                    <span className=\"font-medium\">Processing CSV file...</span>\r\n                  </div>\r\n                  <Progress value={progress} className=\"h-2\" />\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {progress}% complete\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Errors */}\r\n          {errors.length > 0 && (\r\n            <Alert variant=\"destructive\">\r\n              <AlertCircle className=\"h-4 w-4\" />\r\n              <AlertDescription>\r\n                <div className=\"space-y-1\">\r\n                  {errors.map((error, index) => (\r\n                    <div key={index}>ΓÇó {error}</div>\r\n                  ))}\r\n                </div>\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          {/* Preview */}\r\n          {preview && validationResult && (\r\n            <>\r\n              <Card>\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <FileUp className=\"h-5 w-5 text-green-500\" />\r\n                        <span className=\"font-medium\">{file?.name}</span>\r\n                      </div>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => {\r\n                          setFile(null);\r\n                          setPreview(null);\r\n                          setValidationResult(null);\r\n                        }}\r\n                      >\r\n                        <X className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-3 gap-4\">\r\n                      <div className=\"text-center p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg\">\r\n                        <div className=\"text-2xl font-bold text-blue-600\">\r\n                          {preview.totalRows}\r\n                        </div>\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          Total Rows\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-center p-3 bg-green-50 dark:bg-green-950/20 rounded-lg\">\r\n                        <div className=\"text-2xl font-bold text-green-600\">\r\n                          {validationResult.valid}\r\n                        </div>\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          Valid\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-center p-3 bg-red-50 dark:bg-red-950/20 rounded-lg\">\r\n                        <div className=\"text-2xl font-bold text-red-600\">\r\n                          {validationResult.invalid}\r\n                        </div>\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          Invalid\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Warnings */}\r\n              {validationResult.warnings.length > 0 && (\r\n                <Alert>\r\n                  <AlertCircle className=\"h-4 w-4\" />\r\n                  <AlertDescription>\r\n                    <div className=\"space-y-1\">\r\n                      <p className=\"font-medium\">Validation Warnings:</p>\r\n                      {validationResult.warnings.map((warning, index) => (\r\n                        <div key={index} className=\"text-sm\">\r\n                          ΓÇó {warning}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {/* Preview Table */}\r\n              <Card>\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Table className=\"h-4 w-4\" />\r\n                      <span className=\"font-medium\">\r\n                        Preview (First 5 rows)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"w-full text-sm\">\r\n                        <thead>\r\n                          <tr className=\"border-b\">\r\n                            {preview.headers.map((header, index) => (\r\n                              <th\r\n                                key={index}\r\n                                className=\"text-left p-2 font-medium\"\r\n                              >\r\n                                {header}\r\n                              </th>\r\n                            ))}\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {preview.rows.map((row, rowIndex) => (\r\n                            <tr key={rowIndex} className=\"border-b\">\r\n                              {row.map((cell, cellIndex) => (\r\n                                <td key={cellIndex} className=\"p-2\">\r\n                                  {cell || (\r\n                                    <span className=\"text-muted-foreground italic\">\r\n                                      empty\r\n                                    </span>\r\n                                  )}\r\n                                </td>\r\n                              ))}\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <DialogFooter className={isMobile ? 'flex-col gap-2' : ''}>\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={handleClose}\r\n            disabled={isProcessing}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            onClick={handleImport}\r\n            disabled={\r\n              !preview ||\r\n              isProcessing ||\r\n              validationResult?.invalid === preview?.totalRows\r\n            }\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {isProcessing ? (\r\n              <>\r\n                <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                Importing...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <CheckCircle className=\"h-4 w-4 mr-2\" />\r\n                Import {preview?.totalRows || 0} {entityName}\r\n              </>\r\n            )}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\CheckoutHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\DashboardOverview.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":122,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3928,3931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3928,3931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":123,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":123,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3980,3983],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3980,3983],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4019,4022],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4019,4022],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4748,4751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4748,4751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4800,4803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4800,4803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4839,4842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4839,4842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":621,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":621,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25849,25852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25849,25852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":621,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":621,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25871,25874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25871,25874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useActivityTimeline, useHealthCheck } from '@/hooks/api-hooks';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { useWebSocketContext } from '@/contexts/WebSocketContext';\r\nimport { NotificationCalendar } from './NotificationCalendar';\r\nimport { AddStudentDialog } from './AddStudentDialog';\r\nimport { RealTimeDashboard } from './RealTimeDashboard';\r\nimport { utilitiesApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n// Simplified icon imports - only what this component actually uses\r\nimport {\r\n  CheckCircle,\r\n  Activity,\r\n  Clock,\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  Settings,\r\n  BarChart3,\r\n  Download,\r\n  Printer,\r\n  Maximize2,\r\n  Minimize2,\r\n  Bell,\r\n  Wifi,\r\n  CalendarDays,\r\n  Eye,\r\n  Users,\r\n  Monitor,\r\n  Shield,\r\n  AlertCircle,\r\n  ExternalLink,\r\n  Edit,\r\n  FileText,\r\n} from 'lucide-react';\r\n\r\ninterface DashboardOverviewProps {\r\n  onTabChange?: (tab: string) => void;\r\n}\r\n\r\nexport function DashboardOverview({ onTabChange }: DashboardOverviewProps) {\r\n  const { user } = useAuth();\r\n  const { isOnline, connectedToBackend, activities, automationJobs } =\r\n    useAppStore();\r\n  const { isConnected: wsConnected, notifications } = useWebSocketContext();\r\n  const [showRealTime, setShowRealTime] = useState(true);\r\n\r\n  // Real-time clock state (updates every minute for professional appearance)\r\n  const [currentTime, setCurrentTime] = useState(new Date());\r\n\r\n  // Quick Actions loading states\r\n  const [isAddStudentDialogOpen, setIsAddStudentDialogOpen] = useState(false);\r\n\r\n  // Quick Actions loading states\r\n  const [isStartingSession] = useState(false);\r\n  const [isViewingReport, setIsViewingReport] = useState(false);\r\n  const [isRunningBackup, setIsRunningBackup] = useState(false);\r\n\r\n  // New loading states for enhanced functionality\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [isPrinting, setIsPrinting] = useState(false);\r\n  const [isFullscreen, setIsFullscreen] = useState(false);\r\n\r\n  // Update time every minute (professional standard)\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      setCurrentTime(new Date());\r\n    }, 60000); // Update every 60 seconds\r\n\r\n    return () => clearInterval(timer);\r\n  }, []);\r\n\r\n  // Quick Actions handlers\r\n  const handleAddStudent = () => {\r\n    setIsAddStudentDialogOpen(true);\r\n  };\r\n\r\n  const handleStartSession = async () => {\r\n    // For demo purposes, we'll show a message that this requires student/equipment selection\r\n    toast.info(\r\n      'Start Session requires student and equipment selection. This feature will be enhanced in the Equipment tab.'\r\n    );\r\n  };\r\n\r\n  const handleViewReport = async () => {\r\n    try {\r\n      setIsViewingReport(true);\r\n      const response = await utilitiesApi.getQuickReport();\r\n\r\n      if (response.success) {\r\n        toast.success('Report generated successfully!');\r\n        // Display report data in a more user-friendly way\r\n        console.debug('Quick Report:', response.data);\r\n\r\n        // Show key metrics in toast\r\n        const report = response.data as {\r\n          summary: {\r\n            totalStudents: number;\r\n            todayActivities: number;\r\n            equipmentUtilization: number;\r\n          };\r\n        };\r\n        if (\r\n          report?.summary &&\r\n          typeof report.summary.totalStudents === 'number'\r\n        ) {\r\n          toast.info(\r\n            `${report.summary.totalStudents} students, ${report.summary.todayActivities} activities today, ${report.summary.equipmentUtilization}% equipment utilization`\r\n          );\r\n        }\r\n      } else {\r\n        toast.error(\r\n          typeof (response as any).error === 'string'\r\n            ? (response as any).error\r\n            : (response as any).error?.message || 'Failed to generate report'\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error generating report:', error);\r\n      toast.error('Failed to generate report. Please try again.');\r\n    } finally {\r\n      setIsViewingReport(false);\r\n    }\r\n  };\r\n\r\n  const handleRunBackup = async () => {\r\n    try {\r\n      setIsRunningBackup(true);\r\n      const response = await utilitiesApi.quickBackup();\r\n\r\n      if (response.success) {\r\n        const data = response.data as { estimatedDuration?: string };\r\n        toast.success(\r\n          `Backup initiated! ${data?.estimatedDuration ?? 'Unknown'} estimated duration.`\r\n        );\r\n      } else {\r\n        toast.error(\r\n          typeof (response as any).error === 'string'\r\n            ? (response as any).error\r\n            : (response as any).error?.message || 'Failed to initiate backup'\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initiating backup:', error);\r\n      toast.error('Failed to initiate backup. Please try again.');\r\n    } finally {\r\n      setIsRunningBackup(false);\r\n    }\r\n  };\r\n\r\n  // Enhanced functionality handlers\r\n\r\n  const handleExport = async () => {\r\n    try {\r\n      setIsExporting(true);\r\n      // Generate CSV export\r\n      const csvContent = `Data Type,Count,Timestamp\\nStudents Today,${totalToday},${new Date().toISOString()}\\nActive Sessions,${activeSessions},${new Date().toISOString()}\\nRunning Jobs,${runningJobs},${new Date().toISOString()}`;\r\n\r\n      const blob = new Blob([csvContent], { type: 'text/csv' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `dashboard-export-${new Date().toISOString().split('T')[0]}.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success('Dashboard data exported successfully!');\r\n    } catch (error) {\r\n      toast.error('Failed to export dashboard data');\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const handlePrint = () => {\r\n    try {\r\n      setIsPrinting(true);\r\n      window.print();\r\n      toast.success('Print dialog opened');\r\n    } catch (error) {\r\n      toast.error('Failed to open print dialog');\r\n    } finally {\r\n      setIsPrinting(false);\r\n    }\r\n  };\r\n\r\n  const toggleFullscreen = () => {\r\n    setIsFullscreen(!isFullscreen);\r\n    if (!isFullscreen) {\r\n      document.documentElement.requestFullscreen?.();\r\n    } else {\r\n      document.exitFullscreen?.();\r\n    }\r\n    toast.info(\r\n      isFullscreen ? 'Exited fullscreen mode' : 'Entered fullscreen mode'\r\n    );\r\n  };\r\n\r\n  const handleEmergencyAlert = () => {\r\n    toast.warning(\r\n      'Emergency alert system activated. This would notify administrators of critical system issues.'\r\n    );\r\n  };\r\n\r\n  const handleManualSessionEntry = () => {\r\n    toast.info(\r\n      'Manual session entry feature. This would open a form to log missed check-ins.'\r\n    );\r\n  };\r\n\r\n  const handleBulkCheckout = () => {\r\n    toast.info(\r\n      'Bulk checkout feature. This would allow ending multiple active sessions at once.'\r\n    );\r\n  };\r\n\r\n  // Use error boundaries for API calls to prevent crashes\r\n  const { data: timeline, isLoading: timelineLoading } =\r\n    useActivityTimeline(10);\r\n  const { data: healthData } = useHealthCheck();\r\n\r\n  // Calculate real-time metrics from store (initialized to 0)\r\n  const activeSessions = Array.isArray(activities)\r\n    ? activities.filter((a) => a.status === 'active').length\r\n    : 0;\r\n  const totalToday = Array.isArray(activities)\r\n    ? activities.filter((a) => {\r\n        const today = new Date();\r\n        const activityDate = new Date(a.startTime);\r\n        return activityDate.toDateString() === today.toDateString();\r\n      }).length\r\n    : 0;\r\n\r\n  const runningJobs =\r\n    automationJobs?.filter((job) => job.status === 'running').length || 0;\r\n\r\n  // Additional real metrics (initialized to 0)\r\n  const equipmentInUse = 0;\r\n  const availableComputers = 3; // Total computers in library\r\n\r\n  return (\r\n    <div\r\n      className={`space-y-8 ${isFullscreen ? 'fixed inset-0 z-50 bg-white dark:bg-gray-900 p-6 overflow-auto' : ''}`}\r\n    >\r\n      {/* Enhanced Welcome Header - Clean & Professional */}\r\n      <div className=\"space-y-4\">\r\n        {/* Real-time Dashboard Toggle */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <h3 className=\"text-lg font-semibold\">Dashboard View</h3>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge\r\n                variant={wsConnected ? 'default' : 'secondary'}\r\n                className=\"bg-green-500\"\r\n              >\r\n                <Wifi className=\"h-3 w-3 mr-1\" />\r\n                Real-time {wsConnected ? 'Active' : 'Inactive'}\r\n              </Badge>\r\n              {notifications.length > 0 && (\r\n                <Badge\r\n                  variant=\"outline\"\r\n                  className=\"text-orange-600 border-orange-600\"\r\n                >\r\n                  <Bell className=\"h-3 w-3 mr-1\" />\r\n                  {notifications.length} notifications\r\n                </Badge>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              variant={showRealTime ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setShowRealTime(true)}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <Activity className=\"h-4 w-4\" />\r\n              Real-time View\r\n            </Button>\r\n            <Button\r\n              variant={!showRealTime ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setShowRealTime(false)}\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <BarChart3 className=\"h-4 w-4\" />\r\n              Standard View\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Welcome Header with Integrated Info */}\r\n        <div className=\"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 dark:from-blue-950/20 dark:via-indigo-950/20 dark:to-purple-950/20 rounded-2xl border border-blue-100 dark:border-blue-900/30 shadow-sm overflow-hidden\">\r\n          {/* Action Toolbar */}\r\n          <div className=\"flex justify-end gap-2 px-6 pt-4 pb-2\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handleExport}\r\n              disabled={isExporting}\r\n              className=\"hover:bg-white/50 dark:hover:bg-slate-800/50\"\r\n              title=\"Export dashboard data\"\r\n            >\r\n              <Download className=\"h-4 w-4\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handlePrint}\r\n              disabled={isPrinting}\r\n              className=\"hover:bg-white/50 dark:hover:bg-slate-800/50\"\r\n              title=\"Print dashboard\"\r\n            >\r\n              <Printer className=\"h-4 w-4\" />\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={toggleFullscreen}\r\n              className=\"hover:bg-white/50 dark:hover:bg-slate-800/50\"\r\n              title={isFullscreen ? 'Exit fullscreen' : 'Enter fullscreen'}\r\n            >\r\n              {isFullscreen ? (\r\n                <Minimize2 className=\"h-4 w-4\" />\r\n              ) : (\r\n                <Maximize2 className=\"h-4 w-4\" />\r\n              )}\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handleEmergencyAlert}\r\n              className=\"text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-950/30\"\r\n              title=\"Emergency alert\"\r\n            >\r\n              <AlertTriangle className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Main Welcome Content */}\r\n          <div className=\"text-center space-y-2 py-6 px-6\">\r\n            <h2 className=\"text-4xl lg:text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent\">\r\n              Good Morning, {user?.username || 'Administrator'}!{' '}\r\n              <span className=\"opacity-70\">≡ƒîà</span>\r\n            </h2>\r\n            <p className=\"text-lg text-slate-600 dark:text-slate-300\">\r\n              Your library is ready for another wonderful day\r\n            </p>\r\n            <div className=\"text-sm text-slate-600 dark:text-slate-400 pt-2\">\r\n              <span className=\"font-medium\">\r\n                {currentTime.toLocaleDateString('en-US', {\r\n                  weekday: 'long',\r\n                  year: 'numeric',\r\n                  month: 'long',\r\n                  day: 'numeric',\r\n                })}\r\n              </span>\r\n              <span className=\"mx-2\">at</span>\r\n              <span className=\"font-mono font-semibold text-blue-600 dark:text-blue-400\">\r\n                {currentTime.toLocaleTimeString([], {\r\n                  hour: '2-digit',\r\n                  minute: '2-digit',\r\n                })}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Conditional Dashboard Rendering */}\r\n      {showRealTime ? (\r\n        <RealTimeDashboard />\r\n      ) : (\r\n        <>\r\n          {/* Main Cozy Layout with Calendar as Focal Point */}\r\n          <div className=\"grid grid-cols-1 xl:grid-cols-12 gap-6\">\r\n            {/* Left Sidebar - Calendar & Quick Stats */}\r\n            <div className=\"xl:col-span-4 space-y-6\">\r\n              {/* Enhanced Calendar Card */}\r\n              <Card className=\"border-0 shadow-xl bg-gradient-to-br from-white to-blue-50 dark:from-card dark:to-blue-950/20 overflow-hidden\">\r\n                <CardHeader className=\"bg-gradient-to-r from-blue-500 to-purple-500 text-white p-6\">\r\n                  <CardTitle className=\"flex items-center gap-2 text-xl\">\r\n                    <CalendarDays className=\"h-6 w-6\" />\r\n                    Library Calendar\r\n                  </CardTitle>\r\n                  <CardDescription className=\"text-blue-100\">\r\n                    Track student activities and notifications\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"p-6\">\r\n                  <NotificationCalendar />\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Enhanced Interactive Status Cards */}\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                <>\r\n                  <Card\r\n                    className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200 dark:border-green-800 hover:shadow-lg transition-all cursor-pointer group\"\r\n                    onClick={() => {\r\n                      if (onTabChange) {\r\n                        onTabChange('students');\r\n                        toast.success('Opening Students tab...');\r\n                      } else {\r\n                        toast.info('View detailed student analytics');\r\n                      }\r\n                    }}\r\n                  >\r\n                    <CardContent className=\"p-4 text-center relative\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          toast.info('View detailed student analytics');\r\n                        }}\r\n                      >\r\n                        <Eye className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Users className=\"h-8 w-8 mx-auto mb-2 text-green-600 dark:text-green-400\" />\r\n                      <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\r\n                        {totalToday}\r\n                      </div>\r\n                      <p className=\"text-xs text-green-600 dark:text-green-400\">\r\n                        Students Today\r\n                      </p>\r\n                      <div className=\"mt-2 text-xs text-green-500\">\r\n                        Click for details\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  <Card\r\n                    className=\"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 border-blue-200 dark:border-blue-800 hover:shadow-lg transition-all cursor-pointer group\"\r\n                    onClick={() => {\r\n                      if (onTabChange) {\r\n                        onTabChange('scan');\r\n                        toast.success('Opening Activity Management...');\r\n                      } else {\r\n                        toast.info('View active sessions management');\r\n                      }\r\n                    }}\r\n                  >\r\n                    <CardContent className=\"p-4 text-center relative\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          toast.info('View active sessions management');\r\n                        }}\r\n                      >\r\n                        <Settings className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Monitor className=\"h-8 w-8 mx-auto mb-2 text-blue-600 dark:text-blue-400\" />\r\n                      <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">\r\n                        {activeSessions}\r\n                      </div>\r\n                      <p className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n                        Active Now\r\n                      </p>\r\n                      <div className=\"mt-2 text-xs text-blue-500\">\r\n                        Click to manage\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  <Card\r\n                    className=\"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-950/20 dark:to-pink-950/20 border-purple-200 dark:border-purple-800 hover:shadow-lg transition-all cursor-pointer group\"\r\n                    onClick={() => {\r\n                      if (onTabChange) {\r\n                        onTabChange('automation');\r\n                        toast.success('Opening Automation tab...');\r\n                      } else {\r\n                        toast.info('View automation job status');\r\n                      }\r\n                    }}\r\n                  >\r\n                    <CardContent className=\"p-4 text-center relative\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          toast.info('View automation job status');\r\n                        }}\r\n                      >\r\n                        <BarChart3 className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Activity className=\"h-8 w-8 mx-auto mb-2 text-purple-600 dark:text-purple-400\" />\r\n                      <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">\r\n                        {runningJobs}\r\n                      </div>\r\n                      <p className=\"text-xs text-purple-600 dark:text-purple-400\">\r\n                        Automation\r\n                      </p>\r\n                      <div className=\"mt-2 text-xs text-purple-500\">\r\n                        Click for status\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n\r\n                  <Card\r\n                    className=\"bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 border-amber-200 dark:border-amber-800 hover:shadow-lg transition-all cursor-pointer group\"\r\n                    onClick={() => {\r\n                      toast.info(\r\n                        `System Status:\\nΓ£à Backend: ${connectedToBackend ? 'Connected' : 'Disconnected'}\\nΓ£à Internet: ${isOnline ? 'Online' : 'Offline'}\\nΓ£à Database: Healthy\\nΓ£à Google Sheets: Connected`,\r\n                        {\r\n                          duration: 5000,\r\n                        }\r\n                      );\r\n                    }}\r\n                  >\r\n                    <CardContent className=\"p-4 text-center relative\">\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          toast.info('View system health details');\r\n                        }}\r\n                      >\r\n                        <Shield className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      {connectedToBackend ? (\r\n                        <CheckCircle className=\"h-8 w-8 mx-auto mb-2 text-green-600 dark:text-green-400\" />\r\n                      ) : (\r\n                        <AlertCircle className=\"h-8 w-8 mx-auto mb-2 text-red-600 dark:text-red-400\" />\r\n                      )}\r\n                      <div className=\"text-lg font-bold text-amber-700 dark:text-amber-300\">\r\n                        {connectedToBackend ? 'Online' : 'Offline'}\r\n                      </div>\r\n                      <p className=\"text-xs text-amber-600 dark:text-amber-400\">\r\n                        System\r\n                      </p>\r\n                      <div className=\"mt-2 text-xs text-amber-500\">\r\n                        Click for status\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                </>\r\n              </div>\r\n\r\n              {/* Equipment Status Summary */}\r\n              <Card className=\"bg-gradient-to-br from-slate-50 to-gray-50 dark:from-slate-950/20 dark:to-gray-950/20 border-slate-200 dark:border-slate-800\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <CardTitle className=\"text-sm font-medium flex items-center justify-between\">\r\n                    Equipment Status\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={() => toast.info('View equipment management')}\r\n                    >\r\n                      <ExternalLink className=\"h-3 w-3\" />\r\n                    </Button>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"pt-0\">\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2 text-center\">\r\n                    <div className=\"p-2 rounded bg-blue-50 dark:bg-blue-950/20\">\r\n                      <Monitor className=\"h-4 w-4 mx-auto mb-1 text-blue-600\" />\r\n                      <div className=\"text-lg font-bold text-blue-700\">\r\n                        {availableComputers - equipmentInUse}\r\n                      </div>\r\n                      <div className=\"text-xs text-blue-500\">PCs Free</div>\r\n                    </div>\r\n                    <div className=\"p-2 rounded bg-green-50 dark:bg-green-950/20\">\r\n                      <div className=\"h-4 w-4 mx-auto mb-1 bg-green-600 rounded-full\" />\r\n                      <div className=\"text-lg font-bold text-green-700\">1</div>\r\n                      <div className=\"text-xs text-green-500\">AVR Free</div>\r\n                    </div>\r\n                    <div className=\"p-2 rounded bg-purple-50 dark:bg-purple-950/20\">\r\n                      <div className=\"h-4 w-4 mx-auto mb-1 bg-purple-600 rounded-full\" />\r\n                      <div className=\"text-lg font-bold text-purple-700\">1</div>\r\n                      <div className=\"text-xs text-purple-500\">Rec. Free</div>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Center Content - Recent Activity */}\r\n            <div className=\"xl:col-span-5 space-y-6\">\r\n              <Card className=\"border-0 shadow-lg bg-white/80 dark:bg-card/80 backdrop-blur-sm\">\r\n                <CardHeader className=\"bg-gradient-to-r from-indigo-500 to-blue-500 text-white p-6\">\r\n                  <CardTitle className=\"flex items-center gap-2 text-xl\">\r\n                    <Clock className=\"h-6 w-6\" />\r\n                    Recent Activity\r\n                  </CardTitle>\r\n                  <CardDescription className=\"text-indigo-100\">\r\n                    Latest student activities and system events\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"p-6\">\r\n                  {timelineLoading ? (\r\n                    <div className=\"text-center py-12\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n                      <p className=\"text-muted-foreground\">\r\n                        Loading recent activities...\r\n                      </p>\r\n                    </div>\r\n                  ) : timeline &&\r\n                    Array.isArray(timeline) &&\r\n                    timeline.length > 0 ? (\r\n                    <div className=\"space-y-4\">\r\n                      {(timeline as any[]).map((activity: any, _) => (\r\n                        <div\r\n                          key={activity.id}\r\n                          className=\"flex items-start space-x-4 p-4 rounded-lg bg-gradient-to-r from-gray-50 to-blue-50/30 dark:from-gray-800/50 dark:to-blue-900/20 border border-gray-200 dark:border-gray-700 shadow-sm\"\r\n                        >\r\n                          <div className=\"flex-shrink-0 mt-1\">\r\n                            <div\r\n                              className={`h-3 w-3 rounded-full shadow-sm ${activity.status === 'active' ? 'bg-green-500 shadow-green-500/50' : activity.status === 'completed' ? 'bg-blue-500 shadow-blue-500/50' : activity.status === 'expired' ? 'bg-yellow-500 shadow-yellow-500/50' : 'bg-gray-500 shadow-gray-500/50'}`}\r\n                            ></div>\r\n                          </div>\r\n                          <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"font-medium text-foreground dark:text-foreground\">\r\n                              {activity.studentName}\r\n                            </p>\r\n                            <p className=\"text-sm text-muted-foreground dark:text-muted-foreground/80\">\r\n                              {activity.activityType} ΓÇó{' '}\r\n                              {activity.equipmentId || 'No equipment'}\r\n                            </p>\r\n                          </div>\r\n                          <div className=\"flex-shrink-0 text-xs text-muted-foreground bg-white dark:bg-gray-800 px-2 py-1 rounded-full\">\r\n                            {new Date(activity.startTime).toLocaleTimeString()}\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-12\">\r\n                      <div className=\"text-6xl mb-4 opacity-70\">≡ƒôÜ</div>\r\n                      <p className=\"text-muted-foreground text-lg\">\r\n                        No recent activity\r\n                      </p>\r\n                      <p className=\"text-muted-foreground/60 text-sm mt-2\">\r\n                        Your library is quiet today\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Right Sidebar - System Status & Quick Actions */}\r\n            <div className=\"xl:col-span-3 space-y-6\">\r\n              {/* System Health */}\r\n              <Card className=\"border-0 shadow-lg bg-white/80 dark:bg-card/80 backdrop-blur-sm\">\r\n                <CardHeader className=\"bg-gradient-to-r from-green-500 to-teal-500 text-white p-6\">\r\n                  <CardTitle className=\"text-xl flex items-center gap-2\">\r\n                    <Wifi className=\"h-6 w-6\" />\r\n                    System Health\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"p-6 space-y-4\">\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-center justify-between p-3 rounded-lg bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800\">\r\n                      <span className=\"font-medium\">Internet</span>\r\n                      <Badge\r\n                        variant={isOnline ? 'default' : 'destructive'}\r\n                        className=\"bg-green-500 hover:bg-green-600\"\r\n                      >\r\n                        {isOnline ? 'Connected' : 'Offline'}\r\n                      </Badge>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between p-3 rounded-lg bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800\">\r\n                      <span className=\"font-medium\">Backend</span>\r\n                      <Badge\r\n                        variant={connectedToBackend ? 'default' : 'destructive'}\r\n                        className=\"bg-blue-500 hover:bg-blue-600\"\r\n                      >\r\n                        {connectedToBackend ? 'Connected' : 'Offline'}\r\n                      </Badge>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-between p-3 rounded-lg bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-800\">\r\n                      <span className=\"font-medium\">Google Sheets</span>\r\n                      <Badge\r\n                        variant=\"default\"\r\n                        className=\"bg-purple-500 hover:bg-purple-600\"\r\n                      >\r\n                        Connected\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {healthData &&\r\n                    typeof healthData === 'object' &&\r\n                    healthData !== null &&\r\n                    'timestamp' in healthData && (\r\n                      <div className=\"text-xs text-muted-foreground text-center pt-2 border-t\">\r\n                        Last check:{' '}\r\n                        {new Date(\r\n                          typeof healthData.timestamp === 'string' ||\r\n                          typeof healthData.timestamp === 'number'\r\n                            ? healthData.timestamp\r\n                            : new Date().toISOString()\r\n                        ).toLocaleTimeString()}\r\n                      </div>\r\n                    )}\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Enhanced Quick Actions */}\r\n              <Card className=\"border-0 shadow-lg bg-white/80 dark:bg-card/80 backdrop-blur-sm\">\r\n                <CardHeader className=\"bg-gradient-to-r from-orange-500 to-red-500 text-white p-6\">\r\n                  <CardTitle className=\"text-xl flex items-center justify-between\">\r\n                    Quick Actions\r\n                    <div className=\"flex gap-1\">\r\n                      <Button\r\n                        variant=\"secondary\"\r\n                        size=\"sm\"\r\n                        onClick={handleManualSessionEntry}\r\n                        className=\"bg-white/20 hover:bg-white/30 text-white border-white/30\"\r\n                      >\r\n                        <Edit className=\"h-3 w-3 mr-1\" />\r\n                        Manual Entry\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"secondary\"\r\n                        size=\"sm\"\r\n                        onClick={handleBulkCheckout}\r\n                        className=\"bg-white/20 hover:bg-white/30 text-white border-white/30\"\r\n                      >\r\n                        <Users className=\"h-3 w-3 mr-1\" />\r\n                        Bulk Checkout\r\n                      </Button>\r\n                    </div>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"p-6\">\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4\">\r\n                    <Button\r\n                      className=\"h-16 flex-col bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg hover:shadow-xl transition-all\"\r\n                      onClick={handleAddStudent}\r\n                    >\r\n                      <Users className=\"h-5 w-5 mb-1\" />\r\n                      <span className=\"text-xs font-medium\">Add Student</span>\r\n                    </Button>\r\n                    <Button\r\n                      className=\"h-16 flex-col bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg hover:shadow-xl transition-all\"\r\n                      onClick={handleStartSession}\r\n                      disabled={isStartingSession}\r\n                    >\r\n                      <Monitor className=\"h-5 w-5 mb-1\" />\r\n                      <span className=\"text-xs font-medium\">\r\n                        {isStartingSession ? 'Starting...' : 'Start Session'}\r\n                      </span>\r\n                    </Button>\r\n                    <Button\r\n                      className=\"h-16 flex-col bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg hover:shadow-xl transition-all\"\r\n                      onClick={handleViewReport}\r\n                      disabled={isViewingReport}\r\n                    >\r\n                      <TrendingUp className=\"h-5 w-5 mb-1\" />\r\n                      <span className=\"text-xs font-medium\">\r\n                        {isViewingReport ? 'Generating...' : 'View Report'}\r\n                      </span>\r\n                    </Button>\r\n                    <Button\r\n                      className=\"h-16 flex-col bg-gradient-to-r from-orange-500 to-orange-600 text-white shadow-lg hover:shadow-xl transition-all\"\r\n                      onClick={handleRunBackup}\r\n                      disabled={isRunningBackup}\r\n                    >\r\n                      <Activity className=\"h-5 w-5 mb-1\" />\r\n                      <span className=\"text-xs font-medium\">\r\n                        {isRunningBackup ? 'Running...' : 'Run Backup'}\r\n                      </span>\r\n                    </Button>\r\n                  </div>\r\n\r\n                  {/* Additional Quick Actions */}\r\n                  <div className=\"border-t pt-4\">\r\n                    <p className=\"text-sm font-medium text-muted-foreground mb-3\">\r\n                      Additional Actions\r\n                    </p>\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() =>\r\n                          toast.info(\r\n                            'Daily Summary feature - generates end-of-day report'\r\n                          )\r\n                        }\r\n                        className=\"h-10 flex-col\"\r\n                      >\r\n                        <FileText className=\"h-3 w-3 mb-1\" />\r\n                        <span className=\"text-xs\">Daily Summary</span>\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() =>\r\n                          toast.info(\r\n                            'System Check feature - runs health diagnostics'\r\n                          )\r\n                        }\r\n                        className=\"h-10 flex-col\"\r\n                      >\r\n                        <Shield className=\"h-3 w-3 mb-1\" />\r\n                        <span className=\"text-xs\">System Check</span>\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={() =>\r\n                          toast.info(\r\n                            'Maintenance Mode - schedule system maintenance'\r\n                          )\r\n                        }\r\n                        className=\"h-10 flex-col\"\r\n                      >\r\n                        <Settings className=\"h-3 w-3 mb-1\" />\r\n                        <span className=\"text-xs\">Maintenance</span>\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Add Student Dialog */}\r\n      <AddStudentDialog\r\n        open={isAddStudentDialogOpen}\r\n        onOpenChange={setIsAddStudentDialogOpen}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DashboardOverview;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\DocumentationDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3922,3925],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3922,3925],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  CheckCircle,\r\n  AlertCircle,\r\n  XCircle,\r\n  RefreshCw,\r\n  FileText,\r\n  GitBranch,\r\n  Database,\r\n  TestTube,\r\n  Package,\r\n  Clock,\r\n  Users,\r\n  Activity,\r\n} from 'lucide-react';\r\nimport { utilitiesApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\nimport { context7, type DocumentationUpdate } from '@/services/context7';\r\nimport { useDocumentationWebSocket } from '@/hooks/useDocumentationWebSocket';\r\nimport {\r\n  documentationVersionControl,\r\n  type ConflictInfo,\r\n} from '@/services/documentationVersionControl';\r\n\r\ninterface DocumentationInfo {\r\n  version: string;\r\n  lastUpdated: string;\r\n  lastCommitHash?: string;\r\n  environment: string;\r\n  features: {\r\n    backend: {\r\n      tests: number;\r\n      apiEndpoints: number;\r\n      services: number;\r\n      databaseTables: number;\r\n    };\r\n    frontend: {\r\n      tests: number;\r\n      components: number;\r\n      pages: number;\r\n      assets: number;\r\n    };\r\n  };\r\n  documentation: {\r\n    claudeMd: {\r\n      exists: boolean;\r\n      lastModified: string;\r\n    };\r\n    readmeMd: {\r\n      exists: boolean;\r\n      lastModified: string;\r\n    };\r\n    apiDocs: {\r\n      exists: boolean;\r\n      lastModified: string;\r\n    };\r\n  };\r\n  health: {\r\n    status: 'healthy' | 'warning' | 'error';\r\n    checks: {\r\n      documentation: boolean;\r\n      tests: boolean;\r\n      builds: boolean;\r\n    };\r\n  };\r\n}\r\n\r\ninterface HealthCheck {\r\n  status: string;\r\n  checks: Record<string, boolean>;\r\n  lastChecked: string;\r\n}\r\n\r\nexport function DocumentationDashboard() {\r\n  const [docsInfo, setDocsInfo] = useState<DocumentationInfo | null>(null);\r\n  const [healthCheck, setHealthCheck] = useState<HealthCheck | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [context7Service] = useState(() => context7);\r\n  const [versionControl] = useState(() => documentationVersionControl);\r\n  const [realTimeUpdates, setRealTimeUpdates] = useState(0);\r\n  const [lastSyncTime, setLastSyncTime] = useState<Date | null>(null);\r\n\r\n  // Local state for updates and conflicts\r\n  const [updates, setUpdates] = useState<DocumentationUpdate[]>([]);\r\n  const [conflicts, setConflicts] = useState<ConflictInfo[]>([]);\r\n  const [syncStatus, _setSyncStatus] = useState<{\r\n    status: string;\r\n    message?: string;\r\n  } | null>(null);\r\n\r\n  // Initialize WebSocket for real-time documentation updates\r\n  const { isConnected } = useDocumentationWebSocket({\r\n    autoSubscribe: true,\r\n    enableNotifications: true,\r\n    conflictResolution: 'manual',\r\n  });\r\n\r\n  // Helper functions for managing updates and conflicts\r\n  const clearUpdates = useCallback(() => {\r\n    setUpdates([]);\r\n  }, []);\r\n\r\n  const handleConflict = useCallback(\r\n    async (conflictId: string, resolution: string) => {\r\n      try {\r\n        const success = await versionControl.resolveConflict(conflictId, {\r\n          strategy: resolution as\r\n            | 'accept_current'\r\n            | 'accept_incoming'\r\n            | 'merge_manual',\r\n        });\r\n\r\n        if (success) {\r\n          setConflicts((prev) => prev.filter((c) => c.id !== conflictId));\r\n          toast.success('Conflict resolved successfully');\r\n        } else {\r\n          toast.error('Failed to resolve conflict');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error resolving conflict:', error);\r\n        toast.error('Failed to resolve conflict');\r\n      }\r\n    },\r\n    [versionControl]\r\n  );\r\n\r\n  // Handle real-time documentation updates\r\n  const handleDocumentationUpdate = useCallback(\r\n    async (update: any) => {\r\n      try {\r\n        // Apply the update through Context7 service\r\n        await context7Service.applyUpdate(update);\r\n\r\n        // Track the change in version control\r\n        await versionControl.trackChange(update);\r\n\r\n        // Update local state\r\n        setRealTimeUpdates((prev) => prev + 1);\r\n        setLastSyncTime(new Date());\r\n\r\n        // Refresh documentation info to reflect changes\r\n        await fetchDocumentationInfo();\r\n\r\n        toast.success(\r\n          `Documentation updated: ${update.description || update.path}`\r\n        );\r\n      } catch (error) {\r\n        console.error('Failed to handle documentation update:', error);\r\n        toast.error('Failed to apply documentation update');\r\n      }\r\n    },\r\n    [context7Service, versionControl]\r\n  );\r\n\r\n  // Initialize Context7 service\r\n  useEffect(() => {\r\n    const initializeContext7 = async () => {\r\n      try {\r\n        await context7Service.initialize({\r\n          enableRealTime: true,\r\n          autoSync: true,\r\n          syncInterval: 30000, // 30 seconds\r\n          conflictResolution: 'manual',\r\n          enableVersioning: true,\r\n          enableNotifications: true,\r\n        });\r\n\r\n        // Subscribe to documentation updates\r\n        context7Service.subscribe(\r\n          'documentation-dashboard',\r\n          handleDocumentationUpdate\r\n        );\r\n\r\n        // Load initial documentation state\r\n        const initialState = await context7Service.getState();\r\n        if (initialState) {\r\n          setDocsInfo(initialState as unknown as DocumentationInfo);\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to initialize Context7 service:', error);\r\n        toast.error('Failed to initialize real-time documentation updates');\r\n      }\r\n    };\r\n\r\n    initializeContext7();\r\n\r\n    return () => {\r\n      context7Service.unsubscribe('documentation-dashboard');\r\n    };\r\n  }, [context7Service, handleDocumentationUpdate]);\r\n\r\n  const fetchDocumentationInfo = async () => {\r\n    try {\r\n      const response = await utilitiesApi.getDocumentation();\r\n      const docsData = response.data as DocumentationInfo;\r\n      setDocsInfo(docsData);\r\n      setHealthCheck({\r\n        status: docsData.health.status,\r\n        checks: docsData.health.checks,\r\n        lastChecked: docsData.lastUpdated,\r\n      });\r\n    } catch (error) {\r\n      toast.error('Failed to load documentation information');\r\n    }\r\n  };\r\n\r\n  const refreshDocumentation = async () => {\r\n    setRefreshing(true);\r\n    try {\r\n      const response = await utilitiesApi.refreshDocumentation();\r\n      const docsData = response.data as DocumentationInfo;\r\n      setDocsInfo(docsData);\r\n      setHealthCheck({\r\n        status: docsData.health.status,\r\n        checks: docsData.health.checks,\r\n        lastChecked: docsData.lastUpdated,\r\n      });\r\n      toast.success('Documentation refreshed successfully');\r\n    } catch (error) {\r\n      toast.error('Failed to refresh documentation');\r\n    } finally {\r\n      setRefreshing(false);\r\n    }\r\n  };\r\n\r\n  const formatLastUpdated = (dateString: string) => {\r\n    return new Date(dateString).toLocaleString();\r\n  };\r\n\r\n  const getHealthIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\r\n      case 'warning':\r\n        return <AlertCircle className=\"h-5 w-5 text-yellow-600\" />;\r\n      case 'error':\r\n        return <XCircle className=\"h-5 w-5 text-red-600\" />;\r\n      default:\r\n        return <CheckCircle className=\"h-5 w-5 text-gray-600\" />;\r\n    }\r\n  };\r\n\r\n  const getHealthColor = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return 'bg-green-100 text-green-800 border-green-200';\r\n      case 'warning':\r\n        return 'bg-yellow-100 text-yellow-800 border-yellow-200';\r\n      case 'error':\r\n        return 'bg-red-100 text-red-800 border-red-200';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 border-gray-200';\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDocumentationInfo();\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\" />\r\n        <span className=\"ml-2 text-sm text-gray-600\">\r\n          Loading documentation...\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!docsInfo) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <AlertCircle className=\"h-8 w-8 text-red-600\" />\r\n        <span className=\"ml-2 text-sm text-gray-600\">\r\n          Failed to load documentation\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalEndpoints = docsInfo.features.backend.apiEndpoints;\r\n  const totalServices = docsInfo.features.backend.services;\r\n  const totalTables = docsInfo.features.backend.databaseTables;\r\n  const allDocsExist =\r\n    docsInfo.documentation.claudeMd.exists &&\r\n    docsInfo.documentation.readmeMd.exists;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h2 className=\"text-3xl font-bold\">Documentation Dashboard</h2>\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={refreshDocumentation}\r\n          disabled={refreshing}\r\n          className=\"flex items-center gap-2\"\r\n        >\r\n          {refreshing ? (\r\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600\" />\r\n          ) : (\r\n            <RefreshCw className=\"h-4 w-4\" />\r\n          )}\r\n          Refresh\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Health Status */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            {getHealthIcon(healthCheck?.status || 'unknown')}\r\n            System Health\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Last checked:{' '}\r\n            {healthCheck ? formatLastUpdated(healthCheck.lastChecked) : 'Never'}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div\r\n            className={`rounded-lg p-4 border ${getHealthColor(healthCheck?.status || 'unknown')}`}\r\n          >\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                {healthCheck?.checks.documentation ? (\r\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                ) : (\r\n                  <XCircle className=\"h-4 w-4 text-red-600\" />\r\n                )}\r\n                <span className=\"text-sm font-medium\">Documentation Files</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                {healthCheck?.checks.tests ? (\r\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                ) : (\r\n                  <XCircle className=\"h-4 w-4 text-red-600\" />\r\n                )}\r\n                <span className=\"text-sm font-medium\">Test Status</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                {healthCheck?.checks.builds ? (\r\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                ) : (\r\n                  <XCircle className=\"h-4 w-4 text-red-600\" />\r\n                )}\r\n                <span className=\"text-sm font-medium\">Build Status</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-time Documentation Status */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Activity className=\"h-5 w-5 text-blue-600\" />\r\n            Real-time Documentation Status\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Context7 integration and live update monitoring\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full ${isConnected ? 'bg-green-500' : 'bg-red-500'}`}\r\n              />\r\n              <div>\r\n                <div className=\"text-sm font-medium\">WebSocket</div>\r\n                <div className=\"text-xs text-gray-500\">\r\n                  {isConnected ? 'Connected' : 'Disconnected'}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\r\n              <Clock className=\"h-4 w-4 text-blue-600\" />\r\n              <div>\r\n                <div className=\"text-sm font-medium\">{realTimeUpdates}</div>\r\n                <div className=\"text-xs text-gray-500\">Live Updates</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\r\n              <Users className=\"h-4 w-4 text-purple-600\" />\r\n              <div>\r\n                <div className=\"text-sm font-medium\">{conflicts.length}</div>\r\n                <div className=\"text-xs text-gray-500\">Conflicts</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\r\n              <RefreshCw className=\"h-4 w-4 text-green-600\" />\r\n              <div>\r\n                <div className=\"text-sm font-medium\">\r\n                  {lastSyncTime\r\n                    ? formatLastUpdated(lastSyncTime.toISOString())\r\n                    : 'Never'}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Last Sync</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Sync Status Indicator */}\r\n          {syncStatus && (\r\n            <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Activity className=\"h-4 w-4 text-blue-600\" />\r\n                <span className=\"text-sm font-medium text-blue-800\">\r\n                  Sync Status: {syncStatus.status}\r\n                </span>\r\n              </div>\r\n              {syncStatus.message && (\r\n                <p className=\"text-xs text-blue-600 mt-1\">\r\n                  {syncStatus.message}\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Recent Updates */}\r\n          {updates.length > 0 && (\r\n            <div className=\"mt-4\">\r\n              <h4 className=\"text-sm font-medium mb-2\">Recent Updates</h4>\r\n              <div className=\"space-y-2 max-h-32 overflow-y-auto\">\r\n                {updates\r\n                  .slice(0, 3)\r\n                  .map((update: DocumentationUpdate, index: number) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"text-xs p-2 bg-green-50 border border-green-200 rounded\"\r\n                    >\r\n                      <div className=\"font-medium\">\r\n                        {update.changes[0]?.file || 'Multiple files'}\r\n                      </div>\r\n                      <div className=\"text-gray-600\">\r\n                        {update.type.replace('_', ' ')}\r\n                      </div>\r\n                      <div className=\"text-gray-500\">\r\n                        {formatLastUpdated(update.timestamp)}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n              </div>\r\n              {updates.length > 3 && (\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  className=\"mt-2\"\r\n                  onClick={clearUpdates}\r\n                >\r\n                  Clear Updates ({updates.length})\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Conflicts Alert */}\r\n          {conflicts.length > 0 && (\r\n            <div className=\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <AlertCircle className=\"h-4 w-4 text-yellow-600\" />\r\n                <span className=\"text-sm font-medium text-yellow-800\">\r\n                  {conflicts.length} Documentation Conflict\r\n                  {conflicts.length > 1 ? 's' : ''} Detected\r\n                </span>\r\n              </div>\r\n              <div className=\"mt-2 space-y-1\">\r\n                {conflicts.map((conflict: ConflictInfo, index: number) => (\r\n                  <div key={index} className=\"text-xs text-yellow-700\">\r\n                    {conflict.file}: {conflict.conflictType} conflict\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"mt-2\"\r\n                onClick={() =>\r\n                  conflicts.forEach((conflict: ConflictInfo) =>\r\n                    handleConflict(conflict.id, 'accept_incoming')\r\n                  )\r\n                }\r\n              >\r\n                Resolve All Conflicts\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        {/* Version & Environment Info */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Package className=\"h-5 w-5\" />\r\n              System Information\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">Version:</span>\r\n              <Badge variant=\"outline\">{docsInfo.version}</Badge>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">Environment:</span>\r\n              <Badge\r\n                variant={\r\n                  docsInfo.environment === 'production'\r\n                    ? 'default'\r\n                    : 'secondary'\r\n                }\r\n              >\r\n                {docsInfo.environment}\r\n              </Badge>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">Last Updated:</span>\r\n              <span className=\"text-xs text-gray-500\">\r\n                {formatLastUpdated(docsInfo.lastUpdated)}\r\n              </span>\r\n            </div>\r\n            {docsInfo.lastCommitHash && (\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"text-sm font-medium\">Git Commit:</span>\r\n                <Badge variant=\"outline\" className=\"font-mono\">\r\n                  {docsInfo.lastCommitHash}\r\n                </Badge>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Documentation Files Status */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <FileText className=\"h-5 w-5\" />\r\n              Documentation Files\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">CLAUDE.md:</span>\r\n              <Badge\r\n                variant={\r\n                  docsInfo.documentation.claudeMd.exists\r\n                    ? 'default'\r\n                    : 'destructive'\r\n                }\r\n              >\r\n                {docsInfo.documentation.claudeMd.exists ? 'Present' : 'Missing'}\r\n              </Badge>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">README.md:</span>\r\n              <Badge\r\n                variant={\r\n                  docsInfo.documentation.readmeMd.exists\r\n                    ? 'default'\r\n                    : 'destructive'\r\n                }\r\n              >\r\n                {docsInfo.documentation.readmeMd.exists ? 'Present' : 'Missing'}\r\n              </Badge>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm font-medium\">API Docs:</span>\r\n              <Badge\r\n                variant={\r\n                  docsInfo.documentation.apiDocs.exists\r\n                    ? 'default'\r\n                    : 'secondary'\r\n                }\r\n              >\r\n                {docsInfo.documentation.apiDocs.exists ? 'Present' : 'Optional'}\r\n              </Badge>\r\n            </div>\r\n            <div className=\"pt-2 border-t\">\r\n              <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                <FileText className=\"h-4 w-4\" />\r\n                <span>\r\n                  {allDocsExist\r\n                    ? 'All critical documentation files are present and up to date'\r\n                    : 'Some documentation files may be missing or outdated'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Features Overview */}\r\n      <Tabs defaultValue=\"backend\" className=\"w-full\">\r\n        <TabsList className=\"grid w-full grid-cols-2\">\r\n          <TabsTrigger value=\"backend\">Backend Features</TabsTrigger>\r\n          <TabsTrigger value=\"frontend\">Frontend Features</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"backend\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Database className=\"h-8 w-8 mx-auto mb-2 text-blue-600\" />\r\n                <div className=\"text-2xl font-bold\">{totalTables}</div>\r\n                <div className=\"text-xs text-gray-500\">Database Tables</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <TestTube className=\"h-8 w-8 mx-auto mb-2 text-green-600\" />\r\n                <div className=\"text-2xl font-bold\">\r\n                  {docsInfo.features.backend.tests}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Backend Tests</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Package className=\"h-8 w-8 mx-auto mb-2 text-purple-600\" />\r\n                <div className=\"text-2xl font-bold\">{totalServices}</div>\r\n                <div className=\"text-xs text-gray-500\">Services</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <GitBranch className=\"h-8 w-8 mx-auto mb-2 text-orange-600\" />\r\n                <div className=\"text-2xl font-bold\">{totalEndpoints}</div>\r\n                <div className=\"text-xs text-gray-500\">API Endpoints</div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"frontend\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <TestTube className=\"h-8 w-8 mx-auto mb-2 text-green-600\" />\r\n                <div className=\"text-2xl font-bold\">\r\n                  {docsInfo.features.frontend.tests}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Frontend Tests</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Package className=\"h-8 w-8 mx-auto mb-2 text-blue-600\" />\r\n                <div className=\"text-2xl font-bold\">\r\n                  {docsInfo.features.frontend.components}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Components</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <FileText className=\"h-8 w-8 mx-auto mb-2 text-indigo-600\" />\r\n                <div className=\"text-2xl font-bold\">\r\n                  {docsInfo.features.frontend.pages}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Pages</div>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardContent className=\"p-4 text-center\">\r\n                <Package className=\"h-8 w-8 mx-auto mb-2 text-gray-600\" />\r\n                <div className=\"text-2xl font-bold\">\r\n                  {docsInfo.features.frontend.assets}\r\n                </div>\r\n                <div className=\"text-xs text-gray-500\">Assets</div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Quick Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Quick Actions</CardTitle>\r\n          <CardDescription>\r\n            Common documentation-related operations\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            <Button variant=\"outline\" onClick={refreshDocumentation}>\r\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n              Refresh Documentation\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() =>\r\n                window.open('/Docs/API_DOCUMENTATION.md', '_blank')\r\n              }\r\n            >\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              View API Docs\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => window.open('/CLAUDE.md', '_blank')}\r\n            >\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              View CLAUDE.md\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => window.open('/README.md', '_blank')}\r\n            >\r\n              <FileText className=\"h-4 w-4 mr-2\" />\r\n              View README.md\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\EnhancedDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":92,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2228,2231],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2228,2231],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  TrendingUp,\r\n  Users,\r\n  BookOpen,\r\n  Clock,\r\n  Activity,\r\n  Calendar,\r\n  BarChart3,\r\n  PieChart,\r\n  RefreshCw,\r\n} from 'lucide-react';\r\nimport { reportsApi } from '@/lib/api';\r\n\r\ninterface DashboardStats {\r\n  today: {\r\n    checkIns: number;\r\n    uniqueStudents: number;\r\n    booksCirculated: number;\r\n    activeNow: number;\r\n  };\r\n  thisWeek: {\r\n    totalVisits: number;\r\n    averageDaily: number;\r\n    topBooks: Array<{ title: string; count: number }>;\r\n    topCategories: Array<{ name: string; count: number }>;\r\n  };\r\n  trends: {\r\n    visitsTrend: number; // percentage change\r\n    booksTrend: number;\r\n    studentsTrend: number;\r\n  };\r\n}\r\n\r\n// Add type definitions for API responses\r\ninterface DailyStats {\r\n  date: string;\r\n  summary: {\r\n    checkIns: number;\r\n    checkOuts: number;\r\n    uniqueStudents: number;\r\n    booksCirculated: number;\r\n    avgDuration: number;\r\n    peakHour: string;\r\n  };\r\n  details: {\r\n    bookCheckouts: number;\r\n    bookReturns: number;\r\n    computerUse: number;\r\n    gamingSessions: number;\r\n    avrSessions: number;\r\n  };\r\n  gradeLevelBreakdown: {\r\n    [key: string]: number;\r\n  };\r\n}\r\n\r\ninterface WeeklyStats {\r\n  weekStart: string;\r\n  weekEnd: string;\r\n  summary: {\r\n    totalVisits: number;\r\n    uniqueStudents: number;\r\n    totalCheckouts: number;\r\n  };\r\n  popularBooks: Array<{ title: string; count: number }>;\r\n  popularCategories: Array<{ name: string; count: number }>;\r\n  dailyBreakdown: Array<{\r\n    date: string;\r\n    dayOfWeek: string;\r\n    visits: number;\r\n    checkouts: number;\r\n    uniqueStudents: number;\r\n  }>;\r\n}\r\n\r\nexport default function EnhancedDashboard() {\r\n  const [stats, setStats] = useState<DashboardStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [lastUpdated, setLastUpdated] = useState<Date>(new Date());\r\n\r\n  const calculateTrend = useCallback((dailyBreakdown: any[]) => {\r\n    if (!dailyBreakdown || dailyBreakdown.length < 2) {\r\n      return 0;\r\n    }\r\n    const recent =\r\n      dailyBreakdown.slice(-3).reduce((sum, day) => sum + day.visits, 0) / 3;\r\n    const previous =\r\n      dailyBreakdown.slice(0, 3).reduce((sum, day) => sum + day.visits, 0) / 3;\r\n    return previous > 0\r\n      ? Math.round(((recent - previous) / previous) * 100)\r\n      : 0;\r\n  }, []);\r\n\r\n  const fetchDashboardData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      // Fetch today's report\r\n      const dailyResponse = await reportsApi.getDailyReport();\r\n\r\n      // Fetch weekly report\r\n      const weeklyResponse = await reportsApi.getWeeklyReport();\r\n\r\n      if (dailyResponse.success && weeklyResponse.success) {\r\n        const dailyData = dailyResponse.data as DailyStats;\r\n        const weeklyData = weeklyResponse.data as WeeklyStats;\r\n\r\n        setStats({\r\n          today: {\r\n            checkIns: dailyData.summary.checkIns,\r\n            uniqueStudents: dailyData.summary.uniqueStudents,\r\n            booksCirculated: dailyData.summary.booksCirculated,\r\n            activeNow: dailyData.summary.checkIns - dailyData.summary.checkOuts,\r\n          },\r\n          thisWeek: {\r\n            totalVisits: weeklyData.summary.totalVisits,\r\n            averageDaily: Math.round(weeklyData.summary.totalVisits / 7),\r\n            topBooks: weeklyData.popularBooks?.slice(0, 5) || [],\r\n            topCategories: weeklyData.popularCategories?.slice(0, 5) || [],\r\n          },\r\n          trends: {\r\n            visitsTrend: calculateTrend(weeklyData.dailyBreakdown),\r\n            booksTrend: 0, // Can be calculated if historical data available\r\n            studentsTrend: 0,\r\n          },\r\n        });\r\n        setLastUpdated(new Date());\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch dashboard data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [calculateTrend]);\r\n\r\n  useEffect(() => {\r\n    fetchDashboardData();\r\n    // Auto-refresh every 5 minutes\r\n    const interval = setInterval(fetchDashboardData, 5 * 60 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [fetchDashboardData]);\r\n\r\n  const getTrendColor = (trend: number) => {\r\n    if (trend > 0) {\r\n      return 'text-green-500';\r\n    }\r\n    if (trend < 0) {\r\n      return 'text-red-500';\r\n    }\r\n    return 'text-gray-500';\r\n  };\r\n\r\n  const getTrendIcon = (trend: number) => {\r\n    if (trend > 0) {\r\n      return 'Γåæ';\r\n    }\r\n    if (trend < 0) {\r\n      return 'Γåô';\r\n    }\r\n    return 'ΓåÆ';\r\n  };\r\n\r\n  if (loading && !stats) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading dashboard...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight\">Dashboard</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Library overview and statistics\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"text-sm text-muted-foreground\">\r\n            Last updated: {lastUpdated.toLocaleTimeString()}\r\n          </span>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={fetchDashboardData}\r\n            disabled={loading}\r\n          >\r\n            <RefreshCw\r\n              className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`}\r\n            />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {stats && (\r\n        <>\r\n          {/* Today's Stats */}\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">\r\n                  Today's Check-Ins\r\n                </CardTitle>\r\n                <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">{stats.today.checkIns}</div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {stats.today.uniqueStudents} unique students\r\n                </p>\r\n                {stats.trends.visitsTrend !== 0 && (\r\n                  <p\r\n                    className={`text-xs mt-1 ${getTrendColor(stats.trends.visitsTrend)}`}\r\n                  >\r\n                    {getTrendIcon(stats.trends.visitsTrend)}{' '}\r\n                    {Math.abs(stats.trends.visitsTrend)}% vs last week\r\n                  </p>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">\r\n                  Books Circulated\r\n                </CardTitle>\r\n                <BookOpen className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">\r\n                  {stats.today.booksCirculated}\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Today's circulation\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">\r\n                  Active Now\r\n                </CardTitle>\r\n                <Activity className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold text-green-500\">\r\n                  {Math.max(0, stats.today.activeNow)}\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Students in library\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">\r\n                  Weekly Average\r\n                </CardTitle>\r\n                <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">\r\n                  {stats.thisWeek.averageDaily}\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">Visits per day</p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Charts Section */}\r\n          <Tabs defaultValue=\"popular\" className=\"space-y-4\">\r\n            <TabsList>\r\n              <TabsTrigger value=\"popular\">\r\n                <BarChart3 className=\"w-4 h-4 mr-2\" />\r\n                Popular Items\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"activity\">\r\n                <Activity className=\"w-4 h-4 mr-2\" />\r\n                Activity\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            <TabsContent value=\"popular\" className=\"space-y-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                {/* Top Books */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <BookOpen className=\"w-5 h-5\" />\r\n                      Top Books This Week\r\n                    </CardTitle>\r\n                    <CardDescription>Most borrowed books</CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-3\">\r\n                      {stats.thisWeek.topBooks.length > 0 ? (\r\n                        stats.thisWeek.topBooks.map((book, index) => (\r\n                          <div\r\n                            key={index}\r\n                            className=\"flex items-center justify-between\"\r\n                          >\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <Badge\r\n                                variant=\"outline\"\r\n                                className=\"h-6 w-6 flex items-center justify-center p-0\"\r\n                              >\r\n                                {index + 1}\r\n                              </Badge>\r\n                              <span className=\"text-sm font-medium truncate max-w-[200px]\">\r\n                                {book.title}\r\n                              </span>\r\n                            </div>\r\n                            <Badge>{book.count}x</Badge>\r\n                          </div>\r\n                        ))\r\n                      ) : (\r\n                        <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                          No data available\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {/* Top Categories */}\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <PieChart className=\"w-5 h-5\" />\r\n                      Top Categories\r\n                    </CardTitle>\r\n                    <CardDescription>\r\n                      Most popular book categories\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-3\">\r\n                      {stats.thisWeek.topCategories.length > 0 ? (\r\n                        stats.thisWeek.topCategories.map((category, index) => (\r\n                          <div\r\n                            key={index}\r\n                            className=\"flex items-center justify-between\"\r\n                          >\r\n                            <span className=\"text-sm font-medium\">\r\n                              {category.name}\r\n                            </span>\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <div className=\"w-24 bg-gray-200 rounded-full h-2 dark:bg-gray-700\">\r\n                                <div\r\n                                  className=\"bg-primary h-2 rounded-full\"\r\n                                  style={{\r\n                                    width: `${stats.thisWeek.topCategories[0] ? (category.count / stats.thisWeek.topCategories[0].count) * 100 : 0}%`,\r\n                                  }}\r\n                                ></div>\r\n                              </div>\r\n                              <Badge variant=\"outline\">{category.count}</Badge>\r\n                            </div>\r\n                          </div>\r\n                        ))\r\n                      ) : (\r\n                        <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                          No data available\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"activity\" className=\"space-y-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Weekly Activity Overview</CardTitle>\r\n                  <CardDescription>\r\n                    Total visits this week: {stats.thisWeek.totalVisits}\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center justify-between text-sm\">\r\n                      <span className=\"text-muted-foreground\">\r\n                        Average Daily Visits\r\n                      </span>\r\n                      <span className=\"font-medium\">\r\n                        {stats.thisWeek.averageDaily}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between text-sm\">\r\n                      <span className=\"text-muted-foreground\">\r\n                        Books Circulated Today\r\n                      </span>\r\n                      <span className=\"font-medium\">\r\n                        {stats.today.booksCirculated}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between text-sm\">\r\n                      <span className=\"text-muted-foreground\">\r\n                        Current Occupancy\r\n                      </span>\r\n                      <span className=\"font-medium text-green-500\">\r\n                        {Math.max(0, stats.today.activeNow)} students\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </TabsContent>\r\n          </Tabs>\r\n\r\n          {/* Quick Actions */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Quick Actions</CardTitle>\r\n              <CardDescription>Common tasks and reports</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"grid gap-2 md:grid-cols-4\">\r\n                <Button variant=\"outline\" className=\"justify-start\">\r\n                  <Calendar className=\"w-4 h-4 mr-2\" />\r\n                  View Reports\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"justify-start\">\r\n                  <BookOpen className=\"w-4 h-4 mr-2\" />\r\n                  Manage Books\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"justify-start\">\r\n                  <Users className=\"w-4 h-4 mr-2\" />\r\n                  Students\r\n                </Button>\r\n                <Button variant=\"outline\" className=\"justify-start\">\r\n                  <Clock className=\"w-4 h-4 mr-2\" />\r\n                  Activity Log\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\EnhancedEquipmentDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":78,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1744,1747],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1744,1747],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'mockEquipment' and 'mockMetrics'. Either include them or remove the dependency array.","line":354,"column":6,"nodeType":"ArrayExpression","endLine":354,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [mockEquipment, mockMetrics]","fix":{"range":[9609,9611],"text":"[mockEquipment, mockMetrics]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  useMobileOptimization,\r\n  useTouchOptimization,\r\n  getResponsiveClasses,\r\n} from '@/hooks/useMobileOptimization';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport { DashboardCardSkeleton } from '@/components/LoadingStates';\r\nimport {\r\n  Monitor,\r\n  Gamepad2,\r\n  Cpu,\r\n  Play,\r\n  Square,\r\n  RotateCcw,\r\n  CheckCircle,\r\n  Clock,\r\n  User,\r\n  WifiOff,\r\n  Calendar,\r\n  Wrench,\r\n  TrendingUp,\r\n  Search,\r\n  Plus,\r\n  Edit,\r\n  MapPin,\r\n  Tag,\r\n  RefreshCw,\r\n  Eye,\r\n} from 'lucide-react';\r\n\r\ninterface EquipmentItem {\r\n  id: string;\r\n  equipmentId: string;\r\n  name: string;\r\n  type: string;\r\n  status:\r\n    | 'AVAILABLE'\r\n    | 'IN_USE'\r\n    | 'MAINTENANCE'\r\n    | 'OUT_OF_ORDER'\r\n    | 'RESERVED'\r\n    | 'RETIRED';\r\n  location: string;\r\n  conditionRating: 'EXCELLENT' | 'GOOD' | 'FAIR' | 'POOR' | 'DAMAGED';\r\n  maxTimeMinutes: number;\r\n  requiresSupervision: boolean;\r\n  description?: string;\r\n  category?: string;\r\n  specifications?: Record<string, any>;\r\n  purchaseDate?: string;\r\n  purchaseCost?: number;\r\n  serialNumber?: string;\r\n  assetTag?: string;\r\n  warrantyExpiry?: string;\r\n  nextMaintenance?: string;\r\n  totalUsageHours: number;\r\n  tags?: string[];\r\n  currentSession?: {\r\n    id: string;\r\n    studentId: string;\r\n    studentName: string;\r\n    startTime: string;\r\n    timeLimitMinutes: number;\r\n    remainingMinutes: number;\r\n  };\r\n  upcomingReservations?: Array<{\r\n    id: string;\r\n    studentName: string;\r\n    startTime: string;\r\n    endTime: string;\r\n  }>;\r\n  pendingMaintenance?: Array<{\r\n    id: string;\r\n    type: string;\r\n    priority: string;\r\n    scheduledDate: string;\r\n  }>;\r\n}\r\n\r\ninterface EquipmentMetrics {\r\n  totalEquipment: number;\r\n  available: number;\r\n  inUse: number;\r\n  maintenance: number;\r\n  reserved: number;\r\n  outOfOrder: number;\r\n  utilizationRate: number;\r\n  averageSessionLength: number;\r\n  totalUsageHours: number;\r\n  maintenancePending: number;\r\n  upcomingMaintenance: number;\r\n  equipmentByType: Array<{\r\n    type: string;\r\n    count: number;\r\n    utilization: number;\r\n  }>;\r\n  equipmentByCondition: Array<{\r\n    condition: string;\r\n    count: number;\r\n  }>;\r\n  topUsedEquipment: Array<{\r\n    equipmentId: string;\r\n    name: string;\r\n    usageHours: number;\r\n    sessions: number;\r\n  }>;\r\n}\r\n\r\nexport function EnhancedEquipmentDashboard() {\r\n  // Mobile optimization\r\n  const mobileState = useMobileOptimization();\r\n  const { isMobile, isTablet: _isTablet } = mobileState;\r\n  const { handleTouchStart, handleTouchEnd } = useTouchOptimization();\r\n\r\n  // State management\r\n  const [equipment, setEquipment] = useState<EquipmentItem[]>([]);\r\n  const [metrics, setMetrics] = useState<EquipmentMetrics | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedFilter, setSelectedFilter] = useState('all');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedCategory, setSelectedCategory] = useState('all');\r\n  const [selectedLocation] = useState('all');\r\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\r\n  const [showMaintenanceDialog, setShowMaintenanceDialog] = useState(false);\r\n  const [showReservationDialog, setShowReservationDialog] = useState(false);\r\n  const [selectedEquipment, setSelectedEquipment] =\r\n    useState<EquipmentItem | null>(null);\r\n  const isOnline = useAppStore((state) => state.isOnline);\r\n\r\n  // Mock data for development\r\n  const mockEquipment: EquipmentItem[] = [\r\n    {\r\n      id: '1',\r\n      equipmentId: 'PC01',\r\n      name: 'Computer Station 1',\r\n      type: 'COMPUTER',\r\n      status: 'IN_USE',\r\n      location: 'Main Area - Station A1',\r\n      conditionRating: 'EXCELLENT',\r\n      maxTimeMinutes: 60,\r\n      requiresSupervision: false,\r\n      category: 'Computer Workstation',\r\n      specifications: {\r\n        cpu: 'Intel i5-12400',\r\n        ram: '16GB',\r\n        gpu: 'Integrated',\r\n        storage: '512GB SSD',\r\n      },\r\n      purchaseDate: '2023-01-15',\r\n      purchaseCost: 899.99,\r\n      assetTag: 'IT-001-PC',\r\n      warrantyExpiry: '2025-01-15',\r\n      nextMaintenance: '2024-02-01',\r\n      totalUsageHours: 1250.5,\r\n      tags: ['productivity', 'research', 'homework'],\r\n      currentSession: {\r\n        id: 'session1',\r\n        studentId: 'STU001',\r\n        studentName: 'Juan Dela Cruz',\r\n        startTime: '2024-01-20T14:30:00Z',\r\n        timeLimitMinutes: 60,\r\n        remainingMinutes: 25,\r\n      },\r\n      upcomingReservations: [\r\n        {\r\n          id: 'res1',\r\n          studentName: 'Maria Santos',\r\n          startTime: '2024-01-20T16:00:00Z',\r\n          endTime: '2024-01-20T17:00:00Z',\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      id: '2',\r\n      equipmentId: 'PC02',\r\n      name: 'Computer Station 2',\r\n      type: 'COMPUTER',\r\n      status: 'AVAILABLE',\r\n      location: 'Main Area - Station A2',\r\n      conditionRating: 'GOOD',\r\n      maxTimeMinutes: 60,\r\n      requiresSupervision: false,\r\n      category: 'Computer Workstation',\r\n      specifications: {\r\n        cpu: 'Intel i5-12400',\r\n        ram: '16GB',\r\n        gpu: 'Integrated',\r\n        storage: '512GB SSD',\r\n      },\r\n      purchaseDate: '2023-01-15',\r\n      purchaseCost: 899.99,\r\n      assetTag: 'IT-002-PC',\r\n      warrantyExpiry: '2025-01-15',\r\n      totalUsageHours: 980.2,\r\n      tags: ['productivity', 'research', 'homework'],\r\n    },\r\n    {\r\n      id: '3',\r\n      equipmentId: 'PS01',\r\n      name: 'PlayStation 5 Station 1',\r\n      type: 'GAMING',\r\n      status: 'MAINTENANCE',\r\n      location: 'Gaming Area - Console 1',\r\n      conditionRating: 'FAIR',\r\n      maxTimeMinutes: 45,\r\n      requiresSupervision: true,\r\n      category: 'Gaming Console',\r\n      specifications: {\r\n        console: 'PS5',\r\n        storage: '825GB SSD',\r\n        accessories: 'DualSense Controller',\r\n      },\r\n      purchaseDate: '2022-11-01',\r\n      purchaseCost: 499.99,\r\n      assetTag: 'IT-003-PS',\r\n      nextMaintenance: '2024-01-25',\r\n      totalUsageHours: 450.8,\r\n      tags: ['gaming', 'entertainment'],\r\n      pendingMaintenance: [\r\n        {\r\n          id: 'maint1',\r\n          type: 'ROUTINE',\r\n          priority: 'NORMAL',\r\n          scheduledDate: '2024-01-25T10:00:00Z',\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      id: '4',\r\n      equipmentId: 'VR01',\r\n      name: 'VR Station - Oculus Quest 2',\r\n      type: 'AVR',\r\n      status: 'RESERVED',\r\n      location: 'AVR Room - Station 1',\r\n      conditionRating: 'EXCELLENT',\r\n      maxTimeMinutes: 30,\r\n      requiresSupervision: true,\r\n      category: 'Virtual Reality',\r\n      specifications: {\r\n        headset: 'Oculus Quest 2',\r\n        controllers: 'Touch Controllers',\r\n        space: '3m x 3m',\r\n      },\r\n      purchaseDate: '2023-06-01',\r\n      purchaseCost: 299.99,\r\n      assetTag: 'IT-004-VR',\r\n      warrantyExpiry: '2024-06-01',\r\n      totalUsageHours: 125.3,\r\n      tags: ['vr', 'immersive', 'educational'],\r\n      upcomingReservations: [\r\n        {\r\n          id: 'res2',\r\n          studentName: 'Carlos Rodriguez',\r\n          startTime: '2024-01-20T15:00:00Z',\r\n          endTime: '2024-01-20T15:30:00Z',\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  const mockMetrics: EquipmentMetrics = {\r\n    totalEquipment: 25,\r\n    available: 12,\r\n    inUse: 8,\r\n    maintenance: 3,\r\n    reserved: 2,\r\n    outOfOrder: 0,\r\n    utilizationRate: 68.5,\r\n    averageSessionLength: 42.3,\r\n    totalUsageHours: 3847.2,\r\n    maintenancePending: 5,\r\n    upcomingMaintenance: 8,\r\n    equipmentByType: [\r\n      { type: 'COMPUTER', count: 15, utilization: 75.2 },\r\n      { type: 'GAMING', count: 6, utilization: 58.3 },\r\n      { type: 'AVR', count: 4, utilization: 82.1 },\r\n    ],\r\n    equipmentByCondition: [\r\n      { condition: 'EXCELLENT', count: 18 },\r\n      { condition: 'GOOD', count: 5 },\r\n      { condition: 'FAIR', count: 2 },\r\n      { condition: 'POOR', count: 0 },\r\n      { condition: 'DAMAGED', count: 0 },\r\n    ],\r\n    topUsedEquipment: [\r\n      {\r\n        equipmentId: 'PC01',\r\n        name: 'Computer Station 1',\r\n        usageHours: 1250.5,\r\n        sessions: 847,\r\n      },\r\n      {\r\n        equipmentId: 'PC02',\r\n        name: 'Computer Station 2',\r\n        usageHours: 1187.3,\r\n        sessions: 756,\r\n      },\r\n      {\r\n        equipmentId: 'PC03',\r\n        name: 'Computer Station 3',\r\n        usageHours: 1098.7,\r\n        sessions: 692,\r\n      },\r\n    ],\r\n  };\r\n\r\n  // Initialize data\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        // In a real implementation, these would be API calls\r\n        // const equipmentData = await api.getEquipment()\r\n        // const metricsData = await api.getEquipmentMetrics()\r\n        setEquipment(mockEquipment);\r\n        setMetrics(mockMetrics);\r\n      } catch (error) {\r\n        console.error('Error loading equipment data:', error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n  }, []);\r\n\r\n  // Filter equipment based on _search and filters\r\n  const filteredEquipment = equipment.filter((item) => {\r\n    const matchesSearch =\r\n      searchQuery === '' ||\r\n      item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      item.equipmentId.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      item.location.toLowerCase().includes(searchQuery.toLowerCase());\r\n\r\n    const matchesFilter =\r\n      selectedFilter === 'all' || item.status === selectedFilter;\r\n    const matchesCategory =\r\n      selectedCategory === 'all' || item.category === selectedCategory;\r\n    const matchesLocation =\r\n      selectedLocation === 'all' || item.location === selectedLocation;\r\n\r\n    return matchesSearch && matchesFilter && matchesCategory && matchesLocation;\r\n  });\r\n\r\n  // Status helpers\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'AVAILABLE':\r\n        return 'bg-green-500 dark:bg-green-400';\r\n      case 'IN_USE':\r\n        return 'bg-blue-500 dark:bg-blue-400';\r\n      case 'MAINTENANCE':\r\n        return 'bg-yellow-500 dark:bg-yellow-400';\r\n      case 'OUT_OF_ORDER':\r\n        return 'bg-red-500 dark:bg-red-400';\r\n      case 'RESERVED':\r\n        return 'bg-purple-500 dark:bg-purple-400';\r\n      case 'RETIRED':\r\n        return 'bg-gray-500';\r\n      default:\r\n        return 'bg-gray-500';\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'AVAILABLE':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-green-500 hover:bg-green-600\">\r\n            Available\r\n          </Badge>\r\n        );\r\n      case 'IN_USE':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-blue-500 hover:bg-blue-600\">\r\n            In Use\r\n          </Badge>\r\n        );\r\n      case 'MAINTENANCE':\r\n        return <Badge variant=\"secondary\">Maintenance</Badge>;\r\n      case 'OUT_OF_ORDER':\r\n        return <Badge variant=\"destructive\">Out of Order</Badge>;\r\n      case 'RESERVED':\r\n        return (\r\n          <Badge\r\n            variant=\"default\"\r\n            className=\"bg-purple-500 hover:bg-purple-600\"\r\n          >\r\n            Reserved\r\n          </Badge>\r\n        );\r\n      case 'RETIRED':\r\n        return <Badge variant=\"outline\">Retired</Badge>;\r\n      default:\r\n        return <Badge variant=\"outline\">Unknown</Badge>;\r\n    }\r\n  };\r\n\r\n  const getConditionColor = (condition: string) => {\r\n    switch (condition) {\r\n      case 'EXCELLENT':\r\n        return 'text-green-600 dark:text-green-400';\r\n      case 'GOOD':\r\n        return 'text-blue-600 dark:text-blue-400';\r\n      case 'FAIR':\r\n        return 'text-yellow-600 dark:text-yellow-400';\r\n      case 'POOR':\r\n        return 'text-orange-600 dark:text-orange-400';\r\n      case 'DAMAGED':\r\n        return 'text-red-600 dark:text-red-400';\r\n      default:\r\n        return 'text-gray-600 dark:text-gray-400';\r\n    }\r\n  };\r\n\r\n  const getEquipmentIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'COMPUTER':\r\n        return <Monitor className=\"h-5 w-5\" />;\r\n      case 'GAMING':\r\n        return <Gamepad2 className=\"h-5 w-5\" />;\r\n      case 'AVR':\r\n        return <Cpu className=\"h-5 w-5\" />;\r\n      default:\r\n        return <Monitor className=\"h-5 w-5\" />;\r\n    }\r\n  };\r\n\r\n  const formatTimeRemaining = (minutes: number) => {\r\n    if (minutes <= 0) {\r\n      return 'Expired';\r\n    }\r\n    return `${minutes}m remaining`;\r\n  };\r\n\r\n  // Action handlers\r\n  const handleStartSession = (equipment: EquipmentItem) => {\r\n    // Implementation for starting equipment session\r\n    console.debug('Starting session for equipment:', equipment.id);\r\n  };\r\n\r\n  const handleEndSession = (sessionId: string) => {\r\n    // Implementation for ending equipment session\r\n    console.debug('Ending session:', sessionId);\r\n  };\r\n\r\n  const handleScheduleMaintenance = (equipment: EquipmentItem) => {\r\n    setSelectedEquipment(equipment);\r\n    setShowMaintenanceDialog(true);\r\n  };\r\n\r\n  const handleCreateReservation = (equipment: EquipmentItem) => {\r\n    setSelectedEquipment(equipment);\r\n    setShowReservationDialog(true);\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    // Implementation for refreshing equipment data\r\n    window.location.reload();\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className={getResponsiveClasses('space-y-6', mobileState)}>\r\n        <DashboardCardSkeleton />\r\n        <DashboardCardSkeleton />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={getResponsiveClasses('space-y-6', mobileState)}\r\n      onTouchStart={isMobile ? handleTouchStart : undefined}\r\n      onTouchEnd={isMobile ? handleTouchEnd : undefined}\r\n    >\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight\">\r\n            Equipment Management\r\n          </h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Monitor and manage library equipment, reservations, and maintenance.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Button variant=\"outline\" size=\"sm\" onClick={handleRefresh}>\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n          <Dialog open={showCreateDialog} onOpenChange={setShowCreateDialog}>\r\n            <DialogTrigger asChild>\r\n              <Button size=\"sm\">\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                Add Equipment\r\n              </Button>\r\n            </DialogTrigger>\r\n            <DialogContent\r\n              className={getResponsiveClasses('max-w-2xl', mobileState)}\r\n            >\r\n              <DialogHeader>\r\n                <DialogTitle>Add New Equipment</DialogTitle>\r\n                <DialogDescription>\r\n                  Add a new piece of equipment to the library inventory.\r\n                </DialogDescription>\r\n              </DialogHeader>\r\n              {/* Equipment creation form would go here */}\r\n              <div className=\"space-y-4 py-4\">\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Equipment creation form will be implemented here.\r\n                </p>\r\n              </div>\r\n            </DialogContent>\r\n          </Dialog>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Overview */}\r\n      {metrics && (\r\n        <div\r\n          className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-2' : 'grid-cols-2 lg:grid-cols-4'}`}\r\n        >\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">\r\n                Total Equipment\r\n              </CardTitle>\r\n              <Monitor className=\"h-4 w-4 text-muted-foreground\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold\">{metrics.totalEquipment}</div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                All equipment items\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">Available</CardTitle>\r\n              <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\r\n                {metrics.available}\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">Ready for use</p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">In Use</CardTitle>\r\n              <User className=\"h-4 w-4 text-blue-500 dark:text-blue-400\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n                {metrics.inUse}\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">Active sessions</p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n              <CardTitle className=\"text-sm font-medium\">Utilization</CardTitle>\r\n              <TrendingUp className=\"h-4 w-4 text-purple-500 dark:text-purple-400\" />\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\r\n                {metrics.utilizationRate.toFixed(1)}%\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Overall utilization\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n\r\n      {/* Connection Status */}\r\n      {!isOnline && (\r\n        <Alert>\r\n          <WifiOff className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            You are currently offline. Equipment changes will be queued and\r\n            synced when connection is restored.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Filters and _Search */}\r\n      <div className=\"flex flex-col space-y-4 lg:flex-row lg:space-y-0 lg:space-x-4\">\r\n        <div className=\"flex-1\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder=\"_Search equipment...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          <Select value={selectedFilter} onValueChange={setSelectedFilter}>\r\n            <SelectTrigger\r\n              className={getResponsiveClasses('w-full lg:w-40', mobileState)}\r\n            >\r\n              <SelectValue placeholder=\"Filter by status\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Status</SelectItem>\r\n              <SelectItem value=\"AVAILABLE\">Available</SelectItem>\r\n              <SelectItem value=\"IN_USE\">In Use</SelectItem>\r\n              <SelectItem value=\"MAINTENANCE\">Maintenance</SelectItem>\r\n              <SelectItem value=\"RESERVED\">Reserved</SelectItem>\r\n              <SelectItem value=\"OUT_OF_ORDER\">Out of Order</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n          <Select value={selectedCategory} onValueChange={setSelectedCategory}>\r\n            <SelectTrigger\r\n              className={getResponsiveClasses('w-full lg:w-40', mobileState)}\r\n            >\r\n              <SelectValue placeholder=\"Category\" />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"all\">All Categories</SelectItem>\r\n              <SelectItem value=\"Computer Workstation\">Computers</SelectItem>\r\n              <SelectItem value=\"Gaming Console\">Gaming</SelectItem>\r\n              <SelectItem value=\"Virtual Reality\">VR/AVR</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Equipment List */}\r\n      <Tabs defaultValue=\"all\" className={`space-y-${isMobile ? '3' : '4'}`}>\r\n        <div className=\"flex items-center justify-between\">\r\n          <TabsList>\r\n            <TabsTrigger value=\"all\">All Equipment</TabsTrigger>\r\n            <TabsTrigger value=\"available\">Available</TabsTrigger>\r\n            <TabsTrigger value=\"in-use\">In Use</TabsTrigger>\r\n            <TabsTrigger value=\"analytics\">Analytics</TabsTrigger>\r\n          </TabsList>\r\n          <Badge variant=\"outline\">{filteredEquipment.length} items</Badge>\r\n        </div>\r\n\r\n        <TabsContent value=\"all\" className={`space-y-${isMobile ? '3' : '4'}`}>\r\n          <div\r\n            className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-1' : 'lg:grid-cols-2'}`}\r\n          >\r\n            {filteredEquipment.map((item) => (\r\n              <Card key={item.id} className=\"relative\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {getEquipmentIcon(item.type)}\r\n                      <div>\r\n                        <CardTitle className=\"text-sm\">{item.name}</CardTitle>\r\n                        <CardDescription>\r\n                          ID: {item.equipmentId}\r\n                        </CardDescription>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <div\r\n                        className={`h-2 w-2 rounded-full ${getStatusColor(item.status)}`}\r\n                      ></div>\r\n                      {getStatusBadge(item.status)}\r\n                    </div>\r\n                  </div>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-4\">\r\n                  {/* Equipment Details */}\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Location:</span>\r\n                      <div className=\"flex items-center mt-1\">\r\n                        <MapPin className=\"h-3 w-3 mr-1\" />\r\n                        {item.location}\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Condition:</span>\r\n                      <div\r\n                        className={`font-medium ${getConditionColor(item.conditionRating)}`}\r\n                      >\r\n                        {item.conditionRating}\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Max Time:</span>\r\n                      <div className=\"font-medium\">\r\n                        {item.maxTimeMinutes} min\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Usage:</span>\r\n                      <div className=\"font-medium\">\r\n                        {item.totalUsageHours.toFixed(1)} hrs\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Tags */}\r\n                  {item.tags && item.tags.length > 0 && (\r\n                    <div className=\"flex flex-wrap gap-1\">\r\n                      {item.tags.map((tag, index) => (\r\n                        <Badge\r\n                          key={index}\r\n                          variant=\"outline\"\r\n                          className=\"text-xs\"\r\n                        >\r\n                          <Tag className=\"h-2 w-2 mr-1\" />\r\n                          {tag}\r\n                        </Badge>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Current Session */}\r\n                  {item.currentSession ? (\r\n                    <div className=\"space-y-3\">\r\n                      <div className=\"p-3 bg-primary/10 dark:bg-primary/5 rounded-lg border border-primary/20 dark:border-primary/10\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                          <span className=\"text-sm font-medium\">\r\n                            Active Session\r\n                          </span>\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            {formatTimeRemaining(\r\n                              item.currentSession.remainingMinutes\r\n                            )}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <User className=\"h-3 w-3\" />\r\n                            <span>{item.currentSession.studentName}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <Clock className=\"h-3 w-3\" />\r\n                            <span>\r\n                              Started:{' '}\r\n                              {new Date(\r\n                                item.currentSession.startTime\r\n                              ).toLocaleTimeString()}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                        <Progress\r\n                          value={\r\n                            ((item.currentSession.timeLimitMinutes -\r\n                              item.currentSession.remainingMinutes) /\r\n                              item.currentSession.timeLimitMinutes) *\r\n                            100\r\n                          }\r\n                          className=\"mt-2 h-2\"\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"flex space-x-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"destructive\"\r\n                          onClick={() =>\r\n                            handleEndSession(item.currentSession?.id || '')\r\n                          }\r\n                          className=\"flex-1\"\r\n                        >\r\n                          <Square className=\"h-3 w-3 mr-1\" />\r\n                          End Session\r\n                        </Button>\r\n                        <Button size=\"sm\" variant=\"outline\">\r\n                          <RotateCcw className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"space-y-3\">\r\n                      {item.status === 'AVAILABLE' && (\r\n                        <div className=\"text-center py-4\">\r\n                          <CheckCircle className=\"h-8 w-8 mx-auto mb-2 text-green-500\" />\r\n                          <p className=\"text-sm text-muted-foreground mb-3\">\r\n                            Equipment is ready for use\r\n                          </p>\r\n                          <Button\r\n                            size=\"sm\"\r\n                            onClick={() => handleStartSession(item)}\r\n                            className=\"w-full\"\r\n                          >\r\n                            <Play className=\"h-3 w-3 mr-1\" />\r\n                            Start Session\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n\r\n                      {item.status === 'RESERVED' &&\r\n                        item.upcomingReservations && (\r\n                          <div className=\"p-3 bg-purple-10 dark:bg-purple-5 rounded-lg border border-purple-20 dark:border-purple-10\">\r\n                            <div className=\"text-sm\">\r\n                              <div className=\"font-medium mb-2\">\r\n                                Upcoming Reservations\r\n                              </div>\r\n                              {item.upcomingReservations.map(\r\n                                (reservation, index) => (\r\n                                  <div\r\n                                    key={index}\r\n                                    className=\"text-muted-foreground\"\r\n                                  >\r\n                                    {reservation.studentName} -{' '}\r\n                                    {new Date(\r\n                                      reservation.startTime\r\n                                    ).toLocaleTimeString()}\r\n                                  </div>\r\n                                )\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n\r\n                      {item.status === 'MAINTENANCE' && (\r\n                        <div className=\"text-center py-4\">\r\n                          <Wrench className=\"h-8 w-8 mx-auto mb-2 text-yellow-500\" />\r\n                          <p className=\"text-sm text-muted-foreground mb-2\">\r\n                            Under maintenance\r\n                          </p>\r\n                          {item.nextMaintenance && (\r\n                            <p className=\"text-xs text-muted-foreground\">\r\n                              Next maintenance:{' '}\r\n                              {new Date(\r\n                                item.nextMaintenance\r\n                              ).toLocaleDateString()}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"flex space-x-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleCreateReservation(item)}\r\n                          className=\"flex-1\"\r\n                        >\r\n                          <Calendar className=\"h-3 w-3 mr-1\" />\r\n                          Reserve\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => handleScheduleMaintenance(item)}\r\n                        >\r\n                          <Wrench className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Action Buttons */}\r\n                  <div className=\"flex space-x-2 pt-2 border-t\">\r\n                    <Button size=\"sm\" variant=\"outline\" className=\"flex-1\">\r\n                      <Eye className=\"h-3 w-3 mr-1\" />\r\n                      Details\r\n                    </Button>\r\n                    <Button size=\"sm\" variant=\"outline\">\r\n                      <Edit className=\"h-3 w-3\" />\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent\r\n          value=\"analytics\"\r\n          className={`space-y-${isMobile ? '3' : '4'}`}\r\n        >\r\n          {metrics && (\r\n            <div\r\n              className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-1' : 'lg:grid-cols-2'}`}\r\n            >\r\n              {/* Usage Statistics */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Usage Statistics</CardTitle>\r\n                  <CardDescription>\r\n                    Equipment utilization by type\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {metrics.equipmentByType.map((type, index) => (\r\n                      <div key={index} className=\"space-y-2\">\r\n                        <div className=\"flex justify-between\">\r\n                          <span className=\"text-sm font-medium\">\r\n                            {type.type}\r\n                          </span>\r\n                          <span className=\"text-sm\">{type.count} items</span>\r\n                        </div>\r\n                        <Progress value={type.utilization} className=\"h-2\" />\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          {type.utilization.toFixed(1)}% utilization\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Equipment Condition */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Equipment Condition</CardTitle>\r\n                  <CardDescription>\r\n                    Condition rating distribution\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {metrics.equipmentByCondition.map((condition, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"flex justify-between items-center\"\r\n                      >\r\n                        <span className=\"text-sm font-medium\">\r\n                          {condition.condition}\r\n                        </span>\r\n                        <Badge variant=\"outline\">{condition.count}</Badge>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Top Used Equipment */}\r\n              <Card className=\"lg:col-span-2\">\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Most Used Equipment</CardTitle>\r\n                  <CardDescription>\r\n                    Top equipment by usage hours\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    {metrics.topUsedEquipment.map((item, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\r\n                      >\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center\">\r\n                            <span className=\"text-sm font-medium\">\r\n                              {index + 1}\r\n                            </span>\r\n                          </div>\r\n                          <div>\r\n                            <div className=\"font-medium\">{item.name}</div>\r\n                            <div className=\"text-sm text-muted-foreground\">\r\n                              {item.equipmentId}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <div className=\"font-medium\">\r\n                            {item.usageHours.toFixed(1)} hrs\r\n                          </div>\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            {item.sessions} sessions\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Maintenance Dialog */}\r\n      <Dialog\r\n        open={showMaintenanceDialog}\r\n        onOpenChange={setShowMaintenanceDialog}\r\n      >\r\n        <DialogContent\r\n          className={getResponsiveClasses('max-w-2xl', mobileState)}\r\n        >\r\n          <DialogHeader>\r\n            <DialogTitle>Schedule Maintenance</DialogTitle>\r\n            <DialogDescription>\r\n              Schedule maintenance for {selectedEquipment?.name}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4 py-4\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Maintenance scheduling form will be implemented here.\r\n            </p>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Reservation Dialog */}\r\n      <Dialog\r\n        open={showReservationDialog}\r\n        onOpenChange={setShowReservationDialog}\r\n      >\r\n        <DialogContent\r\n          className={getResponsiveClasses('max-w-2xl', mobileState)}\r\n        >\r\n          <DialogHeader>\r\n            <DialogTitle>Create Reservation</DialogTitle>\r\n            <DialogDescription>\r\n              Reserve {selectedEquipment?.name} for future use\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4 py-4\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Reservation form will be implemented here.\r\n            </p>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EnhancedEquipmentDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\EquipmentDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5613,5616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5613,5616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":359,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":359,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11138,11141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11138,11141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport {\r\n  useMobileOptimization,\r\n  useTouchOptimization,\r\n  getResponsiveClasses,\r\n} from '@/hooks/useMobileOptimization';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { useEndSession } from '@/hooks/api-hooks';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport { offlineActions } from '@/lib/offline-queue';\r\n\r\nimport {\r\n  Monitor,\r\n  Gamepad2,\r\n  Cpu,\r\n  Play,\r\n  Square,\r\n  RotateCcw,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  Clock,\r\n  User,\r\n  Settings,\r\n  WifiOff,\r\n} from 'lucide-react';\r\n\r\ninterface EquipmentItem {\r\n  id: string;\r\n  type: 'computer' | 'gaming' | 'avr';\r\n  name: string;\r\n  status: 'available' | 'in-use' | 'maintenance' | 'offline';\r\n  currentSession?: {\r\n    id: string;\r\n    studentId: string;\r\n    studentName: string;\r\n    startTime: Date;\r\n    timeLimitMinutes: number;\r\n    remainingMinutes: number;\r\n  };\r\n  specs?: {\r\n    cpu?: string;\r\n    ram?: string;\r\n    gpu?: string;\r\n  };\r\n}\r\n\r\nexport function EquipmentDashboard() {\r\n  // Mobile optimization\r\n  const mobileState = useMobileOptimization();\r\n  const { isMobile } = mobileState;\r\n  const { handleTouchStart, handleTouchEnd } = useTouchOptimization();\r\n\r\n  const [selectedFilter, setSelectedFilter] = useState<string>('all');\r\n  const { equipment: equipmentData, isOnline } = useAppStore();\r\n  const { mutate: endSession } = useEndSession();\r\n\r\n  // Mock equipment data for now\r\n  const mockEquipment: EquipmentItem[] = [\r\n    {\r\n      id: 'PC01',\r\n      type: 'computer',\r\n      name: 'Computer Station 1',\r\n      status: 'in-use',\r\n      currentSession: {\r\n        id: 'session1',\r\n        studentId: 'STU001',\r\n        studentName: 'Juan Dela Cruz',\r\n        startTime: new Date(Date.now() - 25 * 60000), // 25 minutes ago\r\n        timeLimitMinutes: 30,\r\n        remainingMinutes: 5,\r\n      },\r\n      specs: { cpu: 'Intel i5', ram: '8GB', gpu: 'Integrated' },\r\n    },\r\n    {\r\n      id: 'PC02',\r\n      type: 'computer',\r\n      name: 'Computer Station 2',\r\n      status: 'available',\r\n      specs: { cpu: 'Intel i5', ram: '8GB', gpu: 'Integrated' },\r\n    },\r\n    {\r\n      id: 'PS01',\r\n      type: 'gaming',\r\n      name: 'PlayStation 1',\r\n      status: 'in-use',\r\n      currentSession: {\r\n        id: 'session2',\r\n        studentId: 'STU002',\r\n        studentName: 'Maria Santos',\r\n        startTime: new Date(Date.now() - 40 * 60000), // 40 minutes ago\r\n        timeLimitMinutes: 45,\r\n        remainingMinutes: 5,\r\n      },\r\n    },\r\n    {\r\n      id: 'PS02',\r\n      type: 'gaming',\r\n      name: 'PlayStation 2',\r\n      status: 'available',\r\n    },\r\n    {\r\n      id: 'AVR01',\r\n      type: 'avr',\r\n      name: 'VR Station 1',\r\n      status: 'maintenance',\r\n    },\r\n  ];\r\n\r\n  const equipment = equipmentData.length > 0 ? equipmentData : mockEquipment;\r\n\r\n  // Filter equipment based on selected filter\r\n  const filteredEquipment = equipment.filter((item) => {\r\n    if (selectedFilter === 'all') {\r\n      return true;\r\n    }\r\n    if (selectedFilter === 'available') {\r\n      return item.status === 'available';\r\n    }\r\n    if (selectedFilter === 'in-use') {\r\n      return item.status === 'in-use';\r\n    }\r\n    if (selectedFilter === 'computers') {\r\n      return item.type === 'computer';\r\n    }\r\n    if (selectedFilter === 'gaming') {\r\n      return item.type === 'gaming';\r\n    }\r\n    if (selectedFilter === 'avr') {\r\n      return item.type === 'avr';\r\n    }\r\n    return true;\r\n  });\r\n\r\n  const handleEndSession = async (sessionId: string) => {\r\n    if (isOnline) {\r\n      endSession(sessionId);\r\n    } else {\r\n      await offlineActions.endSession(sessionId);\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'available':\r\n        return 'bg-green-500 dark:bg-green-400';\r\n      case 'in-use':\r\n        return 'bg-blue-500 dark:bg-blue-400';\r\n      case 'maintenance':\r\n        return 'bg-yellow-500';\r\n      case 'offline':\r\n        return 'bg-red-500';\r\n      default:\r\n        return 'bg-gray-500';\r\n    }\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'available':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-green-500 hover:bg-green-600\">\r\n            Available\r\n          </Badge>\r\n        );\r\n      case 'in-use':\r\n        return (\r\n          <Badge variant=\"default\" className=\"bg-blue-500 hover:bg-blue-600\">\r\n            In Use\r\n          </Badge>\r\n        );\r\n      case 'maintenance':\r\n        return <Badge variant=\"secondary\">Maintenance</Badge>;\r\n      case 'offline':\r\n        return <Badge variant=\"destructive\">Offline</Badge>;\r\n      default:\r\n        return <Badge variant=\"outline\">Unknown</Badge>;\r\n    }\r\n  };\r\n\r\n  const getEquipmentIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'computer':\r\n        return <Monitor className=\"h-5 w-5\" />;\r\n      case 'gaming':\r\n        return <Gamepad2 className=\"h-5 w-5\" />;\r\n      case 'avr':\r\n        return <Cpu className=\"h-5 w-5\" />;\r\n      default:\r\n        return <Monitor className=\"h-5 w-5\" />;\r\n    }\r\n  };\r\n\r\n  const formatTimeRemaining = (minutes: number) => {\r\n    if (minutes <= 0) {\r\n      return 'Expired';\r\n    }\r\n    return `${minutes}m remaining`;\r\n  };\r\n\r\n  const getSessionProgress = (session: any) => {\r\n    if (!session) {\r\n      return 0;\r\n    }\r\n    const elapsed = session.timeLimitMinutes - session.remainingMinutes;\r\n    return (elapsed / session.timeLimitMinutes) * 100;\r\n  };\r\n\r\n  // Handle double-tap to refresh on mobile - removed gesture functionality\r\n\r\n  return (\r\n    <div\r\n      className={getResponsiveClasses('space-y-6', mobileState)}\r\n      onTouchStart={isMobile ? handleTouchStart : undefined}\r\n      onTouchEnd={isMobile ? handleTouchEnd : undefined}\r\n    >\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight\">\r\n            Equipment Management\r\n          </h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Monitor and manage library equipment and computer stations.\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Button variant=\"outline\" size=\"sm\">\r\n            <Settings className=\"h-4 w-4 mr-2\" />\r\n            Settings\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Status Overview */}\r\n      <div\r\n        className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-2' : 'md:grid-cols-2 lg:grid-cols-4'}`}\r\n      >\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Equipment\r\n            </CardTitle>\r\n            <Monitor className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{equipment.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">All stations</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Available</CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {equipment.filter((e) => e.status === 'available').length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Ready for use</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">In Use</CardTitle>\r\n            <User className=\"h-4 w-4 text-blue-500 dark:text-blue-400\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n              {equipment.filter((e) => e.status === 'in-use').length}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Active sessions</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Issues</CardTitle>\r\n            <AlertCircle className=\"h-4 w-4 text-red-500\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {\r\n                equipment.filter((e) =>\r\n                  ['maintenance', 'offline'].includes(e.status)\r\n                ).length\r\n              }\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">Need attention</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Connection Status */}\r\n      {!isOnline && (\r\n        <Alert>\r\n          <WifiOff className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            You are currently offline. Session changes will be queued and synced\r\n            when connection is restored.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Equipment List */}\r\n      <Tabs defaultValue=\"all\" className={`space-y-${isMobile ? '3' : '4'}`}>\r\n        <div className=\"flex items-center justify-between\">\r\n          <TabsList>\r\n            <TabsTrigger value=\"all\" onClick={() => setSelectedFilter('all')}>\r\n              All Equipment\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"available\"\r\n              onClick={() => setSelectedFilter('available')}\r\n            >\r\n              Available\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"in-use\"\r\n              onClick={() => setSelectedFilter('in-use')}\r\n            >\r\n              In Use\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"computers\"\r\n              onClick={() => setSelectedFilter('computers')}\r\n            >\r\n              Computers\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"gaming\"\r\n              onClick={() => setSelectedFilter('gaming')}\r\n            >\r\n              Gaming\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Badge variant=\"outline\">{filteredEquipment.length} items</Badge>\r\n          </div>\r\n        </div>\r\n\r\n        <TabsContent value=\"all\" className={`space-y-${isMobile ? '3' : '4'}`}>\r\n          <div\r\n            className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-1' : 'md:grid-cols-2 lg:grid-cols-3'}`}\r\n          >\r\n            {filteredEquipment.map((item: any) => (\r\n              <Card key={item.id} className=\"relative\">\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {getEquipmentIcon(item.type)}\r\n                      <CardTitle className=\"text-sm\">{item.name}</CardTitle>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      <div\r\n                        className={`h-2 w-2 rounded-full ${getStatusColor(item.status)}`}\r\n                      ></div>\r\n                      {getStatusBadge(item.status)}\r\n                    </div>\r\n                  </div>\r\n                  <CardDescription>ID: {item.id}</CardDescription>\r\n                </CardHeader>\r\n\r\n                <CardContent className=\"space-y-4\">\r\n                  {/* Current Session Info */}\r\n                  {item.currentSession ? (\r\n                    <div className=\"space-y-3\">\r\n                      <div className=\"p-3 bg-primary/10 dark:bg-primary/5 rounded-lg border border-primary/20 dark:border-primary/10\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                          <span className=\"text-sm font-medium\">\r\n                            Active Session\r\n                          </span>\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            {formatTimeRemaining(\r\n                              item.currentSession.remainingMinutes\r\n                            )}\r\n                          </Badge>\r\n                        </div>\r\n                        <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <User className=\"h-3 w-3\" />\r\n                            <span>{item.currentSession.studentName}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center space-x-1\">\r\n                            <Clock className=\"h-3 w-3\" />\r\n                            <span>\r\n                              Started:{' '}\r\n                              {new Date(\r\n                                item.currentSession.startTime\r\n                              ).toLocaleTimeString()}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                        <Progress\r\n                          value={getSessionProgress(item.currentSession)}\r\n                          className=\"mt-2 h-2\"\r\n                        />\r\n                      </div>\r\n\r\n                      <div className=\"flex space-x-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"destructive\"\r\n                          onClick={() =>\r\n                            handleEndSession(item.currentSession.id)\r\n                          }\r\n                          className=\"flex-1\"\r\n                        >\r\n                          <Square className=\"h-3 w-3 mr-1\" />\r\n                          End Session\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => {\r\n                            /* Handle extend session */\r\n                          }}\r\n                        >\r\n                          <RotateCcw className=\"h-3 w-3\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"space-y-3\">\r\n                      {item.status === 'available' && (\r\n                        <div className=\"text-center py-4\">\r\n                          <CheckCircle className=\"h-8 w-8 mx-auto mb-2 text-green-500\" />\r\n                          <p className=\"text-sm text-muted-foreground mb-3\">\r\n                            Equipment is ready for use\r\n                          </p>\r\n                          <Button\r\n                            size=\"sm\"\r\n                            onClick={() => {\r\n                              /* Handle start session */\r\n                            }}\r\n                            className=\"w-full\"\r\n                          >\r\n                            <Play className=\"h-3 w-3 mr-1\" />\r\n                            Start Session\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n\r\n                      {item.status === 'maintenance' && (\r\n                        <div className=\"text-center py-4\">\r\n                          <AlertCircle className=\"h-8 w-8 mx-auto mb-2 text-yellow-500\" />\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            Under maintenance\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n\r\n                      {item.status === 'offline' && (\r\n                        <div className=\"text-center py-4\">\r\n                          <WifiOff className=\"h-8 w-8 mx-auto mb-2 text-red-500\" />\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            Equipment offline\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Equipment Specs */}\r\n                  {item.specs && (\r\n                    <div className=\"border-t pt-3\">\r\n                      <div className=\"text-xs text-muted-foreground space-y-1\">\r\n                        {item.specs.cpu && <div>CPU: {item.specs.cpu}</div>}\r\n                        {item.specs.ram && <div>RAM: {item.specs.ram}</div>}\r\n                        {item.specs.gpu && <div>GPU: {item.specs.gpu}</div>}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Equipment Stats */}\r\n      <div\r\n        className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-1' : 'md:grid-cols-2'}`}\r\n      >\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Usage Statistics</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex justify-between\">\r\n                <span>Computer Utilization</span>\r\n                <span className=\"font-medium\">75%</span>\r\n              </div>\r\n              <Progress value={75} className=\"h-2\" />\r\n\r\n              <div className=\"flex justify-between\">\r\n                <span>Gaming Utilization</span>\r\n                <span className=\"font-medium\">50%</span>\r\n              </div>\r\n              <Progress value={50} className=\"h-2\" />\r\n\r\n              <div className=\"flex justify-between\">\r\n                <span>AVR Utilization</span>\r\n                <span className=\"font-medium\">25%</span>\r\n              </div>\r\n              <Progress value={25} className=\"h-2\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Time Limits by Grade</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2 text-sm\">\r\n              <div className=\"flex justify-between\">\r\n                <span>Primary (K-3)</span>\r\n                <Badge variant=\"outline\">15 minutes</Badge>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>Grade School (4-6)</span>\r\n                <Badge variant=\"outline\">30 minutes</Badge>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>Junior High (7-10)</span>\r\n                <Badge variant=\"outline\">45 minutes</Badge>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>Senior High (11-12)</span>\r\n                <Badge variant=\"outline\">60 minutes</Badge>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EquipmentDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\ErrorReportingDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":289,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":289,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7808,7811],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7808,7811],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  AreaChart,\r\n  Area,\r\n  BarChart,\r\n  Bar,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from 'recharts';\r\nimport {\r\n  AlertTriangle,\r\n  TrendingUp,\r\n  TrendingDown,\r\n  Minus,\r\n  Activity,\r\n  Bug,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertCircle,\r\n  RefreshCw,\r\n  Download,\r\n  User,\r\n} from 'lucide-react';\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport api from '@/services/api';\r\n\r\n// Add ErrorCategory enum definition\r\nenum ErrorCategory {\r\n  AUTHENTICATION = 'AUTHENTICATION',\r\n  AUTHORIZATION = 'AUTHORIZATION',\r\n  VALIDATION = 'VALIDATION',\r\n  DATABASE = 'DATABASE',\r\n  NETWORK = 'NETWORK',\r\n  EXTERNAL_SERVICE = 'EXTERNAL_SERVICE',\r\n  BUSINESS_LOGIC = 'BUSINESS_LOGIC',\r\n  SYSTEM = 'SYSTEM',\r\n  PERFORMANCE = 'PERFORMANCE',\r\n}\r\n\r\ninterface ErrorReport {\r\n  id: string;\r\n  timestamp: string;\r\n  message: string;\r\n  category: string;\r\n  severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';\r\n  statusCode?: number;\r\n  code?: string;\r\n  resolved: boolean;\r\n  resolvedAt?: string;\r\n  resolvedBy?: string;\r\n  assignee?: string;\r\n  tags: string[];\r\n  similarErrors: number;\r\n  impact: {\r\n    usersAffected: number;\r\n    requestsAffected: number;\r\n  };\r\n}\r\n\r\ninterface ErrorDashboard {\r\n  overview: {\r\n    totalErrors: number;\r\n    unresolvedErrors: number;\r\n    criticalErrors: number;\r\n    errorsLast24h: number;\r\n    errorRate: number;\r\n    uptime: number;\r\n  };\r\n  trends: Array<{\r\n    date: string;\r\n    total: number;\r\n    critical: number;\r\n    high: number;\r\n    medium: number;\r\n    low: number;\r\n  }>;\r\n  topErrors: Array<{\r\n    id: string;\r\n    message: string;\r\n    count: number;\r\n    severity: string;\r\n    lastOccurred: string;\r\n  }>;\r\n  categoryBreakdown: Array<{\r\n    category: string;\r\n    count: number;\r\n    percentage: number;\r\n    trend: 'up' | 'down' | 'stable';\r\n  }>;\r\n  severityBreakdown: Array<{\r\n    severity: string;\r\n    count: number;\r\n    percentage: number;\r\n  }>;\r\n  recentActivity: Array<{\r\n    id: string;\r\n    type: 'new_error' | 'resolved' | 'assigned';\r\n    message: string;\r\n    timestamp: string;\r\n    user?: string;\r\n  }>;\r\n}\r\n\r\nconst SEVERITY_COLORS = {\r\n  CRITICAL: '#ef4444',\r\n  HIGH: '#f97316',\r\n  MEDIUM: '#eab308',\r\n  LOW: '#22c55e',\r\n};\r\n\r\nconst CATEGORY_COLORS = {\r\n  AUTHENTICATION: '#8b5cf6',\r\n  AUTHORIZATION: '#06b6d4',\r\n  VALIDATION: '#3b82f6',\r\n  DATABASE: '#ef4444',\r\n  NETWORK: '#f97316',\r\n  EXTERNAL_SERVICE: '#a855f7',\r\n  BUSINESS_LOGIC: '#eab308',\r\n  SYSTEM: '#dc2626',\r\n  PERFORMANCE: '#f59e0b',\r\n};\r\n\r\nexport const ErrorReportingDashboard: React.FC = () => {\r\n  const [timeframe, setTimeframe] = useState<'1h' | '24h' | '7d' | '30d'>(\r\n    '24h'\r\n  );\r\n  const [filterCategory, setFilterCategory] = useState<string>('all');\r\n  const [filterSeverity, setFilterSeverity] = useState<string>('all');\r\n  const [showResolved, setShowResolved] = useState(false);\r\n\r\n  const {\r\n    data: dashboard,\r\n    isLoading,\r\n    error,\r\n    refetch,\r\n  } = useQuery<ErrorDashboard>({\r\n    queryKey: ['error-dashboard', timeframe],\r\n    queryFn: async () => {\r\n      const response = await api.get(\r\n        `/api/errors/dashboard?timeframe=${timeframe}`\r\n      );\r\n      return response.data as ErrorDashboard;\r\n    },\r\n    refetchInterval: 30000, // Refresh every 30 seconds\r\n  });\r\n\r\n  const { data: errorReports } = useQuery<ErrorReport[]>({\r\n    queryKey: ['error-reports', filterCategory, filterSeverity, showResolved],\r\n    queryFn: async () => {\r\n      const params = new URLSearchParams();\r\n      if (filterCategory !== 'all') {\r\n        params.append('category', filterCategory ?? '');\r\n      }\r\n      if (filterSeverity !== 'all') {\r\n        params.append('severity', filterSeverity ?? '');\r\n      }\r\n      if (!showResolved) {\r\n        params.append('resolved', 'false');\r\n      }\r\n\r\n      const response = await api.get(`/api/errors/reports?${params}`);\r\n      return response.data as ErrorReport[];\r\n    },\r\n  });\r\n\r\n  const handleResolveError = async (errorId: string) => {\r\n    try {\r\n      await api.post(`/api/errors/reports/${errorId}/resolve`, {\r\n        resolutionNotes: 'Resolved via dashboard',\r\n      });\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Failed to resolve error:', error);\r\n    }\r\n  };\r\n\r\n  const handleAssignError = async (errorId: string, assignee: string) => {\r\n    try {\r\n      await api.post(`/api/errors/reports/${errorId}/assign`, { assignee });\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Failed to assign error:', error);\r\n    }\r\n  };\r\n\r\n  const handleExportData = async (format: 'json' | 'csv') => {\r\n    try {\r\n      const params = new URLSearchParams();\r\n      params.append('format', format ?? '');\r\n      if (filterCategory !== 'all') {\r\n        params.append('category', filterCategory ?? '');\r\n      }\r\n      if (filterSeverity !== 'all') {\r\n        params.append('severity', filterSeverity ?? '');\r\n      }\r\n\r\n      const response = await api.get(`/api/errors/reports/export?${params}`);\r\n      const blob = new Blob([response.data as string], {\r\n        type: format === 'json' ? 'application/json' : 'text/csv',\r\n      });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `error-reports-${new Date().toISOString().split('T')[0]}.${format}`;\r\n      a.click();\r\n      URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      console.error('Failed to export data:', error);\r\n    }\r\n  };\r\n\r\n  const getTrendIcon = (trend: 'up' | 'down' | 'stable') => {\r\n    switch (trend) {\r\n      case 'up':\r\n        return <TrendingUp className=\"h-4 w-4 text-red-500\" />;\r\n      case 'down':\r\n        return <TrendingDown className=\"h-4 w-4 text-green-500\" />;\r\n      case 'stable':\r\n        return <Minus className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getSeverityIcon = (severity: string) => {\r\n    switch (severity) {\r\n      case 'CRITICAL':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\r\n      case 'HIGH':\r\n        return <AlertTriangle className=\"h-4 w-4 text-orange-500\" />;\r\n      case 'MEDIUM':\r\n        return <AlertCircle className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'LOW':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      default:\r\n        return <Bug className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <RefreshCw className=\"h-8 w-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <div className=\"text-center\">\r\n          <AlertTriangle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\r\n          <p className=\"text-lg font-semibold\">\r\n            Failed to load error dashboard\r\n          </p>\r\n          <Button onClick={() => refetch()} className=\"mt-4\">\r\n            Try Again\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!dashboard) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Error Reporting Dashboard</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Monitor and analyze system errors\r\n          </p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <select\r\n            value={timeframe}\r\n            onChange={(e) => setTimeframe(e.target.value as any)}\r\n            className=\"px-3 py-2 border rounded-md\"\r\n          >\r\n            <option value=\"1h\">Last Hour</option>\r\n            <option value=\"24h\">Last 24 Hours</option>\r\n            <option value=\"7d\">Last 7 Days</option>\r\n            <option value=\"30d\">Last 30 Days</option>\r\n          </select>\r\n          <Button variant=\"outline\" onClick={() => refetch()}>\r\n            <RefreshCw className=\"h-4 w-4\" />\r\n          </Button>\r\n          <Button variant=\"outline\" onClick={() => handleExportData('csv')}>\r\n            <Download className=\"h-4 w-4\" />\r\n            Export CSV\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overview Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Errors</CardTitle>\r\n            <Bug className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {dashboard.overview.totalErrors}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {dashboard.overview.errorsLast24h} in last 24h\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Unresolved</CardTitle>\r\n            <XCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {dashboard.overview.unresolvedErrors}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {dashboard.overview.criticalErrors} critical\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Error Rate</CardTitle>\r\n            <Activity className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {(dashboard.overview.errorRate * 100).toFixed(2)}%\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {dashboard.overview.errorRate > 0.05\r\n                ? 'Above threshold'\r\n                : 'Normal'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Uptime</CardTitle>\r\n            <CheckCircle className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">\r\n              {dashboard.overview.uptime}%\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Last{' '}\r\n              {timeframe === '1h'\r\n                ? 'hour'\r\n                : timeframe === '24h'\r\n                  ? '24 hours'\r\n                  : timeframe}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"trends\">Trends</TabsTrigger>\r\n          <TabsTrigger value=\"reports\">Error Reports</TabsTrigger>\r\n          <TabsTrigger value=\"activity\">Activity</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"overview\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n            {/* Error Trends Chart */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Error Trends</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={300}>\r\n                  <AreaChart data={dashboard.trends}>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" />\r\n                    <XAxis dataKey=\"date\" />\r\n                    <YAxis />\r\n                    <Tooltip />\r\n                    <Legend />\r\n                    <Area\r\n                      type=\"monotone\"\r\n                      dataKey=\"total\"\r\n                      stackId=\"1\"\r\n                      stroke=\"#8884d8\"\r\n                      fill=\"#8884d8\"\r\n                    />\r\n                    <Area\r\n                      type=\"monotone\"\r\n                      dataKey=\"critical\"\r\n                      stackId=\"1\"\r\n                      stroke=\"#ef4444\"\r\n                      fill=\"#ef4444\"\r\n                    />\r\n                  </AreaChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Category Breakdown */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Error Categories</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={300}>\r\n                  <PieChart>\r\n                    <Pie\r\n                      data={dashboard.categoryBreakdown}\r\n                      cx=\"50%\"\r\n                      cy=\"50%\"\r\n                      outerRadius={80}\r\n                      fill=\"#8884d8\"\r\n                      dataKey=\"count\"\r\n                      label={({ category, percentage }) =>\r\n                        `${category} ${percentage}%`\r\n                      }\r\n                    >\r\n                      {dashboard.categoryBreakdown.map((entry, index) => (\r\n                        <Cell\r\n                          key={`cell-${index}`}\r\n                          fill={\r\n                            CATEGORY_COLORS[\r\n                              entry.category as keyof typeof CATEGORY_COLORS\r\n                            ] || '#8884d8'\r\n                          }\r\n                        />\r\n                      ))}\r\n                    </Pie>\r\n                    <Tooltip />\r\n                  </PieChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Top Errors */}\r\n            <Card className=\"lg:col-span-2\">\r\n              <CardHeader>\r\n                <CardTitle>Top Errors</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {dashboard.topErrors.slice(0, 5).map((error) => (\r\n                    <div\r\n                      key={error.id}\r\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex items-center gap-3\">\r\n                        {getSeverityIcon(error.severity)}\r\n                        <div>\r\n                          <p className=\"font-medium\">{error.message}</p>\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {error.count} occurrences ΓÇó Last:{' '}\r\n                            {new Date(error.lastOccurred).toLocaleString()}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <Button variant=\"outline\" size=\"sm\">\r\n                        View Details\r\n                      </Button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"trends\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n            {/* Severity Breakdown */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Severity Distribution</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={300}>\r\n                  <BarChart data={dashboard.severityBreakdown}>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" />\r\n                    <XAxis dataKey=\"severity\" />\r\n                    <YAxis />\r\n                    <Tooltip />\r\n                    <Bar dataKey=\"count\" fill=\"#8884d8\">\r\n                      {dashboard.severityBreakdown.map((entry, index) => (\r\n                        <Cell\r\n                          key={`cell-${index}`}\r\n                          fill={\r\n                            SEVERITY_COLORS[\r\n                              entry.severity as keyof typeof SEVERITY_COLORS\r\n                            ]\r\n                          }\r\n                        />\r\n                      ))}\r\n                    </Bar>\r\n                  </BarChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Category Trends */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Category Trends</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {dashboard.categoryBreakdown.map((category) => (\r\n                    <div\r\n                      key={category.category}\r\n                      className=\"flex items-center justify-between\"\r\n                    >\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {getTrendIcon(category.trend)}\r\n                        <span className=\"font-medium\">{category.category}</span>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-sm text-muted-foreground\">\r\n                          {category.count} ({category.percentage}%)\r\n                        </span>\r\n                        <div className=\"w-16 h-2 bg-gray-200 rounded-full\">\r\n                          <div\r\n                            className=\"h-2 bg-blue-500 rounded-full\"\r\n                            style={{ width: `${category.percentage}%` }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"reports\" className=\"space-y-4\">\r\n          {/* Filters */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Filters</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"flex gap-4 flex-wrap\">\r\n                <select\r\n                  value={filterCategory}\r\n                  onChange={(e) => setFilterCategory(e.target.value)}\r\n                  className=\"px-3 py-2 border rounded-md\"\r\n                >\r\n                  <option value=\"all\">All Categories</option>\r\n                  {Object.values(ErrorCategory).map((category) => (\r\n                    <option key={category} value={category}>\r\n                      {category}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n\r\n                <select\r\n                  value={filterSeverity}\r\n                  onChange={(e) => setFilterSeverity(e.target.value)}\r\n                  className=\"px-3 py-2 border rounded-md\"\r\n                >\r\n                  <option value=\"all\">All Severities</option>\r\n                  {Object.keys(SEVERITY_COLORS).map((severity) => (\r\n                    <option key={severity} value={severity}>\r\n                      {severity}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={showResolved}\r\n                    onChange={(e) => setShowResolved(e.target.checked)}\r\n                    className=\"rounded\"\r\n                  />\r\n                  Show Resolved\r\n                </label>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Error Reports Table */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Error Reports</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {errorReports?.slice(0, 20).map((report) => (\r\n                  <div\r\n                    key={report.id}\r\n                    className=\"border rounded-lg p-4 space-y-2\"\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex items-start gap-3\">\r\n                        {getSeverityIcon(report.severity)}\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"font-medium\">{report.message}</p>\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {report.category} ΓÇó{' '}\r\n                            {new Date(report.timestamp).toLocaleString()}\r\n                          </p>\r\n                          <div className=\"flex items-center gap-4 mt-2 text-sm\">\r\n                            <span>\r\n                              Users affected: {report.impact.usersAffected}\r\n                            </span>\r\n                            <span>\r\n                              Requests affected:{' '}\r\n                              {report.impact.requestsAffected}\r\n                            </span>\r\n                            {report.similarErrors > 0 && (\r\n                              <span>\r\n                                Similar errors: {report.similarErrors}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {report.resolved ? (\r\n                          <span className=\"text-green-600 text-sm\">\r\n                            Resolved\r\n                          </span>\r\n                        ) : (\r\n                          <>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleResolveError(report.id)}\r\n                            >\r\n                              Resolve\r\n                            </Button>\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={() =>\r\n                                handleAssignError(report.id, 'current_user')\r\n                              }\r\n                            >\r\n                              Assign\r\n                            </Button>\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"activity\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Recent Activity</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {dashboard.recentActivity.map((activity) => (\r\n                  <div key={activity.id} className=\"flex items-center gap-3\">\r\n                    <div\r\n                      className={`p-2 rounded-full ${\r\n                        activity.type === 'new_error'\r\n                          ? 'bg-red-100'\r\n                          : activity.type === 'resolved'\r\n                            ? 'bg-green-100'\r\n                            : 'bg-blue-100'\r\n                      }`}\r\n                    >\r\n                      {activity.type === 'new_error' && (\r\n                        <Bug className=\"h-4 w-4 text-red-600\" />\r\n                      )}\r\n                      {activity.type === 'resolved' && (\r\n                        <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n                      )}\r\n                      {activity.type === 'assigned' && (\r\n                        <User className=\"h-4 w-4 text-blue-600\" />\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex-1\">\r\n                      <p className=\"text-sm\">{activity.message}</p>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {new Date(activity.timestamp).toLocaleString()}\r\n                        {activity.user && ` ΓÇó ${activity.user}`}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ErrorReportingDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\NotificationCalendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\QRCodeManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1733,1736],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1733,1736],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1785,1788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1785,1788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1824,1827],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1824,1827],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport {\r\n  QrCode,\r\n  Download,\r\n  CheckCircle2,\r\n  XCircle,\r\n  Loader2,\r\n  Printer,\r\n  Eye,\r\n  FileText,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { utilitiesApi } from '@/lib/api';\r\n\r\ninterface QRGenerationResult {\r\n  studentId: string;\r\n  name: string;\r\n  qrPath: string;\r\n  qrUrl: string;\r\n  success: boolean;\r\n  error?: string;\r\n}\r\n\r\ninterface QRGenerationSummary {\r\n  totalStudents: number;\r\n  successCount: number;\r\n  errorCount: number;\r\n  outputDir: string;\r\n  results: QRGenerationResult[];\r\n  generatedAt: string;\r\n}\r\n\r\nexport function QRCodeManager() {\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [report, setReport] = useState<QRGenerationSummary | null>(null);\r\n  const [showResults, setShowResults] = useState(false);\r\n\r\n  const handleGenerateAll = async () => {\r\n    try {\r\n      setIsGenerating(true);\r\n      toast.info('Starting QR code generation...', {\r\n        duration: 3000,\r\n      });\r\n\r\n      const response = await utilitiesApi.generateQRCodes();\r\n\r\n      if (response.success && response.data) {\r\n        const summary = response.data as QRGenerationSummary;\r\n        setReport(summary);\r\n        setShowResults(true);\r\n        toast.success(\r\n          `Γ£à Generated ${summary.successCount} QR codes successfully!`,\r\n          { duration: 5000 }\r\n        );\r\n      } else {\r\n        throw new Error(\r\n          typeof (response as any).error === 'string'\r\n            ? (response as any).error\r\n            : (response as any).error?.message || 'Generation failed'\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('QR generation error:', error);\r\n      toast.error(\r\n        error instanceof Error ? error.message : 'Failed to generate QR codes'\r\n      );\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleLoadReport = async () => {\r\n    try {\r\n      const response = await utilitiesApi.getQRReport();\r\n\r\n      if (response.success && response.data) {\r\n        setReport(response.data as QRGenerationSummary);\r\n        setShowResults(true);\r\n        toast.success('Report loaded');\r\n      } else {\r\n        toast.error('No generation report found. Generate QR codes first.');\r\n      }\r\n    } catch (error) {\r\n      toast.error('Failed to load report');\r\n    }\r\n  };\r\n\r\n  const handleOpenPrintableSheet = () => {\r\n    // Open in new window\r\n    window.open('/api/utilities/qr-codes-sheet', '_blank');\r\n    toast.success('Opening printable QR codes sheet...');\r\n  };\r\n\r\n  const handleDownloadQRCode = (studentId: string) => {\r\n    const url = `/api/utilities/qr-code/${studentId}`;\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `${studentId}.png`;\r\n    link.click();\r\n    toast.success(`Downloading QR code for ${studentId}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <h2 className=\"text-3xl font-bold tracking-tight text-black dark:text-foreground\">\r\n          QR Code Manager\r\n        </h2>\r\n        <p className=\"text-black dark:text-muted-foreground\">\r\n          Generate and manage QR codes for student check-ins\r\n        </p>\r\n      </div>\r\n\r\n      {/* Action Cards */}\r\n      <div className=\"grid gap-6 md:grid-cols-2\">\r\n        {/* Generate QR Codes Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <QrCode className=\"h-5 w-5\" />\r\n              Generate QR Codes\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Create QR codes for all active students\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              This will generate a unique QR code for each active student in the\r\n              database. The QR codes can be scanned using your USB scanner or\r\n              smartphone camera.\r\n            </div>\r\n\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                onClick={handleGenerateAll}\r\n                disabled={isGenerating}\r\n                className=\"flex-1\"\r\n              >\r\n                {isGenerating ? (\r\n                  <>\r\n                    <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                    Generating...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <QrCode className=\"h-4 w-4 mr-2\" />\r\n                    Generate All\r\n                  </>\r\n                )}\r\n              </Button>\r\n\r\n              <Button onClick={handleLoadReport} variant=\"outline\">\r\n                <FileText className=\"h-4 w-4 mr-2\" />\r\n                Load Report\r\n              </Button>\r\n            </div>\r\n\r\n            {isGenerating && (\r\n              <Alert>\r\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                <AlertDescription>\r\n                  Generating QR codes... This may take a few moments.\r\n                </AlertDescription>\r\n              </Alert>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* View & Print Card */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Printer className=\"h-5 w-5\" />\r\n              View & Print\r\n            </CardTitle>\r\n            <CardDescription>Access printable QR code sheets</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              View all generated QR codes in a printable format. Perfect for\r\n              creating student ID cards or stickers.\r\n            </div>\r\n\r\n            <Button\r\n              onClick={handleOpenPrintableSheet}\r\n              variant=\"outline\"\r\n              className=\"w-full\"\r\n            >\r\n              <Eye className=\"h-4 w-4 mr-2\" />\r\n              Open Printable Sheet\r\n            </Button>\r\n\r\n            <div className=\"text-xs text-muted-foreground\">\r\n              ≡ƒÆí Tip: Print on sticker paper or card stock for durable student\r\n              IDs\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Results Section */}\r\n      {showResults && report && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center justify-between\">\r\n              <span className=\"flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                Generation Report\r\n              </span>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => setShowResults(false)}\r\n              >\r\n                Hide\r\n              </Button>\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Generated on {new Date(report.generatedAt).toLocaleString()}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            {/* Summary Stats */}\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n              <Card className=\"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800\">\r\n                <CardContent className=\"pt-6 text-center\">\r\n                  <div className=\"text-3xl font-bold text-blue-600 dark:text-blue-400\">\r\n                    {report.totalStudents}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">\r\n                    Total Students\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-800\">\r\n                <CardContent className=\"pt-6 text-center\">\r\n                  <div className=\"text-3xl font-bold text-green-600 dark:text-green-400\">\r\n                    {report.successCount}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">Generated</div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-800\">\r\n                <CardContent className=\"pt-6 text-center\">\r\n                  <div className=\"text-3xl font-bold text-red-600 dark:text-red-400\">\r\n                    {report.errorCount}\r\n                  </div>\r\n                  <div className=\"text-sm text-muted-foreground\">Failed</div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Results List */}\r\n            <div>\r\n              <h3 className=\"text-sm font-semibold mb-3\">Individual Results</h3>\r\n              <ScrollArea className=\"h-96 border rounded-lg\">\r\n                <div className=\"p-4 space-y-2\">\r\n                  {report.results.map((result, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className={`\r\n                        flex items-center justify-between p-3 rounded-lg\r\n                        ${\r\n                          result.success\r\n                            ? 'bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800'\r\n                            : 'bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800'\r\n                        }\r\n                      `}\r\n                    >\r\n                      <div className=\"flex items-center gap-3 flex-1\">\r\n                        {result.success ? (\r\n                          <CheckCircle2 className=\"h-5 w-5 text-green-600 dark:text-green-400 shrink-0\" />\r\n                        ) : (\r\n                          <XCircle className=\"h-5 w-5 text-red-600 dark:text-red-400 shrink-0\" />\r\n                        )}\r\n                        <div className=\"min-w-0\">\r\n                          <div className=\"font-semibold text-sm truncate\">\r\n                            {result.name}\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            ID: {result.studentId}\r\n                          </div>\r\n                          {result.error && (\r\n                            <div className=\"text-xs text-red-600 dark:text-red-400 mt-1\">\r\n                              Error: {result.error}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {result.success && (\r\n                        <div className=\"flex gap-2\">\r\n                          <Button\r\n                            size=\"sm\"\r\n                            variant=\"ghost\"\r\n                            onClick={() =>\r\n                              handleDownloadQRCode(result.studentId)\r\n                            }\r\n                          >\r\n                            <Download className=\"h-4 w-4\" />\r\n                          </Button>\r\n                          <Button\r\n                            size=\"sm\"\r\n                            variant=\"ghost\"\r\n                            onClick={() => {\r\n                              window.open(\r\n                                `/api/utilities/qr-code/${result.studentId}`,\r\n                                '_blank'\r\n                              );\r\n                            }}\r\n                          >\r\n                            <Eye className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </ScrollArea>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Instructions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>How to Use QR Codes</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid md:grid-cols-2 gap-4 text-sm\">\r\n            <div>\r\n              <h4 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n                <span className=\"text-2xl\">1∩╕ÅΓâú</span>\r\n                Generate QR Codes\r\n              </h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Click \"Generate All\" to create QR codes for all active students\r\n                in your database.\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <h4 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n                <span className=\"text-2xl\">2∩╕ÅΓâú</span>\r\n                Print or Distribute\r\n              </h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Open the printable sheet and print on sticker paper or card\r\n                stock for student IDs.\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <h4 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n                <span className=\"text-2xl\">3∩╕ÅΓâú</span>\r\n                Scan at Check-in\r\n              </h4>\r\n              <p className=\"text-muted-foreground\">\r\n                Students present their QR code, you scan with USB scanner for\r\n                instant check-in.\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <h4 className=\"font-semibold mb-2 flex items-center gap-2\">\r\n                <span className=\"text-2xl\">4∩╕ÅΓâú</span>\r\n                Works Offline\r\n              </h4>\r\n              <p className=\"text-muted-foreground\">\r\n                QR codes work even without internet. Scans are queued and synced\r\n                later.\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default QRCodeManager;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\QRScannerComponent.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'checkCameraAvailability' and 'cleanup'. Either include them or remove the dependency array.","line":104,"column":6,"nodeType":"ArrayExpression","endLine":104,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [checkCameraAvailability, cleanup, enabled]","fix":{"range":[2708,2717],"text":"[checkCameraAvailability, cleanup, enabled]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'isScanning' and 'startScanning'. Either include them or remove the dependency array.","line":111,"column":6,"nodeType":"ArrayExpression","endLine":111,"endColumn":37,"suggestions":[{"desc":"Update the dependencies array to be: [settings.autoStart, hasCamera, isScanning, startScanning]","fix":{"range":[2867,2898],"text":"[settings.autoStart, hasCamera, isScanning, startScanning]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9086,9089],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9086,9089],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":360,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10063,10066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10063,10066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":363,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10212,10215],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10212,10215],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Camera,\r\n  CameraOff,\r\n  QrCode,\r\n  RefreshCw,\r\n  CheckCircle,\r\n  Zap,\r\n  Settings,\r\n  Activity,\r\n} from 'lucide-react';\r\nimport { BrowserMultiFormatReader, Result } from '@zxing/library';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\ninterface QRScanResult {\r\n  text: string;\r\n  format: string;\r\n  timestamp: Date;\r\n  raw: string;\r\n}\r\n\r\ninterface ScanStatistics {\r\n  totalScans: number;\r\n  successfulScans: number;\r\n  failedScans: number;\r\n  averageScanTime: number;\r\n  lastScanTime: Date | null;\r\n}\r\n\r\ninterface QRScannerProps {\r\n  onScanSuccess?: (result: QRScanResult) => void;\r\n  onScanError?: (error: string) => void;\r\n  enabled?: boolean;\r\n  showSettings?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport default function QRScannerComponent({\r\n  onScanSuccess,\r\n  onScanError,\r\n  enabled = true,\r\n  showSettings = true,\r\n  className = '',\r\n}: QRScannerProps) {\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [hasCamera, setHasCamera] = useState(false);\r\n  const [selectedCamera, setSelectedCamera] = useState<string>('');\r\n  const [cameras, setCameras] = useState<MediaDeviceInfo[]>([]);\r\n  const [lastResult, setLastResult] = useState<QRScanResult | null>(null);\r\n  const [statistics, setStatistics] = useState<ScanStatistics>({\r\n    totalScans: 0,\r\n    successfulScans: 0,\r\n    failedScans: 0,\r\n    averageScanTime: 0,\r\n    lastScanTime: null,\r\n  });\r\n  const [settings, setSettings] = useState({\r\n    autoStart: false,\r\n    continuous: false,\r\n    beepOnScan: true,\r\n    vibrateOnScan: true,\r\n    showOverlay: true,\r\n    torchEnabled: false,\r\n    scanDelay: 1000,\r\n    maxResolutions: true,\r\n  });\r\n\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const codeReaderRef = useRef<BrowserMultiFormatReader | null>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n  const scanTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const lastScanTimeRef = useRef<number>(0);\r\n\r\n  // Initialize QR code reader\r\n  useEffect(() => {\r\n    if (enabled) {\r\n      initializeQRReader();\r\n      checkCameraAvailability();\r\n    }\r\n\r\n    return () => {\r\n      cleanup();\r\n    };\r\n  }, [enabled]);\r\n\r\n  // Auto-start if enabled\r\n  useEffect(() => {\r\n    if (settings.autoStart && hasCamera && !isScanning) {\r\n      startScanning();\r\n    }\r\n  }, [settings.autoStart, hasCamera]);\r\n\r\n  const initializeQRReader = () => {\r\n    try {\r\n      codeReaderRef.current = new BrowserMultiFormatReader();\r\n\r\n      // Configure reader - ZXing library type definitions don't match actual API\r\n      // These features are library-specific and handled internally\r\n      // The reader will automatically process results through decode methods\r\n    } catch (error) {\r\n      console.error('Failed to initialize QR reader:', error);\r\n      toast.error('Failed to initialize QR scanner');\r\n    }\r\n  };\r\n\r\n  const checkCameraAvailability = async () => {\r\n    try {\r\n      const devices = await navigator.mediaDevices.enumerateDevices();\r\n      const videoDevices = devices.filter(\r\n        (device) => device.kind === 'videoinput'\r\n      );\r\n\r\n      setCameras(videoDevices);\r\n      setHasCamera(videoDevices.length > 0);\r\n\r\n      if (videoDevices.length > 0 && !selectedCamera) {\r\n        setSelectedCamera(videoDevices[0]?.deviceId || '');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to check camera availability:', error);\r\n      setHasCamera(false);\r\n    }\r\n  };\r\n\r\n  const startScanning = async () => {\r\n    if (!codeReaderRef.current || !selectedCamera) {\r\n      toast.error('No camera selected or scanner not initialized');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsScanning(true);\r\n\r\n      // Start video stream\r\n      const constraints = {\r\n        video: {\r\n          deviceId: selectedCamera,\r\n          width: settings.maxResolutions ? { ideal: 1920 } : { ideal: 640 },\r\n          height: settings.maxResolutions ? { ideal: 1080 } : { ideal: 480 },\r\n          facingMode: 'environment',\r\n        },\r\n        audio: false,\r\n      };\r\n\r\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n      streamRef.current = stream;\r\n\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        await videoRef.current.play();\r\n      }\r\n\r\n      // Start continuous scanning\r\n      if (settings.continuous) {\r\n        startContinuousScanning();\r\n      } else {\r\n        // Single scan mode\r\n        codeReaderRef.current\r\n          .decodeOnceFromVideoDevice(selectedCamera, 'video')\r\n          .then(handleQRResult)\r\n          .catch(handleQRScanError);\r\n      }\r\n\r\n      toast.success('Camera started successfully');\r\n    } catch (error) {\r\n      console.error('Failed to start scanning:', error);\r\n      handleQRScanError(error);\r\n    }\r\n  };\r\n\r\n  const stopScanning = () => {\r\n    try {\r\n      setIsScanning(false);\r\n\r\n      // Stop video stream\r\n      if (streamRef.current) {\r\n        streamRef.current.getTracks().forEach((track) => track.stop());\r\n        streamRef.current = null;\r\n      }\r\n\r\n      // Clear video\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = null;\r\n      }\r\n\r\n      // Clear scan timeout\r\n      if (scanTimeoutRef.current) {\r\n        clearTimeout(scanTimeoutRef.current);\r\n        scanTimeoutRef.current = null;\r\n      }\r\n\r\n      toast.info('Camera stopped');\r\n    } catch (error) {\r\n      console.error('Failed to stop scanning:', error);\r\n    }\r\n  };\r\n\r\n  const startContinuousScanning = () => {\r\n    if (!codeReaderRef.current || !isScanning) {\r\n      return;\r\n    }\r\n\r\n    const scan = async () => {\r\n      if (!isScanning) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Check if enough time has passed since last scan\r\n        const now = Date.now();\r\n        if (now - lastScanTimeRef.current < settings.scanDelay) {\r\n          scanTimeoutRef.current = setTimeout(scan, 100);\r\n          return;\r\n        }\r\n\r\n        if (videoRef.current && codeReaderRef.current) {\r\n          const result = await codeReaderRef.current.decodeOnceFromVideoDevice(\r\n            selectedCamera,\r\n            'video'\r\n          );\r\n          if (result) {\r\n            handleQRResult(result);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        // Ignore scan errors in continuous mode\r\n      }\r\n\r\n      // Schedule next scan\r\n      if (settings.continuous && isScanning) {\r\n        scanTimeoutRef.current = setTimeout(scan, 100);\r\n      }\r\n    };\r\n\r\n    scan();\r\n  };\r\n\r\n  const handleQRResult = (result: Result) => {\r\n    try {\r\n      const now = Date.now();\r\n      lastScanTimeRef.current = now;\r\n\r\n      const scanResult: QRScanResult = {\r\n        text: result.getText(),\r\n        format: result.getBarcodeFormat().toString(),\r\n        timestamp: new Date(),\r\n        raw: result.getRawBytes().toString(),\r\n      };\r\n\r\n      setLastResult(scanResult);\r\n\r\n      // Update statistics\r\n      const scanTime = now - (statistics.lastScanTime?.getTime() || now);\r\n      setStatistics((prev) => ({\r\n        totalScans: prev.totalScans + 1,\r\n        successfulScans: prev.successfulScans + 1,\r\n        failedScans: prev.failedScans,\r\n        averageScanTime:\r\n          (prev.averageScanTime * prev.totalScans + scanTime) /\r\n          (prev.totalScans + 1),\r\n        lastScanTime: new Date(),\r\n      }));\r\n\r\n      // Provide feedback\r\n      if (settings.beepOnScan) {\r\n        playBeep();\r\n      }\r\n\r\n      if (settings.vibrateOnScan && 'vibrate' in navigator) {\r\n        navigator.vibrate(200);\r\n      }\r\n\r\n      // Call success callback\r\n      onScanSuccess?.(scanResult);\r\n\r\n      // Show success toast\r\n      toast.success(`QR Code scanned: ${scanResult.text}`);\r\n\r\n      // Stop scanning if not in continuous mode\r\n      if (!settings.continuous) {\r\n        stopScanning();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error handling QR result:', error);\r\n      handleQRScanError(error);\r\n    }\r\n  };\r\n\r\n  const handleQRScanError = (error: unknown) => {\r\n    console.error('QR scan error:', error);\r\n\r\n    setStatistics((prev) => ({\r\n      ...prev,\r\n      totalScans: prev.totalScans + 1,\r\n      failedScans: prev.failedScans + 1,\r\n    }));\r\n\r\n    const errorMessage = getErrorMessage(error, 'Failed to scan QR code');\r\n    onScanError?.(errorMessage);\r\n\r\n    // Don't show error toast for continuous scanning errors\r\n    if (!settings.continuous) {\r\n      toast.error(errorMessage);\r\n    }\r\n  };\r\n\r\n  const playBeep = () => {\r\n    try {\r\n      // Create audio context for beep\r\n      const AudioContextClass =\r\n        window.AudioContext || (window as any).webkitAudioContext;\r\n      const audioContext = new AudioContextClass();\r\n      const oscillator = audioContext.createOscillator();\r\n      const gainNode = audioContext.createGain();\r\n\r\n      oscillator.connect(gainNode);\r\n      gainNode.connect(audioContext.destination);\r\n\r\n      oscillator.frequency.value = 1000; // 1kHz beep\r\n      oscillator.type = 'sine';\r\n\r\n      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\r\n      gainNode.gain.exponentialRampToValueAtTime(\r\n        0.01,\r\n        audioContext.currentTime + 0.1\r\n      );\r\n\r\n      oscillator.start(audioContext.currentTime);\r\n      oscillator.stop(audioContext.currentTime + 0.1);\r\n    } catch (error) {\r\n      console.error('Failed to play beep:', error);\r\n    }\r\n  };\r\n\r\n  const toggleTorch = async () => {\r\n    try {\r\n      if (streamRef.current) {\r\n        const track = streamRef.current.getVideoTracks()[0];\r\n        if (track) {\r\n          const capabilities = track.getCapabilities() as any;\r\n          if (capabilities.torch) {\r\n            await track.applyConstraints({\r\n              advanced: [{ torch: !settings.torchEnabled } as any],\r\n            } as MediaTrackConstraints);\r\n            setSettings((prev) => ({\r\n              ...prev,\r\n              torchEnabled: !prev.torchEnabled,\r\n            }));\r\n          } else {\r\n            toast.error('Torch not supported on this device');\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to toggle torch:', error);\r\n      toast.error('Failed to toggle flashlight');\r\n    }\r\n  };\r\n\r\n  const cleanup = () => {\r\n    stopScanning();\r\n    if (codeReaderRef.current) {\r\n      // ZXing library doesn't have removeEventListener in types, but reset handles cleanup\r\n      codeReaderRef.current.reset();\r\n    }\r\n  };\r\n\r\n  const resetStatistics = () => {\r\n    setStatistics({\r\n      totalScans: 0,\r\n      successfulScans: 0,\r\n      failedScans: 0,\r\n      averageScanTime: 0,\r\n      lastScanTime: null,\r\n    });\r\n    setLastResult(null);\r\n  };\r\n\r\n  const switchCamera = async (deviceId: string) => {\r\n    if (isScanning) {\r\n      stopScanning();\r\n      setSelectedCamera(deviceId);\r\n      setTimeout(() => startScanning(), 500);\r\n    } else {\r\n      setSelectedCamera(deviceId);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`space-y-6 ${className}`}>\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center\">\r\n            <QrCode className=\"h-5 w-5 mr-2\" />\r\n            QR Code Scanner\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Scan QR codes and barcodes using your device camera\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* Camera Selection */}\r\n          {cameras.length > 1 && (\r\n            <div className=\"flex items-center space-x-4\">\r\n              <Label htmlFor=\"camera-select\">Camera:</Label>\r\n              <Select value={selectedCamera} onValueChange={switchCamera}>\r\n                <SelectTrigger className=\"w-full max-w-xs\">\r\n                  <SelectValue placeholder=\"Select camera\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {cameras.map((camera) => (\r\n                    <SelectItem key={camera.deviceId} value={camera.deviceId}>\r\n                      <div className=\"flex items-center\">\r\n                        <Camera className=\"h-4 w-4 mr-2\" />\r\n                        {camera.label ||\r\n                          `Camera ${camera.deviceId.slice(0, 8)}`}\r\n                      </div>\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          )}\r\n\r\n          {/* Video Preview */}\r\n          <div className=\"relative\">\r\n            <video\r\n              ref={videoRef}\r\n              className=\"w-full h-64 bg-black rounded-lg object-cover\"\r\n              playsInline\r\n              muted\r\n            />\r\n\r\n            {/* Scanner Overlay */}\r\n            {isScanning && settings.showOverlay && (\r\n              <div className=\"absolute inset-0 pointer-events-none\">\r\n                <div className=\"absolute inset-4 border-2 border-green-500 rounded-lg\">\r\n                  <div className=\"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-green-500\"></div>\r\n                  <div className=\"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-green-500\"></div>\r\n                  <div className=\"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-green-500\"></div>\r\n                  <div className=\"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-green-500\"></div>\r\n                </div>\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"w-48 h-1 bg-green-500 animate-pulse\"></div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Status Indicator */}\r\n            <div className=\"absolute top-2 right-2\">\r\n              <Badge variant={isScanning ? 'default' : 'secondary'}>\r\n                {isScanning ? 'Scanning' : 'Ready'}\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Control Buttons */}\r\n          <div className=\"flex justify-center space-x-4\">\r\n            <Button\r\n              onClick={isScanning ? stopScanning : startScanning}\r\n              disabled={!hasCamera || !selectedCamera}\r\n              size=\"lg\"\r\n            >\r\n              {isScanning ? (\r\n                <>\r\n                  <CameraOff className=\"h-4 w-4 mr-2\" />\r\n                  Stop Scanning\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Camera className=\"h-4 w-4 mr-2\" />\r\n                  Start Scanning\r\n                </>\r\n              )}\r\n            </Button>\r\n\r\n            {hasCamera && (\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={toggleTorch}\r\n                disabled={!streamRef.current}\r\n              >\r\n                <Zap className=\"h-4 w-4 mr-2\" />\r\n                {settings.torchEnabled ? 'Torch Off' : 'Torch On'}\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {!hasCamera && (\r\n            <div className=\"text-center py-8\">\r\n              <CameraOff className=\"h-12 w-12 mx-auto text-gray-400 mb-4\" />\r\n              <p className=\"text-gray-600\">No camera detected</p>\r\n              <p className=\"text-sm text-gray-500\">\r\n                Please ensure you have a camera connected and have granted\r\n                camera permissions\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Last Scan Result */}\r\n          {lastResult && (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center text-sm\">\r\n                  <CheckCircle className=\"h-4 w-4 mr-2 text-green-500\" />\r\n                  Last Scan Result\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600\">Content:</span>\r\n                    <span className=\"font-mono text-sm\">{lastResult.text}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600\">Format:</span>\r\n                    <Badge variant=\"outline\">{lastResult.format}</Badge>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <span className=\"text-sm text-gray-600\">Timestamp:</span>\r\n                    <span className=\"text-sm\">\r\n                      {lastResult.timestamp.toLocaleTimeString()}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Settings Panel */}\r\n      {showSettings && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Settings className=\"h-5 w-5 mr-2\" />\r\n              Scanner Settings\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"auto-start\">Auto-start</Label>\r\n              <Switch\r\n                id=\"auto-start\"\r\n                checked={settings.autoStart}\r\n                onCheckedChange={(checked: boolean) =>\r\n                  setSettings((prev) => ({ ...prev, autoStart: checked }))\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"continuous\">Continuous Scanning</Label>\r\n              <Switch\r\n                id=\"continuous\"\r\n                checked={settings.continuous}\r\n                onCheckedChange={(checked: boolean) => {\r\n                  setSettings((prev) => ({ ...prev, continuous: checked }));\r\n                  if (checked && isScanning) {\r\n                    startContinuousScanning();\r\n                  }\r\n                }}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"beep-on-scan\">Beep on Scan</Label>\r\n              <Switch\r\n                id=\"beep-on-scan\"\r\n                checked={settings.beepOnScan}\r\n                onCheckedChange={(checked: boolean) =>\r\n                  setSettings((prev) => ({ ...prev, beepOnScan: checked }))\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"vibrate-on-scan\">Vibrate on Scan</Label>\r\n              <Switch\r\n                id=\"vibrate-on-scan\"\r\n                checked={settings.vibrateOnScan}\r\n                onCheckedChange={(checked: boolean) =>\r\n                  setSettings((prev) => ({ ...prev, vibrateOnScan: checked }))\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"show-overlay\">Show Scan Overlay</Label>\r\n              <Switch\r\n                id=\"show-overlay\"\r\n                checked={settings.showOverlay}\r\n                onCheckedChange={(checked: boolean) =>\r\n                  setSettings((prev) => ({ ...prev, showOverlay: checked }))\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"max-resolution\">Maximum Resolution</Label>\r\n              <Switch\r\n                id=\"max-resolution\"\r\n                checked={settings.maxResolutions}\r\n                onCheckedChange={(checked: boolean) =>\r\n                  setSettings((prev) => ({ ...prev, maxResolutions: checked }))\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"scan-delay\">Scan Delay (ms)</Label>\r\n              <Input\r\n                id=\"scan-delay\"\r\n                type=\"number\"\r\n                value={settings.scanDelay}\r\n                onChange={(e) =>\r\n                  setSettings((prev) => ({\r\n                    ...prev,\r\n                    scanDelay: parseInt(e.target.value) || 1000,\r\n                  }))\r\n                }\r\n                min=\"100\"\r\n                max=\"5000\"\r\n                step=\"100\"\r\n              />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Statistics */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center justify-between\">\r\n            <span className=\"flex items-center\">\r\n              <Activity className=\"h-4 w-4 mr-2\" />\r\n              Scan Statistics\r\n            </span>\r\n            <Button variant=\"outline\" size=\"sm\" onClick={resetStatistics}>\r\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n              Reset\r\n            </Button>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold\">{statistics.totalScans}</div>\r\n              <p className=\"text-sm text-gray-600\">Total Scans</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                {statistics.successfulScans}\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">Successful</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-red-600\">\r\n                {statistics.failedScans}\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">Failed</p>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold\">\r\n                {statistics.averageScanTime.toFixed(0)}ms\r\n              </div>\r\n              <p className=\"text-sm text-gray-600\">Avg Time</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\RealTimeDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2429,2432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2429,2432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":336,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":336,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12553,12556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12553,12556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { useWebSocketContext } from '@/contexts/WebSocketContext';\r\nimport {\r\n  Monitor,\r\n  Activity,\r\n  Wifi,\r\n  WifiOff,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Clock,\r\n  Zap,\r\n  MessageSquare,\r\n  Bell,\r\n  RefreshCw,\r\n  Settings,\r\n  TrendingUp,\r\n} from 'lucide-react';\r\n\r\ninterface RealTimeDashboardProps {\r\n  className?: string;\r\n}\r\n\r\nexport function RealTimeDashboard({ className }: RealTimeDashboardProps) {\r\n  const {\r\n    isConnected,\r\n    isConnecting,\r\n    error,\r\n    recentActivities,\r\n    equipmentStatus,\r\n    notifications,\r\n    dashboardData,\r\n    triggerEmergencyAlert,\r\n    sendChatMessage,\r\n    refreshDashboard,\r\n  } = useWebSocketContext();\r\n\r\n  const [autoRefresh, setAutoRefresh] = useState(true);\r\n\r\n  // Auto-refresh dashboard data\r\n  useEffect(() => {\r\n    if (!isConnected || !autoRefresh) {\r\n      return;\r\n    }\r\n\r\n    const interval = setInterval(() => {\r\n      refreshDashboard('overview');\r\n      refreshDashboard('activities');\r\n      refreshDashboard('equipment');\r\n    }, 30000); // Refresh every 30 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isConnected, autoRefresh, refreshDashboard]);\r\n\r\n  // Calculate statistics from real-time data\r\n  const stats = {\r\n    totalStudents: dashboardData?.overview?.totalStudents || 0,\r\n    todayActivities:\r\n      dashboardData?.overview?.todayActivities || recentActivities.length,\r\n    activeEquipment:\r\n      dashboardData?.overview?.activeEquipment ||\r\n      Object.keys(equipmentStatus).length,\r\n    activeConnections: dashboardData?.overview?.activeConnections || 0,\r\n    systemLoad: dashboardData?.overview?.systemLoad || 0,\r\n    recentNotifications: notifications.length,\r\n    criticalAlerts: notifications.filter((n) => n.priority === 'critical')\r\n      .length,\r\n  };\r\n\r\n  const handleEmergencyAlert = () => {\r\n    const message = prompt('Enter emergency alert message:');\r\n    if (message) {\r\n      triggerEmergencyAlert('system_emergency', message, 'Main Library');\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = () => {\r\n    const message = prompt('Enter message to broadcast to all staff:');\r\n    if (message) {\r\n      sendChatMessage(message, 'staff');\r\n    }\r\n  };\r\n\r\n  const getActivityIcon = (activity: any) => {\r\n    switch (activity.activityType) {\r\n      case 'CHECK_IN':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'CHECK_OUT':\r\n        return <Clock className=\"h-4 w-4 text-blue-500\" />;\r\n      case 'EQUIPMENT_USE':\r\n        return <Monitor className=\"h-4 w-4 text-purple-500\" />;\r\n      default:\r\n        return <Activity className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getEquipmentStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'AVAILABLE':\r\n        return 'text-green-500';\r\n      case 'IN_USE':\r\n        return 'text-blue-500';\r\n      case 'MAINTENANCE_REQUIRED':\r\n        return 'text-yellow-500';\r\n      case 'MALFUNCTIONING':\r\n        return 'text-red-500';\r\n      default:\r\n        return 'text-gray-500';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`space-y-6 ${className}`}>\r\n      {/* Connection Status Bar */}\r\n      <Card className=\"border-l-4 border-l-blue-500\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              {isConnected ? (\r\n                <>\r\n                  <Wifi className=\"h-5 w-5 text-green-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-green-700 dark:text-green-300\">\r\n                      Real-time Connection Active\r\n                    </p>\r\n                    <p className=\"text-sm text-green-600 dark:text-green-400\">\r\n                      WebSocket connected ΓÇó Live updates enabled\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              ) : isConnecting ? (\r\n                <>\r\n                  <RefreshCw className=\"h-5 w-5 text-yellow-500 animate-spin\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-yellow-700 dark:text-yellow-300\">\r\n                      Connecting to Real-time Updates\r\n                    </p>\r\n                    <p className=\"text-sm text-yellow-600 dark:text-yellow-400\">\r\n                      Establishing WebSocket connection...\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <WifiOff className=\"h-5 w-5 text-red-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-red-700 dark:text-red-300\">\r\n                      Real-time Updates Unavailable\r\n                    </p>\r\n                    <p className=\"text-sm text-red-600 dark:text-red-400\">\r\n                      {error || 'WebSocket connection failed'}\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setAutoRefresh(!autoRefresh)}\r\n                className={autoRefresh ? 'bg-green-50 border-green-200' : ''}\r\n              >\r\n                <RefreshCw\r\n                  className={`h-4 w-4 mr-1 ${autoRefresh ? 'animate-spin' : ''}`}\r\n                />\r\n                Auto-refresh\r\n              </Button>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => refreshDashboard('overview')}\r\n              >\r\n                <RefreshCw className=\"h-4 w-4 mr-1\" />\r\n                Refresh Now\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Real-time Statistics Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <Card className=\"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-blue-600 dark:text-blue-400\">\r\n                  Today's Activities\r\n                </p>\r\n                <p className=\"text-3xl font-bold text-blue-700 dark:text-blue-300\">\r\n                  {stats.todayActivities}\r\n                </p>\r\n                <div className=\"flex items-center mt-2 text-xs text-blue-500\">\r\n                  <TrendingUp className=\"h-3 w-3 mr-1\" />\r\n                  Live from system\r\n                </div>\r\n              </div>\r\n              <Activity className=\"h-8 w-8 text-blue-500 opacity-50\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-green-600 dark:text-green-400\">\r\n                  Active Equipment\r\n                </p>\r\n                <p className=\"text-3xl font-bold text-green-700 dark:text-green-300\">\r\n                  {stats.activeEquipment}\r\n                </p>\r\n                <div className=\"flex items-center mt-2 text-xs text-green-500\">\r\n                  <Monitor className=\"h-3 w-3 mr-1\" />\r\n                  Real-time status\r\n                </div>\r\n              </div>\r\n              <Monitor className=\"h-8 w-8 text-green-500 opacity-50\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-950/20 dark:to-pink-950/20\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-purple-600 dark:text-purple-400\">\r\n                  System Load\r\n                </p>\r\n                <p className=\"text-3xl font-bold text-purple-700 dark:text-purple-300\">\r\n                  {stats.systemLoad}%\r\n                </p>\r\n                <div className=\"flex items-center mt-2 text-xs text-purple-500\">\r\n                  <Zap className=\"h-3 w-3 mr-1\" />\r\n                  Live monitoring\r\n                </div>\r\n              </div>\r\n              <Activity className=\"h-8 w-8 text-purple-500 opacity-50\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-950/20 dark:to-orange-950/20\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-red-600 dark:text-red-400\">\r\n                  Critical Alerts\r\n                </p>\r\n                <p className=\"text-3xl font-bold text-red-700 dark:text-red-300\">\r\n                  {stats.criticalAlerts}\r\n                </p>\r\n                <div className=\"flex items-center mt-2 text-xs text-red-500\">\r\n                  <AlertTriangle className=\"h-3 w-3 mr-1\" />\r\n                  Needs attention\r\n                </div>\r\n              </div>\r\n              <Bell className=\"h-8 w-8 text-red-500 opacity-50\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Real-time Activity Feed */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Clock className=\"h-5 w-5\" />\r\n                Live Activity Feed\r\n              </div>\r\n              <Badge variant=\"outline\" className=\"text-xs\">\r\n                Last 24 hours\r\n              </Badge>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n              {recentActivities.length > 0 ? (\r\n                recentActivities.slice(0, 10).map((activity, index) => (\r\n                  <div\r\n                    key={`${activity.studentId}-${index}`}\r\n                    className=\"flex items-start gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50\"\r\n                  >\r\n                    {getActivityIcon(activity)}\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"font-medium text-sm\">\r\n                        {activity.studentName}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                        {activity.activityType}\r\n                        {activity.equipmentName &&\r\n                          ` ΓÇó ${activity.equipmentName}`}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1\">\r\n                        {new Date(activity.timestamp).toLocaleTimeString()}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <div className=\"text-center py-8\">\r\n                  <Activity className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\r\n                  <p className=\"text-gray-500 dark:text-gray-400\">\r\n                    No recent activity\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Equipment Status */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Monitor className=\"h-5 w-5\" />\r\n                Equipment Status\r\n              </div>\r\n              <Badge variant=\"outline\" className=\"text-xs\">\r\n                Live updates\r\n              </Badge>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n              {Object.keys(equipmentStatus).length > 0 ? (\r\n                Object.entries(equipmentStatus).map(\r\n                  ([equipmentId, status]: [string, any]) => (\r\n                    <div\r\n                      key={equipmentId}\r\n                      className=\"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50\"\r\n                    >\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <Monitor\r\n                          className={`h-4 w-4 ${getEquipmentStatusColor(status.status)}`}\r\n                        />\r\n                        <div>\r\n                          <p className=\"font-medium text-sm\">\r\n                            {status.equipmentName || equipmentId}\r\n                          </p>\r\n                          <p className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                            {status.equipmentType}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <Badge\r\n                          variant={\r\n                            status.status === 'AVAILABLE'\r\n                              ? 'default'\r\n                              : 'secondary'\r\n                          }\r\n                          className=\"text-xs\"\r\n                        >\r\n                          {status.status.replace('_', ' ')}\r\n                        </Badge>\r\n                        {status.userId && (\r\n                          <p className=\"text-xs text-gray-500 mt-1\">In use</p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                )\r\n              ) : (\r\n                <div className=\"text-center py-8\">\r\n                  <Monitor className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\r\n                  <p className=\"text-gray-500 dark:text-gray-400\">\r\n                    No equipment data available\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Real-time Notifications */}\r\n      {notifications.length > 0 && (\r\n        <Card className=\"border-l-4 border-l-orange-500\">\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Bell className=\"h-5 w-5\" />\r\n                Recent Notifications\r\n              </div>\r\n              <Badge variant=\"outline\" className=\"text-xs\">\r\n                {notifications.length} new\r\n              </Badge>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2 max-h-48 overflow-y-auto\">\r\n              {notifications.slice(0, 5).map((notification, index) => (\r\n                <div\r\n                  key={`${notification.id}-${index}`}\r\n                  className=\"flex items-start gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50\"\r\n                >\r\n                  <Bell\r\n                    className={`h-4 w-4 mt-0.5 ${\r\n                      notification.priority === 'critical'\r\n                        ? 'text-red-500'\r\n                        : notification.priority === 'high'\r\n                          ? 'text-orange-500'\r\n                          : notification.priority === 'medium'\r\n                            ? 'text-yellow-500'\r\n                            : 'text-blue-500'\r\n                    }`}\r\n                  />\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <p className=\"font-medium text-sm\">{notification.title}</p>\r\n                    <p className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                      {notification.message}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1\">\r\n                      {new Date(notification.timestamp).toLocaleTimeString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Quick Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Settings className=\"h-5 w-5\" />\r\n            Real-time Actions\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleSendMessage}\r\n              className=\"h-16 flex-col\"\r\n              disabled={!isConnected}\r\n            >\r\n              <MessageSquare className=\"h-5 w-5 mb-2\" />\r\n              <span className=\"text-sm\">Broadcast Message</span>\r\n              <span className=\"text-xs text-gray-500\">Send to all staff</span>\r\n            </Button>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleEmergencyAlert}\r\n              className=\"h-16 flex-col border-red-200 text-red-600 hover:bg-red-50\"\r\n              disabled={!isConnected}\r\n            >\r\n              <AlertTriangle className=\"h-5 w-5 mb-2\" />\r\n              <span className=\"text-sm\">Emergency Alert</span>\r\n              <span className=\"text-xs text-red-500\">\r\n                Critical notification\r\n              </span>\r\n            </Button>\r\n\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => refreshDashboard('all')}\r\n              className=\"h-16 flex-col\"\r\n              disabled={!isConnected}\r\n            >\r\n              <RefreshCw className=\"h-5 w-5 mb-2\" />\r\n              <span className=\"text-sm\">Force Refresh</span>\r\n              <span className=\"text-xs text-gray-500\">Update all data</span>\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RealTimeDashboard;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\RealTimeMonitor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":343,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12663,12666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12663,12666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useWebSocketContext } from '@/contexts/WebSocketContext';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\nimport { useScannerMonitor } from '@/hooks/useUSBScanner';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Activity,\r\n  Users,\r\n  Monitor,\r\n  WifiOff,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  TrendingUp,\r\n  Zap,\r\n  RefreshCw,\r\n  Bell,\r\n  Camera,\r\n  Radio,\r\n} from 'lucide-react';\r\n\r\ninterface RealTimeMonitorProps {\r\n  showScanner?: boolean;\r\n  showActivities?: boolean;\r\n  showEquipment?: boolean;\r\n  compact?: boolean;\r\n}\r\n\r\nexport function RealTimeMonitor({\r\n  showScanner = true,\r\n  showActivities = true,\r\n  showEquipment = true,\r\n}: RealTimeMonitorProps) {\r\n  const { isMobile } = useMobileOptimization();\r\n  const {\r\n    isConnected,\r\n    recentActivities,\r\n    equipmentStatus,\r\n    notifications,\r\n    dashboardData,\r\n    refreshDashboard,\r\n    clearNotifications,\r\n  } = useWebSocketContext();\r\n\r\n  const [stats, setStats] = useState({\r\n    activeStudents: 0,\r\n    availableEquipment: 0,\r\n    activeSessions: 0,\r\n    todayVisits: 0,\r\n  });\r\n\r\n  const [recentScans, setRecentScans] = useState<\r\n    Array<{ code: string; type: string; timestamp: Date }>\r\n  >([]);\r\n\r\n  // Scanner monitoring\r\n  const handleScan = (code: string, type: 'barcode' | 'qr') => {\r\n    setRecentScans((prev) => [\r\n      { code, type, timestamp: new Date() },\r\n      ...prev.slice(0, 9),\r\n    ]);\r\n    toast.success(`Scanned: ${code}`);\r\n  };\r\n\r\n  const scanner = useScannerMonitor(handleScan);\r\n\r\n  // Update stats from dashboard data\r\n  useEffect(() => {\r\n    if (dashboardData.overview) {\r\n      setStats({\r\n        activeStudents: dashboardData.overview.activeStudents || 0,\r\n        availableEquipment: dashboardData.overview.availableEquipment || 0,\r\n        activeSessions: dashboardData.overview.activeSessions || 0,\r\n        todayVisits: dashboardData.overview.todayVisits || 0,\r\n      });\r\n    }\r\n  }, [dashboardData]);\r\n\r\n  // Auto-refresh data\r\n  useEffect(() => {\r\n    if (isConnected) {\r\n      const interval = setInterval(() => {\r\n        refreshDashboard('overview');\r\n      }, 30000); // Refresh every 30 seconds\r\n\r\n      return () => clearInterval(interval);\r\n    }\r\n    return undefined;\r\n  }, [isConnected, refreshDashboard]);\r\n\r\n  const formatTime = (date: Date) => {\r\n    return new Date(date).toLocaleTimeString([], {\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  const getActivityIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'CHECK_IN':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'CHECK_OUT':\r\n        return <AlertCircle className=\"h-4 w-4 text-orange-500\" />;\r\n      default:\r\n        return <Activity className=\"h-4 w-4 text-blue-500\" />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={`space-y-${isMobile ? '3' : '4'}`}>\r\n      {/* Connection Status */}\r\n      <Card\r\n        className={\r\n          isConnected\r\n            ? 'border-green-500 bg-green-50/30 dark:bg-green-950/10'\r\n            : 'border-red-500 bg-red-50/30 dark:bg-red-950/10'\r\n        }\r\n      >\r\n        <CardContent className={`p-${isMobile ? '3' : '4'}`}>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              {isConnected ? (\r\n                <>\r\n                  <Radio className=\"h-5 w-5 text-green-500 animate-pulse\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-green-700 dark:text-green-400\">\r\n                      Real-time Connected\r\n                    </p>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      Live updates active\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <WifiOff className=\"h-5 w-5 text-red-500\" />\r\n                  <div>\r\n                    <p className=\"font-medium text-red-700 dark:text-red-400\">\r\n                      Disconnected\r\n                    </p>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      Attempting to reconnect...\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => refreshDashboard('overview')}\r\n              disabled={!isConnected}\r\n            >\r\n              <RefreshCw className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Stats Grid */}\r\n      <div\r\n        className={`grid gap-${isMobile ? '3' : '4'} ${isMobile ? 'grid-cols-2' : 'md:grid-cols-2 lg:grid-cols-4'}`}\r\n      >\r\n        <Card className=\"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20\">\r\n          <CardContent className={`p-${isMobile ? '3' : '4'} text-center`}>\r\n            <Users className=\"h-6 w-6 mx-auto mb-2 text-blue-600 dark:text-blue-400\" />\r\n            <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">\r\n              {stats.activeStudents}\r\n            </div>\r\n            <p className=\"text-xs text-blue-600 dark:text-blue-400\">\r\n              Active Students\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20\">\r\n          <CardContent className={`p-${isMobile ? '3' : '4'} text-center`}>\r\n            <Monitor className=\"h-6 w-6 mx-auto mb-2 text-green-600 dark:text-green-400\" />\r\n            <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\r\n              {stats.availableEquipment}\r\n            </div>\r\n            <p className=\"text-xs text-green-600 dark:text-green-400\">\r\n              Available\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-950/20 dark:to-pink-950/20\">\r\n          <CardContent className={`p-${isMobile ? '3' : '4'} text-center`}>\r\n            <Zap className=\"h-6 w-6 mx-auto mb-2 text-purple-600 dark:text-purple-400\" />\r\n            <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">\r\n              {stats.activeSessions}\r\n            </div>\r\n            <p className=\"text-xs text-purple-600 dark:text-purple-400\">\r\n              Active Sessions\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/20 dark:to-amber-950/20\">\r\n          <CardContent className={`p-${isMobile ? '3' : '4'} text-center`}>\r\n            <TrendingUp className=\"h-6 w-6 mx-auto mb-2 text-orange-600 dark:text-orange-400\" />\r\n            <div className=\"text-2xl font-bold text-orange-700 dark:text-orange-300\">\r\n              {stats.todayVisits}\r\n            </div>\r\n            <p className=\"text-xs text-orange-600 dark:text-orange-400\">\r\n              Today's Visits\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Scanner Monitor */}\r\n      {showScanner && (\r\n        <Card>\r\n          <CardHeader className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Camera className=\"h-5 w-5\" />\r\n                <CardTitle className=\"text-lg\">Scanner Activity</CardTitle>\r\n              </div>\r\n              {scanner.isScanning && (\r\n                <Badge variant=\"default\" className=\"animate-pulse\">\r\n                  Scanning...\r\n                </Badge>\r\n              )}\r\n            </div>\r\n            <CardDescription>\r\n              {scanner.scanCount} scans detected ΓÇó USB Scanner ready\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className={isMobile ? 'p-3' : 'p-4'}>\r\n            {recentScans.length > 0 ? (\r\n              <div className=\"space-y-2\">\r\n                {recentScans.slice(0, 5).map((scan, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className=\"flex items-center justify-between p-2 rounded-lg bg-muted/50\"\r\n                  >\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        {scan.type}\r\n                      </Badge>\r\n                      <code className=\"text-sm font-mono\">{scan.code}</code>\r\n                    </div>\r\n                    <span className=\"text-xs text-muted-foreground\">\r\n                      {formatTime(scan.timestamp)}\r\n                    </span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                <Camera className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\r\n                <p className=\"text-sm\">Waiting for scanner input...</p>\r\n                <p className=\"text-xs mt-1\">\r\n                  Scan a barcode or QR code to begin\r\n                </p>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Recent Activities */}\r\n      {showActivities && (\r\n        <Card>\r\n          <CardHeader className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Activity className=\"h-5 w-5\" />\r\n                <CardTitle className=\"text-lg\">Live Activities</CardTitle>\r\n              </div>\r\n              <Badge variant=\"outline\">{recentActivities.length}</Badge>\r\n            </div>\r\n            <CardDescription>\r\n              Real-time student activity updates\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className={isMobile ? 'p-3' : 'p-4'}>\r\n            {recentActivities.length > 0 ? (\r\n              <div className=\"space-y-2\">\r\n                {recentActivities.slice(0, 10).map((activity, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className=\"flex items-center justify-between p-3 rounded-lg border hover:bg-muted/50 transition-colors\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {getActivityIcon(activity.activityType)}\r\n                      <div>\r\n                        <p className=\"font-medium text-sm\">\r\n                          {activity.studentName || 'Unknown Student'}\r\n                        </p>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {activity.activityType}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        {formatTime(activity.checkInTime || activity.timestamp)}\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-muted-foreground\">\r\n                <Activity className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\r\n                <p className=\"text-sm\">No recent activities</p>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Equipment Status */}\r\n      {showEquipment && Object.keys(equipmentStatus).length > 0 && (\r\n        <Card>\r\n          <CardHeader className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Monitor className=\"h-5 w-5\" />\r\n              <CardTitle className=\"text-lg\">Equipment Status</CardTitle>\r\n            </div>\r\n            <CardDescription>Live equipment monitoring</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div\r\n              className={`grid gap-3 ${isMobile ? 'grid-cols-1' : 'md:grid-cols-2'}`}\r\n            >\r\n              {Object.values(equipmentStatus)\r\n                .slice(0, 6)\r\n                .map((equipment: any, index) => (\r\n                  <div key={index} className=\"p-3 rounded-lg border\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <span className=\"font-medium text-sm\">\r\n                        {equipment.name}\r\n                      </span>\r\n                      <Badge\r\n                        variant={\r\n                          equipment.status === 'AVAILABLE'\r\n                            ? 'default'\r\n                            : 'secondary'\r\n                        }\r\n                        className=\"text-xs\"\r\n                      >\r\n                        {equipment.status}\r\n                      </Badge>\r\n                    </div>\r\n                    {equipment.currentSession && (\r\n                      <div className=\"text-xs text-muted-foreground\">\r\n                        <div className=\"flex justify-between mb-1\">\r\n                          <span>\r\n                            In use by: {equipment.currentSession.studentName}\r\n                          </span>\r\n                          <span>\r\n                            {equipment.currentSession.remainingMinutes}m left\r\n                          </span>\r\n                        </div>\r\n                        <Progress\r\n                          value={\r\n                            (equipment.currentSession.elapsedMinutes /\r\n                              equipment.currentSession.timeLimitMinutes) *\r\n                            100\r\n                          }\r\n                          className=\"h-1\"\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Notifications */}\r\n      {notifications.length > 0 && (\r\n        <Card className=\"border-orange-500 bg-orange-50/30 dark:bg-orange-950/10\">\r\n          <CardHeader className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Bell className=\"h-5 w-5 text-orange-500\" />\r\n                <CardTitle className=\"text-lg\">Active Notifications</CardTitle>\r\n              </div>\r\n              <Button variant=\"ghost\" size=\"sm\" onClick={clearNotifications}>\r\n                Clear All\r\n              </Button>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className={isMobile ? 'p-3' : 'p-4'}>\r\n            <div className=\"space-y-2\">\r\n              {notifications.slice(0, 5).map((notification, index) => (\r\n                <Alert key={index} className=\"p-3\">\r\n                  <AlertCircle className=\"h-4 w-4\" />\r\n                  <AlertDescription>\r\n                    <div className=\"flex justify-between\">\r\n                      <span>{notification.message}</span>\r\n                      <span className=\"text-xs text-muted-foreground\">\r\n                        {formatTime(notification.timestamp)}\r\n                      </span>\r\n                    </div>\r\n                  </AlertDescription>\r\n                </Alert>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default RealTimeMonitor;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\ReportsBuilder.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1591,1594],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1591,1594],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'mockGeneratedReports' and 'mockTemplates'. Either include them or remove the dependency array.","line":294,"column":6,"nodeType":"ArrayExpression","endLine":294,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [mockGeneratedReports, mockTemplates]","fix":{"range":[7872,7874],"text":"[mockGeneratedReports, mockTemplates]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  PieChart,\r\n  TrendingUp,\r\n  FileText,\r\n  Download,\r\n  Printer,\r\n  Mail,\r\n  Settings,\r\n  Save,\r\n  Play,\r\n  Eye,\r\n  Edit,\r\n  Trash2,\r\n  Plus,\r\n  Users,\r\n  BookOpen,\r\n  Monitor,\r\n  Activity,\r\n  RefreshCw,\r\n  Share2,\r\n  Star,\r\n  CalendarClock,\r\n  BarChart,\r\n  LineChart,\r\n  AreaChart,\r\n  ScatterChart,\r\n} from 'lucide-react';\r\n\r\ninterface ReportTemplate {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  type: 'student' | 'equipment' | 'book' | 'activity' | 'financial' | 'custom';\r\n  category: 'summary' | 'detailed' | 'comparison' | 'trend' | 'statistical';\r\n  chartTypes: string[];\r\n  metrics: string[];\r\n  filters: string[];\r\n  columns: string[];\r\n  isDefault: boolean;\r\n  isFavorite: boolean;\r\n  lastUsed?: string;\r\n  useCount: number;\r\n}\r\n\r\ninterface ReportConfig {\r\n  templateId: string;\r\n  name: string;\r\n  dateRange: {\r\n    start: string;\r\n    end: string;\r\n  };\r\n  filters: Record<string, any>;\r\n  metrics: string[];\r\n  chartType: string;\r\n  groupBy?: string;\r\n  sortBy?: string;\r\n  sortOrder?: 'asc' | 'desc';\r\n  exportFormat?: 'pdf' | 'excel' | 'csv';\r\n  schedule?: {\r\n    enabled: boolean;\r\n    frequency: 'daily' | 'weekly' | 'monthly';\r\n    recipients: string[];\r\n  };\r\n}\r\n\r\ninterface GeneratedReport {\r\n  id: string;\r\n  name: string;\r\n  templateName: string;\r\n  generatedAt: string;\r\n  generatedBy: string;\r\n  dateRange: string;\r\n  status: 'generating' | 'completed' | 'failed';\r\n  fileUrl?: string;\r\n  fileSize?: number;\r\n  recordCount?: number;\r\n}\r\n\r\nexport function ReportsBuilder() {\r\n  // State management\r\n  const [activeTab, setActiveTab] = useState('templates');\r\n  const [reportTemplates, setReportTemplates] = useState<ReportTemplate[]>([]);\r\n  const [generatedReports, setGeneratedReports] = useState<GeneratedReport[]>(\r\n    []\r\n  );\r\n  const [selectedTemplate, setSelectedTemplate] =\r\n    useState<ReportTemplate | null>(null);\r\n  const [reportConfig] = useState<ReportConfig | null>(null);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [isPreviewing, setIsPreviewing] = useState(false);\r\n\r\n  // Dialog states\r\n  const [showCreateReport, setShowCreateReport] = useState(false);\r\n  const [showEditTemplate, setShowEditTemplate] = useState(false);\r\n  const [showScheduleReport, setShowScheduleReport] = useState(false);\r\n  // Loading states\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [isSavingTemplate, setIsSavingTemplate] = useState(false);\r\n  // Mock data\r\n  const mockTemplates: ReportTemplate[] = [\r\n    {\r\n      id: '1',\r\n      name: 'Student Activity Summary',\r\n      description: 'Overview of student library activities and usage patterns',\r\n      type: 'student',\r\n      category: 'summary',\r\n      chartTypes: ['bar', 'pie', 'line'],\r\n      metrics: [\r\n        'total_sessions',\r\n        'unique_students',\r\n        'avg_duration',\r\n        'peak_hours',\r\n      ],\r\n      filters: ['grade_level', 'date_range', 'activity_type', 'status'],\r\n      columns: [\r\n        'student_name',\r\n        'grade_level',\r\n        'total_sessions',\r\n        'last_activity',\r\n        'status',\r\n      ],\r\n      isDefault: true,\r\n      isFavorite: true,\r\n      lastUsed: '2024-01-20',\r\n      useCount: 45,\r\n    },\r\n    {\r\n      id: '2',\r\n      name: 'Equipment Utilization Report',\r\n      description: 'Detailed analysis of equipment usage and availability',\r\n      type: 'equipment',\r\n      category: 'detailed',\r\n      chartTypes: ['bar', 'area', 'line'],\r\n      metrics: [\r\n        'utilization_rate',\r\n        'downtime',\r\n        'maintenance_scheduled',\r\n        'usage_patterns',\r\n      ],\r\n      filters: ['equipment_type', 'date_range', 'location', 'status'],\r\n      columns: [\r\n        'equipment_name',\r\n        'total_hours',\r\n        'utilization_rate',\r\n        'maintenance_due',\r\n        'status',\r\n      ],\r\n      isDefault: true,\r\n      isFavorite: false,\r\n      lastUsed: '2024-01-19',\r\n      useCount: 23,\r\n    },\r\n    {\r\n      id: '3',\r\n      name: 'Book Circulation Analysis',\r\n      description: 'Book borrowing patterns and inventory analysis',\r\n      type: 'book',\r\n      category: 'trend',\r\n      chartTypes: ['line', 'bar', 'scatter'],\r\n      metrics: [\r\n        'borrowed_books',\r\n        'returned_books',\r\n        'overdue_books',\r\n        'popular_categories',\r\n      ],\r\n      filters: ['category', 'date_range', 'grade_level', 'book_status'],\r\n      columns: [\r\n        'book_title',\r\n        'author',\r\n        'category',\r\n        'total_borrows',\r\n        'current_status',\r\n        'overdue_count',\r\n      ],\r\n      isDefault: false,\r\n      isFavorite: true,\r\n      lastUsed: '2024-01-18',\r\n      useCount: 31,\r\n    },\r\n    {\r\n      id: '4',\r\n      name: 'Daily Operations Report',\r\n      description: 'Comprehensive daily library operations summary',\r\n      type: 'activity',\r\n      category: 'summary',\r\n      chartTypes: ['bar', 'pie'],\r\n      metrics: ['daily_visitors', 'total_sessions', 'new_students', 'revenue'],\r\n      filters: ['date', 'shift', 'staff', 'location'],\r\n      columns: ['metric_name', 'value', 'target', 'variance', 'status'],\r\n      isDefault: true,\r\n      isFavorite: false,\r\n      lastUsed: '2024-01-20',\r\n      useCount: 67,\r\n    },\r\n    {\r\n      id: '5',\r\n      name: 'Student Performance Analytics',\r\n      description: 'Academic performance vs library usage correlation',\r\n      type: 'student',\r\n      category: 'statistical',\r\n      chartTypes: ['scatter', 'line', 'bar'],\r\n      metrics: [\r\n        'library_usage',\r\n        'grades_correlation',\r\n        'improvement_trends',\r\n        'engagement_score',\r\n      ],\r\n      filters: [\r\n        'grade_level',\r\n        'subject_area',\r\n        'time_period',\r\n        'performance_range',\r\n      ],\r\n      columns: [\r\n        'student_name',\r\n        'library_hours',\r\n        'grade_average',\r\n        'improvement_rate',\r\n        'engagement_level',\r\n      ],\r\n      isDefault: false,\r\n      isFavorite: false,\r\n      lastUsed: '2024-01-15',\r\n      useCount: 12,\r\n    },\r\n  ];\r\n\r\n  const mockGeneratedReports: GeneratedReport[] = [\r\n    {\r\n      id: '1',\r\n      name: 'January Student Activity Report',\r\n      templateName: 'Student Activity Summary',\r\n      generatedAt: '2024-01-20T10:30:00Z',\r\n      generatedBy: 'Admin',\r\n      dateRange: '2024-01-01 to 2024-01-20',\r\n      status: 'completed',\r\n      fileUrl: '/reports/student-activity-jan-2024.pdf',\r\n      fileSize: 2456789,\r\n      recordCount: 156,\r\n    },\r\n    {\r\n      id: '2',\r\n      name: 'Equipment Utilization Q4 2023',\r\n      templateName: 'Equipment Utilization Report',\r\n      generatedAt: '2024-01-15T14:20:00Z',\r\n      generatedBy: 'Librarian',\r\n      dateRange: '2023-10-01 to 2023-12-31',\r\n      status: 'completed',\r\n      fileUrl: '/reports/equipment-q4-2023.xlsx',\r\n      fileSize: 1234567,\r\n      recordCount: 89,\r\n    },\r\n    {\r\n      id: '3',\r\n      name: 'Weekly Operations Summary',\r\n      templateName: 'Daily Operations Report',\r\n      generatedAt: '2024-01-20T08:00:00Z',\r\n      generatedBy: 'System',\r\n      dateRange: '2024-01-14 to 2024-01-20',\r\n      status: 'generating',\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    setReportTemplates(mockTemplates);\r\n    setGeneratedReports(mockGeneratedReports);\r\n  }, []);\r\n\r\n  // Handler functions\r\n  const handleGenerateReport = async () => {\r\n    if (!selectedTemplate || !reportConfig) {\r\n      toast.error('Please select a template and configure report options');\r\n      return;\r\n    }\r\n\r\n    setIsGenerating(true);\r\n    try {\r\n      // Simulate report generation\r\n      await new Promise((resolve) => setTimeout(resolve, 3000));\r\n\r\n      const newReport: GeneratedReport = {\r\n        id: Date.now().toString(),\r\n        name: reportConfig.name,\r\n        templateName: selectedTemplate.name,\r\n        generatedAt: new Date().toISOString(),\r\n        generatedBy: 'Current User',\r\n        dateRange: `${reportConfig.dateRange.start} to ${reportConfig.dateRange.end}`,\r\n        status: 'completed',\r\n        fileUrl: `/reports/${reportConfig.name.toLowerCase().replace(/\\s+/g, '-')}.pdf`,\r\n        fileSize: Math.floor(Math.random() * 5000000) + 500000,\r\n        recordCount: Math.floor(Math.random() * 200) + 50,\r\n      };\r\n\r\n      setGeneratedReports([newReport, ...generatedReports]);\r\n      toast.success('Report generated successfully!');\r\n      setShowCreateReport(false);\r\n    } catch (error) {\r\n      toast.error('Failed to generate report');\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleExportReport = async (\r\n    _report: GeneratedReport,\r\n    format: 'pdf' | 'excel' | 'csv'\r\n  ) => {\r\n    setIsExporting(true);\r\n    try {\r\n      // Simulate export\r\n      await new Promise((resolve) => setTimeout(resolve, 2000));\r\n      toast.success(`Report exported as ${format.toUpperCase()} successfully!`);\r\n    } catch (error) {\r\n      toast.error('Failed to export report');\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveTemplate = async (template: Partial<ReportTemplate>) => {\r\n    setIsSavingTemplate(true);\r\n    try {\r\n      // Simulate template saving\r\n      await new Promise((resolve) => setTimeout(resolve, 1000));\r\n      const newTemplate: ReportTemplate = {\r\n        id: Date.now().toString(),\r\n        name: template.name || 'New Template',\r\n        description: template.description || '',\r\n        type: template.type || 'custom',\r\n        category: template.category || 'summary',\r\n        chartTypes: template.chartTypes || ['bar'],\r\n        metrics: template.metrics || [],\r\n        filters: template.filters || [],\r\n        columns: template.columns || [],\r\n        isDefault: false,\r\n        isFavorite: false,\r\n        useCount: 0,\r\n      };\r\n\r\n      setReportTemplates([...reportTemplates, newTemplate]);\r\n      toast.success('Template saved successfully!');\r\n      setShowEditTemplate(false);\r\n    } catch (error) {\r\n      toast.error('Failed to save template');\r\n    } finally {\r\n      setIsSavingTemplate(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteTemplate = (templateId: string) => {\r\n    if (confirm('Are you sure you want to delete this template?')) {\r\n      setReportTemplates(reportTemplates.filter((t) => t.id !== templateId));\r\n      toast.success('Template deleted successfully!');\r\n    }\r\n  };\r\n\r\n  const handleToggleFavorite = (templateId: string) => {\r\n    setReportTemplates(\r\n      reportTemplates.map((t) =>\r\n        t.id === templateId ? { ...t, isFavorite: !t.isFavorite } : t\r\n      )\r\n    );\r\n  };\r\n\r\n  const getChartIcon = (chartType: string) => {\r\n    switch (chartType) {\r\n      case 'bar':\r\n        return <BarChart className=\"h-4 w-4\" />;\r\n      case 'pie':\r\n        return <PieChart className=\"h-4 w-4\" />;\r\n      case 'line':\r\n        return <LineChart className=\"h-4 w-4\" />;\r\n      case 'area':\r\n        return <AreaChart className=\"h-4 w-4\" />;\r\n      case 'scatter':\r\n        return <ScatterChart className=\"h-4 w-4\" />;\r\n      default:\r\n        return <BarChart className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  const getTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'student':\r\n        return <Users className=\"h-4 w-4\" />;\r\n      case 'equipment':\r\n        return <Monitor className=\"h-4 w-4\" />;\r\n      case 'book':\r\n        return <BookOpen className=\"h-4 w-4\" />;\r\n      case 'activity':\r\n        return <Activity className=\"h-4 w-4\" />;\r\n      case 'financial':\r\n        return <TrendingUp className=\"h-4 w-4\" />;\r\n      default:\r\n        return <FileText className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  const getCategoryColor = (category: string) => {\r\n    switch (category) {\r\n      case 'summary':\r\n        return 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300';\r\n      case 'detailed':\r\n        return 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300';\r\n      case 'comparison':\r\n        return 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300';\r\n      case 'trend':\r\n        return 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300';\r\n      case 'statistical':\r\n        return 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Enhanced Header */}\r\n      <div className=\"relative\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight text-black dark:text-foreground\">\r\n            Reports Builder\r\n          </h2>\r\n          <p className=\"text-black dark:text-muted-foreground\">\r\n            Create, customize, and generate comprehensive library reports.\r\n          </p>\r\n        </div>\r\n\r\n        {/* Header Action Buttons */}\r\n        <div className=\"absolute top-0 right-0 flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowCreateReport(true)}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Plus className=\"h-4 w-4 mr-1\" />\r\n            Create Report\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowEditTemplate(true)}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Edit className=\"h-4 w-4 mr-1\" />\r\n            New Template\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowScheduleReport(true)}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <CalendarClock className=\"h-4 w-4 mr-1\" />\r\n            Schedule\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <Tabs\r\n        value={activeTab}\r\n        onValueChange={setActiveTab}\r\n        className=\"space-y-6\"\r\n      >\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"templates\">Templates</TabsTrigger>\r\n          <TabsTrigger value=\"builder\">Report Builder</TabsTrigger>\r\n          <TabsTrigger value=\"generated\">Generated Reports</TabsTrigger>\r\n          <TabsTrigger value=\"scheduled\">Scheduled Reports</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Templates Tab */}\r\n        <TabsContent value=\"templates\" className=\"space-y-6\">\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {reportTemplates.map((template) => (\r\n              <Card\r\n                key={template.id}\r\n                className={`hover:shadow-lg transition-all cursor-pointer ${\r\n                  selectedTemplate?.id === template.id\r\n                    ? 'ring-2 ring-blue-500'\r\n                    : ''\r\n                }`}\r\n                onClick={() => setSelectedTemplate(template)}\r\n              >\r\n                <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {getTypeIcon(template.type)}\r\n                      <CardTitle className=\"text-lg\">{template.name}</CardTitle>\r\n                    </div>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleToggleFavorite(template.id);\r\n                      }}\r\n                    >\r\n                      <Star\r\n                        className={`h-4 w-4 ${template.isFavorite ? 'fill-yellow-400 text-yellow-400' : ''}`}\r\n                      />\r\n                    </Button>\r\n                  </div>\r\n                  <CardDescription className=\"text-sm\">\r\n                    {template.description}\r\n                  </CardDescription>\r\n                  <div className=\"flex items-center gap-2 mt-2\">\r\n                    <Badge className={getCategoryColor(template.category)}>\r\n                      {template.category}\r\n                    </Badge>\r\n                    {template.isDefault && (\r\n                      <Badge variant=\"secondary\">Default</Badge>\r\n                    )}\r\n                  </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-3\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium mb-1\">Chart Types:</p>\r\n                      <div className=\"flex gap-1\">\r\n                        {template.chartTypes.slice(0, 3).map((chartType) => (\r\n                          <Badge\r\n                            key={chartType}\r\n                            variant=\"outline\"\r\n                            className=\"text-xs\"\r\n                          >\r\n                            {getChartIcon(\r\n                              selectedTemplate?.chartTypes[0] ?? 'bar'\r\n                            )}\r\n                          </Badge>\r\n                        ))}\r\n                        {template.chartTypes.length > 3 && (\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            +{template.chartTypes.length - 3}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm font-medium mb-1\">Metrics:</p>\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {template.metrics.slice(0, 3).map((metric) => (\r\n                          <Badge\r\n                            key={metric}\r\n                            variant=\"outline\"\r\n                            className=\"text-xs\"\r\n                          >\r\n                            {metric}\r\n                          </Badge>\r\n                        ))}\r\n                        {template.metrics.length > 3 && (\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            +{template.metrics.length - 3}\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\r\n                      <span>Used {template.useCount} times</span>\r\n                      {template.lastUsed && (\r\n                        <span>Last: {template.lastUsed}</span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex gap-2 pt-2\">\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"flex-1\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          setSelectedTemplate(template);\r\n                          setShowCreateReport(true);\r\n                        }}\r\n                      >\r\n                        <Play className=\"h-3 w-3 mr-1\" />\r\n                        Use\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleDeleteTemplate(template.id);\r\n                        }}\r\n                        disabled={template.isDefault}\r\n                      >\r\n                        <Trash2 className=\"h-3 w-3\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Report Builder Tab */}\r\n        <TabsContent value=\"builder\" className=\"space-y-6\">\r\n          {selectedTemplate ? (\r\n            <div className=\"grid gap-6 lg:grid-cols-3\">\r\n              {/* Configuration Panel */}\r\n              <div className=\"lg:col-span-1 space-y-4\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Settings className=\"h-5 w-5\" />\r\n                      Report Configuration\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-4\">\r\n                    <div>\r\n                      <label className=\"text-sm font-medium\">Report Name</label>\r\n                      <Input\r\n                        placeholder=\"Enter report name\"\r\n                        defaultValue={`${selectedTemplate.name} - ${new Date().toLocaleDateString()}`}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-sm font-medium\">Date Range</label>\r\n                      <div className=\"grid grid-cols-2 gap-2\">\r\n                        <Input type=\"date\" placeholder=\"Start date\" />\r\n                        <Input type=\"date\" placeholder=\"End date\" />\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-sm font-medium\">Chart Type</label>\r\n                      <Select\r\n                        defaultValue={selectedTemplate.chartTypes[0] ?? 'bar'}\r\n                      >\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          {selectedTemplate.chartTypes.map((chartType) => (\r\n                            <SelectItem key={chartType} value={chartType}>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                {getChartIcon(chartType)}\r\n                                {chartType.charAt(0).toUpperCase() +\r\n                                  chartType.slice(1)}{' '}\r\n                                Chart\r\n                              </div>\r\n                            </SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-sm font-medium\">Group By</label>\r\n                      <Select>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select grouping\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"day\">Day</SelectItem>\r\n                          <SelectItem value=\"week\">Week</SelectItem>\r\n                          <SelectItem value=\"month\">Month</SelectItem>\r\n                          <SelectItem value=\"grade_level\">\r\n                            Grade Level\r\n                          </SelectItem>\r\n                          <SelectItem value=\"activity_type\">\r\n                            Activity Type\r\n                          </SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-sm font-medium\">Sort By</label>\r\n                      <Select>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder=\"Select sort field\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"date\">Date</SelectItem>\r\n                          <SelectItem value=\"name\">Name</SelectItem>\r\n                          <SelectItem value=\"count\">Count</SelectItem>\r\n                          <SelectItem value=\"duration\">Duration</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"text-lg\">Filters</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"space-y-3\">\r\n                    {selectedTemplate.filters.map((filter) => (\r\n                      <div key={filter}>\r\n                        <label className=\"text-sm font-medium capitalize\">\r\n                          {filter.replace('_', ' ')}\r\n                        </label>\r\n                        <Select>\r\n                          <SelectTrigger>\r\n                            <SelectValue placeholder={`Select ${filter}`} />\r\n                          </SelectTrigger>\r\n                          <SelectContent>\r\n                            <SelectItem value=\"all\">All</SelectItem>\r\n                            <SelectItem value=\"active\">Active</SelectItem>\r\n                            <SelectItem value=\"inactive\">Inactive</SelectItem>\r\n                          </SelectContent>\r\n                        </Select>\r\n                      </div>\r\n                    ))}\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n\r\n              {/* Preview Panel */}\r\n              <div className=\"lg:col-span-2\">\r\n                <Card>\r\n                  <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <CardTitle className=\"flex items-center gap-2\">\r\n                        <Eye className=\"h-5 w-5\" />\r\n                        Report Preview\r\n                      </CardTitle>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => setIsPreviewing(!isPreviewing)}\r\n                        >\r\n                          {isPreviewing ? 'Hide Preview' : 'Show Preview'}\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={handleGenerateReport}\r\n                          disabled={isGenerating}\r\n                        >\r\n                          {isGenerating ? (\r\n                            <>\r\n                              <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                              Generating...\r\n                            </>\r\n                          ) : (\r\n                            <>\r\n                              <Play className=\"h-4 w-4 mr-2\" />\r\n                              Generate Report\r\n                            </>\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    {isPreviewing ? (\r\n                      <div className=\"space-y-4\">\r\n                        {/* Mock Chart Preview */}\r\n                        <div className=\"h-64 bg-muted rounded-lg flex items-center justify-center\">\r\n                          <div className=\"text-center\">\r\n                            {getChartIcon(\r\n                              selectedTemplate.chartTypes[0] ?? 'bar'\r\n                            )}\r\n                            <p className=\"mt-2 text-muted-foreground\">\r\n                              {(selectedTemplate.chartTypes[0] ?? 'bar')\r\n                                .charAt(0)\r\n                                .toUpperCase() +\r\n                                (selectedTemplate.chartTypes[0] ?? 'bar').slice(\r\n                                  1\r\n                                )}{' '}\r\n                              Chart Preview\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                        {/* Mock Data Table */}\r\n                        <div className=\"border rounded-lg\">\r\n                          <div className=\"grid grid-cols-3 gap-4 p-3 bg-muted font-medium text-sm\">\r\n                            {(selectedTemplate.columns?.slice(0, 3) ?? []).map(\r\n                              (column) => (\r\n                                <div key={column}>\r\n                                  {column.replace('_', ' ').toUpperCase()}\r\n                                </div>\r\n                              )\r\n                            )}\r\n                          </div>\r\n                          {Array.from({ length: 5 }).map((_, index) => (\r\n                            <div\r\n                              key={index}\r\n                              className=\"grid grid-cols-3 gap-4 p-3 border-t text-sm\"\r\n                            >\r\n                              <div>Sample Data {index + 1}</div>\r\n                              <div>Value {index + 1}</div>\r\n                              <div>Status {index + 1}</div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"text-center py-12\">\r\n                        <Eye className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                        <p className=\"text-muted-foreground\">\r\n                          Click \"Show Preview\" to see report preview\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"text-center py-12\">\r\n                <FileText className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                <p className=\"text-muted-foreground\">\r\n                  Select a template from the Templates tab to start building\r\n                  your report\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Generated Reports Tab */}\r\n        <TabsContent value=\"generated\" className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center justify-between\">\r\n                <span>Generated Reports</span>\r\n                <Button variant=\"outline\" size=\"sm\">\r\n                  <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n                  Refresh\r\n                </Button>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-3\">\r\n                {generatedReports.map((report) => (\r\n                  <div\r\n                    key={report.id}\r\n                    className=\"flex items-center justify-between p-4 rounded-lg border\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div\r\n                        className={`w-2 h-2 rounded-full ${\r\n                          report.status === 'completed'\r\n                            ? 'bg-green-500'\r\n                            : report.status === 'generating'\r\n                              ? 'bg-yellow-500'\r\n                              : 'bg-red-500'\r\n                        }`}\r\n                      />\r\n                      <div>\r\n                        <div className=\"font-medium\">{report.name}</div>\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          {report.templateName} ΓÇó {report.dateRange} ΓÇó Generated\r\n                          by {report.generatedBy}\r\n                        </div>\r\n                        <div className=\"text-xs text-muted-foreground mt-1\">\r\n                          {report.generatedAt &&\r\n                            new Date(report.generatedAt).toLocaleString()}\r\n                          {report.recordCount &&\r\n                            ` ΓÇó ${report.recordCount} records`}\r\n                          {report.fileSize &&\r\n                            ` ΓÇó ${(report.fileSize / 1024 / 1024).toFixed(2)} MB`}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge\r\n                        variant={\r\n                          report.status === 'completed'\r\n                            ? 'default'\r\n                            : 'secondary'\r\n                        }\r\n                      >\r\n                        {report.status}\r\n                      </Badge>\r\n                      {report.status === 'completed' && (\r\n                        <>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleExportReport(report, 'pdf')}\r\n                            disabled={isExporting}\r\n                          >\r\n                            <Download className=\"h-3 w-3\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() =>\r\n                              toast.info(\r\n                                'Email report - would open email dialog'\r\n                              )\r\n                            }\r\n                          >\r\n                            <Mail className=\"h-3 w-3\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() =>\r\n                              toast.info(\r\n                                'Print report - would open print dialog'\r\n                              )\r\n                            }\r\n                          >\r\n                            <Printer className=\"h-3 w-3\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() =>\r\n                              toast.info(\r\n                                'Share report - would open share dialog'\r\n                              )\r\n                            }\r\n                          >\r\n                            <Share2 className=\"h-3 w-3\" />\r\n                          </Button>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        {/* Scheduled Reports Tab */}\r\n        <TabsContent value=\"scheduled\" className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center justify-between\">\r\n                <span>Scheduled Reports</span>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => setShowScheduleReport(true)}\r\n                >\r\n                  <Plus className=\"h-4 w-4 mr-2\" />\r\n                  Add Schedule\r\n                </Button>\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Automate report generation and delivery on a regular schedule.\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-center py-12\">\r\n                <CalendarClock className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                <p className=\"text-muted-foreground\">\r\n                  No scheduled reports yet\r\n                </p>\r\n                <p className=\"text-sm text-muted-foreground mt-2\">\r\n                  Click \"Add Schedule\" to create your first scheduled report\r\n                </p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Create Report Dialog */}\r\n      <Dialog open={showCreateReport} onOpenChange={setShowCreateReport}>\r\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>Create New Report</DialogTitle>\r\n            <DialogDescription>\r\n              Configure and generate a new report using your selected template.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          {selectedTemplate && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"grid gap-6 lg:grid-cols-3\">\r\n                {/* Configuration */}\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">Report Name *</label>\r\n                    <Input\r\n                      placeholder=\"Enter report name\"\r\n                      defaultValue={`${selectedTemplate.name} - ${new Date().toLocaleDateString()}`}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">Description</label>\r\n                    <Input placeholder=\"Enter report description\" />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">Date Range *</label>\r\n                    <div className=\"space-y-2\">\r\n                      <Input type=\"date\" />\r\n                      <Input type=\"date\" />\r\n                    </div>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"text-sm font-medium\">Export Format</label>\r\n                    <Select defaultValue=\"pdf\">\r\n                      <SelectTrigger>\r\n                        <SelectValue />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"pdf\">PDF Document</SelectItem>\r\n                        <SelectItem value=\"excel\">Excel Spreadsheet</SelectItem>\r\n                        <SelectItem value=\"csv\">CSV File</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Filters */}\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium\">Filters</h4>\r\n                  {selectedTemplate.filters.map((filter) => (\r\n                    <div key={filter}>\r\n                      <label className=\"text-sm font-medium capitalize\">\r\n                        {filter.replace('_', ' ')}\r\n                      </label>\r\n                      <Select>\r\n                        <SelectTrigger>\r\n                          <SelectValue placeholder={`Select ${filter}`} />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"all\">All</SelectItem>\r\n                          <SelectItem value=\"active\">Active</SelectItem>\r\n                          <SelectItem value=\"inactive\">Inactive</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {/* Metrics Selection */}\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium\">Metrics to Include</h4>\r\n                  <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n                    {selectedTemplate.metrics.map((metric) => (\r\n                      <div key={metric} className=\"flex items-center space-x-2\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          id={metric}\r\n                          defaultChecked={true}\r\n                          className=\"rounded\"\r\n                        />\r\n                        <label htmlFor={metric} className=\"text-sm font-medium\">\r\n                          {metric.replace('_', ' ').charAt(0).toUpperCase() +\r\n                            metric.replace('_', ' ').slice(1)}\r\n                        </label>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Schedule Options */}\r\n              <div className=\"border-t pt-4\">\r\n                <h4 className=\"font-medium mb-4\">\r\n                  Schedule Options (Optional)\r\n                </h4>\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <input type=\"checkbox\" id=\"schedule\" className=\"rounded\" />\r\n                    <label htmlFor=\"schedule\" className=\"text-sm font-medium\">\r\n                      Schedule this report\r\n                    </label>\r\n                  </div>\r\n                  <div>\r\n                    <Select disabled>\r\n                      <SelectTrigger>\r\n                        <SelectValue placeholder=\"Select frequency\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"daily\">Daily</SelectItem>\r\n                        <SelectItem value=\"weekly\">Weekly</SelectItem>\r\n                        <SelectItem value=\"monthly\">Monthly</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowCreateReport(false)}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleGenerateReport} disabled={isGenerating}>\r\n              {isGenerating ? (\r\n                <>\r\n                  <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                  Generating...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Play className=\"h-4 w-4 mr-2\" />\r\n                  Generate Report\r\n                </>\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Edit Template Dialog */}\r\n      <Dialog open={showEditTemplate} onOpenChange={setShowEditTemplate}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>Create New Template</DialogTitle>\r\n            <DialogDescription>\r\n              Design a custom report template for your specific needs.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Template Name *</label>\r\n                <Input placeholder=\"Enter template name\" />\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Type *</label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select type\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"student\">Student</SelectItem>\r\n                    <SelectItem value=\"equipment\">Equipment</SelectItem>\r\n                    <SelectItem value=\"book\">Book</SelectItem>\r\n                    <SelectItem value=\"activity\">Activity</SelectItem>\r\n                    <SelectItem value=\"financial\">Financial</SelectItem>\r\n                    <SelectItem value=\"custom\">Custom</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Description</label>\r\n              <Input placeholder=\"Enter template description\" />\r\n            </div>\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"text-sm font-medium\">Category</label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select category\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"summary\">Summary</SelectItem>\r\n                    <SelectItem value=\"detailed\">Detailed</SelectItem>\r\n                    <SelectItem value=\"comparison\">Comparison</SelectItem>\r\n                    <SelectItem value=\"trend\">Trend</SelectItem>\r\n                    <SelectItem value=\"statistical\">Statistical</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium\">\r\n                  Default Chart Type\r\n                </label>\r\n                <Select>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select chart type\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"bar\">Bar Chart</SelectItem>\r\n                    <SelectItem value=\"pie\">Pie Chart</SelectItem>\r\n                    <SelectItem value=\"line\">Line Chart</SelectItem>\r\n                    <SelectItem value=\"area\">Area Chart</SelectItem>\r\n                    <SelectItem value=\"scatter\">Scatter Plot</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Available Filters</label>\r\n              <div className=\"grid grid-cols-2 gap-2 mt-2\">\r\n                {[\r\n                  'date_range',\r\n                  'grade_level',\r\n                  'activity_type',\r\n                  'status',\r\n                  'equipment_type',\r\n                ].map((filter) => (\r\n                  <div key={filter} className=\"flex items-center space-x-2\">\r\n                    <input type=\"checkbox\" id={filter} className=\"rounded\" />\r\n                    <label htmlFor={filter} className=\"text-sm\">\r\n                      {filter.replace('_', ' ').charAt(0).toUpperCase() +\r\n                        filter.replace('_', ' ').slice(1)}\r\n                    </label>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowEditTemplate(false)}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={() => handleSaveTemplate({})}\r\n              disabled={isSavingTemplate}\r\n            >\r\n              {isSavingTemplate ? (\r\n                <>\r\n                  <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                  Saving...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Save className=\"h-4 w-4 mr-2\" />\r\n                  Save Template\r\n                </>\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Schedule Report Dialog */}\r\n      <Dialog open={showScheduleReport} onOpenChange={setShowScheduleReport}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Schedule Report</DialogTitle>\r\n            <DialogDescription>\r\n              Set up automatic report generation and delivery.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Select Template</label>\r\n              <Select>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Choose a template\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {reportTemplates.map((template) => (\r\n                    <SelectItem key={template.id} value={template.id}>\r\n                      {template.name}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Frequency</label>\r\n              <Select>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Select frequency\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"daily\">Daily</SelectItem>\r\n                  <SelectItem value=\"weekly\">Weekly</SelectItem>\r\n                  <SelectItem value=\"monthly\">Monthly</SelectItem>\r\n                  <SelectItem value=\"quarterly\">Quarterly</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Recipients</label>\r\n              <Input placeholder=\"Enter email addresses (comma separated)\" />\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">Delivery Time</label>\r\n              <Input type=\"time\" defaultValue=\"09:00\" />\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"include-attachments\"\r\n                className=\"rounded\"\r\n                defaultChecked\r\n              />\r\n              <label\r\n                htmlFor=\"include-attachments\"\r\n                className=\"text-sm font-medium\"\r\n              >\r\n                Include report as attachment\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowScheduleReport(false)}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={() => {\r\n                toast.success('Report scheduled successfully!');\r\n                setShowScheduleReport(false);\r\n              }}\r\n            >\r\n              <CalendarClock className=\"h-4 w-4 mr-2\" />\r\n              Schedule Report\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ReportsBuilder;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\ScanWorkspace.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2575,2578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2575,2578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'processBarcode' and 'scanResult?.barcode'. Either include them or remove the dependency array.","line":112,"column":6,"nodeType":"ArrayExpression","endLine":112,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [lastScanResult, processBarcode, scanResult?.barcode]","fix":{"range":[3247,3263],"text":"[lastScanResult, processBarcode, scanResult?.barcode]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from '@/components/ui/dialog';\r\nimport { useUsbScanner, useManualEntry } from '@/lib/scanner';\r\nimport selfServiceApi from '@/services/selfServiceApi';\r\nimport { useStudentActivity } from '@/hooks/api-hooks';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport { offlineActions } from '@/lib/offline-queue';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Camera,\r\n  Keyboard,\r\n  Edit3,\r\n  Users,\r\n  BookOpen,\r\n  Monitor,\r\n  Gamepad2,\r\n  Clock,\r\n  AlertCircle,\r\n  Play,\r\n  Square,\r\n  RefreshCw,\r\n  Plus,\r\n  Timer,\r\n  UserPlus,\r\n  FileText,\r\n  Settings,\r\n  Eye,\r\n  AlertTriangle,\r\n  Filter,\r\n  Printer,\r\n  ExternalLink,\r\n  Calendar,\r\n  BarChart3,\r\n  Activity,\r\n  Shield,\r\n  Download,\r\n} from 'lucide-react';\r\n\r\ninterface Student {\r\n  id: string;\r\n  studentId: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  gradeLevel: string;\r\n  gradeCategory: string;\r\n  section?: string;\r\n}\r\n\r\ninterface ScanResult {\r\n  student?: Student;\r\n  barcode: string;\r\n  type: 'student' | 'book' | 'equipment' | 'unknown';\r\n  timestamp: number;\r\n}\r\n\r\nexport function ScanWorkspace() {\r\n  const [scanResult, setScanResult] = useState<ScanResult | null>(null);\r\n  const [selectedAction, setSelectedAction] = useState<string>('');\r\n  const [timeLimit, setTimeLimit] = useState<number>(30);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  // Enhanced state for activity management\r\n  const [showActiveSessions, setShowActiveSessions] = useState(false);\r\n  const [showBulkActions, setShowBulkActions] = useState(false);\r\n  const [selectedSessions, setSelectedSessions] = useState<string[]>([]);\r\n  const [filterStatus, setFilterStatus] = useState<string>('all');\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [isPrintingSessions, setIsPrintingSessions] = useState(false);\r\n\r\n  // Self-service enhancements\r\n  const [cooldownInfo, setCooldownInfo] = useState<{\r\n    studentId: string;\r\n    remainingSeconds: number;\r\n  } | null>(null);\r\n  const [statistics, setStatistics] = useState<any>(null);\r\n\r\n  const { isOnline, lastScanResult } = useAppStore();\r\n  const { toggleListening, isListening, currentInput, lastScannedCode } =\r\n    useUsbScanner();\r\n  const { isOpen, input, setIsOpen, setInput, handleSubmit } = useManualEntry();\r\n  const { mutate: logActivity } = useStudentActivity();\r\n\r\n  // Sound effects\r\n  const successSound = new Audio('/sounds/success.mp3');\r\n  const errorSound = new Audio('/sounds/error.mp3');\r\n  const cooldownSound = new Audio('/sounds/warning.mp3');\r\n\r\n  // Process scanned barcode\r\n  useEffect(() => {\r\n    if (lastScanResult && lastScanResult !== scanResult?.barcode) {\r\n      processBarcode(lastScanResult);\r\n    }\r\n  }, [lastScanResult]);\r\n\r\n  // Cooldown timer effect\r\n  useEffect(() => {\r\n    if (!cooldownInfo) {\r\n      return;\r\n    }\r\n\r\n    const interval = setInterval(() => {\r\n      setCooldownInfo((prev) => {\r\n        if (!prev || prev.remainingSeconds <= 1) {\r\n          return null;\r\n        }\r\n        return {\r\n          ...prev,\r\n          remainingSeconds: prev.remainingSeconds - 1,\r\n        };\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [cooldownInfo]);\r\n\r\n  // Load statistics on mount\r\n  useEffect(() => {\r\n    loadStatistics();\r\n    const interval = setInterval(loadStatistics, 60000); // Refresh every minute\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const loadStatistics = async () => {\r\n    try {\r\n      const result = await selfServiceApi.getStatistics(\r\n        new Date(new Date().setHours(0, 0, 0, 0)), // Today start\r\n        new Date() // Now\r\n      );\r\n      setStatistics(result.data);\r\n    } catch (error) {\r\n      console.error('Failed to load statistics:', error);\r\n    }\r\n  };\r\n\r\n  const processBarcode = async (barcode: string) => {\r\n    setIsProcessing(true);\r\n\r\n    try {\r\n      const result = await selfServiceApi.processScan(barcode);\r\n\r\n      if (result.success) {\r\n        // Play success sound\r\n        try {\r\n          successSound\r\n            .play()\r\n            .catch((e) => console.debug('Audio play failed:', e));\r\n        } catch (e) {\r\n          console.debug('Audio not available:', e);\r\n        }\r\n\r\n        toast.success(result.message, {\r\n          description: result.student\r\n            ? `${result.student.name} - ${result.student.gradeLevel}`\r\n            : undefined,\r\n        });\r\n\r\n        setScanResult({\r\n          student: result.student\r\n            ? ({\r\n                id: result.student.id,\r\n                studentId: result.student.studentId,\r\n                firstName: result.student.name?.split(' ')[0] || '',\r\n                lastName:\r\n                  result.student.name?.split(' ').slice(1).join(' ') ||\r\n                  result.student.name ||\r\n                  '',\r\n                gradeLevel: result.student.gradeLevel,\r\n                gradeCategory: result.student.gradeLevel || '', // Use gradeLevel as gradeCategory\r\n                section: result.student.section || '',\r\n              } as Student)\r\n            : undefined,\r\n          barcode,\r\n          type: 'student' as const,\r\n          timestamp: Date.now(),\r\n        } as ScanResult);\r\n\r\n        if (result.activity) {\r\n          setTimeLimit(result.activity.timeLimit);\r\n        }\r\n      } else {\r\n        if (result.cooldownRemaining && result.cooldownRemaining > 0) {\r\n          // Play cooldown warning sound\r\n          try {\r\n            cooldownSound\r\n              .play()\r\n              .catch((e) => console.debug('Audio play failed:', e));\r\n          } catch (e) {\r\n            console.debug('Audio not available:', e);\r\n          }\r\n\r\n          const minutes = Math.ceil(result.cooldownRemaining / 60);\r\n          toast.warning(result.message, {\r\n            description: `Please wait ${minutes} more minute(s)`,\r\n            duration: 5000,\r\n          });\r\n\r\n          // Set cooldown timer display\r\n          setCooldownInfo({\r\n            studentId: barcode,\r\n            remainingSeconds: result.cooldownRemaining,\r\n          });\r\n        } else {\r\n          // Play error sound\r\n          try {\r\n            errorSound\r\n              .play()\r\n              .catch((e) => console.debug('Audio play failed:', e));\r\n          } catch (e) {\r\n            console.debug('Audio not available:', e);\r\n          }\r\n\r\n          toast.error(result.message);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error processing barcode:', error);\r\n      toast.error('Failed to process scan');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Handle action execution\r\n  const executeAction = async () => {\r\n    if (!scanResult || !selectedAction) {\r\n      return;\r\n    }\r\n\r\n    const activityData = {\r\n      studentId: scanResult.student?.id || scanResult.barcode,\r\n      studentName: scanResult.student\r\n        ? `${scanResult.student.firstName} ${scanResult.student.lastName}`\r\n        : `Unknown (${scanResult.barcode})`,\r\n      gradeLevel: scanResult.student?.gradeLevel || 'Unknown',\r\n      gradeCategory: scanResult.student?.gradeCategory || 'unknown',\r\n      activityType: selectedAction,\r\n      timeLimitMinutes: ['computer', 'gaming', 'avr'].includes(selectedAction)\r\n        ? timeLimit\r\n        : undefined,\r\n      equipmentId: ['computer', 'gaming', 'avr'].includes(selectedAction)\r\n        ? 'auto-assign'\r\n        : undefined,\r\n      startTime: new Date().toISOString(),\r\n      status: 'active',\r\n    };\r\n\r\n    if (isOnline) {\r\n      // Online: use API\r\n      logActivity(activityData);\r\n    } else {\r\n      // Offline: queue for later\r\n      await offlineActions.logActivity(activityData);\r\n    }\r\n\r\n    // Reset for next scan\r\n    setScanResult(null);\r\n    setSelectedAction('');\r\n    setTimeLimit(30);\r\n  };\r\n\r\n  // Enhanced Activity Management Handlers\r\n  const handleBulkCheckout = async () => {\r\n    try {\r\n      // Mock bulk checkout functionality\r\n      toast.success(\r\n        `Bulk checkout initiated for ${selectedSessions.length} sessions`\r\n      );\r\n      setSelectedSessions([]);\r\n      setShowBulkActions(false);\r\n    } catch (error) {\r\n      toast.error('Failed to perform bulk checkout');\r\n    }\r\n  };\r\n\r\n  const handleBulkExtendTime = async (additionalMinutes: number) => {\r\n    try {\r\n      // Mock bulk time extension\r\n      toast.success(\r\n        `Extended time by ${additionalMinutes} minutes for ${selectedSessions.length} sessions`\r\n      );\r\n      setSelectedSessions([]);\r\n      setShowBulkActions(false);\r\n    } catch (error) {\r\n      toast.error('Failed to extend session times');\r\n    }\r\n  };\r\n\r\n  const handleBulkNotify = async () => {\r\n    try {\r\n      // Mock bulk notification\r\n      toast.success(\r\n        `Notifications sent to ${selectedSessions.length} students`\r\n      );\r\n      setSelectedSessions([]);\r\n      setShowBulkActions(false);\r\n    } catch (error) {\r\n      toast.error('Failed to send notifications');\r\n    }\r\n  };\r\n\r\n  const handleExportSessions = async () => {\r\n    try {\r\n      setIsExporting(true);\r\n      // Mock export functionality\r\n      const csvContent = `Session ID,Student Name,Activity,Start Time,Status\\n${selectedSessions\r\n        .map((id) => `${id},Student Name,Activity,Time,Active`)\r\n        .join('\\n')}`;\r\n\r\n      const blob = new Blob([csvContent], { type: 'text/csv' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `sessions-export-${\r\n        new Date().toISOString().split('T')[0]\r\n      }.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success('Sessions exported successfully!');\r\n    } catch (error) {\r\n      toast.error('Failed to export sessions');\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const handlePrintSessions = () => {\r\n    try {\r\n      setIsPrintingSessions(true);\r\n      window.print();\r\n      toast.success('Print dialog opened for sessions');\r\n    } catch (error) {\r\n      toast.error('Failed to open print dialog');\r\n    } finally {\r\n      setIsPrintingSessions(false);\r\n    }\r\n  };\r\n\r\n  const handleTransferEquipment = (sessionId: string) => {\r\n    toast.info(\r\n      `Equipment transfer for session ${sessionId} - would open transfer dialog`\r\n    );\r\n  };\r\n\r\n  const handleAddSessionNotes = (sessionId: string) => {\r\n    toast.info(`Add notes for session ${sessionId} - would open notes dialog`);\r\n  };\r\n\r\n  const handleViewStudentHistory = (studentId: string) => {\r\n    toast.info(\r\n      `View history for student ${studentId} - would open history dialog`\r\n    );\r\n  };\r\n\r\n  const handlePrintHallPass = (sessionId: string) => {\r\n    toast.info(\r\n      `Print hall pass for session ${sessionId} - would generate pass`\r\n    );\r\n  };\r\n\r\n  const toggleSessionSelection = (sessionId: string) => {\r\n    setSelectedSessions((prev) =>\r\n      prev.includes(sessionId)\r\n        ? prev.filter((id) => id !== sessionId)\r\n        : [...prev, sessionId]\r\n    );\r\n  };\r\n\r\n  // Mock active sessions data\r\n  const mockActiveSessions = [\r\n    {\r\n      id: '1',\r\n      studentName: 'Juan Dela Cruz',\r\n      activity: 'Computer Session',\r\n      startTime: '10:30 AM',\r\n      status: 'active',\r\n      equipment: 'PC Station 1',\r\n    },\r\n    {\r\n      id: '2',\r\n      studentName: 'Maria Santos',\r\n      activity: 'Gaming Session',\r\n      startTime: '11:15 AM',\r\n      status: 'active',\r\n      equipment: 'Recreational Room',\r\n    },\r\n    {\r\n      id: '3',\r\n      studentName: 'Jose Reyes',\r\n      activity: 'AVR Room',\r\n      startTime: '09:45 AM',\r\n      status: 'overdue',\r\n      equipment: 'AVR Room',\r\n    },\r\n  ];\r\n\r\n  const filteredSessions =\r\n    filterStatus === 'all'\r\n      ? mockActiveSessions\r\n      : mockActiveSessions.filter((session) => session.status === filterStatus);\r\n\r\n  // Get time limit based on grade category\r\n  const getDefaultTimeLimit = (gradeCategory?: string) => {\r\n    switch (gradeCategory) {\r\n      case 'primary':\r\n        return 15;\r\n      case 'gradeSchool':\r\n        return 30;\r\n      case 'juniorHigh':\r\n        return 45;\r\n      case 'seniorHigh':\r\n        return 60;\r\n      default:\r\n        return 30;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (scanResult?.student) {\r\n      setTimeLimit(getDefaultTimeLimit(scanResult.student.gradeCategory));\r\n    }\r\n  }, [scanResult]);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Enhanced Header with Action Buttons */}\r\n      <div className=\"relative\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold tracking-tight text-black dark:text-foreground\">\r\n            Activity Management\r\n          </h2>\r\n          <p className=\"text-black dark:text-muted-foreground\">\r\n            Scan student IDs, books, or equipment for library activities.\r\n          </p>\r\n        </div>\r\n\r\n        {/* Header Action Buttons */}\r\n        <div className=\"absolute top-0 right-0 flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowActiveSessions(!showActiveSessions)}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Eye className=\"h-4 w-4 mr-1\" />\r\n            {showActiveSessions ? 'Hide' : 'Show'} Sessions\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowBulkActions(!showBulkActions)}\r\n            disabled={selectedSessions.length === 0}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Users className=\"h-4 w-4 mr-1\" />\r\n            Bulk Actions ({selectedSessions.length})\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={handleExportSessions}\r\n            disabled={isExporting || selectedSessions.length === 0}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Download className=\"h-4 w-4 mr-1\" />\r\n            Export\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={handlePrintSessions}\r\n            disabled={isPrintingSessions}\r\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\r\n          >\r\n            <Printer className=\"h-4 w-4 mr-1\" />\r\n            Print\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Connection Status */}\r\n      <Alert>\r\n        <AlertCircle className=\"h-4 w-4\" />\r\n        <AlertDescription>\r\n          {isOnline\r\n            ? 'Online mode - All activities will be synced to the server immediately.'\r\n            : 'Offline mode - Activities will be queued and synced when connection is restored.'}\r\n        </AlertDescription>\r\n      </Alert>\r\n\r\n      {/* Visual Cooldown Timer */}\r\n      {cooldownInfo && (\r\n        <Alert className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/20\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription className=\"flex items-center justify-between\">\r\n            <span>\r\n              <strong>Cooldown Active:</strong> Please wait before checking in\r\n              again\r\n            </span>\r\n            <div className=\"flex items-center gap-2\">\r\n              <div className=\"w-32 bg-gray-200 rounded-full h-2\">\r\n                <div\r\n                  className=\"bg-orange-500 h-2 rounded-full transition-all duration-1000\"\r\n                  style={{\r\n                    width: `${((30 * 60 - cooldownInfo.remainingSeconds) / (30 * 60)) * 100}%`,\r\n                  }}\r\n                />\r\n              </div>\r\n              <span className=\"font-mono text-sm font-semibold\">\r\n                {Math.floor(cooldownInfo.remainingSeconds / 60)}:\r\n                {(cooldownInfo.remainingSeconds % 60)\r\n                  .toString()\r\n                  .padStart(2, '0')}\r\n              </span>\r\n            </div>\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Self-Service Statistics Dashboard */}\r\n      {statistics && (\r\n        <div className=\"grid gap-4 md:grid-cols-3\">\r\n          <Card className=\"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/20\">\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-blue-600 dark:text-blue-400\">\r\n                    Check-ins Today\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">\r\n                    {statistics.totalCheckIns}\r\n                  </p>\r\n                </div>\r\n                <Users className=\"h-8 w-8 text-blue-500\" />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950/20\">\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-green-600 dark:text-green-400\">\r\n                    Unique Students\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\r\n                    {statistics.uniqueStudents}\r\n                  </p>\r\n                </div>\r\n                <Activity className=\"h-8 w-8 text-green-500\" />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"border-purple-200 bg-purple-50 dark:border-purple-800 dark:bg-purple-950/20\">\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-purple-600 dark:text-purple-400\">\r\n                    Avg Time\r\n                  </p>\r\n                  <p className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">\r\n                    {statistics.averageTimeSpent} min\r\n                  </p>\r\n                </div>\r\n                <Clock className=\"h-8 w-8 text-purple-500\" />\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      )}\r\n\r\n      {/* Enhanced Filter Buttons */}\r\n      <div className=\"flex items-center justify-between p-4 bg-muted/50 rounded-lg\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <Filter className=\"h-4 w-4 text-muted-foreground\" />\r\n          <span className=\"text-sm font-medium\">Filter Sessions:</span>\r\n          <div className=\"flex gap-1\">\r\n            <Button\r\n              variant={filterStatus === 'all' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setFilterStatus('all')}\r\n            >\r\n              All ({mockActiveSessions.length})\r\n            </Button>\r\n            <Button\r\n              variant={filterStatus === 'active' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setFilterStatus('active')}\r\n            >\r\n              Active (\r\n              {mockActiveSessions.filter((s) => s.status === 'active').length})\r\n            </Button>\r\n            <Button\r\n              variant={filterStatus === 'overdue' ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              onClick={() => setFilterStatus('overdue')}\r\n            >\r\n              Overdue (\r\n              {mockActiveSessions.filter((s) => s.status === 'overdue').length})\r\n            </Button>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex gap-1\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() =>\r\n              toast.info('Manual session entry - would open entry form')\r\n            }\r\n          >\r\n            <Plus className=\"h-3 w-3 mr-1\" />\r\n            Manual Entry\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() =>\r\n              toast.info('End all active sessions - would confirm action')\r\n            }\r\n          >\r\n            <Square className=\"h-3 w-3 mr-1\" />\r\n            End All\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bulk Actions Panel */}\r\n      {showBulkActions && selectedSessions.length > 0 && (\r\n        <Card className=\"border-2 border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/20\">\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-lg flex items-center justify-between\">\r\n              <span>\r\n                Bulk Actions - {selectedSessions.length} Sessions Selected\r\n              </span>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setShowBulkActions(false);\r\n                  setSelectedSessions([]);\r\n                }}\r\n              >\r\n                ├ù\r\n              </Button>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {/* Time Extension Actions */}\r\n              <div>\r\n                <p className=\"text-sm font-medium mb-2\">Extend Time:</p>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleBulkExtendTime(15)}\r\n                  >\r\n                    <Timer className=\"h-3 w-3 mr-1\" />\r\n                    +15 min\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleBulkExtendTime(30)}\r\n                  >\r\n                    <Timer className=\"h-3 w-3 mr-1\" />\r\n                    +30 min\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleBulkExtendTime(60)}\r\n                  >\r\n                    <Timer className=\"h-3 w-3 mr-1\" />\r\n                    +60 min\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Other Bulk Actions */}\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                <Button\r\n                  variant=\"destructive\"\r\n                  size=\"sm\"\r\n                  onClick={handleBulkCheckout}\r\n                >\r\n                  <Square className=\"h-3 w-3 mr-1\" />\r\n                  End Sessions\r\n                </Button>\r\n                <Button variant=\"outline\" size=\"sm\" onClick={handleBulkNotify}>\r\n                  <AlertCircle className=\"h-3 w-3 mr-1\" />\r\n                  Send Notices\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Selected Sessions Summary */}\r\n              <div className=\"text-xs text-muted-foreground bg-white/50 dark:bg-gray-800/50 p-2 rounded\">\r\n                Selected Sessions: {selectedSessions.join(', ')}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Active Sessions Panel */}\r\n      {showActiveSessions && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center justify-between\">\r\n              <span>Active Sessions ({filteredSessions.length})</span>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => setShowActiveSessions(false)}\r\n              >\r\n                ├ù\r\n              </Button>\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Manage current library sessions and student activities\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              {filteredSessions.map((session) => (\r\n                <div\r\n                  key={session.id}\r\n                  className={`p-4 rounded-lg border ${\r\n                    session.status === 'overdue'\r\n                      ? 'bg-red-50 border-red-200 dark:bg-red-950/20 dark:border-red-800'\r\n                      : 'bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedSessions.includes(session.id)}\r\n                        onChange={() => toggleSessionSelection(session.id)}\r\n                        className=\"rounded\"\r\n                      />\r\n                      <div>\r\n                        <div className=\"font-medium\">{session.studentName}</div>\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          {session.activity} ΓÇó {session.equipment} ΓÇó{' '}\r\n                          {session.startTime}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge\r\n                        variant={\r\n                          session.status === 'overdue'\r\n                            ? 'destructive'\r\n                            : 'default'\r\n                        }\r\n                        className=\"text-xs\"\r\n                      >\r\n                        {session.status.toUpperCase()}\r\n                      </Badge>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleViewStudentHistory(session.id)}\r\n                      >\r\n                        <Eye className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleTransferEquipment(session.id)}\r\n                      >\r\n                        <ExternalLink className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handleAddSessionNotes(session.id)}\r\n                      >\r\n                        <FileText className=\"h-3 w-3\" />\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => handlePrintHallPass(session.id)}\r\n                      >\r\n                        <Printer className=\"h-3 w-3\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Session Action Buttons */}\r\n                  <div className=\"flex gap-1 mt-3 pt-3 border-t\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleBulkExtendTime(15)}\r\n                    >\r\n                      <Timer className=\"h-3 w-3 mr-1\" />\r\n                      +15\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleBulkExtendTime(30)}\r\n                    >\r\n                      <Timer className=\"h-3 w-3 mr-1\" />\r\n                      +30\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleBulkExtendTime(60)}\r\n                    >\r\n                      <Timer className=\"h-3 w-3 mr-1\" />\r\n                      +60\r\n                    </Button>\r\n                    <Button\r\n                      variant=\"destructive\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleBulkCheckout()}\r\n                    >\r\n                      <Square className=\"h-3 w-3 mr-1\" />\r\n                      End\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <div className=\"grid gap-6 lg:grid-cols-2\">\r\n        {/* Scanner Section */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Barcode Scanner</CardTitle>\r\n            <CardDescription>\r\n              Choose your preferred scanning method\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Tabs defaultValue=\"usb\" className=\"space-y-4\">\r\n              <TabsList className=\"grid w-full grid-cols-2\">\r\n                <TabsTrigger\r\n                  value=\"usb\"\r\n                  className=\"flex items-center space-x-2\"\r\n                >\r\n                  <Keyboard className=\"h-4 w-4\" />\r\n                  <span>USB Scanner</span>\r\n                </TabsTrigger>\r\n                <TabsTrigger\r\n                  value=\"manual\"\r\n                  className=\"flex items-center space-x-2\"\r\n                >\r\n                  <Edit3 className=\"h-4 w-4\" />\r\n                  <span>Manual Entry</span>\r\n                </TabsTrigger>\r\n              </TabsList>\r\n\r\n              {/* USB Scanner */}\r\n              <TabsContent value=\"usb\" className=\"space-y-4\">\r\n                <div className=\"space-y-4\">\r\n                  <div\r\n                    className={`\r\n                    p-8 rounded-lg border-2 text-center transition-all\r\n                    ${\r\n                      isListening\r\n                        ? 'border-green-500 bg-green-50 dark:bg-green-950/20'\r\n                        : 'border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50'\r\n                    }\r\n                  `}\r\n                  >\r\n                    <Keyboard\r\n                      className={`h-16 w-16 mx-auto mb-4 ${\r\n                        isListening\r\n                          ? 'text-green-600 dark:text-green-400 animate-pulse'\r\n                          : 'text-muted-foreground'\r\n                      }`}\r\n                    />\r\n\r\n                    {isListening ? (\r\n                      <div className=\"space-y-3\">\r\n                        <div className=\"flex items-center justify-center gap-2\">\r\n                          <div className=\"h-2 w-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n                          <p className=\"text-lg font-semibold text-green-700 dark:text-green-300\">\r\n                            USB Scanner ACTIVE\r\n                          </p>\r\n                        </div>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          Scan any barcode or QR code with your USB scanner\r\n                        </p>\r\n                        {currentInput && (\r\n                          <div className=\"mt-4 p-3 bg-white dark:bg-gray-800 rounded border border-green-300 dark:border-green-700\">\r\n                            <p className=\"text-xs text-muted-foreground mb-1\">\r\n                              Reading:\r\n                            </p>\r\n                            <p className=\"font-mono text-lg font-bold text-green-600 dark:text-green-400\">\r\n                              {currentInput}_\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n                        {lastScannedCode && (\r\n                          <div className=\"mt-2 p-2 bg-green-100 dark:bg-green-900/30 rounded\">\r\n                            <p className=\"text-xs text-muted-foreground mb-1\">\r\n                              Last scanned:\r\n                            </p>\r\n                            <p className=\"font-mono text-sm font-semibold text-green-700 dark:text-green-300\">\r\n                              {lastScannedCode}\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"space-y-3\">\r\n                        <p className=\"text-muted-foreground mb-4\">\r\n                          USB Scanner is deactivated\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n\r\n                    <Button\r\n                      onClick={toggleListening}\r\n                      variant={isListening ? 'destructive' : 'default'}\r\n                      className=\"mt-4\"\r\n                    >\r\n                      {isListening ? (\r\n                        <>\r\n                          <Square className=\"h-4 w-4 mr-2\" />\r\n                          Deactivate Scanner\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <Play className=\"h-4 w-4 mr-2\" />\r\n                          Activate Scanner\r\n                        </>\r\n                      )}\r\n                    </Button>\r\n                  </div>\r\n\r\n                  <Alert>\r\n                    <AlertCircle className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                      <strong>How to use:</strong> Make sure this window is\r\n                      focused, then scan any barcode with your USB scanner. The\r\n                      scanner will automatically detect and process the barcode.\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                </div>\r\n              </TabsContent>\r\n\r\n              {/* Manual Entry */}\r\n              <TabsContent value=\"manual\" className=\"space-y-4\">\r\n                <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n                  <DialogTrigger asChild>\r\n                    <Button className=\"w-full\">\r\n                      <Edit3 className=\"h-4 w-4 mr-2\" />\r\n                      Manual Entry\r\n                    </Button>\r\n                  </DialogTrigger>\r\n                  <DialogContent>\r\n                    <DialogHeader>\r\n                      <DialogTitle>Manual Barcode Entry</DialogTitle>\r\n                      <DialogDescription>\r\n                        Enter barcode manually when scanning is not available.\r\n                      </DialogDescription>\r\n                    </DialogHeader>\r\n                    <div className=\"space-y-4\">\r\n                      <Input\r\n                        placeholder=\"Enter barcode...\"\r\n                        value={input}\r\n                        onChange={(e) => setInput(e.target.value)}\r\n                        onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}\r\n                      />\r\n                      <Button onClick={handleSubmit} className=\"w-full\">\r\n                        Submit\r\n                      </Button>\r\n                    </div>\r\n                  </DialogContent>\r\n                </Dialog>\r\n              </TabsContent>\r\n            </Tabs>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Result & Action Section */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Scan Result & Actions</CardTitle>\r\n            <CardDescription>\r\n              Review scan result and select appropriate action\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {isProcessing ? (\r\n              <div className=\"text-center py-8\">\r\n                <RefreshCw className=\"h-8 w-8 mx-auto mb-4 animate-spin\" />\r\n                <p className=\"text-muted-foreground\">Processing barcode...</p>\r\n              </div>\r\n            ) : scanResult ? (\r\n              <div className=\"space-y-4\">\r\n                {/* Scan Result Display */}\r\n                <div className=\"p-4 bg-muted rounded-lg\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <Badge\r\n                      variant={\r\n                        scanResult.type === 'student'\r\n                          ? 'default'\r\n                          : scanResult.type === 'book'\r\n                            ? 'secondary'\r\n                            : scanResult.type === 'equipment'\r\n                              ? 'outline'\r\n                              : 'destructive'\r\n                      }\r\n                    >\r\n                      {scanResult.type.toUpperCase()}\r\n                    </Badge>\r\n                    <span className=\"text-xs text-muted-foreground\">\r\n                      {new Date(scanResult.timestamp).toLocaleTimeString()}\r\n                    </span>\r\n                  </div>\r\n\r\n                  {scanResult.student ? (\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <Users className=\"h-4 w-4\" />\r\n                        <span className=\"font-medium\">\r\n                          {scanResult.student.firstName}{' '}\r\n                          {scanResult.student.lastName}\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                        <div>ID: {scanResult.student.studentId}</div>\r\n                        <div>\r\n                          Grade: {scanResult.student.gradeLevel} -{' '}\r\n                          {scanResult.student.section}\r\n                        </div>\r\n                        <div>Category: {scanResult.student.gradeCategory}</div>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"font-medium\">\r\n                        Barcode: {scanResult.barcode}\r\n                      </div>\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        {scanResult.type === 'unknown'\r\n                          ? 'Unrecognized barcode format'\r\n                          : `No data found for this ${scanResult.type}`}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Action Selection */}\r\n                {scanResult.student && (\r\n                  <div className=\"space-y-4\">\r\n                    <div>\r\n                      <h4 className=\"font-medium mb-2\">Select Action:</h4>\r\n                      <div className=\"grid gap-2\">\r\n                        <Button\r\n                          variant={\r\n                            selectedAction === 'computer'\r\n                              ? 'default'\r\n                              : 'outline'\r\n                          }\r\n                          onClick={() => setSelectedAction('computer')}\r\n                          className=\"justify-start\"\r\n                        >\r\n                          <Monitor className=\"h-4 w-4 mr-2\" />\r\n                          Computer Session\r\n                        </Button>\r\n                        <Button\r\n                          variant={\r\n                            selectedAction === 'gaming' ? 'default' : 'outline'\r\n                          }\r\n                          onClick={() => setSelectedAction('gaming')}\r\n                          className=\"justify-start\"\r\n                        >\r\n                          <Gamepad2 className=\"h-4 w-4 mr-2\" />\r\n                          Gaming Session\r\n                        </Button>\r\n                        <Button\r\n                          variant={\r\n                            selectedAction === 'borrowing'\r\n                              ? 'default'\r\n                              : 'outline'\r\n                          }\r\n                          onClick={() => setSelectedAction('borrowing')}\r\n                          className=\"justify-start\"\r\n                        >\r\n                          <BookOpen className=\"h-4 w-4 mr-2\" />\r\n                          Book Borrowing\r\n                        </Button>\r\n                        <Button\r\n                          variant={\r\n                            selectedAction === 'returning'\r\n                              ? 'default'\r\n                              : 'outline'\r\n                          }\r\n                          onClick={() => setSelectedAction('returning')}\r\n                          className=\"justify-start\"\r\n                        >\r\n                          <BookOpen className=\"h-4 w-4 mr-2\" />\r\n                          Book Return\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Time Limit Selection */}\r\n                    {['computer', 'gaming'].includes(selectedAction) && (\r\n                      <div>\r\n                        <h4 className=\"font-medium mb-2\">\r\n                          Time Limit (minutes):\r\n                        </h4>\r\n                        <div className=\"flex items-center space-x-2\">\r\n                          <Input\r\n                            type=\"number\"\r\n                            min=\"5\"\r\n                            max=\"120\"\r\n                            value={timeLimit}\r\n                            onChange={(e) =>\r\n                              setTimeLimit(parseInt(e.target.value) || 30)\r\n                            }\r\n                            className=\"w-20\"\r\n                          />\r\n                          <span className=\"text-sm text-muted-foreground\">\r\n                            Default for {scanResult.student.gradeCategory}:{' '}\r\n                            {getDefaultTimeLimit(\r\n                              scanResult.student.gradeCategory\r\n                            )}\r\n                            min\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Execute Action */}\r\n                    <Button\r\n                      onClick={executeAction}\r\n                      disabled={!selectedAction}\r\n                      className=\"w-full\"\r\n                    >\r\n                      <Play className=\"h-4 w-4 mr-2\" />\r\n                      Execute {selectedAction || 'Action'}\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\">\r\n                  <Camera />\r\n                </div>\r\n                <p className=\"text-muted-foreground\">\r\n                  Scan a barcode to see results and available actions\r\n                </p>\r\n                {lastScanResult && (\r\n                  <p className=\"text-sm text-muted-foreground mt-2\">\r\n                    Last scan: {lastScanResult}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Enhanced Quick Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Quick Actions</CardTitle>\r\n          <CardDescription>Common tasks without scanning</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid gap-4 md:grid-cols-4\">\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-16 flex-col hover:bg-blue-50 hover:border-blue-300 transition-colors\"\r\n              onClick={() =>\r\n                toast.info(\r\n                  'Register New Student - would open registration form'\r\n                )\r\n              }\r\n            >\r\n              <UserPlus className=\"h-6 w-6 mb-2 text-blue-600\" />\r\n              <span className=\"text-sm\">Register Student</span>\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-16 flex-col hover:bg-green-50 hover:border-green-300 transition-colors\"\r\n              onClick={() => setShowActiveSessions(!showActiveSessions)}\r\n            >\r\n              <Activity className=\"h-6 w-6 mb-2 text-green-600\" />\r\n              <span className=\"text-sm\">Active Sessions</span>\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-16 flex-col hover:bg-purple-50 hover:border-purple-300 transition-colors\"\r\n              onClick={() =>\r\n                toast.info('Generate Reports - would open report builder')\r\n              }\r\n            >\r\n              <BarChart3 className=\"h-6 w-6 mb-2 text-purple-600\" />\r\n              <span className=\"text-sm\">Reports</span>\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              className=\"h-16 flex-col hover:bg-orange-50 hover:border-orange-300 transition-colors\"\r\n              onClick={() =>\r\n                toast.info('Sync Offline Data - would sync queued activities')\r\n              }\r\n            >\r\n              <RefreshCw className=\"h-6 w-6 mb-2 text-orange-600\" />\r\n              <span className=\"text-sm\">Sync Data</span>\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Additional Quick Actions Row */}\r\n          <div className=\"grid gap-4 md:grid-cols-6 mt-4\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('Emergency Alert - would notify administrators')\r\n              }\r\n              className=\"text-red-600 hover:bg-red-50\"\r\n            >\r\n              <AlertTriangle className=\"h-3 w-3 mr-1\" />\r\n              Emergency\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('Maintenance Mode - would schedule maintenance')\r\n              }\r\n              className=\"text-gray-600 hover:bg-gray-50\"\r\n            >\r\n              <Settings className=\"h-3 w-3 mr-1\" />\r\n              Maintenance\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('System Health - would run diagnostics')\r\n              }\r\n              className=\"text-blue-600 hover:bg-blue-50\"\r\n            >\r\n              <Shield className=\"h-3 w-3 mr-1\" />\r\n              Health\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('Daily Summary - would generate summary')\r\n              }\r\n              className=\"text-green-600 hover:bg-green-50\"\r\n            >\r\n              <Calendar className=\"h-3 w-3 mr-1\" />\r\n              Summary\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('Export Data - would export current data')\r\n              }\r\n              className=\"text-purple-600 hover:bg-purple-50\"\r\n            >\r\n              <Download className=\"h-3 w-3 mr-1\" />\r\n              Export\r\n            </Button>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={() =>\r\n                toast.info('Print Reports - would open print dialog')\r\n              }\r\n              className=\"text-orange-600 hover:bg-orange-50\"\r\n            >\r\n              <Printer className=\"h-3 w-3 mr-1\" />\r\n              Print\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ScanWorkspace;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\ScannerManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1447,1450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1447,1450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4327,4330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4327,4330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Wifi,\r\n  Settings,\r\n  Play,\r\n  Square,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  XCircle,\r\n  RefreshCw,\r\n  Plus,\r\n  Trash2,\r\n} from 'lucide-react';\r\n\r\ninterface ScannerDevice {\r\n  path: string;\r\n  vendorId: number;\r\n  productId: number;\r\n  product: string;\r\n  manufacturer: string;\r\n  serialNumber?: string;\r\n}\r\n\r\ninterface ScannerStatus {\r\n  deviceId: string;\r\n  name: string;\r\n  connected: boolean;\r\n  lastScan: Date | null;\r\n  scanCount: number;\r\n  errorCount: number;\r\n  lastError: string | null;\r\n  deviceInfo: ScannerDevice | null;\r\n}\r\n\r\ninterface ScannerStatistics {\r\n  totalScans: number;\r\n  successfulScans: number;\r\n  failedScans: number;\r\n  duplicateScans: number;\r\n  invalidScans: number;\r\n  averageProcessingTime: number;\r\n  lastScanTime: Date | null;\r\n  scansByDevice: Map<string, number>;\r\n  scansByType: Map<string, number>;\r\n}\r\n\r\ninterface ScannerStation {\r\n  id: string;\r\n  name: string;\r\n  location: string;\r\n  description?: string;\r\n  scannerConfigs: any[];\r\n  isActive: boolean;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport default function ScannerManager() {\r\n  const [activeTab, setActiveTab] = useState('devices');\r\n  const [devices, setDevices] = useState<ScannerDevice[]>([]);\r\n  const [connectedScanners, setConnectedScanners] = useState<ScannerStatus[]>(\r\n    []\r\n  );\r\n  const [statistics, setStatistics] = useState<ScannerStatistics | null>(null);\r\n  const [stations, setStations] = useState<ScannerStation[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [connectingDevice, setConnectingDevice] = useState<string | null>(null);\r\n\r\n  // Form states\r\n  const [newStation, setNewStation] = useState({\r\n    name: '',\r\n    location: '',\r\n    description: '',\r\n  });\r\n\r\n  // Fetch scanner data\r\n  const fetchScannerData = async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Fetch devices and status\r\n      const devicesResponse = await fetch('/api/scanner/devices', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (devicesResponse.ok) {\r\n        const data = await devicesResponse.json();\r\n        setDevices(data.data.available || []);\r\n        setConnectedScanners(data.data.connected || []);\r\n      }\r\n\r\n      // Fetch statistics\r\n      const statsResponse = await fetch('/api/scanner/statistics', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (statsResponse.ok) {\r\n        const statsData = await statsResponse.json();\r\n        setStatistics(statsData.data.statistics);\r\n      }\r\n\r\n      // Fetch stations\r\n      const stationsResponse = await fetch('/api/scanner/stations', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (stationsResponse.ok) {\r\n        const stationsData = await stationsResponse.json();\r\n        setStations(stationsData.data || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching scanner data:', error);\r\n      toast.error('Failed to fetch scanner data');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchScannerData();\r\n\r\n    // Set up WebSocket for real-time updates\r\n    const ws = new WebSocket(`ws://${window.location.host}/ws`);\r\n\r\n    ws.onmessage = (event) => {\r\n      const message = JSON.parse(event.data);\r\n\r\n      if (\r\n        message.type === 'scan_event' ||\r\n        message.type === 'scanner_connected' ||\r\n        message.type === 'scanner_disconnected' ||\r\n        message.type === 'scanner_error'\r\n      ) {\r\n        fetchScannerData(); // Refresh data on scanner events\r\n      }\r\n    };\r\n\r\n    return () => {\r\n      ws.close();\r\n    };\r\n  }, []);\r\n\r\n  // Connect to a scanner device\r\n  const connectScanner = async (device: ScannerDevice, config: any = {}) => {\r\n    try {\r\n      setConnectingDevice(device.path);\r\n\r\n      const response = await fetch('/api/scanner/connect', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n        body: JSON.stringify({\r\n          devicePath: device.path,\r\n          vendorId: device.vendorId,\r\n          productId: device.productId,\r\n          name: `${device.manufacturer} ${device.product}`,\r\n          config: {\r\n            bufferSize: 64,\r\n            timeout: 100,\r\n            minLength: 3,\r\n            maxLength: 50,\r\n            beepOnScan: true,\r\n            visualFeedback: true,\r\n            duplicatePrevention: true,\r\n            duplicateWindow: 30 * 60 * 1000,\r\n            ...config,\r\n          },\r\n        }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Scanner connected successfully');\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to connect scanner');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error connecting scanner:', error);\r\n      toast.error('Failed to connect scanner');\r\n    } finally {\r\n      setConnectingDevice(null);\r\n    }\r\n  };\r\n\r\n  // Disconnect a scanner\r\n  const disconnectScanner = async (deviceId: string) => {\r\n    try {\r\n      const response = await fetch(`/api/scanner/disconnect/${deviceId}`, {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Scanner disconnected successfully');\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to disconnect scanner');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error disconnecting scanner:', error);\r\n      toast.error('Failed to disconnect scanner');\r\n    }\r\n  };\r\n\r\n  // Toggle scanner enabled state\r\n  const toggleScanner = async (deviceId: string, enabled: boolean) => {\r\n    try {\r\n      const response = await fetch(`/api/scanner/enable/${deviceId}`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n        body: JSON.stringify({ enabled }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success(\r\n          `Scanner ${enabled ? 'enabled' : 'disabled'} successfully`\r\n        );\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to update scanner');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling scanner:', error);\r\n      toast.error('Failed to update scanner');\r\n    }\r\n  };\r\n\r\n  // Auto-configure scanner\r\n  const autoConfigureScanner = async (device: ScannerDevice) => {\r\n    try {\r\n      setConnectingDevice(device.path);\r\n\r\n      const response = await fetch('/api/scanner/auto-configure', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n        body: JSON.stringify({\r\n          devicePath: device.path,\r\n          vendorId: device.vendorId,\r\n          productId: device.productId,\r\n        }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Scanner auto-configured and connected successfully');\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to auto-configure scanner');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error auto-configuring scanner:', error);\r\n      toast.error('Failed to auto-configure scanner');\r\n    } finally {\r\n      setConnectingDevice(null);\r\n    }\r\n  };\r\n\r\n  // Create new station\r\n  const createStation = async () => {\r\n    try {\r\n      if (!newStation.name || !newStation.location) {\r\n        toast.error('Name and location are required');\r\n        return;\r\n      }\r\n\r\n      const response = await fetch('/api/scanner/stations', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n        body: JSON.stringify(newStation),\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Station created successfully');\r\n        setNewStation({ name: '', location: '', description: '' });\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to create station');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error creating station:', error);\r\n      toast.error('Failed to create station');\r\n    }\r\n  };\r\n\r\n  // Delete station\r\n  const deleteStation = async (stationId: string) => {\r\n    try {\r\n      const response = await fetch(`/api/scanner/stations/${stationId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Station deleted successfully');\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to delete station');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting station:', error);\r\n      toast.error('Failed to delete station');\r\n    }\r\n  };\r\n\r\n  // Reset statistics\r\n  const resetStatistics = async () => {\r\n    try {\r\n      const response = await fetch('/api/scanner/statistics/reset', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n        },\r\n      });\r\n\r\n      if (response.ok) {\r\n        toast.success('Statistics reset successfully');\r\n        fetchScannerData();\r\n      } else {\r\n        const error = await response.json();\r\n        toast.error(error.error || 'Failed to reset statistics');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error resetting statistics:', error);\r\n      toast.error('Failed to reset statistics');\r\n    }\r\n  };\r\n\r\n  // Format device IDs for display\r\n  const formatDeviceId = (deviceId: string) => {\r\n    return deviceId.replace(/_/g, ' ').replace(/\\b\\w/g, (l) => l.toUpperCase());\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <RefreshCw className=\"h-8 w-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Scanner Management</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Manage USB barcode scanners and monitor scan activity\r\n          </p>\r\n        </div>\r\n        <Button onClick={fetchScannerData} variant=\"outline\">\r\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n          Refresh\r\n        </Button>\r\n      </div>\r\n\r\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"devices\">Devices</TabsTrigger>\r\n          <TabsTrigger value=\"status\">Status</TabsTrigger>\r\n          <TabsTrigger value=\"stations\">Stations</TabsTrigger>\r\n          <TabsTrigger value=\"statistics\">Statistics</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"devices\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {/* Available Devices */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center\">\r\n                  <Wifi className=\"h-5 w-5 mr-2\" />\r\n                  Available Devices ({devices.length})\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  USB barcode scanners detected on this system\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                {devices.length === 0 ? (\r\n                  <p className=\"text-muted-foreground text-center py-4\">\r\n                    No USB scanners detected\r\n                  </p>\r\n                ) : (\r\n                  devices.map((device, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"font-medium\">{device.product}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {device.manufacturer}\r\n                        </p>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          VID: {device.vendorId?.toString(16)}, PID:{' '}\r\n                          {device.productId?.toString(16)}\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => autoConfigureScanner(device)}\r\n                          disabled={connectingDevice === device.path}\r\n                        >\r\n                          <Settings className=\"h-4 w-4 mr-1\" />\r\n                          Auto\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          onClick={() => connectScanner(device)}\r\n                          disabled={connectingDevice === device.path}\r\n                        >\r\n                          {connectingDevice === device.path ? (\r\n                            <RefreshCw className=\"h-4 w-4 animate-spin\" />\r\n                          ) : (\r\n                            <Play className=\"h-4 w-4 mr-1\" />\r\n                          )}\r\n                          Connect\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Connected Scanners */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center\">\r\n                  <CheckCircle className=\"h-5 w-5 mr-2\" />\r\n                  Connected Scanners ({connectedScanners.length})\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Currently active scanner connections\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                {connectedScanners.length === 0 ? (\r\n                  <p className=\"text-muted-foreground text-center py-4\">\r\n                    No scanners connected\r\n                  </p>\r\n                ) : (\r\n                  connectedScanners.map((scanner) => (\r\n                    <div\r\n                      key={scanner.deviceId}\r\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <p className=\"font-medium\">{scanner.name}</p>\r\n                          <Badge\r\n                            variant={\r\n                              scanner.connected ? 'default' : 'secondary'\r\n                            }\r\n                          >\r\n                            {scanner.connected ? 'Connected' : 'Disconnected'}\r\n                          </Badge>\r\n                        </div>\r\n                        {scanner.deviceInfo && (\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {scanner.deviceInfo.product}\r\n                          </p>\r\n                        )}\r\n                        <div className=\"flex items-center gap-4 text-xs text-muted-foreground mt-1\">\r\n                          <span>Scans: {scanner.scanCount}</span>\r\n                          <span>Errors: {scanner.errorCount}</span>\r\n                          {scanner.lastScan && (\r\n                            <span>\r\n                              Last:{' '}\r\n                              {new Date(scanner.lastScan).toLocaleTimeString()}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                        {scanner.lastError && (\r\n                          <p className=\"text-xs text-red-500 mt-1\">\r\n                            Error: {scanner.lastError}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => toggleScanner(scanner.deviceId, !true)}\r\n                        >\r\n                          {scanner.connected ? (\r\n                            <Square className=\"h-4 w-4 mr-1\" />\r\n                          ) : (\r\n                            <Play className=\"h-4 w-4 mr-1\" />\r\n                          )}\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"destructive\"\r\n                          onClick={() => disconnectScanner(scanner.deviceId)}\r\n                        >\r\n                          <XCircle className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"status\" className=\"space-y-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-lg\">Total Connected</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-3xl font-bold text-green-600\">\r\n                  {connectedScanners.filter((s) => s.connected).length}\r\n                </div>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  of {connectedScanners.length} configured scanners\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-lg\">Recent Activity</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-3xl font-bold text-blue-600\">\r\n                  {statistics?.totalScans || 0}\r\n                </div>\r\n                <p className=\"text-sm text-muted-foreground\">total scans</p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"text-lg\">Success Rate</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-3xl font-bold text-green-600\">\r\n                  {statistics\r\n                    ? Math.round(\r\n                        (statistics.successfulScans /\r\n                          Math.max(statistics.totalScans, 1)) *\r\n                          100\r\n                      )\r\n                    : 0}\r\n                  %\r\n                </div>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  scan success rate\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Scanner Details</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {connectedScanners.map((scanner) => (\r\n                  <div key={scanner.deviceId} className=\"border rounded-lg p-4\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <h3 className=\"font-medium\">{scanner.name}</h3>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Badge\r\n                          variant={scanner.connected ? 'default' : 'secondary'}\r\n                        >\r\n                          {scanner.connected ? 'Connected' : 'Disconnected'}\r\n                        </Badge>\r\n                        {scanner.connected && (\r\n                          <Badge variant=\"outline\">Active</Badge>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n                      <div>\r\n                        <p className=\"text-muted-foreground\">Device ID</p>\r\n                        <p className=\"font-mono\">\r\n                          {formatDeviceId(scanner.deviceId)}\r\n                        </p>\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-muted-foreground\">Scan Count</p>\r\n                        <p>{scanner.scanCount}</p>\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-muted-foreground\">Error Count</p>\r\n                        <p>{scanner.errorCount}</p>\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-muted-foreground\">Last Scan</p>\r\n                        <p>\r\n                          {scanner.lastScan\r\n                            ? new Date(scanner.lastScan).toLocaleString()\r\n                            : 'Never'}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {scanner.deviceInfo && (\r\n                      <div className=\"mt-3 pt-3 border-t text-sm\">\r\n                        <p className=\"text-muted-foreground\">\r\n                          Device Information\r\n                        </p>\r\n                        <p>Product: {scanner.deviceInfo.product}</p>\r\n                        <p>Manufacturer: {scanner.deviceInfo.manufacturer}</p>\r\n                        {scanner.deviceInfo.serialNumber && (\r\n                          <p>Serial: {scanner.deviceInfo.serialNumber}</p>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n\r\n                    {scanner.lastError && (\r\n                      <div className=\"mt-3 p-2 bg-red-50 border border-red-200 rounded text-sm\">\r\n                        <p className=\"text-red-700\">\r\n                          <AlertCircle className=\"h-4 w-4 inline mr-1\" />\r\n                          Last Error: {scanner.lastError}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"stations\" className=\"space-y-4\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <h2 className=\"text-xl font-semibold\">Scanner Stations</h2>\r\n            <Button\r\n              onClick={createStation}\r\n              disabled={!newStation.name || !newStation.location}\r\n            >\r\n              <Plus className=\"h-4 w-4 mr-2\" />\r\n              Create Station\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {/* New Station Form */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>New Station</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div>\r\n                  <Label htmlFor=\"station-name\">Name</Label>\r\n                  <Input\r\n                    id=\"station-name\"\r\n                    value={newStation.name}\r\n                    onChange={(e) =>\r\n                      setNewStation({ ...newStation, name: e.target.value })\r\n                    }\r\n                    placeholder=\"Front Desk Scanner\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"station-location\">Location</Label>\r\n                  <Input\r\n                    id=\"station-location\"\r\n                    value={newStation.location}\r\n                    onChange={(e) =>\r\n                      setNewStation({ ...newStation, location: e.target.value })\r\n                    }\r\n                    placeholder=\"Main Library Entrance\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label htmlFor=\"station-description\">\r\n                    Description (Optional)\r\n                  </Label>\r\n                  <Input\r\n                    id=\"station-description\"\r\n                    value={newStation.description}\r\n                    onChange={(e) =>\r\n                      setNewStation({\r\n                        ...newStation,\r\n                        description: e.target.value,\r\n                      })\r\n                    }\r\n                    placeholder=\"Primary check-in/out station\"\r\n                  />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Existing Stations */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Existing Stations</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                {stations.length === 0 ? (\r\n                  <p className=\"text-muted-foreground text-center py-4\">\r\n                    No stations configured\r\n                  </p>\r\n                ) : (\r\n                  stations.map((station) => (\r\n                    <div\r\n                      key={station.id}\r\n                      className=\"flex items-center justify-between p-3 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <p className=\"font-medium\">{station.name}</p>\r\n                          <Badge\r\n                            variant={station.isActive ? 'default' : 'secondary'}\r\n                          >\r\n                            {station.isActive ? 'Active' : 'Inactive'}\r\n                          </Badge>\r\n                        </div>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {station.location}\r\n                        </p>\r\n                        {station.description && (\r\n                          <p className=\"text-xs text-muted-foreground\">\r\n                            {station.description}\r\n                          </p>\r\n                        )}\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {station.scannerConfigs.length} scanner(s)\r\n                        </p>\r\n                      </div>\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"destructive\"\r\n                        onClick={() => deleteStation(station.id)}\r\n                      >\r\n                        <Trash2 className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"statistics\" className=\"space-y-4\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <h2 className=\"text-xl font-semibold\">Scan Statistics</h2>\r\n            <Button variant=\"outline\" onClick={resetStatistics}>\r\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n              Reset Statistics\r\n            </Button>\r\n          </div>\r\n\r\n          {statistics ? (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Total Scans</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold\">\r\n                    {statistics.totalScans}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    All time scans\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Successful</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold text-green-600\">\r\n                    {statistics.successfulScans}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {Math.round(\r\n                      (statistics.successfulScans /\r\n                        Math.max(statistics.totalScans, 1)) *\r\n                        100\r\n                    )}\r\n                    % success rate\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Failed</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold text-red-600\">\r\n                    {statistics.failedScans}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {Math.round(\r\n                      (statistics.failedScans /\r\n                        Math.max(statistics.totalScans, 1)) *\r\n                        100\r\n                    )}\r\n                    % failure rate\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Duplicates</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold text-yellow-600\">\r\n                    {statistics.duplicateScans}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Prevented duplicates\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Invalid</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold text-gray-600\">\r\n                    {statistics.invalidScans}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Unrecognized barcodes\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Avg Processing Time</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-3xl font-bold\">\r\n                    {statistics.averageProcessingTime.toFixed(0)}ms\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">Per scan</p>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Last Scan</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"text-lg font-bold\">\r\n                    {statistics.lastScanTime\r\n                      ? new Date(statistics.lastScanTime).toLocaleString()\r\n                      : 'Never'}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Most recent activity\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"text-center py-8\">\r\n                <p className=\"text-muted-foreground\">No statistics available</p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\SelfServiceMode.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":116,"column":20,"nodeType":null,"messageId":"preferOptionalChain","endLine":116,"endColumn":66,"suggestions":[{"fix":{"range":[3658,3704],"text":"result.activity?.checkInTime"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  UserCheck,\r\n  UserX,\r\n  Scan,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  Clock,\r\n  LogIn,\r\n  LogOut,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport selfServiceApi from '@/services/selfServiceApi';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\ninterface Student {\r\n  id: string;\r\n  studentId: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  gradeLevel: string;\r\n  section?: string;\r\n  hasActiveSession?: boolean;\r\n}\r\n\r\ninterface ScanResult {\r\n  success: boolean;\r\n  action: 'check-in' | 'check-out' | 'duplicate' | 'error';\r\n  student?: Student;\r\n  message: string;\r\n  isDuplicate?: boolean;\r\n  duration?: number;\r\n}\r\n\r\nexport default function SelfServiceMode() {\r\n  const [studentId, setStudentId] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [lastScan, setLastScan] = useState<ScanResult | null>(null);\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Auto-focus input on mount and after each scan\r\n  useEffect(() => {\r\n    inputRef.current?.focus();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (showSuccess) {\r\n      const timeout = setTimeout(() => {\r\n        setShowSuccess(false);\r\n        setLastScan(null);\r\n        setStudentId('');\r\n        inputRef.current?.focus();\r\n      }, 3000);\r\n\r\n      return () => clearTimeout(timeout);\r\n    }\r\n    return undefined;\r\n  }, [showSuccess]);\r\n\r\n  // Play sound feedback\r\n  const playSound = (success: boolean) => {\r\n    const audio = new Audio(\r\n      success ? '/sounds/success.mp3' : '/sounds/error.mp3'\r\n    );\r\n    audio.volume = 0.5;\r\n    audio.play().catch(() => {\r\n      // Fallback to system beep if sound file not found\r\n      console.debug(success ? 'Γ£ô Success' : 'Γ£ù Error');\r\n    });\r\n    return undefined;\r\n  };\r\n\r\n  const handleScan = async (scannedId: string) => {\r\n    if (!scannedId.trim()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Use the self-service API to process the scan\r\n      const result = await selfServiceApi.processScan(scannedId.trim());\r\n\r\n      // Map the API response to our component state interface\r\n      // Handle the interface mismatch between API and component\r\n      let action: 'check-in' | 'check-out' | 'duplicate' | 'error' = 'error';\r\n      let student: Student | undefined;\r\n      let message = result.message;\r\n      let isDuplicate = false;\r\n      let duration: number | undefined;\r\n\r\n      if (result.success) {\r\n        // Map student data from API to component interface\r\n        if (result.student) {\r\n          student = {\r\n            id: result.student.id,\r\n            studentId: result.student.studentId,\r\n            firstName: result.student.name?.split(' ')[0] || 'Unknown',\r\n            lastName:\r\n              result.student.name?.split(' ').slice(1).join(' ') || 'Student',\r\n            gradeLevel: result.student.gradeLevel,\r\n            section: result.student.section,\r\n          };\r\n        }\r\n\r\n        // Determine action based on API response\r\n        if (result.cooldownRemaining && result.cooldownRemaining > 0) {\r\n          action = 'duplicate';\r\n          isDuplicate = true;\r\n          message = `You already checked in within the last 30 minutes. Please wait before scanning again.`;\r\n        } else if (result.activity && result.activity.checkInTime) {\r\n          action = 'check-out';\r\n          duration = result.activity.timeLimit || 0;\r\n        } else {\r\n          action = 'check-in';\r\n        }\r\n      } else {\r\n        action = 'error';\r\n        if (result.cooldownRemaining && result.cooldownRemaining > 0) {\r\n          action = 'duplicate';\r\n          isDuplicate = true;\r\n        }\r\n      }\r\n\r\n      // Map the API response to our component state\r\n      const scanResult: ScanResult = {\r\n        success: result.success,\r\n        action,\r\n        message,\r\n        ...(student && { student }),\r\n        ...(isDuplicate !== undefined && { isDuplicate }),\r\n        ...(duration !== undefined && { duration }),\r\n      };\r\n      setLastScan(scanResult);\r\n\r\n      // Play appropriate sound and show feedback\r\n      if (result.success) {\r\n        playSound(true);\r\n\r\n        if (action === 'check-in') {\r\n          toast.success('Checked in successfully!');\r\n        } else if (action === 'check-out') {\r\n          toast.success('Checked out successfully!');\r\n        }\r\n\r\n        setShowSuccess(true);\r\n      } else {\r\n        playSound(false);\r\n\r\n        if (action === 'duplicate') {\r\n          toast.warning('Duplicate scan detected!');\r\n        } else {\r\n          toast.error(message || 'Failed to process scan');\r\n        }\r\n      }\r\n    } catch (error: unknown) {\r\n      const errorMessage = getErrorMessage(error, 'Failed to process scan');\r\n      setLastScan({\r\n        success: false,\r\n        action: 'error',\r\n        message: errorMessage,\r\n      });\r\n      playSound(false);\r\n      toast.error(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    handleScan(studentId);\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    // Barcode scanners typically send Enter after scanning\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleScan(studentId);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-900 dark:to-slate-800 p-4\">\r\n      <Card className=\"w-full max-w-2xl shadow-2xl\">\r\n        <CardHeader className=\"text-center pb-8\">\r\n          <div className=\"flex justify-center mb-4\">\r\n            <div className=\"w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center\">\r\n              <Scan className=\"w-12 h-12 text-primary animate-pulse\" />\r\n            </div>\r\n          </div>\r\n          <CardTitle className=\"text-4xl font-bold mb-2\">\r\n            Library Check-In/Out\r\n          </CardTitle>\r\n          <p className=\"text-xl text-muted-foreground\">\r\n            Scan your ID card to check in or out\r\n          </p>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Scan Input */}\r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <div className=\"relative\">\r\n              <Input\r\n                ref={inputRef}\r\n                type=\"text\"\r\n                placeholder=\"Scan your ID card or enter Student ID...\"\r\n                value={studentId}\r\n                onChange={(e) => setStudentId(e.target.value)}\r\n                onKeyPress={handleKeyPress}\r\n                disabled={loading || showSuccess}\r\n                className=\"text-2xl py-8 text-center font-mono tracking-wider\"\r\n                autoFocus\r\n                autoComplete=\"off\"\r\n              />\r\n              <div className=\"absolute right-4 top-1/2 transform -translate-y-1/2\">\r\n                <Scan\r\n                  className={`w-8 h-8 ${loading ? 'animate-pulse text-primary' : 'text-muted-foreground'}`}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {!showSuccess && (\r\n              <Button\r\n                type=\"submit\"\r\n                disabled={!studentId.trim() || loading}\r\n                className=\"w-full py-6 text-xl\"\r\n                size=\"lg\"\r\n              >\r\n                {loading ? (\r\n                  <>\r\n                    <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-2\"></div>\r\n                    Processing...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Scan className=\"w-6 h-6 mr-2\" />\r\n                    Scan Now\r\n                  </>\r\n                )}\r\n              </Button>\r\n            )}\r\n          </form>\r\n\r\n          {/* Success/Error Display */}\r\n          {lastScan && (\r\n            <div className=\"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500\">\r\n              {lastScan.action === 'check-in' && lastScan.success && (\r\n                <Alert className=\"border-green-500 bg-green-50 dark:bg-green-950/20\">\r\n                  <CheckCircle className=\"h-6 w-6 text-green-600\" />\r\n                  <AlertTitle className=\"text-2xl text-green-800 dark:text-green-400 mb-2\">\r\n                    Welcome!\r\n                  </AlertTitle>\r\n                  <AlertDescription className=\"space-y-2\">\r\n                    <p className=\"text-xl font-semibold text-green-700 dark:text-green-300\">\r\n                      {lastScan.student?.firstName} {lastScan.student?.lastName}\r\n                    </p>\r\n                    <div className=\"flex items-center gap-2 text-green-600 dark:text-green-400\">\r\n                      <LogIn className=\"w-5 h-5\" />\r\n                      <span className=\"text-lg\">You are now checked in</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4 mt-3 text-sm\">\r\n                      <Badge variant=\"outline\" className=\"bg-white/50\">\r\n                        {lastScan.student?.gradeLevel}\r\n                      </Badge>\r\n                      <Badge variant=\"outline\" className=\"bg-white/50\">\r\n                        {lastScan.student?.studentId}\r\n                      </Badge>\r\n                    </div>\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {lastScan.action === 'check-out' && lastScan.success && (\r\n                <Alert className=\"border-blue-500 bg-blue-50 dark:bg-blue-950/20\">\r\n                  <CheckCircle className=\"h-6 w-6 text-blue-600\" />\r\n                  <AlertTitle className=\"text-2xl text-blue-800 dark:text-blue-400 mb-2\">\r\n                    Goodbye!\r\n                  </AlertTitle>\r\n                  <AlertDescription className=\"space-y-2\">\r\n                    <p className=\"text-xl font-semibold text-blue-700 dark:text-blue-300\">\r\n                      {lastScan.student?.firstName} {lastScan.student?.lastName}\r\n                    </p>\r\n                    <div className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\r\n                      <LogOut className=\"w-5 h-5\" />\r\n                      <span className=\"text-lg\">You are now checked out</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 mt-2 text-blue-600 dark:text-blue-400\">\r\n                      <Clock className=\"w-5 h-5\" />\r\n                      <span className=\"text-lg font-semibold\">\r\n                        Time spent: {lastScan.duration} minutes\r\n                      </span>\r\n                    </div>\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {lastScan.action === 'duplicate' && (\r\n                <Alert variant=\"destructive\">\r\n                  <AlertCircle className=\"h-6 w-6\" />\r\n                  <AlertTitle className=\"text-xl mb-2\">\r\n                    Duplicate Scan Detected\r\n                  </AlertTitle>\r\n                  <AlertDescription className=\"space-y-2\">\r\n                    <p className=\"text-lg\">\r\n                      {lastScan.student?.firstName}, you already checked in\r\n                      recently!\r\n                    </p>\r\n                    <p className=\"text-sm\">\r\n                      Please wait at least 30 minutes before scanning again.\r\n                    </p>\r\n                    <div className=\"mt-3 p-3 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg\">\r\n                      <p className=\"text-sm text-yellow-800 dark:text-yellow-400\">\r\n                        ≡ƒÆí If you're leaving, wait a bit before checking out.\r\n                      </p>\r\n                    </div>\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n\r\n              {lastScan.action === 'error' && (\r\n                <Alert variant=\"destructive\">\r\n                  <AlertCircle className=\"h-6 w-6\" />\r\n                  <AlertTitle className=\"text-xl mb-2\">Error</AlertTitle>\r\n                  <AlertDescription className=\"text-lg\">\r\n                    {lastScan.message}\r\n                  </AlertDescription>\r\n                </Alert>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Instructions */}\r\n          {!lastScan && (\r\n            <div className=\"bg-slate-50 dark:bg-slate-800/50 rounded-lg p-6 space-y-4\">\r\n              <h3 className=\"font-semibold text-lg mb-3\">How to use:</h3>\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0\">\r\n                    <span className=\"font-bold text-primary\">1</span>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-medium\">Scan your ID card</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Use the barcode scanner to scan your student ID\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0\">\r\n                    <span className=\"font-bold text-primary\">2</span>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-medium\">Wait for confirmation</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      You'll see a message confirming check-in or check-out\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex items-start gap-3\">\r\n                  <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0\">\r\n                    <span className=\"font-bold text-primary\">3</span>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-medium\">You're done!</p>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      The system automatically tracks your library visit\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Quick Stats */}\r\n          <div className=\"grid grid-cols-2 gap-4 pt-4 border-t\">\r\n            <div className=\"text-center p-4 bg-green-50 dark:bg-green-950/20 rounded-lg\">\r\n              <UserCheck className=\"w-8 h-8 mx-auto mb-2 text-green-600\" />\r\n              <p className=\"text-2xl font-bold text-green-600\">Check In</p>\r\n              <p className=\"text-sm text-muted-foreground\">When entering</p>\r\n            </div>\r\n            <div className=\"text-center p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg\">\r\n              <UserX className=\"w-8 h-8 mx-auto mb-2 text-blue-600\" />\r\n              <p className=\"text-2xl font-bold text-blue-600\">Check Out</p>\r\n              <p className=\"text-sm text-muted-foreground\">When leaving</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Admin Exit (Hidden, press Esc to exit) */}\r\n      <div className=\"fixed bottom-4 right-4 text-xs text-muted-foreground\">\r\n        Press ESC for admin mode\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\StudentBarcodeDialog.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":126,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":126,"endColumn":31,"suggestions":[{"fix":{"range":[3439,3461],"text":"qrImage?.src"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  useMobileOptimization,\r\n  getResponsiveClasses,\r\n} from '@/hooks/useMobileOptimization';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { BarcodeDisplay } from '@/components/ui/BarcodeDisplay';\r\nimport { QRCodeDisplay } from '@/components/ui/QRCodeDisplay';\r\nimport {\r\n  User,\r\n  Mail,\r\n  Phone,\r\n  School,\r\n  Calendar,\r\n  CreditCard,\r\n  QrCode,\r\n  Download,\r\n  Printer,\r\n  Share2,\r\n  CheckCircle,\r\n  AlertCircle,\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\n\r\ninterface Student {\r\n  id: string;\r\n  studentId: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  gradeLevel: string;\r\n  gradeCategory: string;\r\n  section?: string;\r\n  isActive: boolean;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  parentName?: string;\r\n  parentPhone?: string;\r\n  parentEmail?: string;\r\n  qrCodeGenerated: boolean;\r\n  barcodeGenerated: boolean;\r\n  libraryCardPrinted: boolean;\r\n  joinDate: string;\r\n  totalSessions: number;\r\n}\r\n\r\ninterface StudentBarcodeDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  student: Student | null;\r\n}\r\n\r\nexport function StudentBarcodeDialog({\r\n  open,\r\n  onOpenChange,\r\n  student,\r\n}: StudentBarcodeDialogProps) {\r\n  const mobileState = useMobileOptimization();\r\n  const { isMobile: _isMobile } = mobileState;\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n  const [isPrinting, setIsPrinting] = useState(false);\r\n\r\n  if (!student) {\r\n    return null;\r\n  }\r\n\r\n  const handleGenerateCodes = async () => {\r\n    setIsGenerating(true);\r\n    try {\r\n      // Simulate API call for generating codes\r\n      await new Promise((resolve) => setTimeout(resolve, 1500));\r\n      toast.success('Barcode and QR code generated successfully!');\r\n    } catch (error) {\r\n      toast.error('Failed to generate codes');\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handlePrintID = async () => {\r\n    setIsPrinting(true);\r\n    try {\r\n      // Simulate printing\r\n      await new Promise((resolve) => setTimeout(resolve, 1000));\r\n      toast.success('ID card sent to printer!');\r\n    } catch (error) {\r\n      toast.error('Failed to print ID card');\r\n    } finally {\r\n      setIsPrinting(false);\r\n    }\r\n  };\r\n\r\n  const handleDownloadBarcode = () => {\r\n    // Create download link for barcode\r\n    const barcodeElement = document.querySelector('#barcode-svg svg');\r\n    if (barcodeElement) {\r\n      const svgData = new XMLSerializer().serializeToString(barcodeElement);\r\n      const svgBlob = new Blob([svgData], {\r\n        type: 'image/svg+xml;charset=utf-8',\r\n      });\r\n      const svgUrl = URL.createObjectURL(svgBlob);\r\n\r\n      const downloadLink = document.createElement('a');\r\n      downloadLink.href = svgUrl;\r\n      downloadLink.download = `${student.studentId}-barcode.svg`;\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n\r\n      toast.success('Barcode downloaded!');\r\n    }\r\n  };\r\n\r\n  const handleDownloadQR = () => {\r\n    // Find QR code image and download\r\n    const qrImage = document.querySelector('#qr-code img') as HTMLImageElement;\r\n    if (qrImage && qrImage.src) {\r\n      const downloadLink = document.createElement('a');\r\n      downloadLink.href = qrImage.src;\r\n      downloadLink.download = `${student.studentId}-qrcode.png`;\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n\r\n      toast.success('QR code downloaded!');\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString();\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent\r\n        className={`max-w-4xl ${getResponsiveClasses('', mobileState)}`}\r\n      >\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <CreditCard className=\"h-5 w-5\" />\r\n            Student ID Card - {student.firstName} {student.lastName}\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Generate and manage barcode and QR code for student identification\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6\">\r\n          {/* Student Information Card */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center justify-between\">\r\n                <span className=\"flex items-center gap-2\">\r\n                  <User className=\"h-4 w-4\" />\r\n                  Student Information\r\n                </span>\r\n                <Badge variant={student.isActive ? 'default' : 'secondary'}>\r\n                  {student.isActive ? 'Active' : 'Inactive'}\r\n                </Badge>\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-sm font-medium text-gray-600\">\r\n                      Student ID:\r\n                    </span>\r\n                    <span className=\"text-sm font-bold\">\r\n                      {student.studentId}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span className=\"text-sm font-medium text-gray-600\">\r\n                      Grade:\r\n                    </span>\r\n                    <span className=\"text-sm\">\r\n                      {student.gradeLevel}{' '}\r\n                      {student.section && `- Section ${student.section}`}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <Calendar className=\"h-3 w-3 text-gray-400\" />\r\n                    <span className=\"text-sm text-gray-600\">Joined:</span>\r\n                    <span className=\"text-sm\">\r\n                      {formatDate(student.joinDate)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  {student.email && (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Mail className=\"h-3 w-3 text-gray-400\" />\r\n                      <span className=\"text-sm text-gray-600\">\r\n                        {student.email}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  {student.phone && (\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Phone className=\"h-3 w-3 text-gray-400\" />\r\n                      <span className=\"text-sm text-gray-600\">\r\n                        {student.phone}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <School className=\"h-3 w-3 text-gray-400\" />\r\n                    <span className=\"text-sm text-gray-600\">\r\n                      {student.totalSessions} library sessions\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Codes Generation Status */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Generation Status</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"flex gap-4 mb-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  {student.barcodeGenerated ? (\r\n                    <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                  ) : (\r\n                    <AlertCircle className=\"h-4 w-4 text-orange-500\" />\r\n                  )}\r\n                  <span className=\"text-sm\">Barcode Generated</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {student.qrCodeGenerated ? (\r\n                    <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                  ) : (\r\n                    <AlertCircle className=\"h-4 w-4 text-orange-500\" />\r\n                  )}\r\n                  <span className=\"text-sm\">QR Code Generated</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {student.libraryCardPrinted ? (\r\n                    <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                  ) : (\r\n                    <AlertCircle className=\"h-4 w-4 text-orange-500\" />\r\n                  )}\r\n                  <span className=\"text-sm\">ID Card Printed</span>\r\n                </div>\r\n              </div>\r\n              <Button\r\n                onClick={handleGenerateCodes}\r\n                disabled={isGenerating}\r\n                className=\"w-full\"\r\n              >\r\n                {isGenerating ? 'Generating...' : 'Generate Missing Codes'}\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Barcode and QR Code Display */}\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Barcode */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <CreditCard className=\"h-4 w-4\" />\r\n                  Barcode\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div id=\"barcode-svg\">\r\n                  <BarcodeDisplay\r\n                    value={student.studentId}\r\n                    format=\"CODE128\"\r\n                    width={2}\r\n                    height={80}\r\n                    displayValue={true}\r\n                  />\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={handleDownloadBarcode}\r\n                    className=\"flex-1\"\r\n                  >\r\n                    <Download className=\"h-3 w-3 mr-1\" />\r\n                    Download\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* QR Code */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <QrCode className=\"h-4 w-4\" />\r\n                  QR Code\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div id=\"qr-code\">\r\n                  <QRCodeDisplay\r\n                    value={student.studentId}\r\n                    size={150}\r\n                    margin={1}\r\n                  />\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={handleDownloadQR}\r\n                    className=\"flex-1\"\r\n                  >\r\n                    <Download className=\"h-3 w-3 mr-1\" />\r\n                    Download\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex gap-2 pt-4 border-t\">\r\n            <Button\r\n              onClick={handlePrintID}\r\n              disabled={isPrinting}\r\n              className=\"flex-1\"\r\n            >\r\n              <Printer className=\"h-4 w-4 mr-2\" />\r\n              {isPrinting ? 'Printing...' : 'Print ID Card'}\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                toast.info('Share functionality coming soon!');\r\n              }}\r\n            >\r\n              <Share2 className=\"h-4 w-4 mr-2\" />\r\n              Share\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default StudentBarcodeDialog;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\StudentImportDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3570,3573],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3570,3573],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":211,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":211,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6248,6251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6248,6251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8091,8094],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8091,8094],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":350,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10699,10702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10699,10702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":363,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11072,11075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11072,11075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11230,11233],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11230,11233],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":407,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":407,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12776,12779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12776,12779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":420,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":420,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13149,13152],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13149,13152],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n  useEffect,\r\n  Fragment,\r\n} from 'react';\r\nimport { useQueryClient, useMutation } from '@tanstack/react-query';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { toast } from 'sonner';\r\nimport { studentsApi } from '@/lib/api';\r\nimport {\r\n  Upload,\r\n  FileText,\r\n  AlertCircle,\r\n  CheckCircle2,\r\n  Download,\r\n  ArrowRight,\r\n  Settings,\r\n  File as FileIcon,\r\n  Users,\r\n  Loader2,\r\n  ChevronRight,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  XCircle,\r\n} from 'lucide-react';\r\nimport Papa from 'papaparse';\r\nimport * as XLSX from 'xlsx';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\n// Types for import functionality\r\ninterface ImportedStudent {\r\n  rowNumber: number;\r\n  firstName: string;\r\n  lastName: string;\r\n  gradeLevel: string;\r\n  section?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  parentName?: string;\r\n  parentPhone?: string;\r\n  parentEmail?: string;\r\n  address?: string;\r\n  emergencyContact?: string;\r\n  notes?: string;\r\n  errors: string[];\r\n  warnings: string[];\r\n  isValid: boolean;\r\n}\r\n\r\ninterface FieldMapping {\r\n  sourceField: string;\r\n  targetField: string;\r\n  required: boolean;\r\n}\r\n\r\ninterface ImportPreview {\r\n  totalRows: number;\r\n  validRows: number;\r\n  invalidRows: number;\r\n  duplicateRows: number;\r\n  samples: ImportedStudent[];\r\n}\r\n\r\n// Available fields for mapping\r\nconst AVAILABLE_FIELDS: FieldMapping[] = [\r\n  { sourceField: 'firstName', targetField: 'firstName', required: true },\r\n  { sourceField: 'lastName', targetField: 'lastName', required: true },\r\n  { sourceField: 'gradeLevel', targetField: 'gradeLevel', required: true },\r\n  { sourceField: 'section', targetField: 'section', required: false },\r\n  { sourceField: 'email', targetField: 'email', required: false },\r\n  { sourceField: 'phone', targetField: 'phone', required: false },\r\n  { sourceField: 'parentName', targetField: 'parentName', required: false },\r\n  { sourceField: 'parentPhone', targetField: 'parentPhone', required: false },\r\n  { sourceField: 'parentEmail', targetField: 'parentEmail', required: false },\r\n  { sourceField: 'address', targetField: 'address', required: false },\r\n  {\r\n    sourceField: 'emergencyContact',\r\n    targetField: 'emergencyContact',\r\n    required: false,\r\n  },\r\n  { sourceField: 'notes', targetField: 'notes', required: false },\r\n];\r\n\r\ninterface StudentImportDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n}\r\n\r\nexport function StudentImportDialog({\r\n  open,\r\n  onOpenChange,\r\n}: StudentImportDialogProps) {\r\n  const queryClient = useQueryClient();\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // State management\r\n  const [currentStep, setCurrentStep] = useState<\r\n    'upload' | 'mapping' | 'preview' | 'importing' | 'complete'\r\n  >('upload');\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [rawData, setRawData] = useState<any[]>([]);\r\n  const [headers, setHeaders] = useState<string[]>([]);\r\n  const [fieldMapping, setFieldMapping] = useState<Record<string, string>>({});\r\n  const [importedStudents, setImportedStudents] = useState<ImportedStudent[]>(\r\n    []\r\n  );\r\n  const [importPreview, setImportPreview] = useState<ImportPreview | null>(\r\n    null\r\n  );\r\n  const [importProgress, setImportProgress] = useState(0);\r\n  const [importResults, setImportResults] = useState<{\r\n    success: number;\r\n    failed: number;\r\n    errors: string[];\r\n  }>({ success: 0, failed: 0, errors: [] });\r\n  const [skipHeaderRow, setSkipHeaderRow] = useState(true);\r\n  // Reset state when dialog closes\r\n  const handleClose = () => {\r\n    setCurrentStep('upload');\r\n    setSelectedFile(null);\r\n    setRawData([]);\r\n    setHeaders([]);\r\n    setFieldMapping({});\r\n    setImportedStudents([]);\r\n    setImportPreview(null);\r\n    setImportProgress(0);\r\n    setImportResults({ success: 0, failed: 0, errors: [] });\r\n    setSkipHeaderRow(true);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n    onOpenChange(false);\r\n  };\r\n\r\n  // Handle file selection\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      const validTypes = [\r\n        'text/csv',\r\n        'application/vnd.ms-excel',\r\n        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n        'text/plain',\r\n      ];\r\n\r\n      if (!validTypes.includes(file.type)) {\r\n        toast.error('Invalid file type. Please select a CSV or Excel file.');\r\n        return;\r\n      }\r\n\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        // 10MB limit\r\n        toast.error(\r\n          'File size too large. Please select a file smaller than 10MB.'\r\n        );\r\n        return;\r\n      }\r\n\r\n      setSelectedFile(file);\r\n      parseFile(file);\r\n    }\r\n  };\r\n\r\n  // Parse file based on type\r\n  const parseFile = async (file: File) => {\r\n    try {\r\n      if (file.type === 'text/csv' || file.name.endsWith('.csv')) {\r\n        await parseCSV(file);\r\n      } else {\r\n        await parseExcel(file);\r\n      }\r\n    } catch (error) {\r\n      toast.error('Failed to parse file. Please check the file format.');\r\n      console.error('Parse error:', error);\r\n    }\r\n  };\r\n\r\n  // Parse CSV file\r\n  const parseCSV = (file: File): Promise<void> => {\r\n    return new Promise((resolve, reject) => {\r\n      Papa.parse(file, {\r\n        complete: (result) => {\r\n          if (result.errors.length > 0) {\r\n            reject(new Error(result.errors[0]?.message || 'Parse error'));\r\n            return;\r\n          }\r\n\r\n          const data = result.data as any[];\r\n          if (data.length === 0) {\r\n            reject(new Error('File is empty'));\r\n            return;\r\n          }\r\n\r\n          const headers = Object.keys(data[0] || {});\r\n          setHeaders(headers);\r\n          setRawData(data);\r\n          setCurrentStep('mapping');\r\n          resolve();\r\n        },\r\n        error: (error) => {\r\n          reject(error);\r\n        },\r\n        header: true,\r\n        skipEmptyLines: true,\r\n        transformHeader: (header) => header.trim(),\r\n      });\r\n    });\r\n  };\r\n\r\n  // Parse Excel file\r\n  const parseExcel = async (file: File): Promise<void> => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = (e) => {\r\n        try {\r\n          const data = new Uint8Array(e.target?.result as ArrayBuffer);\r\n          const workbook = XLSX.read(data, { type: 'array' });\r\n\r\n          if (!workbook.SheetNames || workbook.SheetNames.length === 0) {\r\n            reject(new Error('No sheets found in the file'));\r\n            return;\r\n          }\r\n\r\n          const sheetName = workbook.SheetNames[0];\r\n          if (!sheetName) {\r\n            reject(new Error('No sheets found in workbook'));\r\n            return;\r\n          }\r\n\r\n          const worksheet = workbook.Sheets[sheetName];\r\n\r\n          if (!worksheet) {\r\n            reject(new Error('Could not access worksheet'));\r\n            return;\r\n          }\r\n\r\n          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\r\n\r\n          if (jsonData.length === 0) {\r\n            reject(new Error('File is empty'));\r\n            return;\r\n          }\r\n\r\n          const headers = (jsonData[0] as string[]).map((h) =>\r\n            String(h).trim()\r\n          );\r\n          const processedData = jsonData.slice(1).map((row: unknown) => {\r\n            const rowArray = row as any[];\r\n            const obj = {};\r\n            headers.forEach((header, index) => {\r\n              if (header) {\r\n                obj[header] = rowArray[index];\r\n              }\r\n            });\r\n            return obj;\r\n          });\r\n\r\n          setHeaders(headers);\r\n          setRawData(processedData);\r\n          setCurrentStep('mapping');\r\n          resolve();\r\n        } catch (error) {\r\n          reject(error);\r\n        }\r\n      };\r\n      reader.onerror = () => reject(new Error('Failed to read file'));\r\n      reader.readAsArrayBuffer(file);\r\n    });\r\n  };\r\n\r\n  // Auto-map fields\r\n  const autoMapFields = useCallback(() => {\r\n    const mapping: Record<string, string> = {};\r\n\r\n    headers.forEach((header) => {\r\n      const normalizedHeader = header.toLowerCase().trim();\r\n\r\n      // Try to find matching field\r\n      const matchedField = AVAILABLE_FIELDS.find((field) => {\r\n        const fieldNames = [\r\n          field.targetField.toLowerCase(),\r\n          field.targetField\r\n            .replace(/([A-Z])/g, ' $1')\r\n            .toLowerCase()\r\n            .trim(),\r\n          ...getCommonAliases(field.targetField),\r\n        ];\r\n\r\n        return fieldNames.some(\r\n          (name) =>\r\n            normalizedHeader === name ||\r\n            normalizedHeader.includes(name) ||\r\n            name.includes(normalizedHeader)\r\n        );\r\n      });\r\n\r\n      if (matchedField) {\r\n        mapping[header] = matchedField.targetField;\r\n      }\r\n    });\r\n\r\n    setFieldMapping(mapping);\r\n  }, [headers]);\r\n\r\n  // Get common field name aliases\r\n  const getCommonAliases = (field: string): string[] => {\r\n    const aliases: Record<string, string[]> = {\r\n      firstName: ['first', 'given name', 'forename', 'fname'],\r\n      lastName: ['last', 'surname', 'family name', 'lname'],\r\n      gradeLevel: ['grade', 'year', 'level', 'grade level', 'class'],\r\n      section: ['section', 'block', 'group'],\r\n      email: ['email', 'e-mail', 'email address'],\r\n      phone: ['phone', 'telephone', 'mobile', 'contact', 'phone number'],\r\n      parentName: ['parent name', 'parent', 'guardian', 'parent/guardian'],\r\n      parentPhone: ['parent phone', 'parent mobile', 'parent contact'],\r\n      parentEmail: ['parent email', 'parent e-mail'],\r\n      address: ['address', 'home address', 'residence'],\r\n      emergencyContact: ['emergency contact', 'emergency phone'],\r\n      notes: ['notes', 'remarks', 'comments', 'observations'],\r\n    };\r\n\r\n    return aliases[field] || [];\r\n  };\r\n\r\n  // Preview import mutation\r\n  const previewImportMutation = useMutation({\r\n    mutationFn: async (data: { file: File; fieldMappings: any[] }) => {\r\n      try {\r\n        const result = await studentsApi.importStudents(\r\n          data.file,\r\n          data.fieldMappings,\r\n          true\r\n        );\r\n        return result.data;\r\n      } catch (error: unknown) {\r\n        const message = getErrorMessage(error, 'Preview failed');\r\n        throw new Error(message);\r\n      }\r\n    },\r\n    onSuccess: (result: any) => {\r\n      if (result.records && Array.isArray(result.records)) {\r\n        const processed: ImportedStudent[] = result.records.map(\r\n          (record: any, index: number) => ({\r\n            rowNumber: index + 1,\r\n            firstName: record.firstName || '',\r\n            lastName: record.lastName || '',\r\n            gradeLevel: record.gradeLevel || '',\r\n            section: record.section || '',\r\n            email: record.email || '',\r\n            phone: record.phone || '',\r\n            parentName: record.parentName || '',\r\n            parentPhone: record.parentPhone || '',\r\n            parentEmail: record.parentEmail || '',\r\n            address: record.address || '',\r\n            emergencyContact: record.emergencyContact || '',\r\n            notes: record.notes || '',\r\n            errors: record.errors || [],\r\n            warnings: record.warnings || [],\r\n            isValid: !(record.errors && record.errors.length > 0),\r\n          })\r\n        );\r\n\r\n        const validCount = processed.filter((s) => s.isValid).length;\r\n        const invalidCount = processed.length - validCount;\r\n\r\n        setImportedStudents(processed);\r\n        setImportPreview({\r\n          totalRows: processed.length,\r\n          validRows: validCount,\r\n          invalidRows: invalidCount,\r\n          duplicateRows: result.duplicateRecords || 0,\r\n          samples: processed.slice(0, 5),\r\n        });\r\n        setCurrentStep('preview');\r\n      }\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Preview failed'));\r\n    },\r\n  });\r\n\r\n  // Import students mutation\r\n  const importStudentsMutation = useMutation({\r\n    mutationFn: async (data: { file: File; fieldMappings: any[] }) => {\r\n      try {\r\n        const result = await studentsApi.importStudents(\r\n          data.file,\r\n          data.fieldMappings,\r\n          false\r\n        );\r\n        return result.data;\r\n      } catch (error: unknown) {\r\n        const message = getErrorMessage(error, 'Import failed');\r\n        throw new Error(message);\r\n      }\r\n    },\r\n    onSuccess: (result: any) => {\r\n      setImportResults({\r\n        success: result.importedRecords || 0,\r\n        failed: result.errorRecords || 0,\r\n        errors: result.errors || [],\r\n      });\r\n      setCurrentStep('complete');\r\n      queryClient.invalidateQueries({ queryKey: ['students'] });\r\n\r\n      if (result.importedRecords > 0) {\r\n        toast.success(\r\n          `Successfully imported ${result.importedRecords} students`\r\n        );\r\n      }\r\n\r\n      if (result.errorRecords > 0) {\r\n        toast.error(`Failed to import ${result.errorRecords} students`);\r\n      }\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Import failed'));\r\n      setCurrentStep('preview');\r\n    },\r\n  });\r\n\r\n  // Process imported data using backend preview\r\n  const processImportedData = useCallback(() => {\r\n    if (!selectedFile) {\r\n      toast.error('No file selected');\r\n      return;\r\n    }\r\n\r\n    // Convert field mapping to backend format\r\n    const mappings = Object.entries(fieldMapping)\r\n      .filter(([_, targetField]) => targetField)\r\n      .map(([sourceField, targetField]) => ({\r\n        sourceField,\r\n        targetField,\r\n        required:\r\n          AVAILABLE_FIELDS.find((f) => f.targetField === targetField)\r\n            ?.required || false,\r\n      }));\r\n\r\n    setCurrentStep('importing');\r\n    previewImportMutation.mutate({\r\n      file: selectedFile,\r\n      fieldMappings: mappings,\r\n    });\r\n  }, [selectedFile, fieldMapping, previewImportMutation]);\r\n\r\n  // Start import\r\n  const handleImport = () => {\r\n    if (!selectedFile) {\r\n      toast.error('No file selected');\r\n      return;\r\n    }\r\n\r\n    const validStudents = importedStudents.filter((s) => s.isValid);\r\n    if (validStudents.length === 0) {\r\n      toast.error('No valid students to import');\r\n      return;\r\n    }\r\n\r\n    // Convert field mapping to backend format\r\n    const mappings = Object.entries(fieldMapping)\r\n      .filter(([_, targetField]) => targetField)\r\n      .map(([sourceField, targetField]) => ({\r\n        sourceField,\r\n        targetField,\r\n        required:\r\n          AVAILABLE_FIELDS.find((f) => f.targetField === targetField)\r\n            ?.required || false,\r\n      }));\r\n\r\n    setCurrentStep('importing');\r\n    importStudentsMutation.mutate({\r\n      file: selectedFile,\r\n      fieldMappings: mappings,\r\n    });\r\n  };\r\n\r\n  // Download template\r\n  const downloadTemplate = async () => {\r\n    try {\r\n      const response = await studentsApi.downloadTemplate();\r\n      const blob = new Blob([response.data as string], { type: 'text/csv' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = 'student-import-template.csv';\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      window.URL.revokeObjectURL(url);\r\n      toast.success('Template downloaded successfully');\r\n    } catch (error) {\r\n      // Fallback to local template generation\r\n      const template = [\r\n        {\r\n          'First Name': 'Juan',\r\n          'Last Name': 'Dela Cruz',\r\n          'Grade Level': 'Grade 5',\r\n          Section: 'A',\r\n          Email: 'juan.delacruz@email.com',\r\n          Phone: '+63 912 345 6789',\r\n          'Parent Name': 'Maria Dela Cruz',\r\n          'Parent Phone': '+63 912 345 6788',\r\n          'Parent Email': 'maria.parent@email.com',\r\n          Address: '123 Main St, City',\r\n          'Emergency Contact': '+63 912 345 6787',\r\n          Notes: 'Regular visitor, prefers computer sessions',\r\n        },\r\n      ];\r\n\r\n      const ws = XLSX.utils.json_to_sheet(template);\r\n      const wb = XLSX.utils.book_new();\r\n      XLSX.utils.book_append_sheet(wb, ws, 'Students');\r\n      XLSX.writeFile(wb, 'student-import-template.xlsx');\r\n    }\r\n  };\r\n\r\n  // Initialize field mapping when headers are available\r\n  useEffect(() => {\r\n    if (headers.length > 0 && Object.keys(fieldMapping).length === 0) {\r\n      autoMapFields();\r\n    }\r\n  }, [headers, fieldMapping, autoMapFields]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-hidden\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Users className=\"h-5 w-5\" />\r\n            Import Students\r\n          </DialogTitle>\r\n          <DialogDescription>\r\n            Import student data from CSV or Excel files\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"flex flex-col h-full\">\r\n          {/* Progress indicator */}\r\n          <div className=\"flex items-center gap-2 p-4 bg-muted/50 rounded-lg mb-4\">\r\n            <div className=\"flex items-center gap-2 flex-1\">\r\n              {['upload', 'mapping', 'preview', 'importing', 'complete'].map(\r\n                (step, index) => (\r\n                  <Fragment key={step}>\r\n                    <div\r\n                      className={`flex items-center gap-2 ${\r\n                        currentStep === step\r\n                          ? 'text-primary'\r\n                          : [\r\n                                'upload',\r\n                                'mapping',\r\n                                'preview',\r\n                                'importing',\r\n                                'complete',\r\n                              ].indexOf(currentStep) > index\r\n                            ? 'text-green-600'\r\n                            : 'text-muted-foreground'\r\n                      }`}\r\n                    >\r\n                      <div\r\n                        className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${\r\n                          currentStep === step\r\n                            ? 'bg-primary text-primary-foreground'\r\n                            : [\r\n                                  'upload',\r\n                                  'mapping',\r\n                                  'preview',\r\n                                  'importing',\r\n                                  'complete',\r\n                                ].indexOf(currentStep) > index\r\n                              ? 'bg-green-600 text-white'\r\n                              : 'bg-muted'\r\n                        }`}\r\n                      >\r\n                        {[\r\n                          'upload',\r\n                          'mapping',\r\n                          'preview',\r\n                          'importing',\r\n                          'complete',\r\n                        ].indexOf(currentStep) > index ? (\r\n                          <CheckCircle className=\"h-4 w-4\" />\r\n                        ) : (\r\n                          index + 1\r\n                        )}\r\n                      </div>\r\n                      <span className=\"capitalize text-sm\">{step}</span>\r\n                    </div>\r\n                    {index < 4 && (\r\n                      <ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\r\n                    )}\r\n                  </Fragment>\r\n                )\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <ScrollArea className=\"flex-1\">\r\n            {/* Step 1: File Upload */}\r\n            {currentStep === 'upload' && (\r\n              <div className=\"space-y-6 p-6\">\r\n                <div className=\"text-center\">\r\n                  <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 hover:border-primary/50 transition-colors\">\r\n                    <Upload className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\r\n                    <h3 className=\"text-lg font-semibold mb-2\">\r\n                      Select CSV or Excel File\r\n                    </h3>\r\n                    <p className=\"text-muted-foreground mb-4\">\r\n                      Choose a file containing student data to import\r\n                    </p>\r\n                    <input\r\n                      ref={fileInputRef}\r\n                      type=\"file\"\r\n                      accept=\".csv,.xlsx,.xls,.txt\"\r\n                      onChange={handleFileSelect}\r\n                      className=\"hidden\"\r\n                    />\r\n                    <Button onClick={() => fileInputRef.current?.click()}>\r\n                      <FileIcon className=\"h-4 w-4 mr-2\" />\r\n                      Choose File\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                {selectedFile && (\r\n                  <Alert>\r\n                    <FileText className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                      Selected: {selectedFile.name} (\r\n                      {(selectedFile.size / 1024 / 1024).toFixed(2)} MB)\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                )}\r\n\r\n                <Card>\r\n                  <CardHeader>\r\n                    <CardTitle className=\"text-sm\">File Requirements</CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent className=\"text-sm space-y-2\">\r\n                    <p>ΓÇó File format: CSV (.csv) or Excel (.xlsx, .xls)</p>\r\n                    <p>ΓÇó Maximum file size: 10MB</p>\r\n                    <p>\r\n                      ΓÇó Required columns: First Name, Last Name, Grade Level\r\n                    </p>\r\n                    <p>\r\n                      ΓÇó Optional columns: Section, Email, Phone, Parent Name,\r\n                      Parent Phone, Parent Email, Address, Emergency Contact,\r\n                      Notes\r\n                    </p>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <div className=\"flex justify-center\">\r\n                  <Button variant=\"outline\" onClick={downloadTemplate}>\r\n                    <Download className=\"h-4 w-4 mr-2\" />\r\n                    Download Template\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Step 2: Field Mapping */}\r\n            {currentStep === 'mapping' && (\r\n              <div className=\"space-y-6 p-6\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <h3 className=\"text-lg font-semibold\">Map Fields</h3>\r\n                  <Button variant=\"outline\" onClick={autoMapFields}>\r\n                    <Settings className=\"h-4 w-4 mr-2\" />\r\n                    Auto Map\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"grid gap-4\">\r\n                  {headers.map((header) => (\r\n                    <div\r\n                      key={header}\r\n                      className=\"flex items-center gap-4 p-3 border rounded-lg\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <Label className=\"text-sm font-medium\">{header}</Label>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {rawData\r\n                            .slice(0, 3)\r\n                            .map((row) => row[header] || '(empty)')\r\n                            .join(', ')}\r\n                        </p>\r\n                      </div>\r\n                      <ArrowRight className=\"h-4 w-4 text-muted-foreground\" />\r\n                      <Select\r\n                        value={fieldMapping[header] || ''}\r\n                        onValueChange={(value) =>\r\n                          setFieldMapping((prev) => ({\r\n                            ...prev,\r\n                            [header]: value,\r\n                          }))\r\n                        }\r\n                      >\r\n                        <SelectTrigger className=\"w-48\">\r\n                          <SelectValue placeholder=\"Select field\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"\">Ignore field</SelectItem>\r\n                          {AVAILABLE_FIELDS.map((field) => (\r\n                            <SelectItem\r\n                              key={field.targetField}\r\n                              value={field.targetField}\r\n                            >\r\n                              {field.targetField}{' '}\r\n                              {field.required && (\r\n                                <span className=\"text-red-500\">*</span>\r\n                              )}\r\n                            </SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-4\">\r\n                  <Checkbox\r\n                    id=\"skipHeader\"\r\n                    checked={skipHeaderRow}\r\n                    onCheckedChange={(checked) =>\r\n                      setSkipHeaderRow(checked as boolean)\r\n                    }\r\n                  />\r\n                  <Label htmlFor=\"skipHeader\">Skip first row (header)</Label>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setCurrentStep('upload')}\r\n                  >\r\n                    Back\r\n                  </Button>\r\n                  <Button\r\n                    onClick={processImportedData}\r\n                    disabled={\r\n                      Object.values(fieldMapping).filter(Boolean).length === 0\r\n                    }\r\n                  >\r\n                    Continue to Preview\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Step 3: Preview */}\r\n            {currentStep === 'preview' && importPreview && (\r\n              <div className=\"space-y-6 p-6\">\r\n                <div className=\"grid gap-4 md:grid-cols-4\">\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-blue-600\">\r\n                        {importPreview.totalRows}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Total Rows\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-green-600\">\r\n                        {importPreview.validRows}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Valid Rows\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-red-600\">\r\n                        {importPreview.invalidRows}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Invalid Rows\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-orange-600\">\r\n                        {importPreview.duplicateRows}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Duplicates\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                </div>\r\n\r\n                <div>\r\n                  <h4 className=\"font-semibold mb-3\">Sample Data</h4>\r\n                  <div className=\"border rounded-lg overflow-hidden\">\r\n                    <table className=\"w-full\">\r\n                      <thead className=\"bg-muted\">\r\n                        <tr>\r\n                          <th className=\"text-left p-2 text-sm\">Row</th>\r\n                          <th className=\"text-left p-2 text-sm\">Name</th>\r\n                          <th className=\"text-left p-2 text-sm\">Grade</th>\r\n                          <th className=\"text-left p-2 text-sm\">Section</th>\r\n                          <th className=\"text-left p-2 text-sm\">Email</th>\r\n                          <th className=\"text-left p-2 text-sm\">Status</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {importPreview.samples.map((student) => (\r\n                          <tr key={student.rowNumber} className=\"border-t\">\r\n                            <td className=\"p-2 text-sm\">{student.rowNumber}</td>\r\n                            <td className=\"p-2 text-sm\">\r\n                              {student.firstName} {student.lastName}\r\n                            </td>\r\n                            <td className=\"p-2 text-sm\">\r\n                              {student.gradeLevel}\r\n                            </td>\r\n                            <td className=\"p-2 text-sm\">\r\n                              {student.section || '-'}\r\n                            </td>\r\n                            <td className=\"p-2 text-sm\">\r\n                              {student.email || '-'}\r\n                            </td>\r\n                            <td className=\"p-2 text-sm\">\r\n                              {student.isValid ? (\r\n                                <Badge variant=\"default\" className=\"text-xs\">\r\n                                  <CheckCircle className=\"h-3 w-3 mr-1\" />\r\n                                  Valid\r\n                                </Badge>\r\n                              ) : (\r\n                                <Badge\r\n                                  variant=\"destructive\"\r\n                                  className=\"text-xs\"\r\n                                >\r\n                                  <XCircle className=\"h-3 w-3 mr-1\" />\r\n                                  Invalid\r\n                                </Badge>\r\n                              )}\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n\r\n                {importPreview.invalidRows > 0 && (\r\n                  <Alert>\r\n                    <AlertTriangle className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                      {importPreview.invalidRows} rows have validation errors\r\n                      and will be skipped during import. Please review your data\r\n                      and field mapping.\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                )}\r\n\r\n                <div className=\"flex justify-end gap-2\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setCurrentStep('mapping')}\r\n                  >\r\n                    Back\r\n                  </Button>\r\n                  <Button\r\n                    onClick={handleImport}\r\n                    disabled={importPreview.validRows === 0}\r\n                  >\r\n                    Import {importPreview.validRows} Students\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Step 4: Importing */}\r\n            {currentStep === 'importing' && (\r\n              <div className=\"space-y-6 p-6 text-center\">\r\n                <Loader2 className=\"h-12 w-12 mx-auto animate-spin text-primary\" />\r\n                <h3 className=\"text-lg font-semibold\">Importing Students</h3>\r\n                <p className=\"text-muted-foreground\">\r\n                  Please wait while we import the students...\r\n                </p>\r\n                <div className=\"max-w-md mx-auto\">\r\n                  <Progress value={importProgress} className=\"w-full\" />\r\n                  <p className=\"text-sm text-muted-foreground mt-2\">\r\n                    {importProgress}% Complete\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Step 5: Complete */}\r\n            {currentStep === 'complete' && (\r\n              <div className=\"space-y-6 p-6\">\r\n                <div className=\"text-center\">\r\n                  <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                    <CheckCircle2 className=\"h-8 w-8 text-green-600\" />\r\n                  </div>\r\n                  <h3 className=\"text-lg font-semibold mb-2\">\r\n                    Import Complete\r\n                  </h3>\r\n                  <p className=\"text-muted-foreground\">\r\n                    Student import process has been completed\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-green-600\">\r\n                        {importResults.success}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Successfully Imported\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                  <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                      <div className=\"text-2xl font-bold text-red-600\">\r\n                        {importResults.failed}\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        Failed to Import\r\n                      </p>\r\n                    </CardContent>\r\n                  </Card>\r\n                </div>\r\n\r\n                {importResults.errors.length > 0 && (\r\n                  <Alert>\r\n                    <AlertCircle className=\"h-4 w-4\" />\r\n                    <AlertDescription>\r\n                      <div className=\"space-y-1\">\r\n                        <p className=\"font-medium\">Import Errors:</p>\r\n                        {importResults.errors\r\n                          .slice(0, 5)\r\n                          .map((error, index) => (\r\n                            <p key={index} className=\"text-sm text-red-600\">\r\n                              {error}\r\n                            </p>\r\n                          ))}\r\n                        {importResults.errors.length > 5 && (\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            ... and {importResults.errors.length - 5} more\r\n                            errors\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </AlertDescription>\r\n                  </Alert>\r\n                )}\r\n\r\n                <div className=\"flex justify-end\">\r\n                  <Button onClick={handleClose}>Done</Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </ScrollArea>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default StudentImportDialog;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\StudentManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3324,3327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3324,3327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4433,4436],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4433,4436],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'students' logical expression could make the dependencies of useMemo Hook (at line 199) change on every render. To fix this, wrap the initialization of 'students' in its own useMemo() Hook.","line":172,"column":9,"nodeType":"VariableDeclarator","endLine":172,"endColumn":61},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'students' logical expression could make the dependencies of useMemo Hook (at line 243) change on every render. To fix this, wrap the initialization of 'students' in its own useMemo() Hook.","line":172,"column":9,"nodeType":"VariableDeclarator","endLine":172,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":312,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":312,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9151,9154],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9151,9154],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":325,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":325,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9630,9633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9630,9633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useMemo, useState } from 'react';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport {\n  useMobileOptimization,\n  useTouchOptimization,\n  getResponsiveClasses,\n} from '@/hooks/useMobileOptimization';\nimport { useMultipleLoadingStates } from '@/hooks/useLoadingState';\nimport { useSearchFilters } from '@/hooks/useSearchFilters';\nimport { useMultipleModals } from '@/hooks/useModalState';\nimport { useForm } from '@/hooks/useFormState';\nimport { useDataRefresh } from '@/hooks/useDataRefresh';\nimport { studentsApi, utilitiesApi } from '@/lib/api';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { StudentBarcodeDialog } from './StudentBarcodeDialog';\nimport { StudentImportDialog } from './StudentImportDialog';\nimport { toast } from 'sonner';\nimport { getErrorMessage } from '@/utils/errorHandling';\nimport {\n  Users,\n  UserPlus,\n  Search,\n  Download,\n  Eye,\n  Edit,\n  Trash2,\n  Settings,\n  QrCode,\n  Award,\n  Phone,\n  Mail,\n  Calendar,\n  AlertTriangle,\n  FileText,\n  Upload,\n  UserMinus,\n  UserCheck,\n  MessageSquare,\n  CreditCard,\n  ExternalLink,\n  TrendingUp,\n  Activity,\n} from 'lucide-react';\n\ninterface Student {\n  id: string;\n  studentId: string;\n  firstName: string;\n  lastName: string;\n  gradeLevel: string;\n  gradeCategory: string;\n  section?: string;\n  isActive: boolean;\n  email?: string;\n  phone?: string;\n  address?: string;\n  parentName?: string;\n  parentPhone?: string;\n  parentEmail?: string;\n  emergencyContact?: string;\n  notes?: string;\n  joinDate: string;\n  lastActivity?: string;\n  totalSessions: number;\n  specialPrivileges: string[];\n  disciplinaryFlags: number;\n  qrCodeGenerated: boolean;\n  barcodeGenerated: boolean;\n  libraryCardPrinted: boolean;\n}\n\n// Define the API response type\ninterface StudentsApiResponse {\n  students: Student[];\n  total: number;\n  pagination: {\n    page?: number;\n    limit?: number;\n    totalPages?: number;\n  };\n}\n\ninterface MockStudentData {\n  students: Student[];\n  stats: {\n    total: number;\n    active: number;\n    inactive: number;\n    newThisMonth: number;\n    averageSessions: number;\n    overdueReturns: number;\n  };\n}\n\nexport function StudentManagement() {\n  const queryClient = useQueryClient();\n\n  // Mobile optimization\n  const mobileState = useMobileOptimization();\n  const { isMobile, isTablet } = mobileState;\n  const { handleTouchStart, handleTouchEnd } = useTouchOptimization();\n\n  // Data refresh with query\n  const [studentsRefreshState, _studentsRefreshActions] = useDataRefresh(\n    async (): Promise<StudentsApiResponse> => {\n      const response = await studentsApi.getStudents();\n      // Backend returns: { success: true, data: [...], count: N }\n      // Frontend expects: { students: [...], total: N, pagination: {...} }\n      const studentsData = response.data as any[];\n      const transformedData: StudentsApiResponse = {\n        students: studentsData.map((student) => ({\n          id: student.id,\n          studentId: student.student_id,\n          firstName: student.first_name,\n          lastName: student.last_name,\n          gradeLevel: `Grade ${student.grade_level}`,\n          gradeCategory: student.grade_category,\n          section: student.section,\n          isActive: student.is_active,\n          email: student.email,\n          phone: student.phone,\n          address: student.address,\n          parentName: student.parent_name,\n          parentPhone: student.parent_phone,\n          parentEmail: student.parent_email,\n          emergencyContact: student.emergency_contact,\n          notes: student.notes,\n          joinDate: student.created_at,\n          lastActivity: student.updated_at,\n          totalSessions: 0,\n          specialPrivileges: [],\n          disciplinaryFlags: 0,\n          qrCodeGenerated: !!student.barcode,\n          barcodeGenerated: !!student.barcode,\n          libraryCardPrinted: false,\n        })),\n        total: (response.data as any)?.count || studentsData.length,\n        pagination: {},\n      };\n      return transformedData;\n    },\n    {\n      initialData: { students: [], total: 0, pagination: {} },\n      interval: 5 * 60 * 1000, // Refresh every 5 minutes\n    }\n  );\n\n  const students = studentsRefreshState.data?.students || [];\n\n  // Calculate real stats from students data\n  const realStats = useMemo(() => {\n    const total = students.length;\n    const active = students.filter((s) => s.isActive).length;\n    const inactive = total - active;\n    const newThisMonth = students.filter((s) => {\n      const joinDate = new Date(s.joinDate);\n      const now = new Date();\n      const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      return joinDate >= monthStart;\n    }).length;\n    const averageSessions =\n      total > 0\n        ? students.reduce((sum, s) => sum + s.totalSessions, 0) / total\n        : 0;\n    const overdueReturns = 0; // TODO: Calculate from checkouts\n\n    return {\n      total,\n      active,\n      inactive,\n      newThisMonth,\n      averageSessions,\n      overdueReturns,\n    };\n  }, [students]);\n\n  // Search and filter state\n  const [searchFilters, _filterActions] = useSearchFilters({\n    defaultSearchTerm: '',\n    defaultFilters: { status: 'all', grade: 'all' },\n  });\n\n  // Manual filtering based on search state\n  const filteredStudents = useMemo(() => {\n    let filtered = students;\n\n    // Apply search term\n    if (searchFilters.searchTerm) {\n      const term = searchFilters.searchTerm.toLowerCase();\n      filtered = filtered.filter(\n        (student: Student) =>\n          student.firstName.toLowerCase().includes(term) ||\n          student.lastName.toLowerCase().includes(term) ||\n          student.studentId.toLowerCase().includes(term)\n      );\n    }\n\n    // Apply status filter\n    if (\n      searchFilters.filters.status &&\n      searchFilters.filters.status !== 'all'\n    ) {\n      filtered = filtered.filter((student: Student) =>\n        searchFilters.filters.status === 'active'\n          ? student.isActive\n          : !student.isActive\n      );\n    }\n\n    // Apply grade filter\n    if (searchFilters.filters.grade && searchFilters.filters.grade !== 'all') {\n      filtered = filtered.filter(\n        (student: Student) =>\n          student.gradeCategory === searchFilters.filters.grade\n      );\n    }\n\n    return filtered;\n  }, [students, searchFilters.searchTerm, searchFilters.filters]);\n\n  // Modal states\n  const [modalStates, modalActions] = useMultipleModals({\n    addStudent: false,\n    editStudent: false,\n    studentDetails: false,\n    bulkImport: false,\n    studentBarcode: false,\n  });\n\n  const _studentDetailsData = modalStates.studentDetails.data;\n\n  // Form state for new student\n  const [formState, formActions] = useForm({\n    initialValues: {\n      firstName: '',\n      lastName: '',\n      gradeLevel: '',\n      section: '',\n      email: '',\n      phone: '',\n      parentName: '',\n      parentPhone: '',\n      parentEmail: '',\n      emergencyContact: '',\n      address: '',\n      notes: '',\n    },\n    validationSchema: {\n      firstName: { required: true, minLength: 1 },\n      lastName: { required: true, minLength: 1 },\n      gradeLevel: { required: true },\n    },\n  });\n\n  const newStudent = formState.values;\n  const _formErrors = formState.errors;\n\n  // Loading states for different operations\n  const [_loadingStates, loadingActions] = useMultipleLoadingStates({\n    generatingQRCodes: {},\n    printingIDs: {},\n    exporting: {},\n    sendingNotifications: {},\n  });\n\n  // Component state\n  const [selectedStudents, setSelectedStudents] = useState<string[]>([]);\n  const [showBulkActions, setShowBulkActions] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n\n  // Missing state variables\n  const [isSendingNotifications, setIsSendingNotifications] = useState(false);\n  const [selectedStudent, setSelectedStudent] = useState<Student | null>(null);\n  const [showStudentDetails, setShowStudentDetails] = useState(false);\n  const [showStudentBarcode, setShowStudentBarcode] = useState(false);\n  const [showAddStudent, setShowAddStudent] = useState(false);\n  const [showBulkImport, setShowBulkImport] = useState(false);\n  const [isGeneratingQRCodes, _setIsGeneratingQRCodes] = useState(false);\n  const [isPrintingIDs, _setIsPrintingIDs] = useState(false);\n  const [isExporting, _setIsExporting] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterStatus, setFilterStatus] = useState('');\n  const [filterGrade, setFilterGrade] = useState('');\n  const [showEditStudent, setShowEditStudent] = useState(false);\n\n  // Mutations\n  const createStudentMutation = useMutation({\n    mutationFn: (studentData: any) => studentsApi.createStudent(studentData),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] });\n      toast.success('Student added successfully!');\n      modalActions.addStudent.close();\n      formActions.resetForm();\n    },\n    onError: (error: unknown) => {\n      toast.error(getErrorMessage(error, 'Failed to add student'));\n    },\n  });\n\n  const updateStudentMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) =>\n      studentsApi.updateStudent(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] });\n      toast.success('Student updated successfully!');\n      modalActions.editStudent.close();\n    },\n    onError: (error: unknown) => {\n      toast.error(getErrorMessage(error, 'Failed to update student'));\n    },\n  });\n\n  const deleteStudentMutation = useMutation({\n    mutationFn: (id: string) => studentsApi.deleteStudent(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] });\n      toast.success('Student deleted successfully!');\n    },\n    onError: (error: unknown) => {\n      toast.error(getErrorMessage(error, 'Failed to delete student'));\n    },\n  });\n\n  const generateQRCodesMutation = useMutation({\n    mutationFn: () => utilitiesApi.generateQRCodes(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] });\n      toast.success('QR codes generated successfully!');\n    },\n    onError: (error: unknown) => {\n      toast.error(getErrorMessage(error, 'Failed to generate QR codes'));\n    },\n  });\n\n  const generateBarcodesMutation = useMutation({\n    mutationFn: () => utilitiesApi.generateBarcodes(),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] });\n      toast.success('Barcodes generated successfully!');\n    },\n    onError: (error: unknown) => {\n      toast.error(getErrorMessage(error, 'Failed to generate barcodes'));\n    },\n  });\n\n  // Mock data\n  const _mockData: MockStudentData = {\n    students: [\n      {\n        id: '1',\n        studentId: 'STU001',\n        firstName: 'Juan',\n        lastName: 'Dela Cruz',\n        gradeLevel: 'Grade 5',\n        gradeCategory: 'gradeSchool',\n        section: 'A',\n        isActive: true,\n        email: 'juan.delacruz@email.com',\n        phone: '+63 912 345 6789',\n        address: '123 Main St, City',\n        parentName: 'Maria Dela Cruz',\n        parentPhone: '+63 912 345 6788',\n        parentEmail: 'maria.parent@email.com',\n        emergencyContact: '+63 912 345 6787',\n        notes: 'Regular visitor, prefers computer sessions',\n        joinDate: '2024-01-15',\n        lastActivity: '2024-01-20',\n        totalSessions: 45,\n        specialPrivileges: ['extended_time'],\n        disciplinaryFlags: 0,\n        qrCodeGenerated: true,\n        barcodeGenerated: true,\n        libraryCardPrinted: true,\n      },\n      {\n        id: '2',\n        studentId: 'STU002',\n        firstName: 'Maria',\n        lastName: 'Santos',\n        gradeLevel: 'Grade 8',\n        gradeCategory: 'juniorHigh',\n        section: 'B',\n        isActive: true,\n        email: 'maria.santos@email.com',\n        phone: '+63 913 456 7890',\n        address: '456 Oak Ave, Town',\n        parentName: 'Jose Santos',\n        parentPhone: '+63 913 456 7891',\n        parentEmail: 'jose.parent@email.com',\n        emergencyContact: '+63 913 456 7892',\n        notes: 'Good student, follows rules',\n        joinDate: '2023-09-10',\n        lastActivity: '2024-01-19',\n        totalSessions: 32,\n        specialPrivileges: [],\n        disciplinaryFlags: 0,\n        qrCodeGenerated: true,\n        barcodeGenerated: true,\n        libraryCardPrinted: true,\n      },\n      {\n        id: '3',\n        studentId: 'STU003',\n        firstName: 'Jose',\n        lastName: 'Reyes',\n        gradeLevel: 'Grade 10',\n        gradeCategory: 'seniorHigh',\n        section: 'C',\n        isActive: false,\n        email: '',\n        phone: '',\n        address: '',\n        parentName: '',\n        parentPhone: '',\n        parentEmail: '',\n        emergencyContact: '',\n        notes: 'Inactive since December 2023',\n        joinDate: '2023-08-20',\n        lastActivity: '2023-12-15',\n        totalSessions: 18,\n        specialPrivileges: [],\n        disciplinaryFlags: 2,\n        qrCodeGenerated: false,\n        barcodeGenerated: false,\n        libraryCardPrinted: false,\n      },\n    ],\n    stats: {\n      total: 3,\n      active: 2,\n      inactive: 1,\n      newThisMonth: 0,\n      averageSessions: 31.7,\n      overdueReturns: 0,\n    },\n  };\n\n  // Handler functions\n  const handleAddStudent = async () => {\n    if (\n      !newStudent.firstName ||\n      !newStudent.lastName ||\n      !newStudent.gradeLevel\n    ) {\n      toast.error('Please fill in required fields');\n      return;\n    }\n\n    const studentData = {\n      firstName: newStudent.firstName,\n      lastName: newStudent.lastName,\n      gradeLevel: newStudent.gradeLevel,\n      section: newStudent.section,\n      email: newStudent.email,\n      phone: newStudent.phone,\n      parentName: newStudent.parentName,\n      parentPhone: newStudent.parentPhone,\n      parentEmail: newStudent.parentEmail,\n      emergencyContact: newStudent.emergencyContact,\n      address: newStudent.address,\n      notes: newStudent.notes,\n    };\n\n    createStudentMutation.mutate(studentData);\n  };\n\n  const handleEditStudent = () => {\n    if (!selectedStudent) {\n      return;\n    }\n\n    updateStudentMutation.mutate({\n      id: selectedStudent.id,\n      data: selectedStudent,\n    });\n  };\n\n  const handleDeleteStudent = (studentId: string) => {\n    if (confirm('Are you sure you want to delete this student?')) {\n      deleteStudentMutation.mutate(studentId);\n    }\n  };\n\n  const handleToggleStatus = (studentId: string) => {\n    const student = students.find((s: Student) => s.id === studentId);\n    if (student) {\n      updateStudentMutation.mutate({\n        id: studentId,\n        data: { ...student, isActive: !student.isActive },\n      });\n    }\n  };\n\n  const handleGenerateQRCodes = async () => {\n    loadingActions.generatingQRCodes.start();\n    try {\n      await generateQRCodesMutation.mutateAsync();\n    } catch (error) {\n      // Error handled by mutation\n    } finally {\n      loadingActions.generatingQRCodes.finish();\n    }\n  };\n\n  const handlePrintIDCards = async () => {\n    loadingActions.printingIDs.start();\n    try {\n      await generateBarcodesMutation.mutateAsync();\n      toast.success('ID cards printed successfully!');\n    } catch (error) {\n      // Error handled by mutation\n    } finally {\n      loadingActions.printingIDs.finish();\n    }\n  };\n\n  const handleExportStudents = async () => {\n    loadingActions.exporting.start();\n    try {\n      const csvContent = [\n        'Student ID,First Name,Last Name,Grade,Section,Status,Email,Phone,Join Date,Total Sessions',\n        ...filteredStudents.map(\n          (s: Student) =>\n            `${s.studentId},${s.firstName},${s.lastName},${s.gradeLevel},${s.section || ''},${s.isActive ? 'Active' : 'Inactive'},${s.email || ''},${s.phone || ''},${s.joinDate},${s.totalSessions}`\n        ),\n      ].join('\\n');\n\n      const blob = new Blob([csvContent], { type: 'text/csv' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `students-${new Date().toISOString().split('T')[0]}.csv`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n\n      toast.success('Students exported successfully!');\n    } catch (error) {\n      toast.error('Failed to export students');\n    } finally {\n      loadingActions.exporting.finish();\n    }\n  };\n\n  const handleBulkNotification = async () => {\n    setIsSendingNotifications(true);\n    try {\n      // Simulate sending notifications\n      await new Promise((resolve) => setTimeout(resolve, 1500));\n      toast.success(\n        `Notifications sent to ${selectedStudents.length} parents!`\n      );\n      setSelectedStudents([]);\n      setShowBulkActions(false);\n    } catch (error) {\n      toast.error('Failed to send notifications');\n    } finally {\n      setIsSendingNotifications(false);\n    }\n  };\n\n  const handleBulkGradeUpdate = async (grade: string) => {\n    try {\n      // Update each selected student\n      await Promise.all(\n        selectedStudents.map((id) =>\n          updateStudentMutation.mutateAsync({\n            id,\n            data: {\n              grade_level: grade,\n              grade_category: getGradeCategory(grade),\n            },\n          })\n        )\n      );\n      toast.success(`Updated ${selectedStudents.length} students`);\n      setSelectedStudents([]);\n      setShowBulkActions(false);\n    } catch (error) {\n      // Error handled by mutation\n    }\n    toast.success(`Grade updated for ${selectedStudents.length} students!`);\n    setSelectedStudents([]);\n    setShowBulkActions(false);\n  };\n\n  const handleBulkStatusUpdate = async (status: 'active' | 'inactive') => {\n    try {\n      // Update each selected student\n      await Promise.all(\n        selectedStudents.map((id) =>\n          updateStudentMutation.mutateAsync({\n            id,\n            data: { is_active: status === 'active' },\n          })\n        )\n      );\n      toast.success(`Status updated for ${selectedStudents.length} students!`);\n      setSelectedStudents([]);\n      setShowBulkActions(false);\n    } catch (error) {\n      // Error handled by mutation\n    }\n  };\n\n  const toggleStudentSelection = (studentId: string) => {\n    setSelectedStudents((prev) =>\n      prev.includes(studentId)\n        ? prev.filter((id) => id !== studentId)\n        : [...prev, studentId]\n    );\n  };\n\n  const getGradeCategory = (grade: string): string => {\n    if (\n      grade.includes('K') ||\n      grade.includes('1') ||\n      grade.includes('2') ||\n      grade.includes('3')\n    ) {\n      return 'primary';\n    }\n    if (grade.includes('4') || grade.includes('5') || grade.includes('6')) {\n      return 'gradeSchool';\n    }\n    if (grade.includes('7') || grade.includes('8') || grade.includes('9')) {\n      return 'juniorHigh';\n    }\n    if (grade.includes('10') || grade.includes('11') || grade.includes('12')) {\n      return 'seniorHigh';\n    }\n    return 'unknown';\n  };\n\n  const handleViewStudentHistory = (student: Student) => {\n    setSelectedStudent(student);\n    setShowStudentDetails(true);\n    toast.info(`Viewing history for ${student.firstName} ${student.lastName}`);\n  };\n\n  const handlePrintSchedule = (student: Student) => {\n    toast.info(\n      `Printing schedule for ${student.firstName} ${student.lastName}`\n    );\n  };\n\n  const handleSendParentMessage = (student: Student) => {\n    toast.info(\n      `Opening message composer for ${student.parentName || 'parent'}`\n    );\n  };\n\n  const handleAwardStudent = (student: Student) => {\n    toast.info(\n      `Opening awards interface for ${student.firstName} ${student.lastName}`\n    );\n  };\n\n  const handleAddNotes = async (student: Student) => {\n    const notes = prompt('Add notes for this student:', student.notes || '');\n    if (notes !== null) {\n      try {\n        await updateStudentMutation.mutateAsync({\n          id: student.id,\n          data: { notes },\n        });\n        toast.success('Notes updated!');\n      } catch (error) {\n        // Error handled by mutation\n      }\n    }\n  };\n\n  const handleViewStudentBarcode = (student: Student) => {\n    setSelectedStudent(student);\n    setShowStudentBarcode(true);\n  };\n\n  // Handle swipe gestures for mobile navigation\n  const handleTouchEndWithGesture = useCallback(\n    (e: React.TouchEvent) => {\n      if (isMobile) {\n        const gesture = handleTouchEnd(e);\n        if (gesture) {\n          if (gesture === 'swipe-left') {\n            // Navigate to next tab\n            const tabs = ['overview', 'students', 'bulk', 'reports'];\n            const currentIndex = tabs.indexOf(activeTab);\n            if (currentIndex < tabs.length - 1) {\n              const nextTab = tabs[currentIndex + 1];\n              if (nextTab) {\n                setActiveTab(nextTab);\n              }\n            }\n          } else if (gesture === 'swipe-right') {\n            // Navigate to previous tab\n            const tabs = ['overview', 'students', 'bulk', 'reports'];\n            const currentIndex = tabs.indexOf(activeTab);\n            if (currentIndex > 0) {\n              const previousTab = tabs[currentIndex - 1];\n              if (previousTab) {\n                setActiveTab(previousTab);\n              }\n            }\n          }\n        }\n      }\n    },\n    [handleTouchEnd, isMobile, activeTab]\n  );\n\n  return (\n    <div\n      className={getResponsiveClasses('space-y-6', mobileState)}\n      onTouchStart={isMobile ? handleTouchStart : undefined}\n      onTouchEnd={isMobile ? handleTouchEndWithGesture : undefined}\n    >\n      {/* Enhanced Header */}\n      <div className={`relative ${isMobile ? 'mb-4' : ''}`}>\n        <div>\n          <h2 className=\"text-3xl font-bold tracking-tight text-black dark:text-foreground\">\n            Student Management\n          </h2>\n          <p className=\"text-black dark:text-muted-foreground\">\n            Manage student records, activities, and library services.\n          </p>\n        </div>\n\n        {/* Header Action Buttons */}\n        <div\n          className={`${isMobile ? 'relative mt-4 grid grid-cols-2 gap-2' : isTablet ? 'relative mt-4 grid grid-cols-3 gap-2' : 'absolute top-0 right-0 flex gap-2'}`}\n        >\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowAddStudent(true)}\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\n          >\n            <UserPlus className=\"h-4 w-4 mr-1\" />\n            Add Student\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleGenerateQRCodes}\n            disabled={isGeneratingQRCodes}\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\n          >\n            <QrCode className=\"h-4 w-4 mr-1\" />\n            {isGeneratingQRCodes ? 'Generating...' : 'Generate QR'}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handlePrintIDCards}\n            disabled={isPrintingIDs}\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\n          >\n            <CreditCard className=\"h-4 w-4 mr-1\" />\n            {isPrintingIDs ? 'Printing...' : 'Print IDs'}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleExportStudents}\n            disabled={isExporting}\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\n          >\n            <Download className=\"h-4 w-4 mr-1\" />\n            Export\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowBulkImport(true)}\n            className=\"bg-white/90 hover:bg-white shadow-sm\"\n          >\n            <Upload className=\"h-4 w-4 mr-1\" />\n            Import\n          </Button>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <Tabs\n        value={activeTab}\n        onValueChange={setActiveTab}\n        className=\"space-y-4 sm:space-y-6\"\n      >\n        <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-4 gap-1 sm:gap-2\">\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n          <TabsTrigger value=\"students\">Students</TabsTrigger>\n          <TabsTrigger value=\"bulk\">Bulk Operations</TabsTrigger>\n          <TabsTrigger value=\"reports\">Reports</TabsTrigger>\n        </TabsList>\n\n        {/* Overview Tab */}\n        <TabsContent value=\"overview\" className=\"space-y-6\">\n          <div\n            className={`grid gap-3 sm:gap-4 grid-cols-2 md:grid-cols-2 lg:grid-cols-4`}\n          >\n            <Card className=\"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 border-blue-200 dark:border-blue-800\">\n              <CardContent className=\"p-4 text-center\">\n                <Users className=\"h-8 w-8 mx-auto mb-2 text-blue-600 dark:text-blue-400\" />\n                <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">\n                  {realStats.total}\n                </div>\n                <p className=\"text-sm text-blue-600 dark:text-blue-400\">\n                  Total Students\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border-green-200 dark:border-green-800\">\n              <CardContent className=\"p-4 text-center\">\n                <UserCheck className=\"h-8 w-8 mx-auto mb-2 text-green-600 dark:text-green-400\" />\n                <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">\n                  {realStats.active}\n                </div>\n                <p className=\"text-sm text-green-600 dark:text-green-400\">\n                  Active Students\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/20 dark:to-amber-950/20 border-orange-200 dark:border-orange-800\">\n              <CardContent className=\"p-4 text-center\">\n                <UserMinus className=\"h-8 w-8 mx-auto mb-2 text-orange-600 dark:text-orange-400\" />\n                <div className=\"text-2xl font-bold text-orange-700 dark:text-orange-300\">\n                  {realStats.inactive}\n                </div>\n                <p className=\"text-sm text-orange-600 dark:text-orange-400\">\n                  Inactive Students\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-950/20 dark:to-pink-950/20 border-purple-200 dark:border-purple-800\">\n              <CardContent className=\"p-4 text-center\">\n                <Activity className=\"h-8 w-8 mx-auto mb-2 text-purple-600 dark:text-purple-400\" />\n                <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">\n                  {realStats.averageSessions.toFixed(1)}\n                </div>\n                <p className=\"text-sm text-purple-600 dark:text-purple-400\">\n                  Avg Sessions\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Recent Activity */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                Recent Student Activity\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => setActiveTab('students')}\n                >\n                  <ExternalLink className=\"h-3 w-3 mr-1\" />\n                  View All\n                </Button>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {filteredStudents.slice(0, 3).map((student: Student) => (\n                  <div\n                    key={student.id}\n                    className=\"flex items-center justify-between p-3 rounded-lg border\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div\n                        className={`w-2 h-2 rounded-full ${student.isActive ? 'bg-green-500' : 'bg-red-500'}`}\n                      />\n                      <div>\n                        <div className=\"font-medium\">\n                          {student.firstName} {student.lastName}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          {student.gradeLevel} ΓÇó {student.totalSessions}{' '}\n                          sessions\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge\n                        variant={student.isActive ? 'default' : 'secondary'}\n                      >\n                        {student.isActive ? 'Active' : 'Inactive'}\n                      </Badge>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleViewStudentHistory(student)}\n                      >\n                        <Eye className=\"h-3 w-3\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Students Tab */}\n        <TabsContent value=\"students\" className=\"space-y-6\">\n          {/* Search and Filters */}\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between gap-4\">\n                <div className=\"flex items-center gap-2 flex-1\">\n                  <Search className=\"h-4 w-4 text-muted-foreground\" />\n                  <Input\n                    placeholder=\"Search students...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"flex-1\"\n                  />\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Select value={filterStatus} onValueChange={setFilterStatus}>\n                    <SelectTrigger className=\"w-[120px]\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Status</SelectItem>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"inactive\">Inactive</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <Select value={filterGrade} onValueChange={setFilterGrade}>\n                    <SelectTrigger className=\"w-[120px]\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Grades</SelectItem>\n                      <SelectItem value=\"primary\">Primary</SelectItem>\n                      <SelectItem value=\"gradeSchool\">Grade School</SelectItem>\n                      <SelectItem value=\"juniorHigh\">Junior High</SelectItem>\n                      <SelectItem value=\"seniorHigh\">Senior High</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Bulk Actions Toggle */}\n          {selectedStudents.length > 0 && (\n            <Card className=\"border-2 border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/20\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium\">\n                    {selectedStudents.length} students selected\n                  </span>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => setShowBulkActions(!showBulkActions)}\n                    >\n                      <Settings className=\"h-3 w-3 mr-1\" />\n                      Bulk Actions\n                    </Button>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setSelectedStudents([])}\n                    >\n                      Clear Selection\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Students List */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Students ({filteredStudents.length})</CardTitle>\n              <CardDescription>\n                Manage student records and activities\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {filteredStudents.map((student: Student) => (\n                  <div\n                    key={student.id}\n                    className={`p-4 rounded-lg border ${\n                      selectedStudents.includes(student.id)\n                        ? 'border-blue-500 bg-blue-50 dark:bg-blue-950/20'\n                        : 'border-gray-200 dark:border-gray-700'\n                    }`}\n                  >\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-3\">\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedStudents.includes(student.id)}\n                          onChange={() => toggleStudentSelection(student.id)}\n                          className=\"rounded\"\n                        />\n                        <div\n                          className={`w-2 h-2 rounded-full ${student.isActive ? 'bg-green-500' : 'bg-red-500'}`}\n                        />\n                        <div>\n                          <div className=\"font-medium\">\n                            {student.firstName} {student.lastName}\n                            {student.disciplinaryFlags > 0 && (\n                              <AlertTriangle className=\"inline h-3 w-3 ml-2 text-red-500\" />\n                            )}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground\">\n                            ID: {student.studentId} ΓÇó {student.gradeLevel}{' '}\n                            {student.section\n                              ? `ΓÇó Section ${student.section}`\n                              : ''}\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge\n                          variant={student.isActive ? 'default' : 'secondary'}\n                        >\n                          {student.isActive ? 'Active' : 'Inactive'}\n                        </Badge>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleViewStudentHistory(student)}\n                        >\n                          <Eye className=\"h-3 w-3\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setSelectedStudent(student);\n                            setShowEditStudent(true);\n                          }}\n                        >\n                          <Edit className=\"h-3 w-3\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleDeleteStudent(student.id)}\n                        >\n                          <Trash2 className=\"h-3 w-3\" />\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Student Info Badges */}\n                    <div className=\"flex items-center gap-2 mb-3 text-xs\">\n                      {student.email && (\n                        <Badge variant=\"outline\" className=\"text-blue-600\">\n                          <Mail className=\"h-3 w-3 mr-1\" />\n                          {student.email}\n                        </Badge>\n                      )}\n                      {student.phone && (\n                        <Badge variant=\"outline\" className=\"text-green-600\">\n                          <Phone className=\"h-3 w-3 mr-1\" />\n                          {student.phone}\n                        </Badge>\n                      )}\n                      <Badge variant=\"outline\" className=\"text-purple-600\">\n                        <Activity className=\"h-3 w-3 mr-1\" />\n                        {student.totalSessions} sessions\n                      </Badge>\n                      {student.qrCodeGenerated && (\n                        <Badge variant=\"outline\" className=\"text-orange-600\">\n                          <QrCode className=\"h-3 w-3 mr-1\" />\n                          QR\n                        </Badge>\n                      )}\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"flex gap-1 flex-wrap\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleToggleStatus(student.id)}\n                      >\n                        {student.isActive ? (\n                          <UserMinus className=\"h-3 w-3 mr-1\" />\n                        ) : (\n                          <UserCheck className=\"h-3 w-3 mr-1\" />\n                        )}\n                        {student.isActive ? 'Deactivate' : 'Activate'}\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handlePrintSchedule(student)}\n                      >\n                        <Calendar className=\"h-3 w-3 mr-1\" />\n                        Schedule\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleSendParentMessage(student)}\n                        disabled={!student.parentPhone && !student.parentEmail}\n                      >\n                        <MessageSquare className=\"h-3 w-3 mr-1\" />\n                        Contact\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleAwardStudent(student)}\n                      >\n                        <Award className=\"h-3 w-3 mr-1\" />\n                        Awards\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleAddNotes(student)}\n                      >\n                        <FileText className=\"h-3 w-3 mr-1\" />\n                        Notes\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleViewStudentBarcode(student)}\n                      >\n                        <QrCode className=\"h-3 w-3 mr-1\" />\n                        Barcode/QR\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Bulk Operations Tab */}\n        <TabsContent value=\"bulk\" className=\"space-y-6\">\n          {showBulkActions && selectedStudents.length > 0 && (\n            <Card className=\"border-2 border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950/20\">\n              <CardHeader>\n                <CardTitle>\n                  Bulk Actions - {selectedStudents.length} Students Selected\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid gap-4 md:grid-cols-2\">\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Grade Updates</h4>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkGradeUpdate('Grade 5')}\n                      >\n                        Grade 5\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkGradeUpdate('Grade 8')}\n                      >\n                        Grade 8\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkGradeUpdate('Grade 10')}\n                      >\n                        Grade 10\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkGradeUpdate('Grade 12')}\n                      >\n                        Grade 12\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Status Updates</h4>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkStatusUpdate('active')}\n                      >\n                        <UserCheck className=\"h-3 w-3 mr-1\" />\n                        Activate\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleBulkStatusUpdate('inactive')}\n                      >\n                        <UserMinus className=\"h-3 w-3 mr-1\" />\n                        Deactivate\n                      </Button>\n                    </div>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Parent Notifications</h4>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={handleBulkNotification}\n                      disabled={isSendingNotifications}\n                      className=\"w-full\"\n                    >\n                      <MessageSquare className=\"h-3 w-3 mr-1\" />\n                      {isSendingNotifications\n                        ? 'Sending...'\n                        : 'Send Notifications'}\n                    </Button>\n                  </div>\n\n                  <div>\n                    <h4 className=\"font-medium mb-2\">Document Generation</h4>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() =>\n                          toast.info('Generate ID cards for selected students')\n                        }\n                      >\n                        <CreditCard className=\"h-3 w-3 mr-1\" />\n                        ID Cards\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() =>\n                          toast.info('Generate QR codes for selected students')\n                        }\n                      >\n                        <QrCode className=\"h-3 w-3 mr-1\" />\n                        QR Codes\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Bulk Import Students</CardTitle>\n                <CardDescription>\n                  Import multiple students from CSV/Excel file\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Button\n                  onClick={() => setShowBulkImport(true)}\n                  className=\"w-full\"\n                >\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Import Students\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Generate Documents</CardTitle>\n                <CardDescription>\n                  Create ID cards, QR codes, and other documents\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={handleGenerateQRCodes}\n                    disabled={isGeneratingQRCodes}\n                    className=\"w-full\"\n                  >\n                    <QrCode className=\"h-4 w-4 mr-2\" />\n                    {isGeneratingQRCodes\n                      ? 'Generating...'\n                      : 'Generate All QR Codes'}\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={handlePrintIDCards}\n                    disabled={isPrintingIDs}\n                    className=\"w-full\"\n                  >\n                    <CreditCard className=\"h-4 w-4 mr-2\" />\n                    {isPrintingIDs ? 'Printing...' : 'Print All ID Cards'}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        {/* Reports Tab */}\n        <TabsContent value=\"reports\" className=\"space-y-6\">\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Student Statistics</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div className=\"flex justify-between\">\n                    <span>Total Students:</span>\n                    <span className=\"font-medium\">{realStats.total}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Active Students:</span>\n                    <span className=\"font-medium\">{realStats.active}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Average Sessions:</span>\n                    <span className=\"font-medium\">\n                      {realStats.averageSessions.toFixed(1)}\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Generate Reports</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() =>\n                      toast.info('Generate student activity report')\n                    }\n                    className=\"w-full\"\n                  >\n                    <Activity className=\"h-4 w-4 mr-2\" />\n                    Activity Report\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => toast.info('Generate disciplinary report')}\n                    className=\"w-full\"\n                  >\n                    <AlertTriangle className=\"h-4 w-4 mr-2\" />\n                    Disciplinary Report\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => toast.info('Generate attendance report')}\n                    className=\"w-full\"\n                  >\n                    <Calendar className=\"h-4 w-4 mr-2\" />\n                    Attendance Report\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      {/* Add Student Dialog */}\n      <Dialog open={showAddStudent} onOpenChange={setShowAddStudent}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>Add New Student</DialogTitle>\n            <DialogDescription>\n              Enter student information to register them in the library system.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"grid gap-4 py-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">First Name *</label>\n                <Input\n                  value={newStudent.firstName}\n                  onChange={(e) =>\n                    formActions.setValue('firstName', e.target.value)\n                  }\n                  placeholder=\"First name\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Last Name *</label>\n                <Input\n                  value={newStudent.lastName}\n                  onChange={(e) =>\n                    formActions.setValue('lastName', e.target.value)\n                  }\n                  placeholder=\"Last name\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Grade Level *</label>\n                <Select\n                  value={newStudent.gradeLevel}\n                  onValueChange={(value) =>\n                    formActions.setValue('gradeLevel', value)\n                  }\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select grade\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"Grade 1\">Grade 1</SelectItem>\n                    <SelectItem value=\"Grade 2\">Grade 2</SelectItem>\n                    <SelectItem value=\"Grade 3\">Grade 3</SelectItem>\n                    <SelectItem value=\"Grade 4\">Grade 4</SelectItem>\n                    <SelectItem value=\"Grade 5\">Grade 5</SelectItem>\n                    <SelectItem value=\"Grade 6\">Grade 6</SelectItem>\n                    <SelectItem value=\"Grade 7\">Grade 7</SelectItem>\n                    <SelectItem value=\"Grade 8\">Grade 8</SelectItem>\n                    <SelectItem value=\"Grade 9\">Grade 9</SelectItem>\n                    <SelectItem value=\"Grade 10\">Grade 10</SelectItem>\n                    <SelectItem value=\"Grade 11\">Grade 11</SelectItem>\n                    <SelectItem value=\"Grade 12\">Grade 12</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Section</label>\n                <Input\n                  value={newStudent.section}\n                  onChange={(e) =>\n                    formActions.setValue('section', e.target.value)\n                  }\n                  placeholder=\"Section\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Email</label>\n                <Input\n                  type=\"email\"\n                  value={newStudent.email}\n                  onChange={(e) =>\n                    formActions.setValue('email', e.target.value)\n                  }\n                  placeholder=\"student@email.com\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Phone</label>\n                <Input\n                  value={newStudent.phone}\n                  onChange={(e) =>\n                    formActions.setValue('phone', e.target.value)\n                  }\n                  placeholder=\"+63 912 345 6789\"\n                />\n              </div>\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium\">Parent Name</label>\n                <Input\n                  value={newStudent.parentName}\n                  onChange={(e) =>\n                    formActions.setValue('parentName', e.target.value)\n                  }\n                  placeholder=\"Parent/Guardian name\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Parent Phone</label>\n                <Input\n                  value={newStudent.parentPhone}\n                  onChange={(e) =>\n                    formActions.setValue('parentPhone', e.target.value)\n                  }\n                  placeholder=\"+63 912 345 6788\"\n                />\n              </div>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Address</label>\n              <Input\n                value={newStudent.address}\n                onChange={(e) =>\n                  formActions.setValue('address', e.target.value)\n                }\n                placeholder=\"Student address\"\n              />\n            </div>\n            <div>\n              <label className=\"text-sm font-medium\">Notes</label>\n              <Input\n                value={newStudent.notes}\n                onChange={(e) => formActions.setValue('notes', e.target.value)}\n                placeholder=\"Additional notes\"\n              />\n            </div>\n          </div>\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={() => setShowAddStudent(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleAddStudent}>Add Student</Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Student Dialog */}\n      <Dialog open={showEditStudent} onOpenChange={setShowEditStudent}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>Edit Student</DialogTitle>\n            <DialogDescription>\n              Update student information in the library system.\n            </DialogDescription>\n          </DialogHeader>\n          {selectedStudent && (\n            <div className=\"grid gap-4 py-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">First Name *</label>\n                  <Input\n                    value={selectedStudent.firstName}\n                    onChange={(e) =>\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        firstName: e.target.value,\n                      })\n                    }\n                    placeholder=\"First name\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Last Name *</label>\n                  <Input\n                    value={selectedStudent.lastName}\n                    onChange={(e) =>\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        lastName: e.target.value,\n                      })\n                    }\n                    placeholder=\"Last name\"\n                  />\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Grade Level *</label>\n                  <Select\n                    value={selectedStudent?.gradeLevel ?? ''}\n                    onValueChange={(value) =>\n                      selectedStudent &&\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        gradeLevel: value,\n                      })\n                    }\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select grade\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"Grade 1\">Grade 1</SelectItem>\n                      <SelectItem value=\"Grade 2\">Grade 2</SelectItem>\n                      <SelectItem value=\"Grade 3\">Grade 3</SelectItem>\n                      <SelectItem value=\"Grade 4\">Grade 4</SelectItem>\n                      <SelectItem value=\"Grade 5\">Grade 5</SelectItem>\n                      <SelectItem value=\"Grade 6\">Grade 6</SelectItem>\n                      <SelectItem value=\"Grade 7\">Grade 7</SelectItem>\n                      <SelectItem value=\"Grade 8\">Grade 8</SelectItem>\n                      <SelectItem value=\"Grade 9\">Grade 9</SelectItem>\n                      <SelectItem value=\"Grade 10\">Grade 10</SelectItem>\n                      <SelectItem value=\"Grade 11\">Grade 11</SelectItem>\n                      <SelectItem value=\"Grade 12\">Grade 12</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Section</label>\n                  <Input\n                    value={selectedStudent.section || ''}\n                    onChange={(e) =>\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        section: e.target.value,\n                      })\n                    }\n                    placeholder=\"Section\"\n                  />\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium\">Email</label>\n                  <Input\n                    type=\"email\"\n                    value={selectedStudent.email || ''}\n                    onChange={(e) =>\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        email: e.target.value,\n                      })\n                    }\n                    placeholder=\"student@email.com\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium\">Phone</label>\n                  <Input\n                    value={selectedStudent.phone || ''}\n                    onChange={(e) =>\n                      setSelectedStudent({\n                        ...selectedStudent,\n                        phone: e.target.value,\n                      })\n                    }\n                    placeholder=\"+63 912 345 6789\"\n                  />\n                </div>\n              </div>\n              <div>\n                <label className=\"text-sm font-medium\">Notes</label>\n                <Input\n                  value={selectedStudent.notes || ''}\n                  onChange={(e) =>\n                    setSelectedStudent({\n                      ...selectedStudent,\n                      notes: e.target.value,\n                    })\n                  }\n                  placeholder=\"Additional notes\"\n                />\n              </div>\n            </div>\n          )}\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={() => setShowEditStudent(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleEditStudent}>Update Student</Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Student Details Dialog */}\n      <Dialog open={showStudentDetails} onOpenChange={setShowStudentDetails}>\n        <DialogContent className=\"max-w-3xl\">\n          <DialogHeader>\n            <DialogTitle>Student Details</DialogTitle>\n            <DialogDescription>\n              Complete information and activity history for this student.\n            </DialogDescription>\n          </DialogHeader>\n          {selectedStudent && (\n            <div className=\"space-y-6\">\n              {/* Basic Information */}\n              <div className=\"grid gap-4 md:grid-cols-2\">\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg\">Basic Information</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Student ID:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.studentId}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Name:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.firstName} {selectedStudent.lastName}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Grade:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.gradeLevel}{' '}\n                        {selectedStudent.section &&\n                          `- Section ${selectedStudent.section}`}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Status:\n                      </span>\n                      <Badge\n                        variant={\n                          selectedStudent.isActive ? 'default' : 'secondary'\n                        }\n                      >\n                        {selectedStudent.isActive ? 'Active' : 'Inactive'}\n                      </Badge>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Join Date:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.joinDate}\n                      </span>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"text-lg\">\n                      Contact Information\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Email:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.email || 'Not provided'}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Phone:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.phone || 'Not provided'}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Parent:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.parentName || 'Not provided'}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Parent Phone:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.parentPhone || 'Not provided'}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-sm text-muted-foreground\">\n                        Emergency Contact:\n                      </span>\n                      <span className=\"font-medium\">\n                        {selectedStudent.emergencyContact || 'Not provided'}\n                      </span>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Activity Summary */}\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-lg\">Activity Summary</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-4 md:grid-cols-3\">\n                    <div className=\"text-center p-4 rounded-lg bg-blue-50 dark:bg-blue-950/20\">\n                      <Activity className=\"h-8 w-8 mx-auto mb-2 text-blue-600\" />\n                      <div className=\"text-2xl font-bold text-blue-700\">\n                        {selectedStudent.totalSessions}\n                      </div>\n                      <p className=\"text-sm text-blue-600\">Total Sessions</p>\n                    </div>\n                    <div className=\"text-center p-4 rounded-lg bg-green-50 dark:bg-green-950/20\">\n                      <Calendar className=\"h-8 w-8 mx-auto mb-2 text-green-600\" />\n                      <div className=\"text-2xl font-bold text-green-700\">\n                        Last Active\n                      </div>\n                      <p className=\"text-sm text-green-600\">\n                        {selectedStudent.lastActivity || 'Never'}\n                      </p>\n                    </div>\n                    <div className=\"text-center p-4 rounded-lg bg-purple-50 dark:bg-purple-950/20\">\n                      <TrendingUp className=\"h-8 w-8 mx-auto mb-2 text-purple-600\" />\n                      <div className=\"text-2xl font-bold text-purple-700\">\n                        Regular\n                      </div>\n                      <p className=\"text-sm text-purple-600\">Usage Pattern</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Quick Actions */}\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-lg\">Quick Actions</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-2 md:grid-cols-4\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handlePrintSchedule(selectedStudent)}\n                    >\n                      <Calendar className=\"h-4 w-4 mr-2\" />\n                      Print Schedule\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handleSendParentMessage(selectedStudent)}\n                    >\n                      <MessageSquare className=\"h-4 w-4 mr-2\" />\n                      Contact Parent\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handleAwardStudent(selectedStudent)}\n                    >\n                      <Award className=\"h-4 w-4 mr-2\" />\n                      Add Award\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handleAddNotes(selectedStudent)}\n                    >\n                      <FileText className=\"h-4 w-4 mr-2\" />\n                      Add Notes\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n          <div className=\"flex justify-end gap-2\">\n            <Button onClick={() => setShowStudentDetails(false)}>Close</Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Student Import Dialog */}\n      <StudentImportDialog\n        open={showBulkImport}\n        onOpenChange={setShowBulkImport}\n      />\n\n      {/* Student Barcode Dialog */}\n      <StudentBarcodeDialog\n        open={showStudentBarcode}\n        onOpenChange={setShowStudentBarcode}\n        student={selectedStudent}\n      />\n    </div>\n  );\n}\n\nexport default StudentManagement;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\dashboard\\StudentPhotoUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\fines\\FinesManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2612,2615],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2612,2615],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  DollarSign,\r\n  Search,\r\n  CheckCircle2,\r\n  AlertCircle,\r\n  Download,\r\n  XCircle,\r\n  Clock,\r\n  BookOpen,\r\n} from 'lucide-react';\r\nimport { finesApi } from '@/lib/api';\r\nimport { exportFinesToCSV } from '@/lib/export-utils';\r\n\r\ninterface Fine {\r\n  id: string;\r\n  studentId: string;\r\n  studentName: string;\r\n  bookId: string;\r\n  bookTitle: string;\r\n  checkoutId: string;\r\n  checkoutDate: Date;\r\n  dueDate: Date;\r\n  returnDate: Date | null;\r\n  overdueDays: number;\r\n  fineAmount: number;\r\n  finePaid: boolean;\r\n  paidDate: Date | null;\r\n  paidAmount: number | null;\r\n  status: 'OUTSTANDING' | 'PAID' | 'WAIVED';\r\n  createdAt: Date;\r\n}\r\n\r\nexport default function FinesManagement() {\r\n  const [fines, setFines] = useState<Fine[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('ALL');\r\n  const [selectedFine, setSelectedFine] = useState<Fine | null>(null);\r\n  const [paymentDialogOpen, setPaymentDialogOpen] = useState(false);\r\n  const [paymentAmount, setPaymentAmount] = useState('');\r\n  const [message, setMessage] = useState<{\r\n    type: 'success' | 'error' | null;\r\n    text: string;\r\n  }>({ type: null, text: '' });\r\n\r\n  const showMessage = useCallback((type: 'success' | 'error', text: string) => {\r\n    setMessage({ type, text });\r\n    setTimeout(() => {\r\n      setMessage({ type: null, text: '' });\r\n    }, 5000);\r\n  }, []);\r\n\r\n  const fetchFines = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const status =\r\n        statusFilter === 'ALL'\r\n          ? undefined\r\n          : (statusFilter.toLowerCase() as 'outstanding' | 'paid');\r\n      const response = await finesApi.getFines(status);\r\n\r\n      if (response.success && response.data) {\r\n        setFines((response.data as any).fines || []);\r\n      } else {\r\n        showMessage('error', 'Failed to load fines');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch fines:', error);\r\n      showMessage('error', 'Failed to load fines');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [statusFilter, showMessage]);\r\n\r\n  useEffect(() => {\r\n    fetchFines();\r\n  }, [fetchFines]);\r\n\r\n  const handleMarkAsPaid = (fine: Fine) => {\r\n    setSelectedFine(fine);\r\n    setPaymentAmount(fine.fineAmount.toString());\r\n    setPaymentDialogOpen(true);\r\n  };\r\n\r\n  const processFinePayment = async () => {\r\n    if (!selectedFine) {\r\n      return;\r\n    }\r\n\r\n    const amount = parseFloat(paymentAmount);\r\n    if (isNaN(amount) || amount <= 0) {\r\n      showMessage('error', 'Please enter a valid payment amount');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await finesApi.recordPayment(selectedFine.checkoutId, {\r\n        amountPaid: amount,\r\n        paymentMethod: 'Cash',\r\n        notes: 'Payment processed',\r\n      });\r\n\r\n      if (response.success) {\r\n        showMessage('success', 'Payment recorded successfully');\r\n        setPaymentDialogOpen(false);\r\n        setSelectedFine(null);\r\n        setPaymentAmount('');\r\n        fetchFines();\r\n      } else {\r\n        showMessage('error', response.error || 'Failed to process payment');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to process payment:', error);\r\n      showMessage('error', 'Failed to process payment');\r\n    }\r\n  };\r\n\r\n  const handleWaiveFine = async (checkoutId: string) => {\r\n    const reason = prompt('Please enter reason for waiving this fine:');\r\n    if (!reason) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await finesApi.waiveFine(checkoutId, reason);\r\n\r\n      if (response.success) {\r\n        showMessage('success', 'Fine waived successfully');\r\n        fetchFines();\r\n      } else {\r\n        showMessage('error', response.error || 'Failed to waive fine');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to waive fine:', error);\r\n      showMessage('error', 'Failed to waive fine');\r\n    }\r\n  };\r\n\r\n  const exportFines = () => {\r\n    try {\r\n      exportFinesToCSV(filteredFines);\r\n      showMessage('success', 'Fines exported successfully');\r\n    } catch (error) {\r\n      console.error('Failed to export fines:', error);\r\n      showMessage('error', 'Failed to export fines');\r\n    }\r\n  };\r\n\r\n  const formatDate = (date: Date | null) => {\r\n    if (!date) {\r\n      return '-';\r\n    }\r\n    return new Date(date).toLocaleDateString();\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    return `Γé▒${amount.toFixed(2)}`;\r\n  };\r\n\r\n  const getStatusBadge = (status: string) => {\r\n    switch (status) {\r\n      case 'OUTSTANDING':\r\n        return (\r\n          <Badge variant=\"destructive\">\r\n            <Clock className=\"w-3 h-3 mr-1\" />\r\n            Outstanding\r\n          </Badge>\r\n        );\r\n      case 'PAID':\r\n        return (\r\n          <Badge className=\"bg-green-500\">\r\n            <CheckCircle2 className=\"w-3 h-3 mr-1\" />\r\n            Paid\r\n          </Badge>\r\n        );\r\n      case 'WAIVED':\r\n        return (\r\n          <Badge variant=\"secondary\">\r\n            <XCircle className=\"w-3 h-3 mr-1\" />\r\n            Waived\r\n          </Badge>\r\n        );\r\n      default:\r\n        return <Badge>{status}</Badge>;\r\n    }\r\n  };\r\n\r\n  const filteredFines = fines.filter(\r\n    (fine) =>\r\n      fine.studentName.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      fine.bookTitle.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  const totalOutstanding = fines\r\n    .filter((f) => f.status === 'OUTSTANDING')\r\n    .reduce((sum, f) => sum + f.fineAmount, 0);\r\n\r\n  const totalCollected = fines\r\n    .filter((f) => f.status === 'PAID')\r\n    .reduce((sum, f) => sum + (f.paidAmount || 0), 0);\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading fines...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Messages */}\r\n      {message.type && (\r\n        <Alert variant={message.type === 'success' ? 'default' : 'destructive'}>\r\n          {message.type === 'success' ? (\r\n            <CheckCircle2 className=\"h-4 w-4\" />\r\n          ) : (\r\n            <AlertCircle className=\"h-4 w-4\" />\r\n          )}\r\n          <AlertDescription>{message.text}</AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Summary Cards */}\r\n      <div className=\"grid gap-4 md:grid-cols-3\">\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Outstanding\r\n            </CardTitle>\r\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-destructive\">\r\n              {formatCurrency(totalOutstanding)}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {fines.filter((f) => f.status === 'OUTSTANDING').length} unpaid\r\n              fines\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">\r\n              Total Collected\r\n            </CardTitle>\r\n            <CheckCircle2 className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {formatCurrency(totalCollected)}\r\n            </div>\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              {fines.filter((f) => f.status === 'PAID').length} paid fines\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n            <CardTitle className=\"text-sm font-medium\">Total Fines</CardTitle>\r\n            <BookOpen className=\"h-4 w-4 text-muted-foreground\" />\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"text-2xl font-bold\">{fines.length}</div>\r\n            <p className=\"text-xs text-muted-foreground\">All time records</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters and Actions */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <DollarSign className=\"w-5 h-5\" />\r\n            Fines Management\r\n          </CardTitle>\r\n          <CardDescription>Track and manage overdue book fines</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"flex items-center gap-4\">\r\n            {/* _Search */}\r\n            <div className=\"relative flex-1\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"_Search by student or book...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n\r\n            {/* Status Filter */}\r\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n              <SelectTrigger className=\"w-[180px]\">\r\n                <SelectValue placeholder=\"All Statuses\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"ALL\">All Statuses</SelectItem>\r\n                <SelectItem value=\"OUTSTANDING\">Outstanding</SelectItem>\r\n                <SelectItem value=\"PAID\">Paid</SelectItem>\r\n                <SelectItem value=\"WAIVED\">Waived</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n\r\n            {/* Export Button */}\r\n            <Button variant=\"outline\" onClick={exportFines}>\r\n              <Download className=\"w-4 h-4 mr-2\" />\r\n              Export\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Fines Table */}\r\n      <Card>\r\n        <CardContent className=\"p-0\">\r\n          <div className=\"border rounded-lg\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Student</TableHead>\r\n                  <TableHead>Book</TableHead>\r\n                  <TableHead>Due Date</TableHead>\r\n                  <TableHead>Overdue Days</TableHead>\r\n                  <TableHead>Amount</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead className=\"text-right\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {filteredFines.length === 0 ? (\r\n                  <TableRow>\r\n                    <TableCell\r\n                      colSpan={7}\r\n                      className=\"text-center text-muted-foreground\"\r\n                    >\r\n                      No fines found\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ) : (\r\n                  filteredFines.map((fine) => (\r\n                    <TableRow key={fine.id}>\r\n                      <TableCell>\r\n                        <div>\r\n                          <div className=\"font-medium\">{fine.studentName}</div>\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            {fine.studentId}\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div\r\n                          className=\"max-w-[200px] truncate\"\r\n                          title={fine.bookTitle}\r\n                        >\r\n                          {fine.bookTitle}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-sm\">\r\n                        {formatDate(fine.dueDate)}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant=\"outline\">{fine.overdueDays} days</Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        {formatCurrency(fine.fineAmount)}\r\n                      </TableCell>\r\n                      <TableCell>{getStatusBadge(fine.status)}</TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        {fine.status === 'OUTSTANDING' && (\r\n                          <div className=\"flex justify-end gap-2\">\r\n                            <Button\r\n                              size=\"sm\"\r\n                              onClick={() => handleMarkAsPaid(fine)}\r\n                            >\r\n                              Mark as Paid\r\n                            </Button>\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant=\"outline\"\r\n                              onClick={() => handleWaiveFine(fine.id)}\r\n                            >\r\n                              Waive\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                        {fine.status === 'PAID' && fine.paidDate && (\r\n                          <span className=\"text-xs text-muted-foreground\">\r\n                            Paid: {formatDate(fine.paidDate)}\r\n                          </span>\r\n                        )}\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))\r\n                )}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Payment Dialog */}\r\n      <Dialog open={paymentDialogOpen} onOpenChange={setPaymentDialogOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>Record Fine Payment</DialogTitle>\r\n            <DialogDescription>\r\n              Enter the payment amount for {selectedFine?.studentName}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {selectedFine && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                <div>\r\n                  <span className=\"text-muted-foreground\">Book:</span>\r\n                  <p className=\"font-medium\">{selectedFine.bookTitle}</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-muted-foreground\">Overdue:</span>\r\n                  <p className=\"font-medium\">{selectedFine.overdueDays} days</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-muted-foreground\">Fine Amount:</span>\r\n                  <p className=\"font-medium text-lg\">\r\n                    {formatCurrency(selectedFine.fineAmount)}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <label htmlFor=\"payment-amount\" className=\"text-sm font-medium\">\r\n                  Payment Amount\r\n                </label>\r\n                <div className=\"relative\">\r\n                  <span className=\"absolute left-3 top-1/2 -translate-y-1/2\">\r\n                    Γé▒\r\n                  </span>\r\n                  <Input\r\n                    id=\"payment-amount\"\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    step=\"0.01\"\r\n                    value={paymentAmount}\r\n                    onChange={(e) => setPaymentAmount(e.target.value)}\r\n                    className=\"pl-7\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setPaymentDialogOpen(false)}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={processFinePayment}>Record Payment</Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\layout\\ResponsiveDrawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\mobile\\MobileBottomNavigation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\mobile\\MobileQuickActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\mobile\\MobileScanner.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[851,854],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[851,854],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[966,969],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[966,969],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'scanFrame'. Either include it or remove the dependency array.","line":99,"column":6,"nodeType":"ArrayExpression","endLine":99,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [isMobile, flashlightEnabled, scanFrame]","fix":{"range":[3118,3147],"text":"[isMobile, flashlightEnabled, scanFrame]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3779,3782],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3779,3782],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'handleScanResult'. Either include it or remove the dependency array.","line":172,"column":6,"nodeType":"ArrayExpression","endLine":172,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [handleScanResult, isScanning]","fix":{"range":[5249,5261],"text":"[handleScanResult, isScanning]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5400,5403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5400,5403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\nimport { useOfflineSync } from '@/hooks/useOfflineSync';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Camera,\r\n  CameraOff,\r\n  Zap,\r\n  History as HistoryIcon,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertCircle,\r\n  RotateCcw,\r\n  Flashlight,\r\n  FlashlightOff,\r\n  Keyboard,\r\n  X,\r\n  Search,\r\n} from 'lucide-react';\r\n\r\ninterface ScanResult {\r\n  id: string;\r\n  code: string;\r\n  type: 'barcode' | 'qr' | 'manual';\r\n  timestamp: number;\r\n  status: 'success' | 'error' | 'pending';\r\n  data?: any;\r\n  error?: string;\r\n}\r\n\r\ninterface MobileScannerProps {\r\n  onScanSuccess: (code: string, type: string, data?: any) => void;\r\n  onScanError: (error: string) => void;\r\n  placeholder?: string;\r\n  allowedTypes?: ('barcode' | 'qr' | 'manual')[];\r\n}\r\n\r\nexport const MobileScanner: React.FC<MobileScannerProps> = ({\r\n  onScanSuccess,\r\n  onScanError,\r\n  placeholder = 'Scan barcode or QR code',\r\n  allowedTypes = ['barcode', 'qr', 'manual'],\r\n}) => {\r\n  const { isMobile } = useMobileOptimization();\r\n  const { queueAction } = useOfflineSync();\r\n\r\n  // Scanner state\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [scanMode, setScanMode] = useState<'camera' | 'manual'>('camera');\r\n  const [manualInput, setManualInput] = useState('');\r\n  const [flashlightEnabled, setFlashlightEnabled] = useState(false);\r\n  const [showHistory, setShowHistory] = useState(false);\r\n\r\n  // Scanner history\r\n  const [scanHistory, setScanHistory] = useState<ScanResult[]>([]);\r\n  const [currentScan, setCurrentScan] = useState<string>('');\r\n\r\n  // Camera refs\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n\r\n  // Auto-focus for manual input on mobile\r\n  const manualInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // Initialize camera\r\n  const startCamera = useCallback(async () => {\r\n    if (!videoRef.current) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const constraints: MediaStreamConstraints = {\r\n        video: {\r\n          facingMode: isMobile ? 'environment' : 'user',\r\n          width: { ideal: 1280 },\r\n          height: { ideal: 720 },\r\n          // @ts-expect-error - torch is not in standard MediaTrackConstraints but supported by browsers\r\n          torch: flashlightEnabled,\r\n        },\r\n      };\r\n\r\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n      videoRef.current.srcObject = stream;\r\n      streamRef.current = stream;\r\n      setIsScanning(true);\r\n\r\n      // Start scanning loop\r\n      requestAnimationFrame(scanFrame);\r\n    } catch (error) {\r\n      console.error('[MobileScanner] Camera access failed:', error);\r\n      toast.error('Failed to access camera');\r\n      setScanMode('manual');\r\n    }\r\n  }, [isMobile, flashlightEnabled]);\r\n\r\n  // Stop camera\r\n  const stopCamera = useCallback(() => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach((track) => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n    if (videoRef.current) {\r\n      videoRef.current.srcObject = null;\r\n    }\r\n    setIsScanning(false);\r\n  }, []);\r\n\r\n  // Toggle flashlight\r\n  const toggleFlashlight = useCallback(async () => {\r\n    if (!streamRef.current) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const track = streamRef.current.getVideoTracks()[0];\r\n      if (!track) {\r\n        return;\r\n      }\r\n\r\n      const capabilities = track.getCapabilities() as any;\r\n\r\n      if (capabilities.torch) {\r\n        await track.applyConstraints({\r\n          // @ts-expect-error - torch is not in standard MediaTrackConstraints but supported by browsers\r\n          advanced: [{ torch: !flashlightEnabled }],\r\n        });\r\n        setFlashlightEnabled(!flashlightEnabled);\r\n      } else {\r\n        toast.error('Flashlight not available');\r\n      }\r\n    } catch (error) {\r\n      console.error('[MobileScanner] Flashlight toggle failed:', error);\r\n      toast.error('Failed to toggle flashlight');\r\n    }\r\n  }, [flashlightEnabled]);\r\n\r\n  // Scan frame for barcodes/QR codes\r\n  const scanFrame = useCallback(() => {\r\n    if (!isScanning || !videoRef.current || !canvasRef.current) {\r\n      return;\r\n    }\r\n\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n    const context = canvas.getContext('2d');\r\n\r\n    if (!context || video.readyState !== 4) {\r\n      requestAnimationFrame(scanFrame);\r\n      return;\r\n    }\r\n\r\n    // Draw video frame to canvas\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n    context.drawImage(video, 0, 0);\r\n\r\n    // Here you would integrate with a barcode scanning library\r\n    // For now, we'll simulate scanning\r\n    const mockScannedCode = `DEMO-${Date.now().toString(36)}`;\r\n\r\n    if (Math.random() < 0.01) {\r\n      // Simulate successful scan\r\n      handleScanResult(mockScannedCode, 'barcode');\r\n    }\r\n\r\n    requestAnimationFrame(scanFrame);\r\n  }, [isScanning]);\r\n\r\n  // Handle scan result\r\n  const handleScanResult = useCallback(\r\n    async (code: string, type: 'barcode' | 'qr' | 'manual', data?: any) => {\r\n      try {\r\n        // Create scan result entry\r\n        const result: ScanResult = {\r\n          id: `scan-${Date.now()}`,\r\n          code,\r\n          type,\r\n          timestamp: Date.now(),\r\n          status: 'success',\r\n          data,\r\n        };\r\n\r\n        // Add to history\r\n        setScanHistory((prev) => [result, ...prev.slice(0, 9)]); // Keep last 10\r\n\r\n        // Provide haptic feedback\r\n        if ('vibrate' in navigator) {\r\n          navigator.vibrate(100);\r\n        }\r\n\r\n        // Call success callback\r\n        onScanSuccess(code, type, data);\r\n\r\n        // Queue action if offline\r\n        if (!navigator.onLine) {\r\n          await queueAction({\r\n            type: 'create',\r\n            endpoint: '/api/activities',\r\n            data: {\r\n              action: 'scan',\r\n              code,\r\n              type,\r\n              timestamp: result.timestamp,\r\n              data,\r\n            },\r\n            maxRetries: 5,\r\n          });\r\n        }\r\n\r\n        // Clear current scan\r\n        setCurrentScan('');\r\n        if (scanMode === 'manual') {\r\n          setManualInput('');\r\n        }\r\n\r\n        toast.success(`Scanned: ${code}`);\r\n      } catch (error) {\r\n        console.error('[MobileScanner] Scan handling failed:', error);\r\n        toast.error('Failed to process scan');\r\n        onScanError?.('Failed to process scan');\r\n      }\r\n    },\r\n    [onScanSuccess, onScanError, scanMode, queueAction]\r\n  );\r\n\r\n  // Handle manual input\r\n  const handleManualSubmit = useCallback(() => {\r\n    if (!manualInput.trim()) {\r\n      return;\r\n    }\r\n\r\n    handleScanResult(manualInput.trim(), 'manual');\r\n  }, [manualInput, handleScanResult]);\r\n\r\n  // Retry failed scan\r\n  const retryScan = useCallback(\r\n    (result: ScanResult) => {\r\n      handleScanResult(result.code, result.type, result.data);\r\n    },\r\n    [handleScanResult]\r\n  );\r\n\r\n  // Clear history\r\n  const clearHistory = useCallback(() => {\r\n    setScanHistory([]);\r\n    toast.success('Scan history cleared');\r\n  }, []);\r\n\r\n  // Initialize camera on mount\r\n  useEffect(() => {\r\n    if (scanMode === 'camera' && !isScanning) {\r\n      startCamera();\r\n    }\r\n\r\n    return () => {\r\n      stopCamera();\r\n    };\r\n  }, [scanMode, startCamera, stopCamera, isScanning]);\r\n\r\n  // Auto-focus manual input\r\n  useEffect(() => {\r\n    if (scanMode === 'manual' && manualInputRef.current) {\r\n      manualInputRef.current.focus();\r\n    }\r\n  }, [scanMode]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Scanner Header */}\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"text-lg\">Mobile Scanner</CardTitle>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge variant={isScanning ? 'default' : 'secondary'}>\r\n                {isScanning ? 'Active' : 'Inactive'}\r\n              </Badge>\r\n              {scanHistory.length > 0 && (\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setShowHistory(!showHistory)}\r\n                  className=\"flex items-center gap-1\"\r\n                >\r\n                  <HistoryIcon className=\"h-4 w-4\" />\r\n                  {scanHistory.length}\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* Mode Selection */}\r\n          <div className=\"flex gap-2\">\r\n            {allowedTypes.includes('barcode') &&\r\n              allowedTypes.includes('qr') && (\r\n                <Button\r\n                  variant={scanMode === 'camera' ? 'default' : 'outline'}\r\n                  size=\"sm\"\r\n                  onClick={() => setScanMode('camera')}\r\n                  className=\"flex items-center gap-2\"\r\n                >\r\n                  <Camera className=\"h-4 w-4\" />\r\n                  Camera\r\n                </Button>\r\n              )}\r\n            {allowedTypes.includes('manual') && (\r\n              <Button\r\n                variant={scanMode === 'manual' ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => setScanMode('manual')}\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <Keyboard className=\"h-4 w-4\" />\r\n                Manual\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Camera Scanner */}\r\n          {scanMode === 'camera' && (\r\n            <div className=\"space-y-4\">\r\n              <div\r\n                className=\"relative bg-black rounded-lg overflow-hidden\"\r\n                style={{ aspectRatio: '16/9' }}\r\n              >\r\n                <video\r\n                  ref={videoRef}\r\n                  autoPlay\r\n                  playsInline\r\n                  muted\r\n                  className=\"w-full h-full object-cover\"\r\n                />\r\n                <canvas ref={canvasRef} className=\"hidden\" />\r\n\r\n                {/* Scan Overlay */}\r\n                <div className=\"absolute inset-0 pointer-events-none\">\r\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent\" />\r\n                  <div className=\"absolute inset-x-4 top-1/2 -translate-y-1/2\">\r\n                    <div className=\"border-2 border-green-400 rounded-lg aspect-square max-w-xs mx-auto animate-pulse\" />\r\n                  </div>\r\n                  <div className=\"absolute bottom-4 left-4 right-4 text-center\">\r\n                    <p className=\"text-white text-sm font-medium\">\r\n                      Position code within frame\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Camera Controls */}\r\n                <div className=\"absolute top-4 right-4 flex flex-col gap-2\">\r\n                  {isMobile && (\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={toggleFlashlight}\r\n                      className=\"bg-black/50 border-white/20 text-white hover:bg-black/70\"\r\n                    >\r\n                      {flashlightEnabled ? (\r\n                        <FlashlightOff className=\"h-4 w-4\" />\r\n                      ) : (\r\n                        <Flashlight className=\"h-4 w-4\" />\r\n                      )}\r\n                    </Button>\r\n                  )}\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={isScanning ? stopCamera : startCamera}\r\n                    className=\"bg-black/50 border-white/20 text-white hover:bg-black/70\"\r\n                  >\r\n                    {isScanning ? (\r\n                      <CameraOff className=\"h-4 w-4\" />\r\n                    ) : (\r\n                      <Camera className=\"h-4 w-4\" />\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Current Scan Display */}\r\n              {currentScan && (\r\n                <div className=\"p-3 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <CheckCircle className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\r\n                    <span className=\"text-sm font-medium text-green-800 dark:text-green-200\">\r\n                      Last Scan: {currentScan}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Manual Input */}\r\n          {scanMode === 'manual' && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  ref={manualInputRef}\r\n                  type=\"text\"\r\n                  placeholder={placeholder}\r\n                  value={manualInput}\r\n                  onChange={(e) => setManualInput(e.target.value)}\r\n                  onKeyPress={(e) => e.key === 'Enter' && handleManualSubmit()}\r\n                  className=\"pl-10 pr-12 text-base\"\r\n                  autoComplete=\"off\"\r\n                  autoCorrect=\"off\"\r\n                  autoCapitalize=\"off\"\r\n                  spellCheck=\"false\"\r\n                />\r\n                {manualInput && (\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={() => setManualInput('')}\r\n                    className=\"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0\"\r\n                  >\r\n                    <X className=\"h-3 w-3\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n\r\n              <Button\r\n                onClick={handleManualSubmit}\r\n                disabled={!manualInput.trim()}\r\n                className=\"w-full\"\r\n                size=\"lg\"\r\n              >\r\n                <Zap className=\"h-4 w-4 mr-2\" />\r\n                Submit Code\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Scan History */}\r\n      {showHistory && scanHistory.length > 0 && (\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <CardTitle className=\"text-lg\">Scan History</CardTitle>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={clearHistory}\r\n                className=\"text-red-600 dark:text-red-400\"\r\n              >\r\n                Clear\r\n              </Button>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-2\">\r\n              {scanHistory.map((result) => (\r\n                <div\r\n                  key={result.id}\r\n                  className={`p-3 rounded-lg border ${\r\n                    result.status === 'success'\r\n                      ? 'bg-green-50 dark:bg-green-950/20 border-green-200 dark:border-green-800'\r\n                      : result.status === 'error'\r\n                        ? 'bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-800'\r\n                        : 'bg-yellow-50 dark:bg-yellow-950/20 border-yellow-200 dark:border-yellow-800'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {result.status === 'success' && (\r\n                        <CheckCircle className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\r\n                      )}\r\n                      {result.status === 'error' && (\r\n                        <XCircle className=\"h-4 w-4 text-red-600 dark:text-red-400\" />\r\n                      )}\r\n                      {result.status === 'pending' && (\r\n                        <AlertCircle className=\"h-4 w-4 text-yellow-600 dark:text-yellow-400\" />\r\n                      )}\r\n                      <div>\r\n                        <p className=\"text-sm font-medium\">{result.code}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">\r\n                          {result.type} ΓÇó{' '}\r\n                          {new Date(result.timestamp).toLocaleTimeString()}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    {result.status === 'error' && (\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => retryScan(result)}\r\n                        className=\"text-blue-600 dark:text-blue-400\"\r\n                      >\r\n                        <RotateCcw className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MobileScanner;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\mobile\\PWAInstallPrompt.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1470,1473],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1470,1473],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\nimport { toast } from 'sonner';\r\nimport { Download, X, Zap, Shield, Wifi, Check, Info } from 'lucide-react';\r\n\r\ninterface BeforeInstallPromptEvent extends Event {\r\n  readonly platforms: string[];\r\n  prompt(): Promise<void>;\r\n  readonly userChoice: Promise<{\r\n    outcome: 'accepted' | 'dismissed';\r\n    platform: string;\r\n  }>;\r\n}\r\n\r\ninterface PWAInstallPromptProps {\r\n  onInstall?: () => void;\r\n  onDismiss?: () => void;\r\n}\r\n\r\nexport const PWAInstallPrompt: React.FC<PWAInstallPromptProps> = ({\r\n  onInstall,\r\n  onDismiss,\r\n}) => {\r\n  const { isMobile } = useMobileOptimization();\r\n  const [deferredPrompt, setDeferredPrompt] =\r\n    useState<BeforeInstallPromptEvent | null>(null);\r\n  const [showPrompt, setShowPrompt] = useState(false);\r\n  const [isInstalled, setIsInstalled] = useState(false);\r\n  const [dismissed, setDismissed] = useState(false);\r\n  const [installStatus, setInstallStatus] = useState<\r\n    'idle' | 'installing' | 'success' | 'error'\r\n  >('idle');\r\n\r\n  // Check if app is already installed\r\n  const checkIfInstalled = useCallback(() => {\r\n    // Check if running in standalone mode\r\n    const isStandalone =\r\n      window.matchMedia('(display-mode: standalone)').matches ||\r\n      (window.navigator as any).standalone === true ||\r\n      document.referrer.includes('android-app://');\r\n\r\n    // Check if app is installed (different methods for different platforms)\r\n    const isInInstalledState =\r\n      isStandalone || localStorage.getItem('pwa-installed') === 'true';\r\n\r\n    setIsInstalled(isInInstalledState);\r\n    return isInInstalledState;\r\n  }, []);\r\n\r\n  // Handle beforeinstallprompt event\r\n  const handleBeforeInstallPrompt = useCallback(\r\n    (e: Event) => {\r\n      // Prevent the mini-infobar from appearing on mobile\r\n      e.preventDefault();\r\n\r\n      const promptEvent = e as BeforeInstallPromptEvent;\r\n      setDeferredPrompt(promptEvent);\r\n\r\n      // Only show prompt if not dismissed and not installed\r\n      if (!dismissed && !checkIfInstalled()) {\r\n        // Show prompt after a delay\r\n        setTimeout(() => {\r\n          setShowPrompt(true);\r\n        }, 3000);\r\n      }\r\n    },\r\n    [dismissed, checkIfInstalled]\r\n  );\r\n\r\n  // Handle app installed event\r\n  const handleAppInstalled = useCallback(() => {\r\n    console.debug('[PWAInstall] App was installed');\r\n    setIsInstalled(true);\r\n    localStorage.setItem('pwa-installed', 'true');\r\n    setShowPrompt(false);\r\n    setInstallStatus('success');\r\n    toast.success('App installed successfully!');\r\n    onInstall?.();\r\n\r\n    // Hide success message after delay\r\n    setTimeout(() => {\r\n      setInstallStatus('idle');\r\n    }, 3000);\r\n  }, [onInstall]);\r\n\r\n  // Install the PWA\r\n  const handleInstall = useCallback(async () => {\r\n    if (!deferredPrompt) {\r\n      // Fallback to manual instructions\r\n      setShowPrompt(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setInstallStatus('installing');\r\n\r\n      // Show the install prompt\r\n      await deferredPrompt.prompt();\r\n\r\n      // Wait for the user to respond to the prompt\r\n      const { outcome } = await deferredPrompt.userChoice;\r\n\r\n      console.debug(`[PWAInstall] User ${outcome} the install prompt`);\r\n\r\n      if (outcome === 'accepted') {\r\n        setInstallStatus('success');\r\n        toast.success('Installing app...');\r\n        onInstall?.();\r\n      } else {\r\n        setInstallStatus('idle');\r\n        toast.info('Install cancelled');\r\n      }\r\n\r\n      // Clear the deferred prompt\r\n      setDeferredPrompt(null);\r\n      setShowPrompt(false);\r\n    } catch (error) {\r\n      console.error('[PWAInstall] Install failed:', error);\r\n      setInstallStatus('error');\r\n      toast.error('Failed to install app');\r\n\r\n      setTimeout(() => {\r\n        setInstallStatus('idle');\r\n      }, 3000);\r\n    }\r\n  }, [deferredPrompt, onInstall]);\r\n\r\n  // Dismiss the prompt\r\n  const handleDismiss = useCallback(() => {\r\n    setShowPrompt(false);\r\n    setDismissed(true);\r\n    localStorage.setItem('pwa-install-dismissed', 'true');\r\n    onDismiss?.();\r\n  }, [onDismiss]);\r\n\r\n  // Get platform-specific install instructions\r\n  const getInstallInstructions = useCallback(() => {\r\n    const userAgent = navigator.userAgent.toLowerCase();\r\n\r\n    if (userAgent.includes('iphone') || userAgent.includes('ipad')) {\r\n      return {\r\n        title: 'Install on iOS',\r\n        steps: [\r\n          'Tap the Share button at the bottom',\r\n          'Scroll down and tap \"Add to Home Screen\"',\r\n          'Tap \"Add\" to install the app',\r\n        ],\r\n        icon: '≡ƒìÄ',\r\n      };\r\n    }\r\n\r\n    if (userAgent.includes('android')) {\r\n      return {\r\n        title: 'Install on Android',\r\n        steps: [\r\n          'Tap the menu button (Γï«) in Chrome',\r\n          'Tap \"Add to Home screen\"',\r\n          'Tap \"Add\" to install the app',\r\n        ],\r\n        icon: '≡ƒñû',\r\n      };\r\n    }\r\n\r\n    return {\r\n      title: 'Install App',\r\n      steps: [\r\n        'Look for the install icon in your browser',\r\n        'Click to add to your device',\r\n        'Launch from your home screen',\r\n      ],\r\n      icon: '≡ƒô▒',\r\n    };\r\n  }, []);\r\n\r\n  // Check installation status on mount\r\n  useEffect(() => {\r\n    checkIfInstalled();\r\n\r\n    // Check if user previously dismissed the prompt\r\n    const wasDismissed =\r\n      localStorage.getItem('pwa-install-dismissed') === 'true';\r\n    setDismissed(wasDismissed);\r\n  }, [checkIfInstalled]);\r\n\r\n  // Set up event listeners\r\n  useEffect(() => {\r\n    if (!isMobile) {\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\r\n    window.addEventListener('appinstalled', handleAppInstalled);\r\n\r\n    return () => {\r\n      window.removeEventListener(\r\n        'beforeinstallprompt',\r\n        handleBeforeInstallPrompt\r\n      );\r\n      window.removeEventListener('appinstalled', handleAppInstalled);\r\n    };\r\n  }, [isMobile, handleBeforeInstallPrompt, handleAppInstalled]);\r\n\r\n  // Don't show if not mobile, already installed, or dismissed\r\n  if (!isMobile || isInstalled || dismissed || !showPrompt) {\r\n    return null;\r\n  }\r\n\r\n  const instructions = getInstallInstructions();\r\n\r\n  return (\r\n    <Card className=\"fixed bottom-4 left-4 right-4 z-50 border-2 border-blue-200 dark:border-blue-800 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 shadow-xl\">\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"space-y-4\">\r\n          {/* Header */}\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-full\">\r\n                <Download className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-semibold text-slate-900 dark:text-slate-100\">\r\n                  Install CLMS App\r\n                </h3>\r\n                <p className=\"text-sm text-slate-600 dark:text-slate-400\">\r\n                  Get the full experience on your device\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handleDismiss}\r\n              className=\"h-8 w-8 p-0\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Features */}\r\n          <div className=\"grid grid-cols-3 gap-2\">\r\n            <div className=\"flex flex-col items-center gap-1 p-2 bg-white/50 dark:bg-slate-800/50 rounded-lg\">\r\n              <Zap className=\"h-4 w-4 text-yellow-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Fast\r\n              </span>\r\n            </div>\r\n            <div className=\"flex flex-col items-center gap-1 p-2 bg-white/50 dark:bg-slate-800/50 rounded-lg\">\r\n              <Wifi className=\"h-4 w-4 text-green-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Offline\r\n              </span>\r\n            </div>\r\n            <div className=\"flex flex-col items-center gap-1 p-2 bg-white/50 dark:bg-slate-800/50 rounded-lg\">\r\n              <Shield className=\"h-4 w-4 text-blue-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Secure\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Install Button */}\r\n          {deferredPrompt ? (\r\n            <Button\r\n              onClick={handleInstall}\r\n              disabled={installStatus === 'installing'}\r\n              className=\"w-full\"\r\n              size=\"lg\"\r\n            >\r\n              {installStatus === 'installing' ? (\r\n                <>\r\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2\" />\r\n                  Installing...\r\n                </>\r\n              ) : installStatus === 'success' ? (\r\n                <>\r\n                  <Check className=\"h-4 w-4 mr-2\" />\r\n                  Installed!\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Download className=\"h-4 w-4 mr-2\" />\r\n                  Install App\r\n                </>\r\n              )}\r\n            </Button>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {/* Manual Instructions */}\r\n              <div className=\"bg-white/50 dark:bg-slate-800/50 rounded-lg p-3\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <span className=\"text-lg\">{instructions.icon}</span>\r\n                  <h4 className=\"font-medium text-slate-900 dark:text-slate-100\">\r\n                    {instructions.title}\r\n                  </h4>\r\n                </div>\r\n                <ol className=\"space-y-1\">\r\n                  {instructions.steps.map((step, index) => (\r\n                    <li\r\n                      key={index}\r\n                      className=\"text-xs text-slate-600 dark:text-slate-400 flex items-start gap-2\"\r\n                    >\r\n                      <span className=\"text-blue-500 font-medium\">\r\n                        {index + 1}.\r\n                      </span>\r\n                      {step}\r\n                    </li>\r\n                  ))}\r\n                </ol>\r\n              </div>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={handleDismiss}\r\n                className=\"w-full\"\r\n              >\r\n                Maybe Later\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Install Status Messages */}\r\n          {installStatus === 'success' && (\r\n            <div className=\"flex items-center gap-2 p-2 bg-green-100 dark:bg-green-900/20 rounded-lg\">\r\n              <Check className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\r\n              <span className=\"text-sm text-green-800 dark:text-green-200\">\r\n                App installed successfully! Check your home screen.\r\n              </span>\r\n            </div>\r\n          )}\r\n\r\n          {installStatus === 'error' && (\r\n            <div className=\"flex items-center gap-2 p-2 bg-red-100 dark:bg-red-900/20 rounded-lg\">\r\n              <Info className=\"h-4 w-4 text-red-600 dark:text-red-400\" />\r\n              <span className=\"text-sm text-red-800 dark:text-red-200\">\r\n                Installation failed. Please try again or follow the manual\r\n                instructions.\r\n              </span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Benefits */}\r\n          <div className=\"grid grid-cols-2 gap-2 pt-2 border-t border-slate-200 dark:border-slate-700\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"h-3 w-3 text-green-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Works offline\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"h-3 w-3 text-green-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Full-screen mode\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"h-3 w-3 text-green-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Push notifications\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Check className=\"h-3 w-3 text-green-500\" />\r\n              <span className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n                Faster loading\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default PWAInstallPrompt;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\patterns\\CompoundComponent.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":28,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":28,"endColumn":37},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":91,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":91,"endColumn":35},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":126,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":126,"endColumn":46},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":189,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":189,"endColumn":42},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":232,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":232,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":233,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5699,5702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5699,5702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  createContext,\r\n  useContext,\r\n  type ReactNode,\r\n  type ComponentType,\r\n} from 'react';\r\nimport { cn } from '@/lib/utils';\r\n\r\n/**\r\n * Compound component pattern for building flexible, composable UI components\r\n */\r\n\r\ninterface CompoundComponentContextValue {\r\n  value?: string;\r\n  onValueChange?: (value: string) => void;\r\n  disabled?: boolean;\r\n  error?: string;\r\n  size?: 'sm' | 'md' | 'lg';\r\n}\r\n\r\nconst CompoundComponentContext = createContext<CompoundComponentContextValue>(\r\n  {}\r\n);\r\n\r\n/**\r\n * Hook to access compound component context\r\n */\r\nexport function useCompoundComponent() {\r\n  const context = useContext(CompoundComponentContext);\r\n  if (!context) {\r\n    throw new Error(\r\n      'Compound components must be used within a CompoundComponent.Provider'\r\n    );\r\n  }\r\n  return context;\r\n}\r\n\r\n/**\r\n * Base compound component interface\r\n */\r\nexport interface CompoundComponentProps {\r\n  value?: string;\r\n  onValueChange?: (value: string) => void;\r\n  disabled?: boolean;\r\n  error?: string;\r\n  size?: 'sm' | 'md' | 'lg';\r\n  className?: string;\r\n  children: ReactNode;\r\n}\r\n\r\n/**\r\n * Compound component provider\r\n */\r\nexport function CompoundComponentProvider({\r\n  value,\r\n  onValueChange,\r\n  disabled = false,\r\n  error,\r\n  size = 'md',\r\n  className,\r\n  children,\r\n}: CompoundComponentProps) {\r\n  const contextValue: CompoundComponentContextValue = {\r\n    ...(value !== undefined && { value }),\r\n    ...(onValueChange && { onValueChange }),\r\n    ...(disabled !== undefined && { disabled }),\r\n    ...(error !== undefined && { error }),\r\n    ...(size && { size }),\r\n  };\r\n\r\n  return (\r\n    <CompoundComponentContext.Provider value={contextValue}>\r\n      <div className={cn('compound-component', `size-${size}`, className)}>\r\n        {children}\r\n      </div>\r\n    </CompoundComponentContext.Provider>\r\n  );\r\n}\r\n\r\n/**\r\n * Sub-component interface\r\n */\r\nexport interface SubComponentProps {\r\n  className?: string;\r\n  children?: ReactNode;\r\n}\r\n\r\n/**\r\n * Higher-order component to create sub-components\r\n */\r\nexport function createSubComponent<T extends SubComponentProps>(\r\n  displayName: string,\r\n  defaultClasses: string = ''\r\n): ComponentType<T> {\r\n  const SubComponent = ({ className, children, ...props }: T) => {\r\n    const { disabled, error, size } = useCompoundComponent();\r\n\r\n    const combinedClasses = cn(\r\n      defaultClasses,\r\n      `sub-component-${displayName.toLowerCase()}`,\r\n      disabled && 'disabled',\r\n      error && 'error',\r\n      size && `size-${size}`,\r\n      className\r\n    );\r\n\r\n    return (\r\n      <div className={combinedClasses} {...props}>\r\n        {children}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  SubComponent.displayName = `CompoundComponent.${displayName}`;\r\n  return SubComponent as ComponentType<T>;\r\n}\r\n\r\n/**\r\n * Interactive sub-component (like tabs, buttons, etc.)\r\n */\r\nexport interface InteractiveSubComponentProps extends SubComponentProps {\r\n  value: string;\r\n  active?: boolean;\r\n}\r\n\r\nexport function createInteractiveSubComponent<\r\n  T extends InteractiveSubComponentProps,\r\n>(displayName: string, defaultClasses: string = ''): ComponentType<T> {\r\n  const InteractiveSubComponent = ({\r\n    value,\r\n    active = false,\r\n    className,\r\n    children,\r\n    ...props\r\n  }: T) => {\r\n    const { onValueChange, disabled, size } = useCompoundComponent();\r\n\r\n    const handleClick = () => {\r\n      if (!disabled && onValueChange) {\r\n        onValueChange(value);\r\n      }\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n      if (!disabled && (e.key === 'Enter' || e.key === ' ') && onValueChange) {\r\n        e.preventDefault();\r\n        onValueChange(value);\r\n      }\r\n    };\r\n\r\n    const combinedClasses = cn(\r\n      defaultClasses,\r\n      `interactive-sub-component-${displayName.toLowerCase()}`,\r\n      active && 'active',\r\n      disabled && 'disabled',\r\n      size && `size-${size}`,\r\n      'cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500',\r\n      className\r\n    );\r\n\r\n    return (\r\n      <div\r\n        className={combinedClasses}\r\n        role=\"button\"\r\n        tabIndex={disabled ? -1 : 0}\r\n        onClick={handleClick}\r\n        onKeyDown={handleKeyDown}\r\n        aria-pressed={active}\r\n        aria-disabled={disabled}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  InteractiveSubComponent.displayName = `CompoundComponent.${displayName}`;\r\n  return InteractiveSubComponent as ComponentType<T>;\r\n}\r\n\r\n/**\r\n * Content sub-component (conditional rendering)\r\n */\r\nexport interface ContentSubComponentProps extends SubComponentProps {\r\n  when?: string | boolean;\r\n  show?: boolean;\r\n}\r\n\r\nexport function createContentSubComponent<T extends ContentSubComponentProps>(\r\n  displayName: string,\r\n  defaultClasses: string = ''\r\n): ComponentType<T> {\r\n  const ContentSubComponent = ({\r\n    when,\r\n    show = true,\r\n    className,\r\n    children,\r\n    ...props\r\n  }: T) => {\r\n    const { value } = useCompoundComponent();\r\n\r\n    const shouldShow =\r\n      show &&\r\n      (when === undefined ||\r\n        (typeof when === 'boolean' && when) ||\r\n        (typeof when === 'string' && when === value));\r\n\r\n    if (!shouldShow) {\r\n      return null;\r\n    }\r\n\r\n    const combinedClasses = cn(\r\n      defaultClasses,\r\n      `content-sub-component-${displayName.toLowerCase()}`,\r\n      className\r\n    );\r\n\r\n    return (\r\n      <div className={combinedClasses} {...props}>\r\n        {children}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  ContentSubComponent.displayName = `CompoundComponent.${displayName}`;\r\n  return ContentSubComponent as ComponentType<T>;\r\n}\r\n\r\n/**\r\n * Utility to build compound components\r\n */\r\nexport function createCompoundComponent<\r\n  T extends Record<string, ComponentType<any>>,\r\n>(\r\n  name: string,\r\n  subComponents: T,\r\n  Provider: ComponentType<CompoundComponentProps> = CompoundComponentProvider\r\n) {\r\n  const Compound = Object.assign(Provider, subComponents);\r\n  Compound.displayName = name;\r\n\r\n  return Compound as typeof Compound & T;\r\n}\r\n\r\n/**\r\n * Example: Creating a Tab component using the compound pattern\r\n */\r\nexport const Tab = createCompoundComponent('Tab', {\r\n  Root: CompoundComponentProvider,\r\n\r\n  List: createSubComponent('TabList', 'flex border-b border-gray-200'),\r\n\r\n  Trigger: createInteractiveSubComponent(\r\n    'TabTrigger',\r\n    'px-4 py-2 border-b-2 border-transparent hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500'\r\n  ),\r\n\r\n  Content: createContentSubComponent('TabContent', 'p-4 focus:outline-none'),\r\n});\r\n\r\n/**\r\n * Example: Creating an Accordion component using the compound pattern\r\n */\r\nexport const Accordion = createCompoundComponent('Accordion', {\r\n  Root: CompoundComponentProvider,\r\n\r\n  Item: createSubComponent(\r\n    'AccordionItem',\r\n    'border border-gray-200 rounded-lg mb-2'\r\n  ),\r\n\r\n  Trigger: createInteractiveSubComponent(\r\n    'AccordionTrigger',\r\n    'w-full px-4 py-3 text-left bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500'\r\n  ),\r\n\r\n  Content: createContentSubComponent(\r\n    'AccordionContent',\r\n    'px-4 py-3 border-t border-gray-200'\r\n  ),\r\n});\r\n\r\n/**\r\n * Example: Creating a Card component using the compound pattern\r\n */\r\nexport const Card = createCompoundComponent('Card', {\r\n  Root: createSubComponent(\r\n    'CardRoot',\r\n    'bg-white border border-gray-200 rounded-lg shadow-sm'\r\n  ),\r\n\r\n  Header: createSubComponent(\r\n    'CardHeader',\r\n    'px-6 py-4 border-b border-gray-200'\r\n  ),\r\n\r\n  Title: createSubComponent('CardTitle', 'text-lg font-semibold text-gray-900'),\r\n\r\n  Description: createSubComponent(\r\n    'CardDescription',\r\n    'text-sm text-gray-600 mt-1'\r\n  ),\r\n\r\n  Content: createSubComponent('CardContent', 'px-6 py-4'),\r\n\r\n  Footer: createSubComponent(\r\n    'CardFooter',\r\n    'px-6 py-4 border-t border-gray-200 bg-gray-50'\r\n  ),\r\n});\r\n\r\nexport default CompoundComponentProvider;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\patterns\\RenderProps.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1519,1522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1519,1522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1575,1578],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1575,1578],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":404,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":404,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10640,10643],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10640,10643],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":488,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":488,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13023,13026],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13023,13026],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":493,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":493,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13192,13195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13192,13195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":508,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":508,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13563,13566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13563,13566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":508,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":508,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13587,13590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13587,13590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":508,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":508,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13597,13600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13597,13600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { type ReactNode, type ComponentType } from 'react';\r\n\r\n/**\r\n * Render prop patterns for flexible component composition\r\n */\r\n\r\n/**\r\n * Basic render prop interface\r\n */\r\nexport interface RenderProps<T = unknown> {\r\n  children: ((data: T) => ReactNode) | ReactNode;\r\n}\r\n\r\n/**\r\n * State render prop interface\r\n */\r\nexport interface StateRenderProps<T, S = unknown> {\r\n  children: ((state: S, actions: T) => ReactNode) | ReactNode;\r\n}\r\n\r\n/**\r\n * Enhanced render prop with multiple render functions\r\n */\r\nexport interface MultiRenderProps<T = unknown> {\r\n  render?: (data: T) => ReactNode;\r\n  children?: ((data: T) => ReactNode) | ReactNode;\r\n  component?: ComponentType<T>;\r\n}\r\n\r\n/**\r\n * Data provider with render prop\r\n */\r\nexport interface DataProviderProps<T> {\r\n  data: T;\r\n  children: ((data: T) => ReactNode) | ReactNode;\r\n  render?: (data: T) => ReactNode;\r\n  component?: ComponentType<T>;\r\n}\r\n\r\nexport function DataProvider<T>({\r\n  data,\r\n  children,\r\n  render,\r\n  component: Component,\r\n}: DataProviderProps<T>) {\r\n  const renderFunction =\r\n    render || (typeof children === 'function' ? children : undefined);\r\n\r\n  // Only use Component prop, don't try to cast children to ComponentType\r\n  const ChildComponent = Component;\r\n\r\n  if (renderFunction) {\r\n    return React.createElement(React.Fragment, null, renderFunction(data));\r\n  }\r\n\r\n  if (ChildComponent) {\r\n    // Ensure data is treated as props object\r\n    const props =\r\n      typeof data === 'object' && data !== null ? data : ({ data } as any);\r\n    return React.createElement(ChildComponent as any, props);\r\n  }\r\n\r\n  if (typeof children !== 'function') {\r\n    return React.createElement(React.Fragment, null, children);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Async data provider with render props\r\n */\r\nexport interface AsyncDataProviderProps<T> {\r\n  fetcher: () => Promise<T>;\r\n  initialData?: T;\r\n  children: (data: {\r\n    data: T | undefined;\r\n    loading: boolean;\r\n    error: Error | null;\r\n    refetch: () => void;\r\n  }) => ReactNode;\r\n  render?: (data: {\r\n    data: T | undefined;\r\n    loading: boolean;\r\n    error: Error | null;\r\n    refetch: () => void;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport function AsyncDataProvider<T>({\r\n  fetcher,\r\n  initialData,\r\n  children,\r\n  render,\r\n}: AsyncDataProviderProps<T>) {\r\n  const [data, setData] = React.useState<T | undefined>(initialData);\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [error, setError] = React.useState<Error | null>(null);\r\n\r\n  const fetchData = React.useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await fetcher();\r\n      setData(result);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err : new Error('Unknown error'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [fetcher]);\r\n\r\n  React.useEffect(() => {\r\n    if (initialData === undefined) {\r\n      fetchData();\r\n    }\r\n  }, [fetchData, initialData]);\r\n\r\n  const renderData = {\r\n    data,\r\n    loading,\r\n    error,\r\n    refetch: fetchData,\r\n  };\r\n\r\n  const renderFunction = render || children;\r\n  return React.createElement(React.Fragment, null, renderFunction(renderData));\r\n}\r\n\r\n/**\r\n * Toggle provider with render props\r\n */\r\nexport interface ToggleProviderProps {\r\n  initialOn?: boolean;\r\n  children: (data: {\r\n    on: boolean;\r\n    toggle: () => void;\r\n    setOn: (on: boolean) => void;\r\n    setOff: () => void;\r\n  }) => ReactNode;\r\n  render?: (data: {\r\n    on: boolean;\r\n    toggle: () => void;\r\n    setOn: (on: boolean) => void;\r\n    setOff: () => void;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport function ToggleProvider({\r\n  initialOn = false,\r\n  children,\r\n  render,\r\n}: ToggleProviderProps) {\r\n  const [on, setOn] = React.useState(initialOn);\r\n\r\n  const toggle = React.useCallback(() => {\r\n    setOn((prev) => !prev);\r\n  }, []);\r\n\r\n  const setOnState = React.useCallback((newOn: boolean) => {\r\n    setOn(newOn);\r\n  }, []);\r\n\r\n  const setOff = React.useCallback(() => {\r\n    setOn(false);\r\n  }, []);\r\n\r\n  const renderData = {\r\n    on,\r\n    toggle,\r\n    setOn: setOnState,\r\n    setOff,\r\n  };\r\n\r\n  const renderFunction = render || children;\r\n  return React.createElement(React.Fragment, null, renderFunction(renderData));\r\n}\r\n\r\n/**\r\n * Counter provider with render props\r\n */\r\nexport interface CounterProviderProps {\r\n  initialCount?: number;\r\n  step?: number;\r\n  min?: number;\r\n  max?: number;\r\n  children: (data: {\r\n    count: number;\r\n    increment: () => void;\r\n    decrement: () => void;\r\n    setCount: (count: number) => void;\r\n    reset: () => void;\r\n    canIncrement: boolean;\r\n    canDecrement: boolean;\r\n  }) => ReactNode;\r\n  render?: (data: {\r\n    count: number;\r\n    increment: () => void;\r\n    decrement: () => void;\r\n    setCount: (count: number) => void;\r\n    reset: () => void;\r\n    canIncrement: boolean;\r\n    canDecrement: boolean;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport function CounterProvider({\r\n  initialCount = 0,\r\n  step = 1,\r\n  min,\r\n  max,\r\n  children,\r\n  render,\r\n}: CounterProviderProps) {\r\n  const [count, setCount] = React.useState(initialCount);\r\n\r\n  const increment = React.useCallback(() => {\r\n    setCount((prev) => {\r\n      const newValue = prev + step;\r\n      return max !== undefined ? Math.min(newValue, max) : newValue;\r\n    });\r\n  }, [step, max]);\r\n\r\n  const decrement = React.useCallback(() => {\r\n    setCount((prev) => {\r\n      const newValue = prev - step;\r\n      return min !== undefined ? Math.max(newValue, min) : newValue;\r\n    });\r\n  }, [step, min]);\r\n\r\n  const setCountValue = React.useCallback(\r\n    (newCount: number) => {\r\n      let validatedCount = newCount;\r\n      if (min !== undefined) {\r\n        validatedCount = Math.max(validatedCount, min);\r\n      }\r\n      if (max !== undefined) {\r\n        validatedCount = Math.min(validatedCount, max);\r\n      }\r\n      setCount(validatedCount);\r\n    },\r\n    [min, max]\r\n  );\r\n\r\n  const reset = React.useCallback(() => {\r\n    setCount(initialCount);\r\n  }, [initialCount]);\r\n\r\n  const canIncrement = max === undefined || count < max;\r\n  const canDecrement = min === undefined || count > min;\r\n\r\n  const renderData = {\r\n    count,\r\n    increment,\r\n    decrement,\r\n    setCount: setCountValue,\r\n    reset,\r\n    canIncrement,\r\n    canDecrement,\r\n  };\r\n\r\n  const renderFunction = render || children;\r\n  return React.createElement(React.Fragment, null, renderFunction(renderData));\r\n}\r\n\r\n/**\r\n * List provider with render props\r\n */\r\nexport interface ListProviderProps<T> {\r\n  items: T[];\r\n  children: (data: {\r\n    items: T[];\r\n    map: <U>(callback: (item: T, index: number) => U) => U[];\r\n    filter: (predicate: (item: T, index: number) => boolean) => T[];\r\n    reduce: <U>(\r\n      callback: (accumulator: U, item: T, index: number) => U,\r\n      initialValue: U\r\n    ) => U;\r\n    find: (predicate: (item: T, index: number) => boolean) => T | undefined;\r\n    some: (predicate: (item: T, index: number) => boolean) => boolean;\r\n    every: (predicate: (item: T, index: number) => boolean) => boolean;\r\n    length: number;\r\n    isEmpty: boolean;\r\n    first: T | undefined;\r\n    last: T | undefined;\r\n  }) => ReactNode;\r\n  render?: (data: {\r\n    items: T[];\r\n    map: <U>(callback: (item: T, index: number) => U) => U[];\r\n    filter: (predicate: (item: T, index: number) => boolean) => T[];\r\n    reduce: <U>(\r\n      callback: (accumulator: U, item: T, index: number) => U,\r\n      initialValue: U\r\n    ) => U;\r\n    find: (predicate: (item: T, index: number) => boolean) => T | undefined;\r\n    some: (predicate: (item: T, index: number) => boolean) => boolean;\r\n    every: (predicate: (item: T, index: number) => boolean) => boolean;\r\n    length: number;\r\n    isEmpty: boolean;\r\n    first: T | undefined;\r\n    last: T | undefined;\r\n  }) => ReactNode;\r\n}\r\n\r\nexport function ListProvider<T>({\r\n  items,\r\n  children,\r\n  render,\r\n}: ListProviderProps<T>) {\r\n  const mapCallback = React.useCallback(\r\n    <U>(callback: (item: T, index: number) => U): U[] => items.map(callback),\r\n    [items]\r\n  );\r\n\r\n  const filterCallback = React.useCallback(\r\n    (predicate: (item: T, index: number) => boolean): T[] =>\r\n      items.filter(predicate),\r\n    [items]\r\n  );\r\n\r\n  const reduceCallback = React.useCallback(\r\n    <U>(\r\n      callback: (accumulator: U, item: T, index: number) => U,\r\n      initialValue: U\r\n    ): U => items.reduce(callback, initialValue),\r\n    [items]\r\n  );\r\n\r\n  const findCallback = React.useCallback(\r\n    (predicate: (item: T, index: number) => boolean): T | undefined =>\r\n      items.find(predicate),\r\n    [items]\r\n  );\r\n\r\n  const someCallback = React.useCallback(\r\n    (predicate: (item: T, index: number) => boolean): boolean =>\r\n      items.some(predicate),\r\n    [items]\r\n  );\r\n\r\n  const everyCallback = React.useCallback(\r\n    (predicate: (item: T, index: number) => boolean): boolean =>\r\n      items.every(predicate),\r\n    [items]\r\n  );\r\n\r\n  const renderData = {\r\n    items,\r\n    map: mapCallback,\r\n    filter: filterCallback,\r\n    reduce: reduceCallback,\r\n    find: findCallback,\r\n    some: someCallback,\r\n    every: everyCallback,\r\n    length: items.length,\r\n    isEmpty: items.length === 0,\r\n    first: items[0],\r\n    last: items[items.length - 1],\r\n  };\r\n\r\n  const renderFunction = render || children;\r\n  return React.createElement(React.Fragment, null, renderFunction(renderData));\r\n}\r\n\r\n/**\r\n * Form provider with render props\r\n */\r\nexport interface FormProviderProps<T> {\r\n  initialValues: T;\r\n  children: (data: {\r\n    values: T;\r\n    errors: Partial<Record<keyof T, string>>;\r\n    touched: Partial<Record<keyof T, boolean>>;\r\n    isValid: boolean;\r\n    isDirty: boolean;\r\n    setValue: <K extends keyof T>(field: K, value: T[K]) => void;\r\n    setError: <K extends keyof T>(field: K, error: string) => void;\r\n    setTouched: <K extends keyof T>(field: K, touched?: boolean) => void;\r\n    validate: () => boolean;\r\n    reset: () => void;\r\n    handleSubmit: (\r\n      onSubmit: (values: T) => void\r\n    ) => (e: React.FormEvent) => void;\r\n  }) => ReactNode;\r\n  render?: (data: {\r\n    values: T;\r\n    errors: Partial<Record<keyof T, string>>;\r\n    touched: Partial<Record<keyof T, boolean>>;\r\n    isValid: boolean;\r\n    isDirty: boolean;\r\n    setValue: <K extends keyof T>(field: K, value: T[K]) => void;\r\n    setError: <K extends keyof T>(field: K, error: string) => void;\r\n    setTouched: <K extends keyof T>(field: K, touched?: boolean) => void;\r\n    validate: () => boolean;\r\n    reset: () => void;\r\n    handleSubmit: (\r\n      onSubmit: (values: T) => void\r\n    ) => (e: React.FormEvent) => void;\r\n  }) => ReactNode;\r\n  validate?: (values: T) => Partial<Record<keyof T, string>>;\r\n}\r\n\r\nexport function FormProvider<T extends Record<string, any>>({\r\n  initialValues,\r\n  children,\r\n  render,\r\n  validate,\r\n}: FormProviderProps<T>) {\r\n  const [values, setValues] = React.useState<T>(initialValues);\r\n  const [errors, setErrors] = React.useState<Partial<Record<keyof T, string>>>(\r\n    {}\r\n  );\r\n  const [touched, setTouched] = React.useState<\r\n    Partial<Record<keyof T, boolean>>\r\n  >({});\r\n\r\n  const setValueCallback = React.useCallback(\r\n    <K extends keyof T>(field: K, value: T[K]) => {\r\n      setValues((prev) => ({ ...prev, [field]: value }));\r\n      setTouched((prev) => ({ ...prev, [field]: true }));\r\n    },\r\n    []\r\n  );\r\n\r\n  const setErrorCallback = React.useCallback(\r\n    <K extends keyof T>(field: K, error: string) => {\r\n      setErrors((prev) => ({ ...prev, [field]: error }));\r\n    },\r\n    []\r\n  );\r\n\r\n  const setTouchedFieldCallback = React.useCallback(\r\n    <K extends keyof T>(field: K, touchedValue: boolean = true) => {\r\n      setTouched((prev) => ({ ...prev, [field]: touchedValue }));\r\n    },\r\n    []\r\n  );\r\n\r\n  const validateFormCallback = React.useCallback(() => {\r\n    const newErrors = validate ? validate(values) : {};\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  }, [values, validate]);\r\n\r\n  const resetCallback = React.useCallback(() => {\r\n    setValues(initialValues);\r\n    setErrors({});\r\n    setTouched({});\r\n  }, [initialValues]);\r\n\r\n  const handleSubmitCallback = React.useCallback(\r\n    (onSubmit: (values: T) => void) => {\r\n      return (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (validateFormCallback()) {\r\n          onSubmit(values);\r\n        }\r\n      };\r\n    },\r\n    [values, validateFormCallback]\r\n  );\r\n\r\n  const isValid = Object.keys(errors).length === 0;\r\n  const isDirty = JSON.stringify(values) !== JSON.stringify(initialValues);\r\n\r\n  const renderData = {\r\n    values,\r\n    errors,\r\n    touched,\r\n    isValid,\r\n    isDirty,\r\n    setValue: setValueCallback,\r\n    setError: setErrorCallback,\r\n    setTouched: setTouchedFieldCallback,\r\n    validate: validateFormCallback,\r\n    reset: resetCallback,\r\n    handleSubmit: handleSubmitCallback,\r\n  };\r\n\r\n  const renderFunction = render || children;\r\n  return React.createElement(React.Fragment, null, renderFunction(renderData));\r\n}\r\n\r\n/**\r\n * Higher-order component that converts a component to use render props\r\n */\r\nexport function withRenderProps<T extends Record<string, any>>(\r\n  Component: ComponentType<T>,\r\n  propName: string = 'children'\r\n) {\r\n  return function WithRenderProps(\r\n    props: Omit<T, typeof propName> & { [key: string]: any }\r\n  ) {\r\n    const { [propName]: children, ...rest } = props;\r\n\r\n    if (typeof children === 'function') {\r\n      return React.createElement(React.Fragment, null, children(rest as T));\r\n    }\r\n\r\n    return React.createElement(Component, rest as T);\r\n  };\r\n}\r\n\r\n/**\r\n * Utility to determine if a prop is a render function\r\n */\r\nexport function isRenderFunction(prop: any): prop is (...args: any[]) => any {\r\n  return typeof prop === 'function';\r\n}\r\n\r\n/**\r\n * Utility to get the render function from props\r\n */\r\nexport function getRenderFunction<T = unknown>(\r\n  props: RenderProps<T> | MultiRenderProps<T>\r\n): ((data: T) => ReactNode) | null {\r\n  if ('render' in props && typeof props.render === 'function') {\r\n    return props.render;\r\n  }\r\n\r\n  if ('children' in props && typeof props.children === 'function') {\r\n    return props.children;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport default DataProvider;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\Image.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\ImagePerformanceMonitor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\LazyLoad.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":186,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":186,"endColumn":28},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5395,5398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5395,5398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":206,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5848,5851],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5848,5851],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":309,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":309,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":309,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9057,9060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9057,9060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9548,9551],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9548,9551],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":454,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":454,"endColumn":39},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect contains a call to 'setRenderCount'. Without a list of dependencies, this can lead to an infinite chain of updates. To fix this, pass [lastRenderTime, renderCount, props] as a second argument to the useEffect Hook.","line":463,"column":5,"nodeType":"MemberExpression","endLine":463,"endColumn":20,"suggestions":[{"desc":"Add dependencies array: [lastRenderTime, renderCount, props]","fix":{"range":[14159,14159],"text":", [lastRenderTime, renderCount, props]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":562,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":562,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  Suspense,\r\n  lazy,\r\n  memo,\r\n  type ComponentType,\r\n  type ReactNode,\r\n} from 'react';\r\nimport { Loader2, AlertCircle, Wifi, WifiOff } from 'lucide-react';\r\n\r\n// Lazy loading component states\r\ntype LoadingState = 'idle' | 'loading' | 'success' | 'error' | 'retry';\r\n\r\ninterface LazyLoadProps {\r\n  loader?: ReactNode;\r\n  fallback?: ReactNode;\r\n  errorFallback?: ReactNode;\r\n  delay?: number;\r\n  retryCount?: number;\r\n  maxRetries?: number;\r\n  retryDelay?: number;\r\n  onRetry?: () => void;\r\n  onError?: (error: Error) => void;\r\n  onLoad?: () => void;\r\n  prefetch?: boolean;\r\n  threshold?: number;\r\n  rootMargin?: string;\r\n  trigger?: boolean;\r\n}\r\n\r\ninterface LoadingIndicatorProps {\r\n  size?: 'sm' | 'md' | 'lg';\r\n  message?: string;\r\n  showSpinner?: boolean;\r\n  skeleton?: boolean;\r\n}\r\n\r\ninterface ErrorFallbackProps {\r\n  error: Error;\r\n  retryCount: number;\r\n  onRetry: () => void;\r\n  maxRetries: number;\r\n  component?: string;\r\n}\r\n\r\n// Loading indicator component\r\nconst LoadingIndicator = memo(\r\n  ({\r\n    size = 'md',\r\n    message = 'Loading...',\r\n    showSpinner = true,\r\n    skeleton = false,\r\n  }: LoadingIndicatorProps) => {\r\n    if (skeleton) {\r\n      return (\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"bg-slate-200 dark:bg-slate-700 rounded-lg h-32 w-full mb-2\"></div>\r\n          <div className=\"bg-slate-200 dark:bg-slate-700 rounded h-4 w-3/4 mb-2\"></div>\r\n          <div className=\"bg-slate-200 dark:bg-slate-700 rounded h-4 w-1/2\"></div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center p-8 text-center\">\r\n        {showSpinner && (\r\n          <Loader2\r\n            className={`animate-spin ${\r\n              size === 'sm' ? 'h-4 w-4' : size === 'lg' ? 'h-8 w-8' : 'h-6 w-6'\r\n            } text-primary mb-4`}\r\n          />\r\n        )}\r\n        <p className=\"text-sm text-muted-foreground font-medium\">{message}</p>\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\n// Error fallback component\r\nconst ErrorFallback = memo(\r\n  ({\r\n    error,\r\n    retryCount,\r\n    onRetry,\r\n    maxRetries,\r\n    component = 'Component',\r\n  }: ErrorFallbackProps) => {\r\n    const canRetry = retryCount < maxRetries;\r\n\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center p-8 text-center\">\r\n        <div className=\"rounded-full bg-red-100 dark:bg-red-900/20 p-3 mb-4\">\r\n          <AlertCircle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-foreground mb-2\">\r\n          Failed to Load {component}\r\n        </h3>\r\n        <p className=\"text-sm text-muted-foreground mb-4 max-w-md\">\r\n          {error.message || 'An error occurred while loading this component.'}\r\n        </p>\r\n        {canRetry && (\r\n          <div className=\"space-y-2\">\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Retry {retryCount} of {maxRetries}\r\n            </p>\r\n            <button\r\n              onClick={onRetry}\r\n              className=\"inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium\"\r\n            >\r\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n              Try Again\r\n            </button>\r\n          </div>\r\n        )}\r\n        {!canRetry && (\r\n          <p className=\"text-xs text-red-600 dark:text-red-400\">\r\n            Maximum retries reached. Please refresh the page.\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\n// Network detection component\r\nconst NetworkStatus = memo(() => {\r\n  const [isOnline, setIsOnline] = React.useState(navigator.onLine);\r\n  const [hasConnection, setHasConnection] = React.useState(true);\r\n\r\n  React.useEffect(() => {\r\n    const handleOnline = () => {\r\n      setIsOnline(true);\r\n      setHasConnection(true);\r\n    };\r\n\r\n    const handleOffline = () => {\r\n      setIsOnline(false);\r\n    };\r\n\r\n    const checkConnection = async () => {\r\n      try {\r\n        const response = await fetch('/api/health', {\r\n          method: 'HEAD',\r\n          cache: 'no-store',\r\n          signal: AbortSignal.timeout(3000),\r\n        });\r\n        setHasConnection(response.ok);\r\n      } catch (error) {\r\n        setHasConnection(false);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('online', handleOnline);\r\n    window.addEventListener('offline', handleOffline);\r\n\r\n    // Check connection every 30 seconds\r\n    const interval = setInterval(checkConnection, 30000);\r\n    checkConnection();\r\n\r\n    return () => {\r\n      window.removeEventListener('online', handleOnline);\r\n      window.removeEventListener('offline', handleOffline);\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 px-3 py-1 text-sm rounded-md border\">\r\n      {isOnline && hasConnection ? (\r\n        <>\r\n          <Wifi className=\"h-3 w-3 text-green-500\" />\r\n          <span className=\"text-green-600 dark:text-green-400\">Online</span>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <WifiOff className=\"h-3 w-3 text-red-500\" />\r\n          <span className=\"text-red-600 dark:text-red-400\">\r\n            {!isOnline ? 'Offline' : 'No Connection'}\r\n          </span>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\n// Advanced lazy load component with retry and prefetch\r\nexport const createLazyLoad = <T extends ComponentType<any>>(\r\n  importFunc: () => Promise<{ default: T }>,\r\n  options: Partial<LazyLoadProps> = {}\r\n) => {\r\n  const {\r\n    loader: _loader = <LoadingIndicator />,\r\n    fallback = <LoadingIndicator />,\r\n    delay = 200,\r\n    maxRetries = 3,\r\n    onRetry,\r\n    onError,\r\n    onLoad,\r\n    prefetch = false,\r\n    threshold = 0.1,\r\n    rootMargin = '50px',\r\n    trigger = true,\r\n  } = options;\r\n\r\n  const LazyComponent = lazy(importFunc);\r\n\r\n  return memo((props: any) => {\r\n    const [loadingState, setLoadingState] =\r\n      React.useState<LoadingState>('idle');\r\n    const [currentRetryCount, setCurrentRetryCount] = React.useState(0);\r\n\r\n    React.useCallback(() => {\r\n      setCurrentRetryCount((prev) => prev + 1);\r\n      setLoadingState('retry');\r\n      onRetry?.();\r\n\r\n      // Reset loading state after delay\r\n      setTimeout(() => {\r\n        setLoadingState('loading');\r\n      }, 100);\r\n    }, []); // onRetry is a prop and doesn't need to be in deps\r\n\r\n    const handleError = React.useCallback(\r\n      (error: Error) => {\r\n        setLoadingState('error');\r\n        onError?.(error);\r\n        console.error('Lazy loading error:', error);\r\n      },\r\n      [] // onError is a prop and doesn't need to be in deps\r\n    );\r\n\r\n    const handleLoad = React.useCallback(() => {\r\n      setLoadingState('success');\r\n      onLoad?.();\r\n    }, []); // onLoad is a prop and doesn't need to be in deps\r\n\r\n    // Component implementation with Intersection Observer for prefetching\r\n    const observerRef = React.useRef<IntersectionObserver | null>(null);\r\n    const elementRef = React.useRef<HTMLDivElement>(null);\r\n\r\n    React.useEffect(() => {\r\n      if (prefetch && elementRef.current && trigger) {\r\n        observerRef.current = new IntersectionObserver(\r\n          (entries) => {\r\n            entries.forEach((entry) => {\r\n              if (entry.isIntersecting) {\r\n                // Prefetch the component\r\n                importFunc();\r\n                observerRef.current?.disconnect();\r\n              }\r\n            });\r\n          },\r\n          { threshold, rootMargin }\r\n        );\r\n\r\n        observerRef.current.observe(elementRef.current);\r\n      }\r\n\r\n      return () => {\r\n        observerRef.current?.disconnect();\r\n      };\r\n      // Props like prefetch, trigger, threshold, rootMargin, importFunc don't need to be deps\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    // Reset state when component changes\r\n    React.useEffect(() => {\r\n      setCurrentRetryCount(0);\r\n      setLoadingState('loading');\r\n      // importFunc is a prop and doesn't need to be in deps\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    if (loadingState === 'retry' && currentRetryCount > 0) {\r\n      return (\r\n        <div>\r\n          <LoadingIndicator\r\n            message={`Retrying... (${currentRetryCount}/${maxRetries})`}\r\n            showSpinner\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div ref={elementRef}>\r\n        <Suspense\r\n          fallback={\r\n            <div style={{ minHeight: delay ? '0px' : '200px' }}>\r\n              {delay === 0 ? (\r\n                fallback\r\n              ) : (\r\n                <div\r\n                  style={{ opacity: 0, transition: 'opacity 0.3s ease-in-out' }}\r\n                >\r\n                  {fallback}\r\n                </div>\r\n              )}\r\n            </div>\r\n          }\r\n        >\r\n          <LazyComponent {...props} onError={handleError} onLoad={handleLoad} />\r\n        </Suspense>\r\n      </div>\r\n    );\r\n  });\r\n};\r\n\r\n// Preload component for critical resources\r\nexport const usePreloadComponent = <T extends ComponentType<any>>(\r\n  importFunc: () => Promise<{ default: T }>\r\n) => {\r\n  React.useEffect(() => {\r\n    importFunc();\r\n  }, [importFunc]);\r\n};\r\n\r\n// Intersection Observer based lazy loading for images\r\nexport const LazyImage = memo(\r\n  ({\r\n    src,\r\n    alt,\r\n    className,\r\n    placeholder,\r\n    onLoad,\r\n    onError,\r\n    ...props\r\n  }: {\r\n    src: string;\r\n    alt: string;\r\n    className?: string;\r\n    placeholder?: string;\r\n    onLoad?: () => void;\r\n    onError?: () => void;\r\n    [key: string]: any;\r\n  }) => {\r\n    const [isLoaded, setIsLoaded] = React.useState(false);\r\n    const [isInView, setIsInView] = React.useState(false);\r\n    const [hasError, setHasError] = React.useState(false);\r\n    const imgRef = React.useRef<HTMLImageElement>(null);\r\n\r\n    React.useEffect(() => {\r\n      const observer = new IntersectionObserver(\r\n        ([entry]) => {\r\n          if (entry && entry.isIntersecting) {\r\n            setIsInView(true);\r\n          }\r\n        },\r\n        { threshold: 0.1 }\r\n      );\r\n\r\n      if (imgRef.current) {\r\n        observer.observe(imgRef.current);\r\n      }\r\n\r\n      return () => observer.disconnect();\r\n    }, []);\r\n\r\n    React.useEffect(() => {\r\n      if (isInView && src && !isLoaded && !hasError) {\r\n        if (imgRef.current) {\r\n          imgRef.current.src = src;\r\n        }\r\n      }\r\n    }, [isInView, src, isLoaded, hasError]);\r\n\r\n    return (\r\n      <div className={`relative overflow-hidden ${className || ''}`}>\r\n        {!isLoaded && (\r\n          <div className=\"absolute inset-0 bg-slate-200 dark:bg-slate-700 animate-pulse flex items-center justify-center\">\r\n            {placeholder ? (\r\n              <img\r\n                src={placeholder}\r\n                alt={alt}\r\n                className=\"w-full h-full object-cover opacity-50\"\r\n              />\r\n            ) : (\r\n              <div className=\"w-full h-full bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 to-slate-800\" />\r\n            )}\r\n          </div>\r\n        )}\r\n        <img\r\n          ref={imgRef}\r\n          alt={alt}\r\n          className={`w-full h-full object-cover transition-opacity duration-300 ${\r\n            isLoaded ? 'opacity-100' : 'opacity-0'\r\n          } ${hasError ? 'opacity-50' : ''}`}\r\n          onLoad={() => {\r\n            setIsLoaded(true);\r\n            onLoad?.();\r\n          }}\r\n          onError={() => {\r\n            setHasError(true);\r\n            onError?.();\r\n          }}\r\n          {...props}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nLazyImage.displayName = 'LazyImage';\r\n\r\n// Bundle analysis and reporting\r\nexport const BundleAnalyzer = memo(() => {\r\n  const [bundleSize, setBundleSize] = React.useState(0);\r\n  const [loadTime, setLoadTime] = React.useState(0);\r\n  const [chunkCount, setChunkCount] = React.useState(0);\r\n\r\n  React.useEffect(() => {\r\n    // Analyze bundle size if performance API is available\r\n    if ('performance' in window && 'memory' in performance) {\r\n      const analyzeBundle = () => {\r\n        const navigation = performance.getEntriesByType(\r\n          'navigation'\r\n        )[0] as PerformanceNavigationTiming;\r\n        if (navigation) {\r\n          setLoadTime(\r\n            Math.round(navigation.loadEventEnd - navigation.loadEventStart)\r\n          );\r\n        }\r\n\r\n        // Get resource timing info for chunks\r\n        const resources = performance.getEntriesByType(\r\n          'resource'\r\n        ) as PerformanceResourceTiming[];\r\n        const jsResources = resources.filter((r) => r.name.endsWith('.js'));\r\n        setChunkCount(jsResources.length);\r\n\r\n        // Calculate approximate bundle size\r\n        const totalSize = jsResources.reduce((sum, resource) => {\r\n          return sum + (resource.transferSize || 0);\r\n        }, 0);\r\n        setBundleSize(totalSize);\r\n      };\r\n\r\n      // Analyze after initial load\r\n      setTimeout(analyzeBundle, 1000);\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"hidden lg:block fixed bottom-4 right-4 bg-black/80 text-white p-3 rounded-lg text-xs\">\r\n      <div className=\"space-y-1\">\r\n        <div>Bundle: {(bundleSize / 1024).toFixed(1)}KB</div>\r\n        <div>Chunks: {chunkCount}</div>\r\n        <div>Load: {loadTime}ms</div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\n// Performance monitoring HOC\r\nexport const withPerformanceMonitoring = <P extends object>(\r\n  Component: ComponentType<P>\r\n) => {\r\n  const MonitoredComponent = memo((props: P) => {\r\n    const [renderCount, setRenderCount] = React.useState(0);\r\n    const [lastRenderTime, setLastRenderTime] = React.useState<number>(\r\n      Date.now()\r\n    );\r\n\r\n    React.useEffect(() => {\r\n      const now = Date.now();\r\n      const timeSinceLastRender = now - lastRenderTime;\r\n\r\n      // Log performance metrics in development\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.debug(`Component ${Component.displayName} rendered:`, {\r\n          renderCount: renderCount + 1,\r\n          timeSinceLastRender: `${timeSinceLastRender}ms`,\r\n          props: Object.keys(props).slice(0, 3),\r\n        });\r\n      }\r\n\r\n      setRenderCount((prev) => prev + 1);\r\n      setLastRenderTime(now);\r\n    });\r\n\r\n    return <Component {...props} />;\r\n  });\r\n\r\n  MonitoredComponent.displayName = `withPerformanceMonitoring(${Component.displayName || Component.name})`;\r\n\r\n  return MonitoredComponent;\r\n};\r\n\r\n// Virtual list for large datasets\r\ninterface VirtualListProps<T> {\r\n  items: T[];\r\n  itemHeight: number;\r\n  containerHeight: number;\r\n  renderItem: (item: T, index: number) => ReactNode;\r\n  overscan?: number;\r\n  className?: string;\r\n}\r\n\r\nexport const VirtualList = <T,>({\r\n  items,\r\n  itemHeight,\r\n  containerHeight,\r\n  renderItem,\r\n  overscan = 5,\r\n  className,\r\n}: VirtualListProps<T>) => {\r\n  const [scrollTop, setScrollTop] = React.useState(0);\r\n  const [startIndex, setStartIndex] = React.useState(0);\r\n  const [endIndex, setEndIndex] = React.useState(0);\r\n\r\n  const containerRef = React.useRef<HTMLDivElement>(null);\r\n\r\n  // Calculate visible range\r\n  React.useEffect(() => {\r\n    const start = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\r\n    const end = Math.min(\r\n      items.length - 1,\r\n      Math.ceil((scrollTop + containerHeight) / itemHeight) + overscan\r\n    );\r\n\r\n    setStartIndex(start);\r\n    setEndIndex(end);\r\n  }, [scrollTop, containerHeight, itemHeight, items.length, overscan]);\r\n\r\n  const handleScroll = React.useCallback((e: React.UIEvent<HTMLDivElement>) => {\r\n    setScrollTop(e.currentTarget.scrollTop);\r\n  }, []);\r\n\r\n  const visibleItems = items.slice(startIndex, endIndex + 1);\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className={`overflow-auto ${className || ''}`}\r\n      style={{ height: containerHeight }}\r\n      onScroll={handleScroll}\r\n    >\r\n      <div style={{ height: startIndex * itemHeight, position: 'relative' }}>\r\n        {visibleItems.map((item, index) => (\r\n          <div\r\n            key={startIndex + index}\r\n            style={{\r\n              position: 'absolute',\r\n              top: (startIndex + index) * itemHeight,\r\n              height: itemHeight,\r\n              width: '100%',\r\n            }}\r\n          >\r\n            {renderItem(item, startIndex + index)}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      {items.length > endIndex + 1 && (\r\n        <div style={{ height: (items.length - endIndex - 1) * itemHeight }}>\r\n          {/* Spacer for remaining items */}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Preload critical components\r\nexport const usePreloadCriticalComponents = () => {\r\n  usePreloadComponent(() => import('@/components/dashboard/DashboardOverview'));\r\n  usePreloadComponent(() => import('@/components/dashboard/StudentManagement'));\r\n  usePreloadComponent(\r\n    () => import('@/components/dashboard/EquipmentDashboard')\r\n  );\r\n};\r\n\r\nexport default {\r\n  createLazyLoad,\r\n  usePreloadComponent,\r\n  LazyImage,\r\n  BundleAnalyzer,\r\n  withPerformanceMonitoring,\r\n  VirtualList,\r\n  usePreloadCriticalComponents,\r\n  LoadingIndicator,\r\n  ErrorFallback,\r\n  NetworkStatus,\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\OptimizedImage.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":300,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":300,"endColumn":35},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":312,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":312,"endColumn":26},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":329,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":329,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  memo,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  type ComponentType,\r\n} from 'react';\r\nimport { Loader2, AlertCircle } from 'lucide-react';\r\n\r\ninterface OptimizedImageProps {\r\n  src: string;\r\n  alt: string;\r\n  width?: number | undefined;\r\n  height?: number | undefined;\r\n  className?: string | undefined;\r\n  placeholder?: string | undefined;\r\n  blurDataURL?: string | undefined;\r\n  priority?: boolean | undefined;\r\n  quality?: number | undefined;\r\n  format?: 'webp' | 'avif' | 'png' | 'jpg' | undefined;\r\n  sizes?: string | undefined;\r\n  srcSet?: string | undefined;\r\n  onLoad?: (() => void) | undefined;\r\n  onError?: (() => void) | undefined;\r\n  lazy?: boolean | undefined;\r\n  fadeDuration?: number | undefined;\r\n  style?: React.CSSProperties | undefined;\r\n  aspectRatio?: number | undefined;\r\n  objectFit?: 'cover' | 'contain' | 'fill' | 'none' | 'scale-down' | undefined;\r\n  decoding?: 'async' | 'auto' | 'sync' | undefined;\r\n  loading?: 'lazy' | 'eager' | undefined;\r\n  fetchPriority?: 'high' | 'low' | 'auto' | undefined;\r\n}\r\n\r\ninterface ImageState {\r\n  isLoading: boolean;\r\n  isLoaded: boolean;\r\n  hasError: boolean;\r\n  currentSrc: string;\r\n}\r\n\r\n// Generate responsive srcSet\r\nconst generateSrcSet = (\r\n  src: string,\r\n  format: string,\r\n  quality: number,\r\n  sizes: number[] = [320, 640, 768, 1024, 1280, 1536]\r\n): string => {\r\n  return sizes\r\n    .map((size) => `${src}?w=${size}&f=${format}&q=${quality} ${size}w`)\r\n    .join(', ');\r\n};\r\n\r\n// Generate placeholder image\r\nconst generatePlaceholder = (width: number, height: number): string => {\r\n  const canvas = document.createElement('canvas');\r\n  canvas.width = width;\r\n  canvas.height = height;\r\n  const ctx = canvas.getContext('2d');\r\n  if (ctx) {\r\n    ctx.fillStyle = '#e5e7eb';\r\n    ctx.fillRect(0, 0, width, height);\r\n  }\r\n  return canvas.toDataURL('image/jpeg', 0.1);\r\n};\r\n\r\nconst OptimizedImage = forwardRef<HTMLImageElement, OptimizedImageProps>(\r\n  (props, ref) => {\r\n    const {\r\n      src,\r\n      alt,\r\n      width,\r\n      height,\r\n      className = '',\r\n      placeholder,\r\n      blurDataURL,\r\n      priority = false,\r\n      quality = 75,\r\n      format = 'webp',\r\n      sizes = '(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw',\r\n      srcSet,\r\n      onLoad,\r\n      onError,\r\n      lazy = true,\r\n      fadeDuration = 300,\r\n      style,\r\n      aspectRatio,\r\n      objectFit = 'cover',\r\n      decoding = 'async',\r\n      loading = 'lazy',\r\n      fetchPriority = 'auto',\r\n    } = props;\r\n    const [imageState, setImageState] = useState<ImageState>({\r\n      isLoading: true,\r\n      isLoaded: false,\r\n      hasError: false,\r\n      currentSrc: src,\r\n    });\r\n\r\n    const imgRef = useRef<HTMLImageElement>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const observerRef = useRef<IntersectionObserver | null>(null);\r\n\r\n    // Expose ref to parent component\r\n    useImperativeHandle(ref, () => imgRef.current as HTMLImageElement);\r\n\r\n    // Generate placeholder if not provided\r\n    const placeholderSrc =\r\n      placeholder ||\r\n      (width && height ? generatePlaceholder(width, height) : '');\r\n\r\n    // Generate responsive srcSet if not provided\r\n    const generatedSrcSet = srcSet || generateSrcSet(src, format, quality);\r\n\r\n    // Handle image load\r\n    const handleLoad = () => {\r\n      setImageState((prev) => ({\r\n        ...prev,\r\n        isLoading: false,\r\n        isLoaded: true,\r\n      }));\r\n      onLoad?.();\r\n    };\r\n\r\n    // Handle image error\r\n    const handleError = () => {\r\n      setImageState((prev) => ({\r\n        ...prev,\r\n        isLoading: false,\r\n        hasError: true,\r\n      }));\r\n      onError?.();\r\n    };\r\n\r\n    // Setup intersection observer for lazy loading\r\n    useEffect(() => {\r\n      if (!lazy || priority) {\r\n        return;\r\n      }\r\n\r\n      const img = imgRef.current;\r\n      if (!img) {\r\n        return;\r\n      }\r\n\r\n      observerRef.current = new IntersectionObserver(\r\n        (entries) => {\r\n          const [entry] = entries;\r\n          if (entry && entry.isIntersecting) {\r\n            const img = entry.target as HTMLImageElement;\r\n            img.loading = 'lazy';\r\n            img.decoding = decoding;\r\n            observerRef.current?.disconnect();\r\n          }\r\n        },\r\n        {\r\n          rootMargin: '50px', // Start loading 50px before image comes into view\r\n          threshold: 0.01,\r\n        }\r\n      );\r\n\r\n      observerRef.current.observe(img);\r\n\r\n      return () => {\r\n        observerRef.current?.disconnect();\r\n      };\r\n    }, [lazy, priority, decoding]);\r\n\r\n    // Preload priority images\r\n    useEffect(() => {\r\n      if (priority && src) {\r\n        const link = document.createElement('link');\r\n        link.rel = 'preload';\r\n        link.as = 'image';\r\n        link.href = src;\r\n        // link.fetchPriority = 'high'; // fetchPriority not supported on link elements\r\n        document.head.appendChild(link);\r\n\r\n        return () => {\r\n          document.head.removeChild(link);\r\n        };\r\n      }\r\n      // Return undefined for cases where preloading is not needed\r\n      return undefined;\r\n    }, [priority, src]);\r\n\r\n    // Calculate aspect ratio style\r\n    const aspectRatioStyle = aspectRatio\r\n      ? {\r\n          aspectRatio: `${aspectRatio}`,\r\n          ...style,\r\n        }\r\n      : style;\r\n\r\n    // Ensure width/height attributes exist to prevent layout shift\r\n    useEffect(() => {\r\n      const img = imgRef.current;\r\n      const container = containerRef.current;\r\n      if (!img || !container) {\r\n        return;\r\n      }\r\n\r\n      const hasWidthAttr = img.getAttribute('width');\r\n      const hasHeightAttr = img.getAttribute('height');\r\n\r\n      if (!hasWidthAttr || !hasHeightAttr) {\r\n        const w = width ?? container.clientWidth ?? img.clientWidth;\r\n        const h =\r\n          height ??\r\n          container.clientHeight ??\r\n          (aspectRatio ? Math.round((w || 0) / aspectRatio) : img.clientHeight);\r\n        if (w && h) {\r\n          img.setAttribute('width', String(w));\r\n          img.setAttribute('height', String(h));\r\n        }\r\n      }\r\n    }, [width, height, aspectRatio]);\r\n\r\n    return (\r\n      <div\r\n        ref={containerRef}\r\n        className={`relative overflow-hidden ${className}`}\r\n        style={aspectRatioStyle}\r\n      >\r\n        {/* Loading/Placeholder State */}\r\n        {(imageState.isLoading || imageState.hasError) && placeholderSrc && (\r\n          <div className=\"absolute inset-0 bg-gray-100 dark:bg-gray-800\">\r\n            <img\r\n              src={placeholderSrc}\r\n              alt=\"\"\r\n              className=\"w-full h-full object-cover\"\r\n              style={{\r\n                filter: blurDataURL ? 'blur(20px)' : 'none',\r\n                transform: 'scale(1.1)',\r\n                transition: 'opacity 0.3s ease-in-out',\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Loading Indicator */}\r\n        {imageState.isLoading && (\r\n          <div className=\"absolute inset-0 flex items-center justify-center bg-gray-50/80 dark:bg-gray-900/80\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n          </div>\r\n        )}\r\n\r\n        {/* Error State */}\r\n        {imageState.hasError && (\r\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900\">\r\n            <AlertCircle className=\"w-8 h-8 text-red-500 mb-2\" />\r\n            <span className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n              Failed to load image\r\n            </span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Main Image */}\r\n        <img\r\n          ref={imgRef}\r\n          src={src}\r\n          srcSet={generatedSrcSet}\r\n          sizes={sizes}\r\n          alt={alt}\r\n          {...(width !== undefined ? { width } : {})}\r\n          {...(height !== undefined ? { height } : {})}\r\n          loading={priority ? 'eager' : loading}\r\n          decoding={decoding}\r\n          {...(fetchPriority && fetchPriority !== 'auto'\r\n            ? { fetchPriority }\r\n            : {})}\r\n          className={`w-full h-full object-${objectFit} transition-opacity duration-${fadeDuration} ${\r\n            imageState.isLoaded ? 'opacity-100' : 'opacity-0'\r\n          }`}\r\n          onLoad={handleLoad}\r\n          onError={handleError}\r\n          style={{\r\n            objectFit,\r\n          }}\r\n        />\r\n\r\n        {/* Priority Indicator for Development */}\r\n        {process.env.NODE_ENV === 'development' && priority && (\r\n          <div className=\"absolute top-2 left-2 bg-green-500 text-white text-xs px-2 py-1 rounded\">\r\n            Priority\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nOptimizedImage.displayName = 'OptimizedImage';\r\n\r\nexport default OptimizedImage;\r\n\r\n// Higher-order component for image optimization\r\nexport const withImageOptimization = <P extends object>(\r\n  Component: ComponentType<P>\r\n): ComponentType<P & OptimizedImageProps> => {\r\n  const OptimizedComponent = memo((props: P & OptimizedImageProps) => {\r\n    return <Component {...props} />;\r\n  });\r\n\r\n  OptimizedComponent.displayName = `withImageOptimization(${Component.displayName || Component.name})`;\r\n  return OptimizedComponent;\r\n};\r\n\r\n// Utility function to preload images\r\nexport const preloadImage = (\r\n  src: string,\r\n  _priority: 'high' | 'low' = 'low'\r\n): Promise<void> => {\r\n  return new Promise((resolve, reject) => {\r\n    const link = document.createElement('link');\r\n    link.rel = 'preload';\r\n    link.as = 'image';\r\n    link.href = src;\r\n    // link.fetchPriority = priority; // fetchPriority not supported on link elements\r\n    link.onload = () => resolve();\r\n    link.onerror = () => reject(new Error(`Failed to preload image: ${src}`));\r\n    document.head.appendChild(link);\r\n  });\r\n};\r\n\r\n// Utility function to get optimal image format\r\nexport const getOptimalFormat = (): 'avif' | 'webp' | 'png' | 'jpg' => {\r\n  const canvas = document.createElement('canvas');\r\n  canvas.width = 1;\r\n  canvas.height = 1;\r\n  const ctx = canvas.getContext('2d');\r\n  if (!ctx) {\r\n    return 'png';\r\n  }\r\n\r\n  // Check for AVIF support\r\n  if (canvas.toDataURL('image/avif').indexOf('data:image/avif') === 0) {\r\n    return 'avif';\r\n  }\r\n\r\n  // Check for WebP support\r\n  if (canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0) {\r\n    return 'webp';\r\n  }\r\n\r\n  // Fallback to PNG\r\n  return 'png';\r\n};\r\n\r\n// Responsive image component for art direction\r\nexport const ResponsiveImage: ComponentType<{\r\n  sources: Array<{\r\n    srcSet: string;\r\n    media?: string;\r\n    type?: string;\r\n  }>;\r\n  fallbackSrc: string;\r\n  alt: string;\r\n  className?: string;\r\n  onLoad?: () => void;\r\n  onError?: () => void;\r\n}> = memo(({ sources, fallbackSrc, alt, className, onLoad, onError }) => {\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [hasError, setHasError] = useState(false);\r\n\r\n  const handleLoad = () => {\r\n    setIsLoaded(true);\r\n    onLoad?.();\r\n  };\r\n\r\n  const handleError = () => {\r\n    setHasError(true);\r\n    onError?.();\r\n  };\r\n\r\n  return (\r\n    <picture className={className}>\r\n      {sources.map((source, index) => (\r\n        <source\r\n          key={index}\r\n          srcSet={source.srcSet}\r\n          media={source.media}\r\n          type={source.type}\r\n        />\r\n      ))}\r\n      <img\r\n        src={fallbackSrc}\r\n        alt={alt}\r\n        onLoad={handleLoad}\r\n        onError={handleError}\r\n        className={`w-full h-full object-cover transition-opacity duration-300 ${\r\n          isLoaded ? 'opacity-100' : 'opacity-0'\r\n        }`}\r\n      />\r\n      {hasError && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\r\n          <AlertCircle className=\"w-8 h-8 text-red-500\" />\r\n        </div>\r\n      )}\r\n    </picture>\r\n  );\r\n});\r\n\r\nResponsiveImage.displayName = 'ResponsiveImage';\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\OptimizedList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1284,1287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1284,1287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2171,2174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2171,2174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2622,2625],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2622,2625],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2808,2811],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2808,2811],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3869,3872],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3869,3872],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8471,8474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8471,8474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8508,8511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8508,8511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":315,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9145,9148],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9145,9148],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":358,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":358,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10282,10285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10282,10285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":401,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":401,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11438,11441],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11438,11441],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":436,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":436,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12421,12424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12421,12424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":437,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":437,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12463,12466],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12463,12466],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":446,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":446,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12725,12728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12725,12728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":450,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":450,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12785,12788],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12785,12788],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":664,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":664,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19080,19083],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19080,19083],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":703,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":703,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20230,20233],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20230,20233],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":740,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":740,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21347,21350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21347,21350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  memo,\r\n  useMemo,\r\n  useCallback,\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  type ComponentType,\r\n  type ReactNode,\r\n  type Key,\r\n} from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Search, Filter, ChevronDown, ChevronUp } from 'lucide-react';\r\n\r\n// Types\r\ninterface OptimizedListProps<T> {\r\n  items: T[];\r\n  itemHeight: number;\r\n  height: number;\r\n  width?: number | string;\r\n  renderItem: (item: T, index: number, style: React.CSSProperties) => ReactNode;\r\n  itemKey?: (item: T, index: number) => Key;\r\n  className?: string;\r\n  overscanCount?: number;\r\n  estimatedItemSize?: number;\r\n  variableSize?: boolean;\r\n  getItemSize?: (index: number) => number;\r\n  onScroll?: (scrollInfo: {\r\n    scrollOffset: number;\r\n    scrollDirection: 'forward' | 'backward';\r\n  }) => void;\r\n  loadingIndicator?: ReactNode;\r\n  emptyState?: ReactNode;\r\n  searchPlaceholder?: string;\r\n  searchable?: boolean;\r\n  sortable?: boolean;\r\n  sortOptions?: Array<{\r\n    key: keyof T;\r\n    label: string;\r\n    direction?: 'asc' | 'desc';\r\n  }>;\r\n  filterable?: boolean;\r\n  filterOptions?: Array<{\r\n    key: keyof T;\r\n    label: string;\r\n    options: Array<{ value: any; label: string }>;\r\n  }>;\r\n  infiniteScroll?: boolean;\r\n  hasNextPage?: boolean;\r\n  isNextPageLoading?: boolean;\r\n  loadNextPage?: () => void;\r\n  itemCount?: number;\r\n}\r\n\r\ninterface ListRowProps<T> {\r\n  index: number;\r\n  style: React.CSSProperties;\r\n  data: {\r\n    items: T[];\r\n    renderItem: (\r\n      item: T,\r\n      index: number,\r\n      style: React.CSSProperties\r\n    ) => ReactNode;\r\n  };\r\n}\r\n\r\n// Memoized list row component\r\nconst ListRow = memo(<T,>({ index, style, data }: ListRowProps<T>) => {\r\n  const { items, renderItem } = data;\r\n  const item = items[index];\r\n\r\n  if (!item) {\r\n    return (\r\n      <div style={style} className=\"flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-primary\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <>{renderItem(item, index, style)}</>;\r\n}) as ComponentType<ListRowProps<any>>;\r\n\r\nListRow.displayName = 'ListRow';\r\n\r\n// _Search and Filter Component\r\ninterface SearchFilterProps<T> {\r\n  searchable?: boolean;\r\n  sortable?: boolean;\r\n  filterable?: boolean;\r\n  searchPlaceholder?: string | undefined;\r\n  sortOptions?:\r\n    | Array<{ key: keyof T; label: string; direction?: 'asc' | 'desc' }>\r\n    | undefined;\r\n  filterOptions?:\r\n    | Array<{\r\n        key: keyof T;\r\n        label: string;\r\n        options: Array<{ value: any; label: string }>;\r\n      }>\r\n    | undefined;\r\n  onSearch: (query: string) => void;\r\n  onSort: (key: keyof T, direction: 'asc' | 'desc') => void;\r\n  onFilter: (key: keyof T, value: any) => void;\r\n  totalCount: number;\r\n  filteredCount: number;\r\n}\r\n\r\nconst SearchFilter = <T,>({\r\n  searchable = true,\r\n  sortable = true,\r\n  filterable = true,\r\n  searchPlaceholder = '_Search...',\r\n  sortOptions = [],\r\n  filterOptions = [],\r\n  onSearch,\r\n  onSort,\r\n  onFilter,\r\n  totalCount,\r\n  filteredCount,\r\n}: SearchFilterProps<T>) => {\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [currentSort, setCurrentSort] = useState<{\r\n    key: keyof T;\r\n    direction: 'asc' | 'desc';\r\n  } | null>(null);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  const handleSearchChange = useCallback(\r\n    (event: React.ChangeEvent<HTMLInputElement>) => {\r\n      const query = event.target.value;\r\n      setSearchQuery(query);\r\n      onSearch(query);\r\n    },\r\n    [onSearch]\r\n  );\r\n\r\n  const handleSort = useCallback(\r\n    (key: keyof T, direction: 'asc' | 'desc') => {\r\n      setCurrentSort({ key, direction });\r\n      onSort(key, direction);\r\n    },\r\n    [onSort]\r\n  );\r\n\r\n  const handleFilter = useCallback(\r\n    (key: keyof T, value: any) => {\r\n      onFilter(key, value);\r\n    },\r\n    [onFilter]\r\n  );\r\n\r\n  const toggleSortDirection = useCallback(\r\n    (key: keyof T) => {\r\n      const newDirection =\r\n        currentSort?.key === key && currentSort.direction === 'asc'\r\n          ? 'desc'\r\n          : 'asc';\r\n      handleSort(key, newDirection);\r\n    },\r\n    [currentSort, handleSort]\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-4 p-4 border-b\">\r\n      {/* _Search */}\r\n      {searchable && (\r\n        <div className=\"relative\">\r\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n          <Input\r\n            type=\"text\"\r\n            placeholder={searchPlaceholder}\r\n            value={searchQuery}\r\n            onChange={handleSearchChange}\r\n            className=\"pl-10\"\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Controls */}\r\n      <div className=\"flex items-center justify-between gap-4\">\r\n        <div className=\"flex items-center gap-2\">\r\n          {/* Sort */}\r\n          {sortable && sortOptions.length > 0 && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-muted-foreground\">Sort:</span>\r\n              <div className=\"flex gap-1\">\r\n                {sortOptions.map((option) => (\r\n                  <Button\r\n                    key={String(option.key)}\r\n                    variant={\r\n                      currentSort?.key === option.key ? 'default' : 'outline'\r\n                    }\r\n                    size=\"sm\"\r\n                    onClick={() => toggleSortDirection(option.key)}\r\n                    className=\"flex items-center gap-1\"\r\n                  >\r\n                    {option.label}\r\n                    {currentSort?.key === option.key &&\r\n                      (currentSort.direction === 'asc' ? (\r\n                        <ChevronUp className=\"h-3 w-3\" />\r\n                      ) : (\r\n                        <ChevronDown className=\"h-3 w-3\" />\r\n                      ))}\r\n                  </Button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Filter Toggle */}\r\n          {filterable && filterOptions.length > 0 && (\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowFilters(!showFilters)}\r\n              className=\"flex items-center gap-1\"\r\n            >\r\n              <Filter className=\"h-3 w-3\" />\r\n              Filters\r\n              {showFilters && <ChevronUp className=\"h-3 w-3\" />}\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Results Count */}\r\n        <div className=\"text-sm text-muted-foreground px-2 py-1 border rounded\">\r\n          {filteredCount} of {totalCount} items\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      {showFilters && filterable && filterOptions.length > 0 && (\r\n        <div className=\"space-y-3\">\r\n          {filterOptions.map((filter) => (\r\n            <div key={String(filter.key)} className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-muted-foreground min-w-fit\">\r\n                {filter.label}:\r\n              </span>\r\n              <select\r\n                className=\"flex-1 px-2 py-1 text-sm border rounded\"\r\n                onChange={(e) => handleFilter(filter.key, e.target.value)}\r\n                defaultValue=\"\"\r\n              >\r\n                <option value=\"\">All</option>\r\n                {filter.options.map((option) => (\r\n                  <option key={option.value} value={option.value}>\r\n                    {option.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Main Optimized List Component\r\nexport const OptimizedList = <T,>({\r\n  items,\r\n  itemHeight,\r\n  height,\r\n  width = '100%',\r\n  renderItem,\r\n  itemKey,\r\n  className = '',\r\n  overscanCount = 5,\r\n  variableSize = false,\r\n  getItemSize,\r\n  onScroll,\r\n  loadingIndicator,\r\n  emptyState,\r\n  searchPlaceholder,\r\n  searchable = true,\r\n  sortable = true,\r\n  sortOptions,\r\n  filterable = true,\r\n  filterOptions,\r\n  infiniteScroll = false,\r\n  hasNextPage,\r\n  isNextPageLoading,\r\n  loadNextPage,\r\n  itemCount,\r\n}: OptimizedListProps<T>) => {\r\n  const [filteredItems, setFilteredItems] = useState<T[]>(items);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [currentSort, setCurrentSort] = useState<{\r\n    key: keyof T;\r\n    direction: 'asc' | 'desc';\r\n  } | null>(null);\r\n  const [currentFilters, setCurrentFilters] = useState<Record<string, any>>({});\r\n  const listRef = useRef<any>(null);\r\n\r\n  // Apply _search, sort, and filters\r\n  const processedItems = useMemo(() => {\r\n    let result = [...items];\r\n\r\n    // Apply _search\r\n    if (searchQuery) {\r\n      result = result.filter((item) => {\r\n        return Object.values(item as Record<string, unknown>).some((value) =>\r\n          String(value).toLowerCase().includes(searchQuery.toLowerCase())\r\n        );\r\n      });\r\n    }\r\n\r\n    // Apply filters\r\n    Object.entries(currentFilters).forEach(([key, value]) => {\r\n      if (value !== '' && value !== null && value !== undefined) {\r\n        result = result.filter((item) => {\r\n          const itemValue = (item as any)[key];\r\n          return (\r\n            String(itemValue).toLowerCase() === String(value).toLowerCase()\r\n          );\r\n        });\r\n      }\r\n    });\r\n\r\n    // Apply sort\r\n    if (currentSort) {\r\n      result.sort((a, b) => {\r\n        const aValue = a[currentSort.key];\r\n        const bValue = b[currentSort.key];\r\n\r\n        if (aValue < bValue) {\r\n          return currentSort.direction === 'asc' ? -1 : 1;\r\n        }\r\n        if (aValue > bValue) {\r\n          return currentSort.direction === 'asc' ? 1 : -1;\r\n        }\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    return result;\r\n  }, [items, searchQuery, currentSort, currentFilters]);\r\n\r\n  // Update filtered items when processed items change\r\n  useEffect(() => {\r\n    setFilteredItems(processedItems);\r\n  }, [processedItems]);\r\n\r\n  // Handle _search\r\n  const handleSearch = useCallback((query: string) => {\r\n    setSearchQuery(query);\r\n  }, []);\r\n\r\n  // Handle sort\r\n  const handleSort = useCallback((key: keyof T, direction: 'asc' | 'desc') => {\r\n    setCurrentSort({ key, direction });\r\n  }, []);\r\n\r\n  // Handle filter\r\n  const handleFilter = useCallback((key: keyof T, value: any) => {\r\n    setCurrentFilters((prev) => ({\r\n      ...prev,\r\n      [String(key)]: value,\r\n    }));\r\n  }, []);\r\n\r\n  // Get item key\r\n  const getItemKey = useCallback(\r\n    (index: number): Key => {\r\n      const item = filteredItems[index];\r\n      if (item && itemKey) {\r\n        return itemKey(item, index);\r\n      }\r\n      return index;\r\n    },\r\n    [filteredItems, itemKey]\r\n  );\r\n\r\n  // Render row\r\n  const renderRow = useCallback(\r\n    ({ index, style }: { index: number; style: React.CSSProperties }) => {\r\n      const item = filteredItems[index];\r\n\r\n      if (!item && infiniteScroll && isNextPageLoading) {\r\n        return (\r\n          <div style={style} className=\"flex items-center justify-center\">\r\n            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary\"></div>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      if (!item) {\r\n        return <div style={style}></div>;\r\n      }\r\n\r\n      return <>{renderItem(item, index, style)}</>;\r\n    },\r\n    [filteredItems, renderItem, infiniteScroll, isNextPageLoading]\r\n  );\r\n\r\n  // Handle scroll\r\n  const handleScroll = useCallback(\r\n    ({ scrollOffset, scrollDirection }: any) => {\r\n      if (onScroll) {\r\n        onScroll({ scrollOffset, scrollDirection });\r\n      }\r\n\r\n      // Infinite scroll loading\r\n      if (infiniteScroll && hasNextPage && !isNextPageLoading) {\r\n        const listElement = listRef.current;\r\n        if (listElement) {\r\n          const { scrollHeight, clientHeight, scrollTop } =\r\n            listElement._outerRef;\r\n          if (scrollHeight - scrollTop <= clientHeight * 1.5) {\r\n            loadNextPage?.();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    [onScroll, infiniteScroll, hasNextPage, isNextPageLoading, loadNextPage]\r\n  );\r\n\r\n  // Item data for list\r\n  const itemData = useMemo(\r\n    () => ({\r\n      items: filteredItems,\r\n      renderItem,\r\n    }),\r\n    [filteredItems, renderItem]\r\n  );\r\n\r\n  // Custom List component to replace react-window\r\n  interface CustomListProps {\r\n    height: number;\r\n    width: number | string;\r\n    itemCount: number;\r\n    itemSize: number | ((index: number) => number);\r\n    itemData: any;\r\n    itemKey?: (index: number, data: any) => Key;\r\n    overscanCount?: number;\r\n    onScroll?: (info: {\r\n      scrollOffset: number;\r\n      scrollDirection: 'forward' | 'backward';\r\n    }) => void;\r\n    children: ComponentType<{\r\n      index: number;\r\n      style: React.CSSProperties;\r\n      data: any;\r\n    }>;\r\n  }\r\n\r\n  const CustomList = React.forwardRef<any, CustomListProps>(\r\n    (\r\n      {\r\n        height,\r\n        width,\r\n        itemCount,\r\n        itemSize,\r\n        itemData,\r\n        itemKey,\r\n        overscanCount = 5,\r\n        onScroll,\r\n        children: RowComponent,\r\n      },\r\n      ref\r\n    ) => {\r\n      const [scrollTop, setScrollTop] = useState(0);\r\n      const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n      const getItemHeight = useCallback(\r\n        (index: number) => {\r\n          return typeof itemSize === 'function' ? itemSize(index) : itemSize;\r\n        },\r\n        [itemSize]\r\n      );\r\n\r\n      const itemHeights = useMemo(() => {\r\n        const heights: number[] = [];\r\n        let totalHeight = 0;\r\n        for (let i = 0; i < itemCount; i++) {\r\n          const height = getItemHeight(i);\r\n          heights.push(totalHeight);\r\n          totalHeight += height;\r\n        }\r\n        return { heights, totalHeight };\r\n      }, [itemCount, getItemHeight]);\r\n\r\n      const getVisibleRange = useCallback(() => {\r\n        const { heights } = itemHeights;\r\n        let startIndex = 0;\r\n        let endIndex = itemCount - 1;\r\n\r\n        // Find start index\r\n        for (let i = 0; i < heights.length; i++) {\r\n          if ((heights[i] ?? 0) + getItemHeight(i) > scrollTop) {\r\n            startIndex = Math.max(0, i - overscanCount);\r\n            break;\r\n          }\r\n        }\r\n\r\n        // Find end index\r\n        for (let i = startIndex; i < heights.length; i++) {\r\n          if ((heights[i] ?? 0) > scrollTop + height) {\r\n            endIndex = Math.min(itemCount - 1, i + overscanCount);\r\n            break;\r\n          }\r\n        }\r\n\r\n        return { startIndex, endIndex };\r\n      }, [\r\n        scrollTop,\r\n        height,\r\n        itemCount,\r\n        itemHeights,\r\n        overscanCount,\r\n        getItemHeight,\r\n      ]);\r\n\r\n      const { startIndex, endIndex } = getVisibleRange();\r\n\r\n      const handleScroll = useCallback(\r\n        (e: React.UIEvent<HTMLDivElement>) => {\r\n          const newScrollTop = e.currentTarget.scrollTop;\r\n          const scrollDirection =\r\n            newScrollTop > scrollTop ? 'forward' : 'backward';\r\n          setScrollTop(newScrollTop);\r\n\r\n          if (onScroll) {\r\n            onScroll({ scrollOffset: newScrollTop, scrollDirection });\r\n          }\r\n        },\r\n        [scrollTop, onScroll]\r\n      );\r\n\r\n      React.useImperativeHandle(ref, () => ({\r\n        _outerRef: containerRef.current,\r\n        scrollTo: (offset: number) => {\r\n          if (containerRef.current) {\r\n            containerRef.current.scrollTop = offset;\r\n          }\r\n        },\r\n        scrollToItem: (index: number) => {\r\n          if (\r\n            containerRef.current &&\r\n            itemHeights.heights[index] !== undefined\r\n          ) {\r\n            containerRef.current.scrollTop = itemHeights.heights[index];\r\n          }\r\n        },\r\n      }));\r\n\r\n      const visibleItems = [];\r\n      for (let i = startIndex; i <= endIndex; i++) {\r\n        const top = itemHeights.heights[i] || 0;\r\n        const itemHeight = getItemHeight(i);\r\n        const key = itemKey ? itemKey(i, itemData) : i;\r\n\r\n        visibleItems.push(\r\n          <RowComponent\r\n            key={key}\r\n            index={i}\r\n            style={{\r\n              position: 'absolute',\r\n              top,\r\n              height: itemHeight,\r\n              width: '100%',\r\n            }}\r\n            data={itemData}\r\n          />\r\n        );\r\n      }\r\n\r\n      return (\r\n        <div\r\n          ref={containerRef}\r\n          style={{\r\n            height,\r\n            width,\r\n            overflow: 'auto',\r\n            position: 'relative',\r\n          }}\r\n          onScroll={handleScroll}\r\n        >\r\n          <div\r\n            style={{ height: itemHeights.totalHeight, position: 'relative' }}\r\n          >\r\n            {visibleItems}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  );\r\n\r\n  CustomList.displayName = 'CustomList';\r\n\r\n  // Determine which list component to use - react-window only has List component\r\n  const ListComponent = CustomList;\r\n  const actualItemCount = infiniteScroll\r\n    ? itemCount || filteredItems.length\r\n    : filteredItems.length;\r\n\r\n  return (\r\n    <Card className={className}>\r\n      {(searchable || sortable || filterable) && (\r\n        <SearchFilter\r\n          searchable={searchable}\r\n          sortable={sortable}\r\n          filterable={filterable}\r\n          searchPlaceholder={searchPlaceholder ?? undefined}\r\n          sortOptions={sortOptions ?? undefined}\r\n          filterOptions={filterOptions ?? undefined}\r\n          onSearch={handleSearch}\r\n          onSort={handleSort}\r\n          onFilter={handleFilter}\r\n          totalCount={items.length}\r\n          filteredCount={filteredItems.length}\r\n        />\r\n      )}\r\n\r\n      <CardContent className=\"p-0\">\r\n        {filteredItems.length === 0 ? (\r\n          emptyState || (\r\n            <div className=\"flex flex-col items-center justify-center p-8 text-center\">\r\n              <div className=\"text-muted-foreground mb-2\">No items found</div>\r\n              <div className=\"text-sm text-muted-foreground\">\r\n                {searchQuery || Object.keys(currentFilters).length > 0\r\n                  ? 'Try adjusting your _search or filters'\r\n                  : 'No items available'}\r\n              </div>\r\n            </div>\r\n          )\r\n        ) : (\r\n          <div style={{ height, width }}>\r\n            <ListComponent\r\n              ref={listRef}\r\n              height={height}\r\n              width={width}\r\n              itemCount={actualItemCount}\r\n              itemSize={\r\n                variableSize ? getItemSize || (() => itemHeight) : itemHeight\r\n              }\r\n              itemData={itemData}\r\n              itemKey={getItemKey}\r\n              overscanCount={overscanCount}\r\n              onScroll={handleScroll}\r\n            >\r\n              {renderRow}\r\n            </ListComponent>\r\n          </div>\r\n        )}\r\n\r\n        {loadingIndicator && isNextPageLoading && (\r\n          <div className=\"flex items-center justify-center p-4\">\r\n            {loadingIndicator}\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nOptimizedList.displayName = 'OptimizedList';\r\n\r\n// Specialized list components for common use cases\r\nexport const StudentList = (\r\n  props: Omit<OptimizedListProps<any>, 'sortOptions' | 'filterOptions'>\r\n) => (\r\n  <OptimizedList\r\n    {...props}\r\n    sortOptions={[\r\n      { key: 'name', label: 'Name' },\r\n      { key: 'grade', label: 'Grade' },\r\n      { key: 'section', label: 'Section' },\r\n      { key: 'lrn', label: 'LRN' },\r\n    ]}\r\n    filterOptions={[\r\n      {\r\n        key: 'grade',\r\n        label: 'Grade Level',\r\n        options: [\r\n          { value: 'GRADE_7', label: 'Grade 7' },\r\n          { value: 'GRADE_8', label: 'Grade 8' },\r\n          { value: 'GRADE_9', label: 'Grade 9' },\r\n          { value: 'GRADE_10', label: 'Grade 10' },\r\n          { value: 'GRADE_11', label: 'Grade 11' },\r\n          { value: 'GRADE_12', label: 'Grade 12' },\r\n        ],\r\n      },\r\n      {\r\n        key: 'section',\r\n        label: 'Section',\r\n        options: [\r\n          { value: 'A', label: 'Section A' },\r\n          { value: 'B', label: 'Section B' },\r\n          { value: 'C', label: 'Section C' },\r\n          { value: 'D', label: 'Section D' },\r\n        ],\r\n      },\r\n    ]}\r\n    searchPlaceholder=\"_Search students by name, LRN, or grade...\"\r\n  />\r\n);\r\n\r\nexport const BookList = (\r\n  props: Omit<OptimizedListProps<any>, 'sortOptions' | 'filterOptions'>\r\n) => (\r\n  <OptimizedList\r\n    {...props}\r\n    sortOptions={[\r\n      { key: 'title', label: 'Title' },\r\n      { key: 'author', label: 'Author' },\r\n      { key: 'accessionNumber', label: 'Accession No.' },\r\n      { key: 'category', label: 'Category' },\r\n    ]}\r\n    filterOptions={[\r\n      {\r\n        key: 'category',\r\n        label: 'Category',\r\n        options: [\r\n          { value: 'FICTION', label: 'Fiction' },\r\n          { value: 'NON_FICTION', label: 'Non-Fiction' },\r\n          { value: 'REFERENCE', label: 'Reference' },\r\n          { value: 'TEXTBOOK', label: 'Textbook' },\r\n        ],\r\n      },\r\n      {\r\n        key: 'status',\r\n        label: 'Status',\r\n        options: [\r\n          { value: 'AVAILABLE', label: 'Available' },\r\n          { value: 'BORROWED', label: 'Borrowed' },\r\n          { value: 'RESERVED', label: 'Reserved' },\r\n          { value: 'LOST', label: 'Lost' },\r\n        ],\r\n      },\r\n    ]}\r\n    searchPlaceholder=\"_Search books by title, author, or accession number...\"\r\n  />\r\n);\r\n\r\nexport const EquipmentList = (\r\n  props: Omit<OptimizedListProps<any>, 'sortOptions' | 'filterOptions'>\r\n) => (\r\n  <OptimizedList\r\n    {...props}\r\n    sortOptions={[\r\n      { key: 'name', label: 'Name' },\r\n      { key: 'category', label: 'Category' },\r\n      { key: 'serialNumber', label: 'Serial No.' },\r\n      { key: 'status', label: 'Status' },\r\n    ]}\r\n    filterOptions={[\r\n      {\r\n        key: 'category',\r\n        label: 'Category',\r\n        options: [\r\n          { value: 'COMPUTER', label: 'Computer' },\r\n          { value: 'PRINTER', label: 'Printer' },\r\n          { value: 'PROJECTOR', label: 'Projector' },\r\n          { value: 'SCANNER', label: 'Scanner' },\r\n        ],\r\n      },\r\n      {\r\n        key: 'status',\r\n        label: 'Status',\r\n        options: [\r\n          { value: 'AVAILABLE', label: 'Available' },\r\n          { value: 'IN_USE', label: 'In Use' },\r\n          { value: 'MAINTENANCE', label: 'Maintenance' },\r\n          { value: 'DAMAGED', label: 'Damaged' },\r\n        ],\r\n      },\r\n    ]}\r\n    searchPlaceholder=\"_Search equipment by name, category, or serial number...\"\r\n  />\r\n);\r\n\r\nexport default OptimizedList;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\PerformanceDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\PerformanceMonitor.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":171,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4365,4368],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4365,4368],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from 'recharts';\r\nimport {\r\n  Activity,\r\n  Zap,\r\n  Clock,\r\n  Database,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Download,\r\n  RefreshCw,\r\n  Play,\r\n  Pause,\r\n  FileText,\r\n  BarChart3,\r\n  Monitor,\r\n  Gauge,\r\n  Target,\r\n  TrendingUp,\r\n  TrendingDown,\r\n} from 'lucide-react';\r\nimport {\r\n  performanceMonitoringService,\r\n  type PerformanceReport,\r\n  type ComponentPerformance,\r\n} from '@/services/performanceMonitoringService';\r\n\r\ninterface MetricCardProps {\r\n  title: string;\r\n  value: string | number;\r\n  unit?: string;\r\n  trend?: 'up' | 'down' | 'neutral';\r\n  target?: number;\r\n  actual?: number;\r\n  icon: React.ReactNode;\r\n  color?: string;\r\n}\r\n\r\nconst MetricCard: React.FC<MetricCardProps> = ({\r\n  title,\r\n  value,\r\n  unit,\r\n  trend,\r\n  target,\r\n  actual,\r\n  icon,\r\n  color = 'text-blue-600',\r\n}) => {\r\n  const percentage = target && actual ? (actual / target) * 100 : null;\r\n  const trendColor =\r\n    trend === 'up'\r\n      ? 'text-red-600'\r\n      : trend === 'down'\r\n        ? 'text-green-600'\r\n        : 'text-gray-600';\r\n  const TrendIcon =\r\n    trend === 'up' ? TrendingUp : trend === 'down' ? TrendingDown : Activity;\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"p-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className={color}>{icon}</div>\r\n            <div>\r\n              <p className=\"text-sm font-medium text-muted-foreground\">\r\n                {title}\r\n              </p>\r\n              <p className=\"text-2xl font-bold\">\r\n                {value}\r\n                {unit && (\r\n                  <span className=\"text-sm font-normal text-muted-foreground ml-1\">\r\n                    {unit}\r\n                  </span>\r\n                )}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          {trend && (\r\n            <div className={`flex items-center space-x-1 ${trendColor}`}>\r\n              <TrendIcon className=\"h-4 w-4\" />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {percentage !== null && (\r\n          <div className=\"mt-4\">\r\n            <div className=\"flex justify-between text-sm mb-1\">\r\n              <span className=\"text-muted-foreground\">Performance</span>\r\n              <span>{percentage.toFixed(1)}%</span>\r\n            </div>\r\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n              <div\r\n                className=\"bg-blue-600 h-2 rounded-full\"\r\n                style={{ width: `${percentage}%` }}\r\n              ></div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\ninterface PerformanceGradeProps {\r\n  grade: 'A' | 'B' | 'C' | 'D' | 'F';\r\n  score: number;\r\n}\r\n\r\nconst PerformanceGrade: React.FC<PerformanceGradeProps> = ({\r\n  grade,\r\n  score,\r\n}) => {\r\n  const gradeColors = {\r\n    A: 'text-green-600 bg-green-50',\r\n    B: 'text-blue-600 bg-blue-50',\r\n    C: 'text-yellow-600 bg-yellow-50',\r\n    D: 'text-orange-600 bg-orange-50',\r\n    F: 'text-red-600 bg-red-50',\r\n  };\r\n\r\n  const gradeIcons = {\r\n    A: CheckCircle,\r\n    B: CheckCircle,\r\n    C: AlertTriangle,\r\n    D: AlertTriangle,\r\n    F: AlertTriangle,\r\n  };\r\n\r\n  const Icon = gradeIcons[grade];\r\n\r\n  return (\r\n    <div className=\"flex items-center space-x-4\">\r\n      <div className={`p-3 rounded-full ${gradeColors[grade]}`}>\r\n        <Icon className=\"h-8 w-8\" />\r\n      </div>\r\n      <div>\r\n        <div className=\"text-3xl font-bold\">{grade}</div>\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Score: {score.toFixed(1)}/100\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst PerformanceMonitor: React.FC = () => {\r\n  const [isMonitoring, setIsMonitoring] = useState(false);\r\n  const [currentReport, setCurrentReport] = useState<PerformanceReport | null>(\r\n    null\r\n  );\r\n  const [componentMetrics, setComponentMetrics] = useState<\r\n    ComponentPerformance[]\r\n  >([]);\r\n  const [insights, setInsights] = useState<any>(null);\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n\r\n  useEffect(() => {\r\n    // Load existing data\r\n    setComponentMetrics(performanceMonitoringService.getComponentMetrics());\r\n\r\n    const latestReport = performanceMonitoringService.getLatestReport();\r\n    if (latestReport) {\r\n      setCurrentReport(latestReport);\r\n    }\r\n\r\n    // Get insights\r\n    setInsights(performanceMonitoringService.getPerformanceInsights());\r\n\r\n    // Set up monitoring status\r\n    setIsMonitoring(true);\r\n  }, []);\r\n\r\n  const startMonitoring = useCallback(() => {\r\n    performanceMonitoringService.startMonitoring();\r\n    setIsMonitoring(true);\r\n  }, []);\r\n\r\n  const stopMonitoring = useCallback(() => {\r\n    performanceMonitoringService.stopMonitoring();\r\n    setIsMonitoring(false);\r\n  }, []);\r\n\r\n  const generateReport = useCallback(() => {\r\n    const report = performanceMonitoringService.generateReport();\r\n    setCurrentReport(report);\r\n    setInsights(performanceMonitoringService.getPerformanceInsights());\r\n  }, []);\r\n\r\n  const exportData = useCallback(() => {\r\n    const data = performanceMonitoringService.exportData();\r\n    const blob = new Blob([data], { type: 'application/json' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `performance-report-${Date.now()}.json`;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n  }, []);\r\n\r\n  const runLighthouseAudit = useCallback(async () => {\r\n    try {\r\n      // This would require Lighthouse to be available\r\n      // For now, we'll simulate it\r\n      console.debug('Running Lighthouse audit...');\r\n      // const result = await performanceMonitoringService.runLighthouseAudit();\r\n    } catch (error) {\r\n      console.error('Lighthouse audit failed:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Format time values\r\n  const formatTime = (ms: number): string => {\r\n    if (ms < 1000) {\r\n      return `${ms.toFixed(0)}ms`;\r\n    }\r\n    return `${(ms / 1000).toFixed(2)}s`;\r\n  };\r\n\r\n  // Format memory values\r\n  const formatMemory = (bytes: number): string => {\r\n    const mb = bytes / 1024 / 1024;\r\n    if (mb < 1024) {\r\n      return `${mb.toFixed(1)}MB`;\r\n    }\r\n    return `${(mb / 1024).toFixed(1)}GB`;\r\n  };\r\n\r\n  if (!currentReport) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"text-center\">\r\n          <Monitor className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\r\n          <p className=\"text-muted-foreground\">\r\n            Generating performance report...\r\n          </p>\r\n          <Button onClick={generateReport} className=\"mt-4\">\r\n            Generate Report\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold flex items-center gap-2\">\r\n            <Activity className=\"h-8 w-8\" />\r\n            Performance Monitor\r\n          </h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Real-time performance monitoring and analysis\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant={isMonitoring ? 'destructive' : 'default'}\r\n            onClick={isMonitoring ? stopMonitoring : startMonitoring}\r\n          >\r\n            {isMonitoring ? (\r\n              <>\r\n                <Pause className=\"h-4 w-4 mr-2\" />\r\n                Stop Monitoring\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Play className=\"h-4 w-4 mr-2\" />\r\n                Start Monitoring\r\n              </>\r\n            )}\r\n          </Button>\r\n          <Button onClick={generateReport} variant=\"outline\">\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Generate Report\r\n          </Button>\r\n          <Button onClick={exportData} variant=\"outline\">\r\n            <Download className=\"h-4 w-4 mr-2\" />\r\n            Export\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Performance Grade */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Gauge className=\"h-5 w-5\" />\r\n            Performance Score\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-between\">\r\n            <PerformanceGrade\r\n              grade={currentReport.grade}\r\n              score={currentReport.score}\r\n            />\r\n            <div className=\"text-right\">\r\n              <div className=\"text-sm text-muted-foreground\">Last Updated</div>\r\n              <div className=\"text-sm\">\r\n                {new Date(currentReport.timestamp).toLocaleString()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Tabs */}\r\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n        <TabsList className=\"grid w-full grid-cols-4\">\r\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\r\n          <TabsTrigger value=\"metrics\">Metrics</TabsTrigger>\r\n          <TabsTrigger value=\"components\">Components</TabsTrigger>\r\n          <TabsTrigger value=\"recommendations\">Recommendations</TabsTrigger>\r\n        </TabsList>\r\n\r\n        {/* Overview Tab */}\r\n        <TabsContent value=\"overview\" className=\"space-y-6\">\r\n          {/* Core Metrics */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <MetricCard\r\n              title=\"Largest Contentful Paint\"\r\n              value={formatTime(currentReport.metrics.lcp)}\r\n              icon={<Target className=\"h-5 w-5\" />}\r\n              target={2500}\r\n              actual={currentReport.metrics.lcp}\r\n              color={\r\n                currentReport.metrics.lcp < 2500\r\n                  ? 'text-green-600'\r\n                  : 'text-red-600'\r\n              }\r\n            />\r\n            <MetricCard\r\n              title=\"First Input Delay\"\r\n              value={formatTime(currentReport.metrics.fid)}\r\n              icon={<Zap className=\"h-5 w-5\" />}\r\n              target={100}\r\n              actual={currentReport.metrics.fid}\r\n              color={\r\n                currentReport.metrics.fid < 100\r\n                  ? 'text-green-600'\r\n                  : 'text-red-600'\r\n              }\r\n            />\r\n            <MetricCard\r\n              title=\"Cumulative Layout Shift\"\r\n              value={currentReport.metrics.cls.toFixed(3)}\r\n              icon={<Activity className=\"h-5 w-5\" />}\r\n              target={0.1}\r\n              actual={currentReport.metrics.cls}\r\n              color={\r\n                currentReport.metrics.cls < 0.1\r\n                  ? 'text-green-600'\r\n                  : 'text-red-600'\r\n              }\r\n            />\r\n            <MetricCard\r\n              title=\"Memory Usage\"\r\n              value={formatMemory(\r\n                currentReport.metrics.memoryUsage * 1024 * 1024\r\n              )}\r\n              icon={<Database className=\"h-5 w-5\" />}\r\n              target={50 * 1024 * 1024}\r\n              actual={currentReport.metrics.memoryUsage * 1024 * 1024}\r\n              color={\r\n                currentReport.metrics.memoryUsage < 50\r\n                  ? 'text-green-600'\r\n                  : 'text-orange-600'\r\n              }\r\n            />\r\n          </div>\r\n\r\n          {/* Performance Trends */}\r\n          {insights && insights.trends.length > 0 && (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <BarChart3 className=\"h-5 w-5\" />\r\n                  Performance Trends\r\n                </CardTitle>\r\n                <CardDescription>Performance metrics over time</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ResponsiveContainer width=\"100%\" height={300}>\r\n                  <LineChart data={insights.trends}>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" />\r\n                    <XAxis\r\n                      dataKey=\"timestamp\"\r\n                      tickFormatter={(value) =>\r\n                        new Date(value).toLocaleTimeString()\r\n                      }\r\n                    />\r\n                    <YAxis />\r\n                    <Tooltip\r\n                      labelFormatter={(value) =>\r\n                        new Date(value).toLocaleString()\r\n                      }\r\n                      formatter={(value: number, name: string) => [\r\n                        name === 'score'\r\n                          ? `${value.toFixed(1)}`\r\n                          : formatTime(value),\r\n                        name === 'score' ? 'Score' : name.toUpperCase(),\r\n                      ]}\r\n                    />\r\n                    <Line\r\n                      type=\"monotone\"\r\n                      dataKey=\"score\"\r\n                      stroke=\"#8884d8\"\r\n                      strokeWidth={2}\r\n                      name=\"Performance Score\"\r\n                    />\r\n                    <Line\r\n                      type=\"monotone\"\r\n                      dataKey=\"lcp\"\r\n                      stroke=\"#82ca9d\"\r\n                      strokeWidth={2}\r\n                      name=\"LCP\"\r\n                    />\r\n                  </LineChart>\r\n                </ResponsiveContainer>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Metrics Tab */}\r\n        <TabsContent value=\"metrics\" className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {/* Navigation Timing */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Clock className=\"h-5 w-5\" />\r\n                  Navigation Timing\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>DOM Content Loaded</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatTime(currentReport.metrics.domContentLoaded)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Load Complete</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatTime(currentReport.metrics.loadComplete)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Time to First Byte</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatTime(currentReport.metrics.ttfb)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>First Contentful Paint</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatTime(currentReport.metrics.fcp)}\r\n                  </span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Resource Metrics */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Database className=\"h-5 w-5\" />\r\n                  Resource Metrics\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Resource Count</span>\r\n                  <span className=\"font-mono\">\r\n                    {currentReport.metrics.resourceCount}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Total Size</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatMemory(currentReport.metrics.totalResourceSize)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Transfer Size</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatMemory(currentReport.metrics.totalTransferSize)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>API Response Time</span>\r\n                  <span className=\"font-mono\">\r\n                    {formatTime(currentReport.metrics.apiResponseTime)}\r\n                  </span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {/* Components Tab */}\r\n        <TabsContent value=\"components\" className=\"space-y-6\">\r\n          {componentMetrics.length > 0 ? (\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Monitor className=\"h-5 w-5\" />\r\n                  Component Performance\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  Performance metrics for React components\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  {componentMetrics\r\n                    .sort((a, b) => b.averageTime - a.averageTime)\r\n                    .slice(0, 10)\r\n                    .map((component) => (\r\n                      <div\r\n                        key={component.name}\r\n                        className=\"border rounded-lg p-4\"\r\n                      >\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                          <h4 className=\"font-semibold\">{component.name}</h4>\r\n                          <div\r\n                            className={`px-2 py-1 rounded text-xs font-medium ${\r\n                              component.averageTime > 16\r\n                                ? 'bg-red-100 text-red-800'\r\n                                : 'bg-green-100 text-green-800'\r\n                            }`}\r\n                          >\r\n                            {component.averageTime.toFixed(2)}ms avg\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n                          <div>\r\n                            <span className=\"text-muted-foreground\">\r\n                              Renders:\r\n                            </span>\r\n                            <div className=\"font-semibold\">\r\n                              {component.renders}\r\n                            </div>\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"text-muted-foreground\">\r\n                              Slowest:\r\n                            </span>\r\n                            <div className=\"font-semibold\">\r\n                              {component.slowestRender.toFixed(2)}ms\r\n                            </div>\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"text-muted-foreground\">\r\n                              Fastest:\r\n                            </span>\r\n                            <div className=\"font-semibold\">\r\n                              {component.fastestRender === Infinity\r\n                                ? 'N/A'\r\n                                : `${component.fastestRender.toFixed(2)}ms`}\r\n                            </div>\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"text-muted-foreground\">\r\n                              Mount Time:\r\n                            </span>\r\n                            <div className=\"font-semibold\">\r\n                              {component.mountTime.toFixed(2)}ms\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"flex items-center justify-center h-32\">\r\n                <p className=\"text-muted-foreground\">\r\n                  No component metrics available yet\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        {/* Recommendations Tab */}\r\n        <TabsContent value=\"recommendations\" className=\"space-y-6\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Target className=\"h-5 w-5\" />\r\n                Performance Recommendations\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Actionable suggestions to improve performance\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {currentReport.recommendations.map((recommendation, index) => (\r\n                  <div\r\n                    key={index}\r\n                    className={`p-4 rounded-lg border ${\r\n                      recommendation.includes('excellent')\r\n                        ? 'bg-green-50 border-green-200'\r\n                        : 'bg-yellow-50 border-yellow-200'\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-start gap-3\">\r\n                      {recommendation.includes('excellent') ? (\r\n                        <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\r\n                      ) : (\r\n                        <AlertTriangle className=\"h-5 w-5 text-yellow-600 mt-0.5\" />\r\n                      )}\r\n                      <p className=\"text-sm\">{recommendation}</p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Additional Actions */}\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                Additional Actions\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"flex flex-wrap gap-4\">\r\n                <Button onClick={runLighthouseAudit} variant=\"outline\">\r\n                  <BarChart3 className=\"h-4 w-4 mr-2\" />\r\n                  Run Lighthouse Audit\r\n                </Button>\r\n                <Button onClick={exportData} variant=\"outline\">\r\n                  <Download className=\"h-4 w-4 mr-2\" />\r\n                  Export Full Report\r\n                </Button>\r\n                <Button\r\n                  onClick={() => window.open('/stats.html', '_blank')}\r\n                  variant=\"outline\"\r\n                >\r\n                  <Activity className=\"h-4 w-4 mr-2\" />\r\n                  View Bundle Analysis\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PerformanceMonitor;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\PerformanceProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":126,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":126,"endColumn":38},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":139,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":139,"endColumn":38},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":147,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":147,"endColumn":35},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":155,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":155,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, {\n  createContext,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  performanceMonitor,\n  type PerformanceMetric,\n  type LogEntry,\n} from '@/lib/performance-monitor';\n\ninterface PerformanceContextType {\n  metrics: PerformanceMetric[];\n  logs: LogEntry[];\n  sessionId: string;\n  userId: string | null;\n  setUserId: (userId: string) => void;\n  clearUserId: () => void;\n  flush: () => void;\n  getSummary: () => {\n    metricsCount: number;\n    logsCount: number;\n    activeEntriesCount: number;\n    sessionId: string;\n    userId: string | null;\n  };\n}\n\nconst PerformanceContext = createContext<PerformanceContextType | null>(null);\n\ninterface PerformanceProviderProps {\n  children: React.ReactNode;\n  config?: {\n    enableConsoleLogging?: boolean;\n    enableRemoteLogging?: boolean;\n    remoteEndpoint?: string;\n    sampleRate?: number;\n    flushInterval?: number;\n  };\n}\n\nexport function PerformanceProvider({\n  children,\n  config,\n}: PerformanceProviderProps) {\n  const [metrics, setMetrics] = useState<PerformanceMetric[]>([]);\n  const [logs, setLogs] = useState<LogEntry[]>([]);\n  const [userId, setUserIdState] = useState<string | null>(null);\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Update performance monitor config if provided\n  useEffect(() => {\n    if (config) {\n      // Note: In a real implementation, you'd need to reinitialize the monitor\n      // For now, we'll just log that config was updated\n      performanceMonitor.info('Performance provider config updated', {\n        config,\n      });\n    }\n  }, [config]);\n\n  // Periodically sync data from monitor\n  useEffect(() => {\n    const syncData = () => {\n      setMetrics(performanceMonitor.getMetrics());\n      setLogs(performanceMonitor.getLogs());\n    };\n\n    // Initial sync\n    syncData();\n\n    // Set up periodic sync\n    intervalRef.current = setInterval(syncData, 5000);\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, []);\n\n  // Set user ID in monitor when it changes\n  const setUserId = (newUserId: string) => {\n    setUserIdState(newUserId);\n    performanceMonitor.setUserId(newUserId);\n  };\n\n  const clearUserId = () => {\n    setUserIdState(null);\n    performanceMonitor.clearUserId();\n  };\n\n  const flush = () => {\n    performanceMonitor.flushNow();\n    // Update local state after flush\n    setTimeout(() => {\n      setMetrics(performanceMonitor.getMetrics());\n      setLogs(performanceMonitor.getLogs());\n    }, 100);\n  };\n\n  const getSummary = () => performanceMonitor.getSummary();\n\n  const contextValue: PerformanceContextType = {\n    metrics,\n    logs,\n    sessionId: performanceMonitor['sessionId'],\n    userId,\n    setUserId,\n    clearUserId,\n    flush,\n    getSummary,\n  };\n\n  return (\n    <PerformanceContext.Provider value={contextValue}>\n      {children}\n    </PerformanceContext.Provider>\n  );\n}\n\nexport function usePerformanceContext() {\n  const context = useContext(PerformanceContext);\n  if (!context) {\n    throw new Error(\n      'usePerformanceContext must be used within a PerformanceProvider'\n    );\n  }\n  return context;\n}\n\n/**\n * Hook for accessing performance metrics\n */\nexport function usePerformanceMetrics() {\n  const { metrics } = usePerformanceContext();\n  return metrics;\n}\n\n/**\n * Hook for accessing performance logs\n */\nexport function usePerformanceLogs() {\n  const { logs } = usePerformanceContext();\n  return logs;\n}\n\n/**\n * Hook for performance session management\n */\nexport function usePerformanceSession() {\n  const { sessionId, userId, setUserId, clearUserId, flush, getSummary } =\n    usePerformanceContext();\n  return { sessionId, userId, setUserId, clearUserId, flush, getSummary };\n}\n\nexport default PerformanceProvider;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\performance\\ReactPerformanceOptimizer.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":39,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":39,"endColumn":37},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":82,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":82,"endColumn":39},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":228,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":228,"endColumn":37},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'calculation'. Either include it or remove the dependency array.","line":232,"column":10,"nodeType":"Identifier","endLine":232,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [calculation]","fix":{"range":[6460,6472],"text":"[calculation]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":236,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":236,"endColumn":31},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6561,6564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6561,6564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":236,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6571,6574],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6571,6574],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'callback'. Either include it or remove the dependency array.","line":240,"column":10,"nodeType":"Identifier","endLine":240,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [callback]","fix":{"range":[6674,6686],"text":"[callback]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":244,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":244,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6852,6855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6852,6855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6862,6865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6862,6865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7206,7209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7206,7209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7216,7219],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7216,7219],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":273,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7602,7605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7602,7605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":273,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":273,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7612,7615],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7612,7615],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":453,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":453,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  useState,\r\n  useEffect,\r\n  useCallback,\r\n  useMemo,\r\n  useRef,\r\n  memo,\r\n  Profiler,\r\n  type ComponentType,\r\n  type ReactNode,\r\n  type ProfilerOnRenderCallback,\r\n} from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { AlertCircle, Activity, BarChart3 } from 'lucide-react';\r\n\r\n// Performance monitoring types\r\ninterface PerformanceMetrics {\r\n  renderTime: number;\r\n  renderCount: number;\r\n  lastRenderTime: number;\r\n  averageRenderTime: number;\r\n  slowestRender: number;\r\n  fastestRender: number;\r\n}\r\n\r\ninterface ComponentPerformanceData {\r\n  [componentName: string]: PerformanceMetrics;\r\n}\r\n\r\n// Memoized component factory with performance tracking\r\nexport const createMemoizedComponent = <P extends object>(\r\n  Component: ComponentType<P>,\r\n  componentName?: string\r\n): ComponentType<P> => {\r\n  const MemoizedComponent = memo(Component, (prevProps, nextProps) => {\r\n    // Custom comparison function for optimization\r\n    const keys = Object.keys(prevProps) as (keyof P)[];\r\n\r\n    return keys.every((key) => {\r\n      const prev = prevProps[key];\r\n      const next = nextProps[key];\r\n\r\n      // Handle different types of comparisons\r\n      if (typeof prev === 'function' && typeof next === 'function') {\r\n        return prev.toString() === next.toString();\r\n      }\r\n\r\n      if (Array.isArray(prev) && Array.isArray(next)) {\r\n        if (prev.length !== next.length) {\r\n          return false;\r\n        }\r\n        return prev.every((item, index) => item === next[index]);\r\n      }\r\n\r\n      if (\r\n        typeof prev === 'object' &&\r\n        prev !== null &&\r\n        typeof next === 'object' &&\r\n        next !== null\r\n      ) {\r\n        return JSON.stringify(prev) === JSON.stringify(next);\r\n      }\r\n\r\n      return prev === next;\r\n    });\r\n  });\r\n\r\n  MemoizedComponent.displayName = `Memoized(${componentName || Component.displayName || Component.name})`;\r\n\r\n  return MemoizedComponent;\r\n};\r\n\r\n// Performance monitoring HOC\r\nexport const withPerformanceMonitoring = <P extends object>(\r\n  Component: ComponentType<P>,\r\n  componentName?: string\r\n): ComponentType<P> => {\r\n  const name = componentName || Component.displayName || Component.name;\r\n\r\n  const MonitoredComponent = memo((props: P) => {\r\n    const [metrics, setMetrics] = useState<PerformanceMetrics>({\r\n      renderTime: 0,\r\n      renderCount: 0,\r\n      lastRenderTime: 0,\r\n      averageRenderTime: 0,\r\n      slowestRender: 0,\r\n      fastestRender: Infinity,\r\n    });\r\n\r\n    const renderStartTime = useRef<number>(Date.now());\r\n\r\n    const onRender: ProfilerOnRenderCallback = (\r\n      _id,\r\n      _phase,\r\n      actualDuration,\r\n      _baseDuration,\r\n      _startTime,\r\n      _commitTime\r\n    ) => {\r\n      const renderTime = actualDuration;\r\n      renderStartTime.current = Date.now();\r\n\r\n      setMetrics((prev) => {\r\n        const newRenderCount = prev.renderCount + 1;\r\n        const totalTime =\r\n          prev.averageRenderTime * prev.renderCount + renderTime;\r\n        const newAverage = totalTime / newRenderCount;\r\n\r\n        return {\r\n          renderTime,\r\n          renderCount: newRenderCount,\r\n          lastRenderTime: renderTime,\r\n          averageRenderTime: newAverage,\r\n          slowestRender: Math.max(prev.slowestRender, renderTime),\r\n          fastestRender: Math.min(prev.fastestRender, renderTime),\r\n        };\r\n      });\r\n\r\n      // Log performance warnings in development\r\n      if (process.env.NODE_ENV === 'development') {\r\n        if (renderTime > 16) {\r\n          console.warn(\r\n            `ΓÜá∩╕Å Slow render detected in ${name}: ${renderTime.toFixed(2)}ms`\r\n          );\r\n        }\r\n        if (renderTime > 100) {\r\n          console.error(\r\n            `≡ƒÜ¿ Very slow render in ${name}: ${renderTime.toFixed(2)}ms`\r\n          );\r\n        }\r\n      }\r\n    };\r\n\r\n    return (\r\n      <Profiler id={name} onRender={onRender}>\r\n        <Component {...props} />\r\n        {process.env.NODE_ENV === 'development' && (\r\n          <div className=\"fixed bottom-4 right-4 bg-black/80 text-white p-2 rounded text-xs\">\r\n            {name}: {metrics.renderTime.toFixed(2)}ms ({metrics.renderCount}{' '}\r\n            renders)\r\n          </div>\r\n        )}\r\n      </Profiler>\r\n    );\r\n  });\r\n\r\n  MonitoredComponent.displayName = `WithPerformanceMonitoring(${name})`;\r\n  return MonitoredComponent;\r\n};\r\n\r\n// Virtualized List Component\r\ninterface VirtualizedListProps<T> {\r\n  items: T[];\r\n  itemHeight: number | ((index: number) => number);\r\n  renderItem: (item: T, index: number) => ReactNode;\r\n  height: number;\r\n  width?: number;\r\n  overscanCount?: number;\r\n  className?: string;\r\n  estimateSize?: (index: number) => number;\r\n}\r\n\r\nexport const VirtualizedList = <T,>({\r\n  items,\r\n  itemHeight,\r\n  renderItem,\r\n  height,\r\n  width = 300,\r\n  overscanCount = 5,\r\n  className = '',\r\n}: VirtualizedListProps<T>) => {\r\n  const [scrollTop, setScrollTop] = useState(0);\r\n\r\n  const containerHeight = typeof height === 'number' ? height : 400;\r\n  const itemSize = typeof itemHeight === 'function' ? 50 : itemHeight;\r\n\r\n  const startIndex = Math.floor(scrollTop / itemSize);\r\n  const endIndex = Math.min(\r\n    startIndex + Math.ceil(containerHeight / itemSize) + overscanCount,\r\n    items.length\r\n  );\r\n\r\n  const visibleItems = items.slice(startIndex, endIndex);\r\n\r\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\r\n    setScrollTop(e.currentTarget.scrollTop);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={className}\r\n      style={{\r\n        height: containerHeight,\r\n        width,\r\n        overflow: 'auto',\r\n        position: 'relative',\r\n      }}\r\n      onScroll={handleScroll}\r\n    >\r\n      <div style={{ height: items.length * itemSize, position: 'relative' }}>\r\n        {visibleItems.map((item, index) => (\r\n          <div\r\n            key={startIndex + index}\r\n            style={{\r\n              position: 'absolute',\r\n              top: (startIndex + index) * itemSize,\r\n              height: itemSize,\r\n              width: '100%',\r\n            }}\r\n          >\r\n            {renderItem(item, startIndex + index)}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Expensive calculation hook\r\nexport const useExpensiveCalculation = <T,>(\r\n  calculation: () => T,\r\n  dependencies: React.DependencyList\r\n): T => {\r\n  return useMemo(calculation, dependencies);\r\n};\r\n\r\n// Stable callback hook\r\nexport const useStableCallback = <T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  dependencies: React.DependencyList\r\n): T => {\r\n  return useCallback(callback, dependencies);\r\n};\r\n\r\n// Performance optimization utilities\r\nexport const performanceUtils = {\r\n  // Debounce function for expensive operations\r\n  debounce: <T extends (...args: any[]) => any>(\r\n    func: T,\r\n    wait: number\r\n  ): ((...args: Parameters<T>) => void) => {\r\n    let timeout: NodeJS.Timeout;\r\n    return (...args: Parameters<T>) => {\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(() => func(...args), wait);\r\n    };\r\n  },\r\n\r\n  // Throttle function for frequent operations\r\n  throttle: <T extends (...args: any[]) => any>(\r\n    func: T,\r\n    limit: number\r\n  ): ((...args: Parameters<T>) => void) => {\r\n    let inThrottle: boolean;\r\n    return (...args: Parameters<T>) => {\r\n      if (!inThrottle) {\r\n        func(...args);\r\n        inThrottle = true;\r\n        setTimeout(() => (inThrottle = false), limit);\r\n      }\r\n    };\r\n  },\r\n\r\n  // Memoize expensive computations\r\n  memoize: <T extends (...args: any[]) => any>(func: T): T => {\r\n    const cache = new Map();\r\n    return ((...args: Parameters<T>) => {\r\n      const key = JSON.stringify(args);\r\n      if (cache.has(key)) {\r\n        return cache.get(key);\r\n      }\r\n      const result = func(...args);\r\n      cache.set(key, result);\r\n      return result;\r\n    }) as T;\r\n  },\r\n};\r\n\r\n// Performance Dashboard Component\r\nexport const PerformanceDashboard: React.FC = () => {\r\n  const [performanceData, setPerformanceData] =\r\n    useState<ComponentPerformanceData>({});\r\n  const [isVisible, setIsVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Listen for custom performance events\r\n    const handlePerformanceUpdate = (event: CustomEvent) => {\r\n      setPerformanceData((prev) => ({\r\n        ...prev,\r\n        [event.detail.componentName]: event.detail.metrics,\r\n      }));\r\n    };\r\n\r\n    window.addEventListener(\r\n      'performance-update',\r\n      handlePerformanceUpdate as EventListener\r\n    );\r\n\r\n    return () => {\r\n      window.removeEventListener(\r\n        'performance-update',\r\n        handlePerformanceUpdate as EventListener\r\n      );\r\n    };\r\n  }, []);\r\n\r\n  const getPerformanceGrade = (\r\n    averageTime: number\r\n  ): { grade: string; color: string } => {\r\n    if (averageTime < 10) {\r\n      return { grade: 'A', color: 'text-green-600' };\r\n    }\r\n    if (averageTime < 20) {\r\n      return { grade: 'B', color: 'text-yellow-600' };\r\n    }\r\n    if (averageTime < 50) {\r\n      return { grade: 'C', color: 'text-orange-600' };\r\n    }\r\n    return { grade: 'D', color: 'text-red-600' };\r\n  };\r\n\r\n  const totalRenders = Object.values(performanceData).reduce(\r\n    (sum, metrics) => sum + metrics.renderCount,\r\n    0\r\n  );\r\n  const averageRenderTime =\r\n    Object.values(performanceData).reduce(\r\n      (sum, metrics) => sum + metrics.averageRenderTime,\r\n      0\r\n    ) / Object.keys(performanceData).length || 0;\r\n\r\n  if (!isVisible) {\r\n    return (\r\n      <Button\r\n        onClick={() => setIsVisible(true)}\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        className=\"fixed bottom-4 right-4 z-50\"\r\n      >\r\n        <BarChart3 className=\"h-4 w-4 mr-2\" />\r\n        Performance\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className=\"fixed bottom-4 right-4 w-96 max-h-96 overflow-y-auto z-50 shadow-lg\">\r\n      <CardHeader className=\"pb-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"text-sm flex items-center gap-2\">\r\n            <Activity className=\"h-4 w-4\" />\r\n            Performance Dashboard\r\n          </CardTitle>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={() => setIsVisible(false)}\r\n            className=\"h-6 w-6 p-0\"\r\n          >\r\n            ├ù\r\n          </Button>\r\n        </div>\r\n        <CardDescription className=\"text-xs\">\r\n          Real-time component performance metrics\r\n        </CardDescription>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-3\">\r\n        {/* Summary Stats */}\r\n        <div className=\"grid grid-cols-2 gap-2\">\r\n          <div className=\"bg-slate-50 dark:bg-slate-800 p-2 rounded\">\r\n            <div className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n              Total Renders\r\n            </div>\r\n            <div className=\"text-lg font-semibold\">{totalRenders}</div>\r\n          </div>\r\n          <div className=\"bg-slate-50 dark:bg-slate-800 p-2 rounded\">\r\n            <div className=\"text-xs text-slate-600 dark:text-slate-400\">\r\n              Avg Time\r\n            </div>\r\n            <div className=\"text-lg font-semibold\">\r\n              {averageRenderTime.toFixed(1)}ms\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Component Details */}\r\n        <div className=\"space-y-2\">\r\n          {Object.entries(performanceData).map(([componentName, metrics]) => {\r\n            const grade = getPerformanceGrade(metrics.averageRenderTime);\r\n\r\n            return (\r\n              <div key={componentName} className=\"border rounded p-2\">\r\n                <div className=\"flex items-center justify-between mb-1\">\r\n                  <span className=\"text-sm font-medium truncate\">\r\n                    {componentName}\r\n                  </span>\r\n                  <Badge variant=\"outline\" className={grade.color}>\r\n                    {grade.grade}\r\n                  </Badge>\r\n                </div>\r\n                <div className=\"grid grid-cols-3 gap-1 text-xs text-slate-600 dark:text-slate-400\">\r\n                  <div>\r\n                    <div className=\"font-medium\">Renders</div>\r\n                    <div>{metrics.renderCount}</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"font-medium\">Avg</div>\r\n                    <div>{metrics.averageRenderTime.toFixed(1)}ms</div>\r\n                  </div>\r\n                  <div>\r\n                    <div className=\"font-medium\">Last</div>\r\n                    <div>{metrics.lastRenderTime.toFixed(1)}ms</div>\r\n                  </div>\r\n                </div>\r\n                {metrics.averageRenderTime > 20 && (\r\n                  <div className=\"mt-1 flex items-center gap-1 text-xs text-orange-600\">\r\n                    <AlertCircle className=\"h-3 w-3\" />\r\n                    <span>Consider optimization</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Performance Tips */}\r\n        <div className=\"border-t pt-2\">\r\n          <div className=\"text-xs text-slate-600 dark:text-slate-400 mb-1\">\r\n            Tips:\r\n          </div>\r\n          <ul className=\"text-xs space-y-1 text-slate-500 dark:text-slate-400\">\r\n            <li>ΓÇó Use React.memo for pure components</li>\r\n            <li>ΓÇó Memoize expensive calculations with useMemo</li>\r\n            <li>ΓÇó Use useCallback for stable function references</li>\r\n            <li>ΓÇó Virtualize large lists with react-window</li>\r\n            <li>ΓÇó Avoid inline objects in render props</li>\r\n          </ul>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\n// Custom hook for performance optimization\r\nexport const usePerformanceOptimization = () => {\r\n  const [metrics, setMetrics] = useState<ComponentPerformanceData>({});\r\n\r\n  const recordPerformance = useCallback(\r\n    (componentName: string, renderTime: number) => {\r\n      setMetrics((prev) => {\r\n        const existing = prev[componentName] || {\r\n          renderTime: 0,\r\n          renderCount: 0,\r\n          lastRenderTime: 0,\r\n          averageRenderTime: 0,\r\n          slowestRender: 0,\r\n          fastestRender: Infinity,\r\n        };\r\n\r\n        const newRenderCount = existing.renderCount + 1;\r\n        const totalTime =\r\n          existing.averageRenderTime * existing.renderCount + renderTime;\r\n        const newAverage = totalTime / newRenderCount;\r\n\r\n        const updated = {\r\n          renderTime,\r\n          renderCount: newRenderCount,\r\n          lastRenderTime: renderTime,\r\n          averageRenderTime: newAverage,\r\n          slowestRender: Math.max(existing.slowestRender, renderTime),\r\n          fastestRender: Math.min(existing.fastestRender, renderTime),\r\n        };\r\n\r\n        // Emit custom event for dashboard\r\n        window.dispatchEvent(\r\n          new CustomEvent('performance-update', {\r\n            detail: { componentName, metrics: updated },\r\n          })\r\n        );\r\n\r\n        return {\r\n          ...prev,\r\n          [componentName]: updated,\r\n        };\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  return { metrics, recordPerformance };\r\n};\r\n\r\nexport default {\r\n  createMemoizedComponent,\r\n  withPerformanceMonitoring,\r\n  VirtualizedList,\r\n  useExpensiveCalculation,\r\n  useStableCallback,\r\n  performanceUtils,\r\n  PerformanceDashboard,\r\n  usePerformanceOptimization,\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\profile\\UserProfile.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":178,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":178,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4790,4793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4790,4793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  User,\r\n  Key,\r\n  Clock,\r\n  CheckCircle2,\r\n  AlertCircle,\r\n  Activity,\r\n  Shield,\r\n  Calendar,\r\n} from 'lucide-react';\r\n\r\ninterface UserProfileData {\r\n  id: string;\r\n  username: string;\r\n  role: 'ADMIN' | 'LIBRARIAN' | 'STAFF';\r\n  isActive: boolean;\r\n  lastLoginAt: Date | null;\r\n  createdAt: Date;\r\n}\r\n\r\ninterface ActivityLog {\r\n  id: string;\r\n  action: string;\r\n  details: string;\r\n  timestamp: Date;\r\n}\r\n\r\nexport default function UserProfile() {\r\n  const [profile, setProfile] = useState<UserProfileData | null>(null);\r\n  const [activityLogs, setActivityLogs] = useState<ActivityLog[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [changingPassword, setChangingPassword] = useState(false);\r\n  const [passwordForm, setPasswordForm] = useState({\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: '',\r\n  });\r\n  const [message, setMessage] = useState<{\r\n    type: 'success' | 'error' | null;\r\n    text: string;\r\n  }>({ type: null, text: '' });\r\n\r\n  const showMessage = useCallback((type: 'success' | 'error', text: string) => {\r\n    setMessage({ type, text });\r\n    setTimeout(() => {\r\n      setMessage({ type: null, text: '' });\r\n    }, 5000);\r\n  }, []);\r\n\r\n  const fetchProfile = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch('/api/profile', {\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setProfile(data);\r\n      } else {\r\n        showMessage('error', 'Failed to load profile');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch profile:', error);\r\n      showMessage('error', 'Failed to load profile');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [showMessage]);\r\n\r\n  const fetchActivityLogs = useCallback(async () => {\r\n    try {\r\n      const response = await fetch('/api/profile/activity', {\r\n        credentials: 'include',\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setActivityLogs(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch activity logs:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchProfile();\r\n    fetchActivityLogs();\r\n  }, [fetchProfile, fetchActivityLogs]);\r\n\r\n  const handlePasswordChange = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    // Validation\r\n    if (!passwordForm.currentPassword || !passwordForm.newPassword) {\r\n      showMessage('error', 'All fields are required');\r\n      return;\r\n    }\r\n\r\n    if (passwordForm.newPassword.length < 6) {\r\n      showMessage('error', 'New password must be at least 6 characters');\r\n      return;\r\n    }\r\n\r\n    if (passwordForm.newPassword !== passwordForm.confirmPassword) {\r\n      showMessage('error', 'Passwords do not match');\r\n      return;\r\n    }\r\n\r\n    setChangingPassword(true);\r\n    try {\r\n      const response = await fetch('/api/profile/change-password', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include',\r\n        body: JSON.stringify({\r\n          currentPassword: passwordForm.currentPassword,\r\n          newPassword: passwordForm.newPassword,\r\n        }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        showMessage('success', 'Password changed successfully');\r\n        setPasswordForm({\r\n          currentPassword: '',\r\n          newPassword: '',\r\n          confirmPassword: '',\r\n        });\r\n      } else {\r\n        const error = await response.json();\r\n        showMessage('error', error.message || 'Failed to change password');\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to change password:', error);\r\n      showMessage('error', 'Failed to change password');\r\n    } finally {\r\n      setChangingPassword(false);\r\n    }\r\n  };\r\n\r\n  const formatDate = (date: Date | null) => {\r\n    if (!date) {\r\n      return 'Never';\r\n    }\r\n    return new Date(date).toLocaleString();\r\n  };\r\n\r\n  const getRoleBadge = (role: string) => {\r\n    const variants: Record<string, string> = {\r\n      ADMIN: 'destructive',\r\n      LIBRARIAN: 'default',\r\n      STAFF: 'secondary',\r\n    };\r\n    return (\r\n      <Badge variant={variants[role] as any}>\r\n        <Shield className=\"w-3 h-3 mr-1\" />\r\n        {role}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading profile...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (!profile) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <AlertCircle className=\"w-8 h-8 text-destructive mb-2\" />\r\n          <p className=\"text-muted-foreground\">Failed to load profile</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Messages */}\r\n      {message.type && (\r\n        <Alert variant={message.type === 'success' ? 'default' : 'destructive'}>\r\n          {message.type === 'success' ? (\r\n            <CheckCircle2 className=\"h-4 w-4\" />\r\n          ) : (\r\n            <AlertCircle className=\"h-4 w-4\" />\r\n          )}\r\n          <AlertDescription>{message.text}</AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Profile Information */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <User className=\"w-5 h-5\" />\r\n            Profile Information\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Your account details and information\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">Username</Label>\r\n              <div className=\"text-lg font-medium\">{profile.username}</div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">Role</Label>\r\n              <div>{getRoleBadge(profile.role)}</div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">Account Status</Label>\r\n              <div>\r\n                {profile.isActive ? (\r\n                  <Badge className=\"bg-green-500\">\r\n                    <CheckCircle2 className=\"w-3 h-3 mr-1\" />\r\n                    Active\r\n                  </Badge>\r\n                ) : (\r\n                  <Badge variant=\"secondary\">Inactive</Badge>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">Member Since</Label>\r\n              <div className=\"flex items-center gap-2 text-sm\">\r\n                <Calendar className=\"w-4 h-4 text-muted-foreground\" />\r\n                {formatDate(profile.createdAt)}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">Last Login</Label>\r\n              <div className=\"flex items-center gap-2 text-sm\">\r\n                <Clock className=\"w-4 h-4 text-muted-foreground\" />\r\n                {formatDate(profile.lastLoginAt)}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label className=\"text-muted-foreground\">User ID</Label>\r\n              <div className=\"text-sm font-mono text-muted-foreground\">\r\n                {profile.id}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Change Password */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Key className=\"w-5 h-5\" />\r\n            Change Password\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Update your password to keep your account secure\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <form onSubmit={handlePasswordChange} className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"currentPassword\">Current Password</Label>\r\n              <Input\r\n                id=\"currentPassword\"\r\n                type=\"password\"\r\n                value={passwordForm.currentPassword}\r\n                onChange={(e) =>\r\n                  setPasswordForm({\r\n                    ...passwordForm,\r\n                    currentPassword: e.target.value,\r\n                  })\r\n                }\r\n                disabled={changingPassword}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"newPassword\">New Password</Label>\r\n              <Input\r\n                id=\"newPassword\"\r\n                type=\"password\"\r\n                value={passwordForm.newPassword}\r\n                onChange={(e) =>\r\n                  setPasswordForm({\r\n                    ...passwordForm,\r\n                    newPassword: e.target.value,\r\n                  })\r\n                }\r\n                disabled={changingPassword}\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Minimum 6 characters\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"confirmPassword\">Confirm New Password</Label>\r\n              <Input\r\n                id=\"confirmPassword\"\r\n                type=\"password\"\r\n                value={passwordForm.confirmPassword}\r\n                onChange={(e) =>\r\n                  setPasswordForm({\r\n                    ...passwordForm,\r\n                    confirmPassword: e.target.value,\r\n                  })\r\n                }\r\n                disabled={changingPassword}\r\n              />\r\n            </div>\r\n\r\n            <Button type=\"submit\" disabled={changingPassword}>\r\n              {changingPassword ? 'Changing Password...' : 'Change Password'}\r\n            </Button>\r\n          </form>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Recent Activity */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Activity className=\"w-5 h-5\" />\r\n            Recent Activity\r\n          </CardTitle>\r\n          <CardDescription>Your recent actions in the system</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"border rounded-lg\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Action</TableHead>\r\n                  <TableHead>Details</TableHead>\r\n                  <TableHead>Timestamp</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {activityLogs.length === 0 ? (\r\n                  <TableRow>\r\n                    <TableCell\r\n                      colSpan={3}\r\n                      className=\"text-center text-muted-foreground\"\r\n                    >\r\n                      No recent activity\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ) : (\r\n                  activityLogs.map((log) => (\r\n                    <TableRow key={log.id}>\r\n                      <TableCell className=\"font-medium\">\r\n                        {log.action}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-muted-foreground\">\r\n                        {log.details}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-sm text-muted-foreground\">\r\n                        {formatDate(log.timestamp)}\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))\r\n                )}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\AdvancedSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[962,965],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[962,965],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2666,2669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2666,2669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2775,2778],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2775,2778],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3553,3556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3553,3556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3674,3677],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3674,3677],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":158,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4642,4645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4642,4645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4770,4773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4770,4773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":304,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9294,9297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9294,9297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Search,\r\n  BookOpen,\r\n  Users,\r\n  Activity,\r\n  Filter,\r\n  History as HistoryIcon,\r\n  Star,\r\n  X,\r\n  Download,\r\n} from 'lucide-react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { downloadCSV } from '@/lib/export-utils';\r\n\r\ninterface SearchResult {\r\n  type: 'book' | 'student' | 'activity';\r\n  id: string;\r\n  title: string;\r\n  subtitle: string;\r\n  metadata: any;\r\n}\r\n\r\ninterface SavedSearch {\r\n  id: string;\r\n  name: string;\r\n  query: string;\r\n  filters: SearchFilters;\r\n  createdAt: Date;\r\n}\r\n\r\ninterface SearchFilters {\r\n  type: 'all' | 'book' | 'student' | 'activity';\r\n  dateFrom?: string;\r\n  dateTo?: string;\r\n  status?: string;\r\n  category?: string;\r\n  gradeLevel?: string;\r\n}\r\n\r\nexport default function AdvancedSearch() {\r\n  const [query, setQuery] = useState('');\r\n  const [results, setResults] = useState<SearchResult[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filters, setFilters] = useState<SearchFilters>({ type: 'all' });\r\n  const [searchHistory, setSearchHistory] = useState<string[]>([]);\r\n  const [savedSearches, setSavedSearches] = useState<SavedSearch[]>([]);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Load _search history from localStorage\r\n    const history = localStorage.getItem('clms_search_history');\r\n    if (history) {\r\n      setSearchHistory(JSON.parse(history));\r\n    }\r\n\r\n    // Load saved searches\r\n    const saved = localStorage.getItem('clms_saved_searches');\r\n    if (saved) {\r\n      setSavedSearches(JSON.parse(saved));\r\n    }\r\n  }, []);\r\n\r\n  const performSearch = async () => {\r\n    if (!query.trim()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const searchResults: SearchResult[] = [];\r\n\r\n      // _Search Books\r\n      if (filters.type === 'all' || filters.type === 'book') {\r\n        const booksResponse = await apiClient.get('/api/books', {\r\n          _search: query,\r\n          category: filters.category,\r\n        });\r\n\r\n        if (booksResponse.success && booksResponse.data) {\r\n          const data = booksResponse.data as any;\r\n          const books = Array.isArray(data) ? data : data.books || [];\r\n          books.forEach((book: any) => {\r\n            if (\r\n              book.title?.toLowerCase().includes(query.toLowerCase()) ||\r\n              book.author?.toLowerCase().includes(query.toLowerCase())\r\n            ) {\r\n              searchResults.push({\r\n                type: 'book',\r\n                id: book.id,\r\n                title: book.title,\r\n                subtitle: `by ${book.author} ΓÇó ${book.category}`,\r\n                metadata: book,\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      // _Search Students\r\n      if (filters.type === 'all' || filters.type === 'student') {\r\n        const studentsResponse = await apiClient.get('/api/students');\r\n\r\n        if (studentsResponse.success && studentsResponse.data) {\r\n          const data = studentsResponse.data as any;\r\n          const students = Array.isArray(data) ? data : data.students || [];\r\n          students.forEach((student: any) => {\r\n            const fullName =\r\n              `${student.firstName} ${student.lastName}`.toLowerCase();\r\n            if (\r\n              fullName.includes(query.toLowerCase()) ||\r\n              student.studentId?.toLowerCase().includes(query.toLowerCase())\r\n            ) {\r\n              searchResults.push({\r\n                type: 'student',\r\n                id: student.id,\r\n                title: `${student.firstName} ${student.lastName}`,\r\n                subtitle: `${student.studentId} ΓÇó ${student.gradeLevel}`,\r\n                metadata: student,\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      // _Search Activities\r\n      if (filters.type === 'all' || filters.type === 'activity') {\r\n        const activitiesResponse = await apiClient.get('/api/activities', {\r\n          limit: 50,\r\n        });\r\n\r\n        if (activitiesResponse.success && activitiesResponse.data) {\r\n          const data = activitiesResponse.data as any;\r\n          const activities = Array.isArray(data) ? data : data.activities || [];\r\n          activities.forEach((activity: any) => {\r\n            if (\r\n              activity.studentName?.toLowerCase().includes(query.toLowerCase())\r\n            ) {\r\n              searchResults.push({\r\n                type: 'activity',\r\n                id: activity.id,\r\n                title: activity.studentName || 'Unknown Student',\r\n                subtitle: `${activity.activityType} ΓÇó ${new Date(activity.startTime).toLocaleDateString()}`,\r\n                metadata: activity,\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      setResults(searchResults);\r\n\r\n      // Add to _search history\r\n      const newHistory = [\r\n        query,\r\n        ...searchHistory.filter((h) => h !== query),\r\n      ].slice(0, 10);\r\n      setSearchHistory(newHistory);\r\n      localStorage.setItem('clms_search_history', JSON.stringify(newHistory));\r\n    } catch (error) {\r\n      console.error('_Search error:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const saveSearch = () => {\r\n    const name = prompt('Enter a name for this _search:');\r\n    if (!name) {\r\n      return;\r\n    }\r\n\r\n    const newSearch: SavedSearch = {\r\n      id: Date.now().toString(),\r\n      name,\r\n      query,\r\n      filters: { ...filters },\r\n      createdAt: new Date(),\r\n    };\r\n\r\n    const updated = [...savedSearches, newSearch];\r\n    setSavedSearches(updated);\r\n    localStorage.setItem('clms_saved_searches', JSON.stringify(updated));\r\n  };\r\n\r\n  const loadSavedSearch = (_search: SavedSearch) => {\r\n    setQuery(_search.query);\r\n    setFilters(_search.filters);\r\n    performSearch();\r\n  };\r\n\r\n  const deleteSavedSearch = (id: string) => {\r\n    const updated = savedSearches.filter((s) => s.id !== id);\r\n    setSavedSearches(updated);\r\n    localStorage.setItem('clms_saved_searches', JSON.stringify(updated));\r\n  };\r\n\r\n  const clearHistory = () => {\r\n    setSearchHistory([]);\r\n    localStorage.removeItem('clms_search_history');\r\n  };\r\n\r\n  const exportResults = () => {\r\n    const data = results.map((r) => ({\r\n      Type: r.type,\r\n      Title: r.title,\r\n      Details: r.subtitle,\r\n    }));\r\n    downloadCSV(\r\n      data,\r\n      `_search-results-${new Date().toISOString().split('T')[0]}`\r\n    );\r\n  };\r\n\r\n  const getResultIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'book':\r\n        return <BookOpen className=\"w-4 h-4 text-blue-500\" />;\r\n      case 'student':\r\n        return <Users className=\"w-4 h-4 text-green-500\" />;\r\n      case 'activity':\r\n        return <Activity className=\"w-4 h-4 text-purple-500\" />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Search className=\"w-5 h-5\" />\r\n            Advanced _Search\r\n          </CardTitle>\r\n          <CardDescription>\r\n            _Search across books, students, and activities\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* _Search Bar */}\r\n          <div className=\"flex gap-2\">\r\n            <div className=\"flex-1 relative\">\r\n              <Search className=\"absolute left-3 top-3 w-4 h-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"_Search for books, students, or activities...\"\r\n                value={query}\r\n                onChange={(e) => setQuery(e.target.value)}\r\n                onKeyPress={(e) => e.key === 'Enter' && performSearch()}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n            <Button onClick={performSearch} disabled={loading}>\r\n              {loading ? 'Searching...' : '_Search'}\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setShowFilters(!showFilters)}\r\n            >\r\n              <Filter className=\"w-4 h-4 mr-2\" />\r\n              Filters\r\n            </Button>\r\n            {results.length > 0 && (\r\n              <Button variant=\"outline\" onClick={exportResults}>\r\n                <Download className=\"w-4 h-4 mr-2\" />\r\n                Export\r\n              </Button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          {showFilters && (\r\n            <Card className=\"p-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-4\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Type</label>\r\n                  <Select\r\n                    value={filters.type}\r\n                    onValueChange={(value: any) =>\r\n                      setFilters({ ...filters, type: value })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"all\">All</SelectItem>\r\n                      <SelectItem value=\"book\">Books</SelectItem>\r\n                      <SelectItem value=\"student\">Students</SelectItem>\r\n                      <SelectItem value=\"activity\">Activities</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Date From</label>\r\n                  <Input\r\n                    type=\"date\"\r\n                    value={filters.dateFrom || ''}\r\n                    onChange={(e) =>\r\n                      setFilters({ ...filters, dateFrom: e.target.value })\r\n                    }\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Date To</label>\r\n                  <Input\r\n                    type=\"date\"\r\n                    value={filters.dateTo || ''}\r\n                    onChange={(e) =>\r\n                      setFilters({ ...filters, dateTo: e.target.value })\r\n                    }\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Actions</label>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => setFilters({ type: 'all' })}\r\n                    >\r\n                      Clear\r\n                    </Button>\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={saveSearch}>\r\n                      <Star className=\"w-4 h-4 mr-1\" />\r\n                      Save\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Results and History Tabs */}\r\n      <Tabs defaultValue=\"results\" className=\"space-y-4\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"results\">Results ({results.length})</TabsTrigger>\r\n          <TabsTrigger value=\"history\">\r\n            <HistoryIcon className=\"w-4 h-4 mr-2\" />\r\n            History\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"saved\">\r\n            <Star className=\"w-4 h-4 mr-2\" />\r\n            Saved Searches\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"results\">\r\n          {results.length > 0 ? (\r\n            <Card>\r\n              <CardContent className=\"p-0\">\r\n                <Table>\r\n                  <TableHeader>\r\n                    <TableRow>\r\n                      <TableHead className=\"w-12\">Type</TableHead>\r\n                      <TableHead>Title</TableHead>\r\n                      <TableHead>Details</TableHead>\r\n                      <TableHead className=\"w-24\">Actions</TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {results.map((result) => (\r\n                      <TableRow key={`${result.type}-${result.id}`}>\r\n                        <TableCell>{getResultIcon(result.type)}</TableCell>\r\n                        <TableCell className=\"font-medium\">\r\n                          {result.title}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-muted-foreground\">\r\n                          {result.subtitle}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            View\r\n                          </Button>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </CardContent>\r\n            </Card>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"flex items-center justify-center h-32\">\r\n                <p className=\"text-muted-foreground\">\r\n                  {query\r\n                    ? 'No results found'\r\n                    : 'Enter a _search query to begin'}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"history\">\r\n          <Card>\r\n            <CardHeader>\r\n              <div className=\"flex items-center justify-between\">\r\n                <CardTitle>Recent Searches</CardTitle>\r\n                {searchHistory.length > 0 && (\r\n                  <Button variant=\"ghost\" size=\"sm\" onClick={clearHistory}>\r\n                    Clear All\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {searchHistory.length > 0 ? (\r\n                <div className=\"space-y-2\">\r\n                  {searchHistory.map((term, index) => (\r\n                    <div\r\n                      key={index}\r\n                      className=\"flex items-center justify-between p-2 border rounded hover:bg-accent cursor-pointer\"\r\n                      onClick={() => {\r\n                        setQuery(term);\r\n                        performSearch();\r\n                      }}\r\n                    >\r\n                      <span className=\"text-sm\">{term}</span>\r\n                      <HistoryIcon className=\"w-4 h-4 text-muted-foreground\" />\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                  No _search history\r\n                </p>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"saved\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Saved Searches</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {savedSearches.length > 0 ? (\r\n                <div className=\"space-y-2\">\r\n                  {savedSearches.map((_search) => (\r\n                    <div\r\n                      key={_search.id}\r\n                      className=\"flex items-center justify-between p-3 border rounded\"\r\n                    >\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"font-medium\">{_search.name}</div>\r\n                        <div className=\"text-sm text-muted-foreground\">\r\n                          {_search.query} ΓÇó {_search.filters.type}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex gap-2\">\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => loadSavedSearch(_search)}\r\n                        >\r\n                          Load\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => deleteSavedSearch(_search.id)}\r\n                        >\r\n                          <X className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                  No saved searches\r\n                </p>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\AdvancedStudentSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1332,1335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1332,1335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":593,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":593,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18233,18236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18233,18236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":613,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":613,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19129,19132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19129,19132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":638,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":638,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[20116,20119],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[20116,20119],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":674,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":674,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21767,21770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21767,21770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Search,\r\n  Users,\r\n  Filter,\r\n  X,\r\n  Download,\r\n  BookOpen,\r\n  Monitor,\r\n  AlertTriangle,\r\n  Calendar,\r\n  ChevronDown,\r\n  UserCheck,\r\n  UserX,\r\n} from 'lucide-react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n\r\ninterface Student {\r\n  id: string;\r\n  student_id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  fullName: string;\r\n  grade_category: string;\r\n  grade_level: string;\r\n  section?: string;\r\n  is_active: boolean;\r\n  fine_balance: number;\r\n  equipment_ban: boolean;\r\n  equipment_ban_reason?: string;\r\n  equipment_ban_until?: string;\r\n  activeCheckouts: number;\r\n  overdueCheckouts: number;\r\n  totalActivities: number;\r\n  lastActivityDate?: string;\r\n  lastCheckoutDate?: string;\r\n  currentEquipmentSession?: any;\r\n  hasOverdueItems: boolean;\r\n  equipmentBanStatus: {\r\n    isBanned: boolean;\r\n    reason?: string;\r\n    until?: string;\r\n  };\r\n}\r\n\r\ninterface StudentSearchOptions {\r\n  query?: string;\r\n  gradeCategory?: string;\r\n  gradeLevel?: string;\r\n  isActive?: boolean;\r\n  hasEquipmentBan?: boolean;\r\n  hasFines?: boolean;\r\n  activityType?: string;\r\n  dateFrom?: string;\r\n  dateTo?: string;\r\n  sortBy?:\r\n    | 'name'\r\n    | 'gradeLevel'\r\n    | 'lastActivity'\r\n    | 'fineBalance'\r\n    | 'checkoutCount';\r\n  sortOrder?: 'asc' | 'desc';\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\ninterface StudentSearchResult {\r\n  students: Student[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n  filters: StudentSearchOptions;\r\n  sortBy: string;\r\n  sortOrder: string;\r\n}\r\n\r\ninterface StudentSuggestion {\r\n  names: string[];\r\n  studentIds: string[];\r\n  grades: string[];\r\n}\r\n\r\nexport default function AdvancedStudentSearch() {\r\n  const [query, setQuery] = useState('');\r\n  const [suggestions, setSuggestions] = useState<StudentSuggestion>({\r\n    names: [],\r\n    studentIds: [],\r\n    grades: [],\r\n  });\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [searchResults, setSearchResults] =\r\n    useState<StudentSearchResult | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filters, setFilters] = useState<StudentSearchOptions>({\r\n    sortBy: 'name',\r\n    sortOrder: 'asc',\r\n    isActive: true,\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [selectedStudents, setSelectedStudents] = useState<string[]>([]);\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const suggestionTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  // Fetch suggestions with debouncing\r\n  const fetchSuggestions = useCallback(async (searchQuery: string) => {\r\n    if (searchQuery.length < 2) {\r\n      setSuggestions({ names: [], studentIds: [], grades: [] });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await apiClient.get(\r\n        '/api/_search/students/suggestions',\r\n        {\r\n          params: {\r\n            query: searchQuery,\r\n            limit: 5,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setSuggestions(response.data as StudentSuggestion);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch student suggestions:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Debounced _search input handler\r\n  const handleSearchInput = (value: string) => {\r\n    setQuery(value);\r\n    setCurrentPage(1);\r\n\r\n    // Clear existing timeout\r\n    if (suggestionTimeoutRef.current) {\r\n      clearTimeout(suggestionTimeoutRef.current);\r\n    }\r\n\r\n    // Set new timeout for suggestions\r\n    suggestionTimeoutRef.current = setTimeout(() => {\r\n      fetchSuggestions(value);\r\n    }, 300);\r\n\r\n    if (value.length >= 2) {\r\n      setShowSuggestions(true);\r\n    } else {\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  // Enhanced student _search function\r\n  const performSearch = async (page = 1, resetPagination = true) => {\r\n    if (\r\n      !query.trim() &&\r\n      !Object.keys(filters).some(\r\n        (key) =>\r\n          filters[key as keyof StudentSearchOptions] !== undefined &&\r\n          filters[key as keyof StudentSearchOptions] !== ''\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Build query params\r\n      const searchParams: Record<string, unknown> = {\r\n        page,\r\n        limit: 20,\r\n      };\r\n\r\n      // Add filters to _search params\r\n      if (query) {\r\n        searchParams.query = query;\r\n      }\r\n      if (filters.gradeCategory) {\r\n        searchParams.gradeCategory = filters.gradeCategory;\r\n      }\r\n      if (filters.gradeLevel) {\r\n        searchParams.gradeLevel = filters.gradeLevel;\r\n      }\r\n      if (filters.isActive !== undefined) {\r\n        searchParams.isActive = filters.isActive;\r\n      }\r\n      if (filters.hasEquipmentBan !== undefined) {\r\n        searchParams.hasEquipmentBan = filters.hasEquipmentBan;\r\n      }\r\n      if (filters.hasFines !== undefined) {\r\n        searchParams.hasFines = filters.hasFines;\r\n      }\r\n      if (filters.activityType) {\r\n        searchParams.activityType = filters.activityType;\r\n      }\r\n      if (filters.dateFrom) {\r\n        searchParams.dateFrom = filters.dateFrom;\r\n      }\r\n      if (filters.dateTo) {\r\n        searchParams.dateTo = filters.dateTo;\r\n      }\r\n      if (filters.sortBy) {\r\n        searchParams.sortBy = filters.sortBy;\r\n      }\r\n      if (filters.sortOrder) {\r\n        searchParams.sortOrder = filters.sortOrder;\r\n      }\r\n\r\n      const response = await apiClient.get('/api/_search/students', {\r\n        params: searchParams,\r\n      });\r\n\r\n      if (response.success && response.data) {\r\n        const data = response.data as StudentSearchResult;\r\n        if (resetPagination) {\r\n          setSearchResults(data);\r\n        } else {\r\n          // Append results for pagination\r\n          setSearchResults((prev) => ({\r\n            ...data,\r\n            students: [...(prev?.students || []), ...data.students],\r\n          }));\r\n        }\r\n        setCurrentPage(page);\r\n      }\r\n    } catch (error) {\r\n      console.error('Student _search error:', error);\r\n      toast.error('Failed to perform student _search');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Load more results (pagination)\r\n  const loadMore = () => {\r\n    if (searchResults && currentPage < searchResults.pagination.pages) {\r\n      performSearch(currentPage + 1, false);\r\n    }\r\n  };\r\n\r\n  // Clear all filters\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      sortBy: 'name',\r\n      sortOrder: 'asc',\r\n      isActive: true,\r\n    });\r\n    setQuery('');\r\n    setCurrentPage(1);\r\n    setSearchResults(null);\r\n    setShowSuggestions(false);\r\n  };\r\n\r\n  // Apply suggestion\r\n  const applySuggestion = (\r\n    type: 'name' | 'studentId' | 'grade',\r\n    value: string\r\n  ) => {\r\n    setQuery(value);\r\n    setShowSuggestions(false);\r\n\r\n    // Update filters based on suggestion type\r\n    if (type === 'studentId') {\r\n      // Student ID _search is more specific\r\n      setFilters({ ...filters, query: value });\r\n    } else if (type === 'grade') {\r\n      setFilters({ ...filters, gradeLevel: value });\r\n    }\r\n\r\n    setCurrentPage(1);\r\n    performSearch();\r\n  };\r\n\r\n  // Toggle student selection\r\n  const toggleStudentSelection = (studentId: string) => {\r\n    setSelectedStudents((prev) =>\r\n      prev.includes(studentId)\r\n        ? prev.filter((id) => id !== studentId)\r\n        : [...prev, studentId]\r\n    );\r\n  };\r\n\r\n  // Export results\r\n  const exportResults = () => {\r\n    if (!searchResults || searchResults.students.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const data = searchResults.students.map((student) => ({\r\n      'Student ID': student.student_id,\r\n      Name: student.fullName,\r\n      Grade: student.grade_level,\r\n      Section: student.section || '',\r\n      Status: student.is_active ? 'Active' : 'Inactive',\r\n      'Fine Balance': student.fine_balance,\r\n      'Active Checkouts': student.activeCheckouts,\r\n      'Overdue Items': student.overdueCheckouts,\r\n      'Equipment Ban': student.equipment_ban ? 'Yes' : 'No',\r\n      'Last Activity': student.lastActivityDate || 'Never',\r\n    }));\r\n\r\n    if (data.length === 0) {\r\n      throw new Error('No data to export');\r\n    }\r\n\r\n    const csv = [\r\n      Object.keys(data[0]).join(','),\r\n      ...data.map((row) =>\r\n        Object.values(row)\r\n          .map((v) => `\"${v}\"`)\r\n          .join(',')\r\n      ),\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `student-_search-results-${new Date().toISOString().split('T')[0]}.csv`;\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Student status badges\r\n  const getStatusBadges = (student: Student) => {\r\n    const badges = [];\r\n\r\n    if (!student.is_active) {\r\n      badges.push(\r\n        <Badge key=\"inactive\" variant=\"secondary\">\r\n          Inactive\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    if (student.equipment_ban) {\r\n      badges.push(\r\n        <Badge key=\"ban\" variant=\"destructive\">\r\n          <AlertTriangle className=\"w-3 h-3 mr-1\" />\r\n          Equipment Ban\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    if (student.hasOverdueItems) {\r\n      badges.push(\r\n        <Badge key=\"overdue\" variant=\"destructive\">\r\n          <AlertTriangle className=\"w-3 h-3 mr-1\" />\r\n          Overdue Items\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    if (student.fine_balance > 0) {\r\n      badges.push(\r\n        <Badge key=\"fines\" variant=\"outline\">\r\n          ${student.fine_balance.toFixed(2)} Fines\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    if (student.activeCheckouts > 0) {\r\n      badges.push(\r\n        <Badge key=\"checkouts\" variant=\"default\">\r\n          <BookOpen className=\"w-3 h-3 mr-1\" />\r\n          {student.activeCheckouts} Active\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    if (student.currentEquipmentSession) {\r\n      badges.push(\r\n        <Badge key=\"session\" variant=\"default\">\r\n          <Monitor className=\"w-3 h-3 mr-1\" />\r\n          In Session\r\n        </Badge>\r\n      );\r\n    }\r\n\r\n    return badges;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* _Search Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Users className=\"w-5 h-5\" />\r\n            Advanced Student _Search\r\n          </CardTitle>\r\n          <CardDescription>\r\n            _Search and filter students by various criteria including grade,\r\n            activity, and status\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* _Search Bar with Suggestions */}\r\n          <div className=\"relative\">\r\n            <div className=\"flex gap-2\">\r\n              <div className=\"flex-1 relative\">\r\n                <Search className=\"absolute left-3 top-3 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  ref={searchInputRef}\r\n                  placeholder=\"_Search by name, student ID, or grade...\"\r\n                  value={query}\r\n                  onChange={(e) => handleSearchInput(e.target.value)}\r\n                  onFocus={() => query.length >= 2 && setShowSuggestions(true)}\r\n                  onBlur={() =>\r\n                    setTimeout(() => setShowSuggestions(false), 200)\r\n                  }\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === 'Enter') {\r\n                      setShowSuggestions(false);\r\n                      performSearch();\r\n                    }\r\n                  }}\r\n                  className=\"pl-10\"\r\n                />\r\n\r\n                {/* Suggestions Dropdown */}\r\n                {showSuggestions &&\r\n                  (suggestions.names.length > 0 ||\r\n                    suggestions.studentIds.length > 0 ||\r\n                    suggestions.grades.length > 0) && (\r\n                    <div className=\"absolute top-full left-0 right-0 z-50 mt-1 bg-background border rounded-md shadow-lg\">\r\n                      <div className=\"p-2 space-y-2\">\r\n                        {suggestions.names.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Names\r\n                            </div>\r\n                            {suggestions.names.map((name, index) => (\r\n                              <div\r\n                                key={`name-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() => applySuggestion('name', name)}\r\n                              >\r\n                                <Users className=\"w-3 h-3 mr-2 inline\" />\r\n                                {name}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.studentIds.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Student IDs\r\n                            </div>\r\n                            {suggestions.studentIds.map((studentId, index) => (\r\n                              <div\r\n                                key={`id-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() =>\r\n                                  applySuggestion('studentId', studentId)\r\n                                }\r\n                              >\r\n                                <Users className=\"w-3 h-3 mr-2 inline\" />\r\n                                {studentId}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.grades.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Grades\r\n                            </div>\r\n                            {suggestions.grades.map((grade, index) => (\r\n                              <div\r\n                                key={`grade-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() => applySuggestion('grade', grade)}\r\n                              >\r\n                                <Users className=\"w-3 h-3 mr-2 inline\" />\r\n                                {grade}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n              </div>\r\n\r\n              <Button onClick={() => performSearch()} disabled={loading}>\r\n                {loading ? 'Searching...' : '_Search'}\r\n              </Button>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setShowFilters(!showFilters)}\r\n              >\r\n                <Filter className=\"w-4 h-4 mr-2\" />\r\n                Filters\r\n                {(filters.gradeCategory ||\r\n                  filters.gradeLevel ||\r\n                  filters.hasEquipmentBan ||\r\n                  filters.hasFines) && <ChevronDown className=\"w-4 h-4 ml-2\" />}\r\n              </Button>\r\n\r\n              {searchResults && searchResults.students.length > 0 && (\r\n                <Button variant=\"outline\" onClick={exportResults}>\r\n                  <Download className=\"w-4 h-4 mr-2\" />\r\n                  Export\r\n                </Button>\r\n              )}\r\n            </div>\r\n\r\n            {/* Quick Filters */}\r\n            <div className=\"flex gap-2 flex-wrap\">\r\n              <Button\r\n                variant={filters.isActive ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({ ...filters, isActive: !filters.isActive });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                {filters.isActive ? (\r\n                  <UserCheck className=\"w-3 h-3 mr-1\" />\r\n                ) : (\r\n                  <UserX className=\"w-3 h-3 mr-1\" />\r\n                )}\r\n                {filters.isActive ? 'Active' : 'Inactive'} Only\r\n              </Button>\r\n\r\n              <Button\r\n                variant={filters.hasEquipmentBan ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({\r\n                    ...filters,\r\n                    hasEquipmentBan: !filters.hasEquipmentBan,\r\n                  });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <AlertTriangle className=\"w-3 h-3 mr-1\" />\r\n                Equipment Ban\r\n              </Button>\r\n\r\n              <Button\r\n                variant={filters.hasFines ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({ ...filters, hasFines: !filters.hasFines });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                $ Fines\r\n              </Button>\r\n\r\n              <Select\r\n                value={filters.sortBy ?? 'name'}\r\n                onValueChange={(value: any) => {\r\n                  setFilters({ ...filters, sortBy: value });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-32\">\r\n                  <SelectValue placeholder=\"Sort by\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"name\">Name</SelectItem>\r\n                  <SelectItem value=\"gradeLevel\">Grade</SelectItem>\r\n                  <SelectItem value=\"lastActivity\">Last Activity</SelectItem>\r\n                  <SelectItem value=\"fineBalance\">Fine Balance</SelectItem>\r\n                  <SelectItem value=\"checkoutCount\">Checkouts</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select\r\n                value={filters.sortOrder ?? 'asc'}\r\n                onValueChange={(value: any) => {\r\n                  setFilters({ ...filters, sortOrder: value });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-24\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"asc\">A-Z</SelectItem>\r\n                  <SelectItem value=\"desc\">Z-A</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Advanced Filters */}\r\n          {showFilters && (\r\n            <Card className=\"p-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-3 lg:grid-cols-5\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Grade Category</label>\r\n                  <Select\r\n                    value={filters.gradeCategory || ''}\r\n                    onValueChange={(value: any) => {\r\n                      setFilters({ ...filters, gradeCategory: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Categories\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Categories</SelectItem>\r\n                      <SelectItem value=\"PRIMARY\">Primary</SelectItem>\r\n                      <SelectItem value=\"GRADE_SCHOOL\">Grade School</SelectItem>\r\n                      <SelectItem value=\"JUNIOR_HIGH\">Junior High</SelectItem>\r\n                      <SelectItem value=\"SENIOR_HIGH\">Senior High</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Grade Level</label>\r\n                  <Input\r\n                    placeholder=\"Filter by grade...\"\r\n                    value={filters.gradeLevel || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, gradeLevel: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Activity Type</label>\r\n                  <Select\r\n                    value={filters.activityType || ''}\r\n                    onValueChange={(value: any) => {\r\n                      setFilters({ ...filters, activityType: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Activities\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Activities</SelectItem>\r\n                      <SelectItem value=\"COMPUTER_USE\">Computer Use</SelectItem>\r\n                      <SelectItem value=\"GAMING_SESSION\">Gaming</SelectItem>\r\n                      <SelectItem value=\"AVR_SESSION\">AVR</SelectItem>\r\n                      <SelectItem value=\"BOOK_CHECKOUT\">\r\n                        Book Checkout\r\n                      </SelectItem>\r\n                      <SelectItem value=\"GENERAL_VISIT\">\r\n                        General Visit\r\n                      </SelectItem>\r\n                      <SelectItem value=\"STUDY\">Study</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Date From</label>\r\n                  <Input\r\n                    type=\"date\"\r\n                    value={filters.dateFrom || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, dateFrom: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Date To</label>\r\n                  <Input\r\n                    type=\"date\"\r\n                    value={filters.dateTo || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, dateTo: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2 md:col-span-3 lg:col-span-5\">\r\n                  <label className=\"text-sm font-medium\">Actions</label>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                      <X className=\"w-4 h-4 mr-1\" />\r\n                      Clear All\r\n                    </Button>\r\n                    {selectedStudents.length > 0 && (\r\n                      <Badge variant=\"outline\">\r\n                        {selectedStudents.length} selected\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* _Search Results */}\r\n      {searchResults && (\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <CardTitle>Student _Search Results</CardTitle>\r\n                <CardDescription>\r\n                  Found {searchResults.pagination.total} students\r\n                  {query && ` for \"${query}\"`}\r\n                  {filters.gradeLevel && ` in grade ${filters.gradeLevel}`}\r\n                </CardDescription>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                {searchResults.pagination.total > 20 && (\r\n                  <Badge variant=\"outline\">\r\n                    Page {searchResults.pagination.page} of{' '}\r\n                    {searchResults.pagination.pages}\r\n                  </Badge>\r\n                )}\r\n                <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                  <X className=\"w-4 h-4 mr-1\" />\r\n                  Clear\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"p-0\">\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead className=\"w-12\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={\r\n                          selectedStudents.length ===\r\n                          searchResults.students.length\r\n                        }\r\n                        onChange={(e) => {\r\n                          if (e.target.checked) {\r\n                            setSelectedStudents(\r\n                              searchResults.students.map((s) => s.id)\r\n                            );\r\n                          } else {\r\n                            setSelectedStudents([]);\r\n                          }\r\n                        }}\r\n                      />\r\n                    </TableHead>\r\n                    <TableHead>Name</TableHead>\r\n                    <TableHead>Student ID</TableHead>\r\n                    <TableHead>Grade</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead>Fines</TableHead>\r\n                    <TableHead>Checkouts</TableHead>\r\n                    <TableHead>Activity</TableHead>\r\n                    <TableHead className=\"w-24\">Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {searchResults.students.map((student) => (\r\n                    <TableRow key={student.id}>\r\n                      <TableCell>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedStudents.includes(student.id)}\r\n                          onChange={() => toggleStudentSelection(student.id)}\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        {student.fullName}\r\n                      </TableCell>\r\n                      <TableCell>{student.student_id}</TableCell>\r\n                      <TableCell>\r\n                        <div>\r\n                          <div className=\"font-medium\">\r\n                            {student.grade_level}\r\n                          </div>\r\n                          {student.section && (\r\n                            <div className=\"text-sm text-muted-foreground\">\r\n                              {student.section}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"space-y-1\">\r\n                          {student.is_active ? (\r\n                            <Badge variant=\"default\">Active</Badge>\r\n                          ) : (\r\n                            <Badge variant=\"secondary\">Inactive</Badge>\r\n                          )}\r\n                          {student.currentEquipmentSession && (\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              <Monitor className=\"w-3 h-3 mr-1\" />\r\n                              In Session\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {student.fine_balance > 0 ? (\r\n                          <Badge variant=\"destructive\">\r\n                            ${student.fine_balance.toFixed(2)}\r\n                          </Badge>\r\n                        ) : (\r\n                          <span className=\"text-muted-foreground\">-</span>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div>\r\n                          <div>{student.activeCheckouts} active</div>\r\n                          {student.overdueCheckouts > 0 && (\r\n                            <div className=\"text-xs text-destructive\">\r\n                              {student.overdueCheckouts} overdue\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"space-y-1\">\r\n                          {student.lastActivityDate && (\r\n                            <div className=\"text-xs text-muted-foreground\">\r\n                              <Calendar className=\"w-3 h-3 inline mr-1\" />\r\n                              {new Date(\r\n                                student.lastActivityDate\r\n                              ).toLocaleDateString()}\r\n                            </div>\r\n                          )}\r\n                          <div className=\"flex gap-1 flex-wrap\">\r\n                            {getStatusBadges(student)}\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex gap-1\">\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            View\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n\r\n            {/* Load More Button */}\r\n            {searchResults.pagination.page < searchResults.pagination.pages && (\r\n              <div className=\"flex justify-center mt-6 p-4\">\r\n                <Button onClick={loadMore} disabled={loading} variant=\"outline\">\r\n                  {loading ? 'Loading...' : 'Load More'}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {!searchResults && (\r\n        <Card>\r\n          <CardContent className=\"flex items-center justify-center h-32\">\r\n            <p className=\"text-muted-foreground\">\r\n              {query ? 'No results found' : 'Enter a _search query to begin'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\EnhancedBookSearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1097,1100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1097,1100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":596,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":596,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18008,18011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18008,18011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":617,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":617,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18950,18953],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18950,18953],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":642,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":642,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19926,19929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19926,19929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":701,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":701,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22371,22374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22371,22374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Search,\r\n  BookOpen,\r\n  Filter,\r\n  X,\r\n  TrendingUp,\r\n  Star,\r\n  ChevronDown,\r\n  Eye,\r\n  Users,\r\n  Sparkles,\r\n} from 'lucide-react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n\r\ninterface Book {\r\n  id: string;\r\n  accession_no: string;\r\n  isbn?: string;\r\n  title: string;\r\n  author: string;\r\n  publisher?: string;\r\n  category: string;\r\n  subcategory?: string;\r\n  location?: string;\r\n  total_copies: number;\r\n  available_copies: number;\r\n  is_active: boolean;\r\n  coverUrl?: string;\r\n  popularityScore?: number;\r\n  isAvailable?: boolean;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n  book_checkouts?: any[];\r\n}\r\n\r\ninterface EnhancedBookSearchProps {\r\n  onNavigateToDetails?: (bookId: string) => void;\r\n}\r\n\r\ninterface SearchFilters {\r\n  query?: string;\r\n  category?: string;\r\n  subcategory?: string;\r\n  author?: string;\r\n  publisher?: string;\r\n  location?: string;\r\n  availableOnly?: boolean;\r\n  readingLevel?: string;\r\n  sortBy?:\r\n    | 'title'\r\n    | 'author'\r\n    | 'category'\r\n    | 'popularity'\r\n    | 'newest'\r\n    | 'available';\r\n  sortOrder?: 'asc' | 'desc';\r\n  includeCovers?: boolean;\r\n}\r\n\r\ninterface SearchResponse {\r\n  books: Book[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n  filters: SearchFilters;\r\n  sortBy: string;\r\n  sortOrder: string;\r\n}\r\n\r\ninterface SearchSuggestion {\r\n  titles: string[];\r\n  authors: string[];\r\n  categories: string[];\r\n}\r\n\r\ninterface Recommendation {\r\n  id: string;\r\n  title: string;\r\n  author: string;\r\n  category: string;\r\n  coverUrl?: string;\r\n  popularityScore?: number;\r\n  isAvailable?: boolean;\r\n  recommendationReason?: string;\r\n}\r\n\r\ninterface PopularBooks {\r\n  books: Book[];\r\n}\r\n\r\nexport default function EnhancedBookSearch({\r\n  onNavigateToDetails,\r\n}: EnhancedBookSearchProps = {}) {\r\n  const [query, setQuery] = useState('');\r\n  const [suggestions, setSuggestions] = useState<SearchSuggestion>({\r\n    titles: [],\r\n    authors: [],\r\n    categories: [],\r\n  });\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [searchResults, setSearchResults] = useState<SearchResponse | null>(\r\n    null\r\n  );\r\n  const [popularBooks, setPopularBooks] = useState<Book[]>([]);\r\n  const [newBooks, setNewBooks] = useState<Book[]>([]);\r\n  const [availableBooks, setAvailableBooks] = useState<Book[]>([]);\r\n  const [recommendations, setRecommendations] = useState<Recommendation[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filters, setFilters] = useState<SearchFilters>({\r\n    sortBy: 'title',\r\n    sortOrder: 'asc',\r\n    includeCovers: true,\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const suggestionTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  // Fetch popular books\r\n  const fetchPopularBooks = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.get<PopularBooks>(\r\n        '/api/_search/popular',\r\n        { limit: 8 }\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setPopularBooks(response.data.books);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch popular books:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch new books\r\n  const fetchNewBooks = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.get<PopularBooks>('/api/_search/new', {\r\n        limit: 8,\r\n      });\r\n\r\n      if (response.success && response.data) {\r\n        setNewBooks(response.data.books);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch new books:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch available books\r\n  const fetchAvailableBooks = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.get<PopularBooks>(\r\n        '/api/_search/available',\r\n        { limit: 8 }\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setAvailableBooks(response.data.books);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch available books:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Fetch popular books on mount\r\n  useEffect(() => {\r\n    fetchPopularBooks();\r\n    fetchNewBooks();\r\n    fetchAvailableBooks();\r\n  }, [fetchPopularBooks, fetchNewBooks, fetchAvailableBooks]);\r\n\r\n  // Fetch suggestions with debouncing\r\n  const fetchSuggestions = useCallback(async (searchQuery: string) => {\r\n    if (searchQuery.length < 2) {\r\n      setSuggestions({ titles: [], authors: [], categories: [] });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await apiClient.get<SearchSuggestion>(\r\n        '/api/_search/suggestions',\r\n        {\r\n          query: searchQuery,\r\n          limit: 5,\r\n          type: 'all',\r\n        }\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setSuggestions(response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch suggestions:', error);\r\n      // Don't show error toast for suggestions\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Debounced _search input handler\r\n  const handleSearchInput = (value: string) => {\r\n    setQuery(value);\r\n    setCurrentPage(1);\r\n\r\n    // Clear existing timeout\r\n    if (suggestionTimeoutRef.current) {\r\n      clearTimeout(suggestionTimeoutRef.current);\r\n    }\r\n\r\n    // Set new timeout for suggestions\r\n    suggestionTimeoutRef.current = setTimeout(() => {\r\n      fetchSuggestions(value);\r\n    }, 300);\r\n\r\n    if (value.length >= 2) {\r\n      setShowSuggestions(true);\r\n    } else {\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  // Enhanced _search function\r\n  const performSearch = async (page = 1, resetPagination = true) => {\r\n    if (\r\n      !query.trim() &&\r\n      !Object.keys(filters).some((key) => filters[key as keyof SearchFilters])\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Build query params\r\n      const searchParams: Record<string, unknown> = {\r\n        page,\r\n        limit: 20,\r\n        includeCovers: filters.includeCovers,\r\n      };\r\n\r\n      // Add filters to _search params\r\n      if (query) {\r\n        searchParams.query = query;\r\n      }\r\n      if (filters.category) {\r\n        searchParams.category = filters.category;\r\n      }\r\n      if (filters.subcategory) {\r\n        searchParams.subcategory = filters.subcategory;\r\n      }\r\n      if (filters.author) {\r\n        searchParams.author = filters.author;\r\n      }\r\n      if (filters.publisher) {\r\n        searchParams.publisher = filters.publisher;\r\n      }\r\n      if (filters.location) {\r\n        searchParams.location = filters.location;\r\n      }\r\n      if (filters.availableOnly) {\r\n        searchParams.availableOnly = filters.availableOnly;\r\n      }\r\n      if (filters.readingLevel) {\r\n        searchParams.readingLevel = filters.readingLevel;\r\n      }\r\n      if (filters.sortBy) {\r\n        searchParams.sortBy = filters.sortBy;\r\n      }\r\n      if (filters.sortOrder) {\r\n        searchParams.sortOrder = filters.sortOrder;\r\n      }\r\n\r\n      const response = await apiClient.get<SearchResponse>(\r\n        '/api/_search/books',\r\n        searchParams\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        if (resetPagination) {\r\n          setSearchResults(response.data);\r\n        } else {\r\n          // Append results for pagination\r\n          setSearchResults((prev) => {\r\n            if (!prev || !response.data) {\r\n              return prev;\r\n            }\r\n            return {\r\n              ...response.data,\r\n              books: [...prev.books, ...response.data.books],\r\n            };\r\n          });\r\n        }\r\n        setCurrentPage(page);\r\n\r\n        // Fetch recommendations based on first book in results\r\n        if (response.data.books.length > 0 && !recommendations.length) {\r\n          fetchRecommendations(response.data.books[0]);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('_Search error:', error);\r\n      toast.error('Failed to perform _search');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fetch recommendations\r\n  const fetchRecommendations = async (book?: Book) => {\r\n    if (!book) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const params: Record<string, unknown> = { limit: 8 };\r\n      if (book.category) {\r\n        params.category = book.category;\r\n      }\r\n      if (book.author) {\r\n        params.author = book.author;\r\n      }\r\n\r\n      const response = await apiClient.get<Recommendation[]>(\r\n        '/api/_search/recommendations',\r\n        params\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setRecommendations(response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch recommendations:', error);\r\n    }\r\n  };\r\n\r\n  // Load more results (pagination)\r\n  const loadMore = () => {\r\n    if (searchResults && currentPage < searchResults.pagination.pages) {\r\n      performSearch(currentPage + 1, false);\r\n    }\r\n  };\r\n\r\n  // Clear all filters\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      sortBy: 'title',\r\n      sortOrder: 'asc',\r\n      includeCovers: true,\r\n    });\r\n    setQuery('');\r\n    setCurrentPage(1);\r\n    setSearchResults(null);\r\n    setRecommendations([]);\r\n    setShowSuggestions(false);\r\n  };\r\n\r\n  // Apply saved _search\r\n  const applySuggestion = (\r\n    type: 'title' | 'author' | 'category',\r\n    value: string\r\n  ) => {\r\n    setQuery(value);\r\n    setShowSuggestions(false);\r\n\r\n    // Update filters based on suggestion type\r\n    if (type === 'author') {\r\n      setFilters((prev) => ({ ...prev, author: value }));\r\n    } else if (type === 'category') {\r\n      setFilters((prev) => ({ ...prev, category: value }));\r\n    }\r\n\r\n    setCurrentPage(1);\r\n    performSearch();\r\n  };\r\n\r\n  // Book availability badge\r\n  const getAvailabilityBadge = (book: Book | Recommendation) => {\r\n    // For recommendations, use isAvailable property\r\n    if ('isAvailable' in book && typeof book.isAvailable === 'boolean') {\r\n      return book.isAvailable ? (\r\n        <Badge variant=\"default\">Available</Badge>\r\n      ) : (\r\n        <Badge variant=\"destructive\">Not Available</Badge>\r\n      );\r\n    }\r\n\r\n    // For full Book objects\r\n    if ('is_active' in book && 'available_copies' in book) {\r\n      if (!book.is_active) {\r\n        return <Badge variant=\"secondary\">Inactive</Badge>;\r\n      }\r\n      if (book.available_copies === 0) {\r\n        return <Badge variant=\"destructive\">All Checked Out</Badge>;\r\n      }\r\n      if (book.available_copies === 1) {\r\n        return <Badge variant=\"outline\">Last Copy</Badge>;\r\n      }\r\n      return <Badge variant=\"default\">{book.available_copies} Available</Badge>;\r\n    }\r\n\r\n    // Fallback\r\n    return <Badge variant=\"outline\">Unknown</Badge>;\r\n  };\r\n\r\n  // Popularity score display\r\n  const getPopularityDisplay = (score?: number) => {\r\n    if (!score) {\r\n      return null;\r\n    }\r\n    if (score >= 80) {\r\n      return (\r\n        <Badge variant=\"default\">\r\n          <TrendingUp className=\"w-3 h-3 mr-1\" />\r\n          Very Popular\r\n        </Badge>\r\n      );\r\n    } else if (score >= 50) {\r\n      return (\r\n        <Badge variant=\"secondary\">\r\n          <Star className=\"w-3 h-3 mr-1\" />\r\n          Popular\r\n        </Badge>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* _Search Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <BookOpen className=\"w-5 h-5\" />\r\n            Enhanced Book _Search\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Discover books with advanced filtering, recommendations, and cover\r\n            images\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* _Search Bar with Suggestions */}\r\n          <div className=\"relative\">\r\n            <div className=\"flex gap-2\">\r\n              <div className=\"flex-1 relative\">\r\n                <Search className=\"absolute left-3 top-3 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  ref={searchInputRef}\r\n                  placeholder=\"_Search by title, author, ISBN, or keyword...\"\r\n                  value={query}\r\n                  onChange={(e) => handleSearchInput(e.target.value)}\r\n                  onFocus={() => query.length >= 2 && setShowSuggestions(true)}\r\n                  onBlur={() =>\r\n                    setTimeout(() => setShowSuggestions(false), 200)\r\n                  }\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === 'Enter') {\r\n                      setShowSuggestions(false);\r\n                      performSearch();\r\n                    }\r\n                  }}\r\n                  className=\"pl-10\"\r\n                />\r\n\r\n                {/* Suggestions Dropdown */}\r\n                {showSuggestions &&\r\n                  (suggestions.titles.length > 0 ||\r\n                    suggestions.authors.length > 0 ||\r\n                    suggestions.categories.length > 0) && (\r\n                    <div className=\"absolute top-full left-0 right-0 z-50 mt-1 bg-background border rounded-md shadow-lg\">\r\n                      <div className=\"p-2 space-y-2\">\r\n                        {suggestions.titles.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Titles\r\n                            </div>\r\n                            {suggestions.titles.map((title, index) => (\r\n                              <div\r\n                                key={`title-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() => applySuggestion('title', title)}\r\n                              >\r\n                                <BookOpen className=\"w-3 h-3 mr-2 inline\" />\r\n                                {title}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.authors.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Authors\r\n                            </div>\r\n                            {suggestions.authors.map((author, index) => (\r\n                              <div\r\n                                key={`author-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() =>\r\n                                  applySuggestion('author', author)\r\n                                }\r\n                              >\r\n                                <Users className=\"w-3 h-3 mr-2 inline\" />\r\n                                {author}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.categories.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Categories\r\n                            </div>\r\n                            {suggestions.categories.map((category, index) => (\r\n                              <div\r\n                                key={`category-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() =>\r\n                                  applySuggestion('category', category)\r\n                                }\r\n                              >\r\n                                <Filter className=\"w-3 h-3 mr-2 inline\" />\r\n                                {category}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n              </div>\r\n\r\n              <Button onClick={() => performSearch()} disabled={loading}>\r\n                {loading ? 'Searching...' : '_Search'}\r\n              </Button>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setShowFilters(!showFilters)}\r\n              >\r\n                <Filter className=\"w-4 h-4 mr-2\" />\r\n                Filters\r\n                {(filters.category ||\r\n                  filters.author ||\r\n                  filters.availableOnly) && (\r\n                  <ChevronDown className=\"w-4 h-4 ml-2\" />\r\n                )}\r\n              </Button>\r\n            </div>\r\n\r\n            {/* Quick Filters */}\r\n            <div className=\"flex gap-2 flex-wrap\">\r\n              <Button\r\n                variant={filters.availableOnly ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({\r\n                    ...filters,\r\n                    availableOnly: !filters.availableOnly,\r\n                  });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <Eye className=\"w-3 h-3 mr-1\" />\r\n                Available Only\r\n              </Button>\r\n\r\n              <Select\r\n                value={filters.sortBy ?? 'title'}\r\n                onValueChange={(value: any) => {\r\n                  setFilters({ ...filters, sortBy: value });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-32\">\r\n                  <SelectValue placeholder=\"Sort by\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"title\">Title</SelectItem>\r\n                  <SelectItem value=\"author\">Author</SelectItem>\r\n                  <SelectItem value=\"category\">Category</SelectItem>\r\n                  <SelectItem value=\"popularity\">Popular</SelectItem>\r\n                  <SelectItem value=\"newest\">Newest</SelectItem>\r\n                  <SelectItem value=\"available\">Available</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select\r\n                value={filters.sortOrder ?? 'asc'}\r\n                onValueChange={(value: any) => {\r\n                  setFilters({ ...filters, sortOrder: value });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-24\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"asc\">A-Z</SelectItem>\r\n                  <SelectItem value=\"desc\">Z-A</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Advanced Filters */}\r\n          {showFilters && (\r\n            <Card className=\"p-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-3 lg:grid-cols-5\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Category</label>\r\n                  <Select\r\n                    value={filters.category || ''}\r\n                    onValueChange={(value: any) => {\r\n                      setFilters({ ...filters, category: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Categories\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Categories</SelectItem>\r\n                      {/* Categories will be populated from API */}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Author</label>\r\n                  <Input\r\n                    placeholder=\"Filter by author...\"\r\n                    value={filters.author || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, author: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Publisher</label>\r\n                  <Input\r\n                    placeholder=\"Filter by publisher...\"\r\n                    value={filters.publisher || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, publisher: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Location</label>\r\n                  <Input\r\n                    placeholder=\"Filter by location...\"\r\n                    value={filters.location || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, location: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Reading Level</label>\r\n                  <Select\r\n                    value={filters.readingLevel || ''}\r\n                    onValueChange={(value: any) => {\r\n                      setFilters({ ...filters, readingLevel: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Levels\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Levels</SelectItem>\r\n                      <SelectItem value=\"Elementary\">Elementary</SelectItem>\r\n                      <SelectItem value=\"Middle School\">\r\n                        Middle School\r\n                      </SelectItem>\r\n                      <SelectItem value=\"High School\">High School</SelectItem>\r\n                      <SelectItem value=\"Young Adult\">Young Adult</SelectItem>\r\n                      <SelectItem value=\"Adult\">Adult</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Actions</label>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                      <X className=\"w-4 h-4 mr-1\" />\r\n                      Clear\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Quick Access Sections */}\r\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\r\n        {/* Popular Books */}\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-lg flex items-center gap-2\">\r\n              <TrendingUp className=\"w-5 h-5\" />\r\n              Popular\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"pt-0\">\r\n            <div className=\"grid gap-3\">\r\n              {popularBooks.slice(0, 4).map((book) => (\r\n                <div\r\n                  key={book.id}\r\n                  className=\"flex items-center gap-3 p-2 rounded-lg hover:bg-accent cursor-pointer\"\r\n                  onClick={() => {\r\n                    setQuery(book.title);\r\n                    setFilters({ ...filters, category: book.category });\r\n                    performSearch();\r\n                  }}\r\n                >\r\n                  {book.coverUrl ? (\r\n                    <img\r\n                      src={book.coverUrl}\r\n                      alt={book.title}\r\n                      className=\"w-10 h-14 object-cover rounded\"\r\n                      onError={(e) => {\r\n                        (e.target as HTMLImageElement).style.display = 'none';\r\n                        (e.target as HTMLImageElement).style.background =\r\n                          '#f3f4f6';\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-10 h-14 bg-muted rounded flex items-center justify-center\">\r\n                      <BookOpen className=\"w-5 h-5 text-muted-foreground\" />\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"font-medium text-sm truncate\">\r\n                      {book.title}\r\n                    </div>\r\n                    <div className=\"text-xs text-muted-foreground truncate\">\r\n                      {book.author}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      {getAvailabilityBadge(book)}\r\n                      {getPopularityDisplay(book.popularityScore)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* New Books */}\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-lg flex items-center gap-2\">\r\n              <Sparkles className=\"w-5 h-5\" />\r\n              New Arrivals\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"pt-0\">\r\n            <div className=\"grid gap-3\">\r\n              {newBooks.slice(0, 4).map((book) => (\r\n                <div\r\n                  key={book.id}\r\n                  className=\"flex items-center gap-3 p-2 rounded-lg hover:bg-accent cursor-pointer\"\r\n                  onClick={() => {\r\n                    setQuery(book.title);\r\n                    setFilters({ ...filters, category: book.category });\r\n                    performSearch();\r\n                  }}\r\n                >\r\n                  {book.coverUrl ? (\r\n                    <img\r\n                      src={book.coverUrl}\r\n                      alt={book.title}\r\n                      className=\"w-10 h-14 object-cover rounded\"\r\n                      onError={(e) => {\r\n                        (e.target as HTMLImageElement).style.display = 'none';\r\n                        (e.target as HTMLImageElement).style.background =\r\n                          '#f3f4f6';\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-10 h-14 bg-muted rounded flex items-center justify-center\">\r\n                      <BookOpen className=\"w-5 h-5 text-muted-foreground\" />\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"font-medium text-sm truncate\">\r\n                      {book.title}\r\n                    </div>\r\n                    <div className=\"text-xs text-muted-foreground truncate\">\r\n                      {book.author}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      {getAvailabilityBadge(book)}\r\n                      <Badge variant=\"outline\" className=\"text-xs\">\r\n                        New\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Available Now */}\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-lg flex items-center gap-2\">\r\n              <Eye className=\"w-5 h-5\" />\r\n              Available Now\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"pt-0\">\r\n            <div className=\"grid gap-3\">\r\n              {availableBooks.slice(0, 4).map((book) => (\r\n                <div\r\n                  key={book.id}\r\n                  className=\"flex items-center gap-3 p-2 rounded-lg hover:bg-accent cursor-pointer\"\r\n                  onClick={() => {\r\n                    setQuery(book.title);\r\n                    setFilters({ ...filters, category: book.category });\r\n                    performSearch();\r\n                  }}\r\n                >\r\n                  {book.coverUrl ? (\r\n                    <img\r\n                      src={book.coverUrl}\r\n                      alt={book.title}\r\n                      className=\"w-10 h-14 object-cover rounded\"\r\n                      onError={(e) => {\r\n                        (e.target as HTMLImageElement).style.display = 'none';\r\n                        (e.target as HTMLImageElement).style.background =\r\n                          '#f3f4f6';\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-10 h-14 bg-muted rounded flex items-center justify-center\">\r\n                      <BookOpen className=\"w-5 h-5 text-muted-foreground\" />\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"font-medium text-sm truncate\">\r\n                      {book.title}\r\n                    </div>\r\n                    <div className=\"text-xs text-muted-foreground truncate\">\r\n                      {book.author}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      {getAvailabilityBadge(book)}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Quick Stats */}\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-lg\">Quick Stats</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"pt-0 space-y-3\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                Popular Books\r\n              </span>\r\n              <span className=\"font-semibold\">{popularBooks.length}</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm text-muted-foreground\">\r\n                New Arrivals\r\n              </span>\r\n              <span className=\"font-semibold\">{newBooks.length}</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm text-muted-foreground\">Available</span>\r\n              <span className=\"font-semibold text-green-600\">\r\n                {availableBooks.length}\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* _Search Results */}\r\n      {searchResults && (\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <CardTitle>_Search Results</CardTitle>\r\n                <CardDescription>\r\n                  Found {searchResults.pagination.total} books\r\n                  {query && ` for \"${query}\"`}\r\n                  {filters.category && ` in ${filters.category}`}\r\n                </CardDescription>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                {searchResults.pagination.total > 20 && (\r\n                  <Badge variant=\"outline\">\r\n                    Page {searchResults.pagination.page} of{' '}\r\n                    {searchResults.pagination.pages}\r\n                  </Badge>\r\n                )}\r\n                <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                  <X className=\"w-4 h-4 mr-1\" />\r\n                  Clear\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"p-0\">\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\r\n              {searchResults.books.map((book) => (\r\n                <Card\r\n                  key={book.id}\r\n                  className=\"hover:shadow-md transition-shadow cursor-pointer group\"\r\n                  onClick={() => {\r\n                    // Navigate to book details\r\n                    if (onNavigateToDetails) {\r\n                      onNavigateToDetails(book.id);\r\n                    } else {\r\n                      // Fallback to hash navigation for simple routing\r\n                      window.location.hash = `book/${book.id}`;\r\n                    }\r\n                    console.debug('Navigate to book details:', book.id);\r\n                  }}\r\n                >\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"space-y-3\">\r\n                      {/* Book Cover */}\r\n                      <div className=\"relative mx-auto w-24 h-32\">\r\n                        {book.coverUrl ? (\r\n                          <img\r\n                            src={book.coverUrl}\r\n                            alt={book.title}\r\n                            className=\"w-full h-full object-cover rounded-lg\"\r\n                            onError={(e) => {\r\n                              (e.target as HTMLImageElement).style.display =\r\n                                'none';\r\n                              (e.target as HTMLImageElement).style.background =\r\n                                '#f3f4f6';\r\n                              (e.target as HTMLImageElement).innerHTML =\r\n                                '<BookOpen className=\"w-8 h-8 text-muted-foreground m-auto\" />';\r\n                            }}\r\n                          />\r\n                        ) : (\r\n                          <div className=\"w-full h-full bg-muted rounded-lg flex items-center justify-center\">\r\n                            <BookOpen className=\"w-8 h-8 text-muted-foreground\" />\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Availability Badge */}\r\n                        <div className=\"absolute top-2 right-2\">\r\n                          {getAvailabilityBadge(book)}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Book Info */}\r\n                      <div className=\"space-y-2\">\r\n                        <h3 className=\"font-semibold text-sm line-clamp-2\">\r\n                          {book.title}\r\n                        </h3>\r\n                        <p className=\"text-sm text-muted-foreground line-clamp-1\">\r\n                          by {book.author}\r\n                        </p>\r\n\r\n                        <div className=\"flex flex-wrap gap-1\">\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">\r\n                            {book.category}\r\n                          </Badge>\r\n                          {book.subcategory && (\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              {book.subcategory}\r\n                            </Badge>\r\n                          )}\r\n                          {getPopularityDisplay(book.popularityScore)}\r\n                        </div>\r\n\r\n                        {/* Copies Info */}\r\n                        <div className=\"text-xs text-muted-foreground\">\r\n                          {book.available_copies} of {book.total_copies} copies\r\n                          available\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Load More Button */}\r\n            {searchResults.pagination.page < searchResults.pagination.pages && (\r\n              <div className=\"flex justify-center mt-6\">\r\n                <Button onClick={loadMore} disabled={loading} variant=\"outline\">\r\n                  {loading ? 'Loading...' : 'Load More'}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Recommendations */}\r\n      {recommendations.length > 0 && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Sparkles className=\"w-5 h-5\" />\r\n              Recommended for You\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Based on your _search and library popularity\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n              {recommendations.map((book) => (\r\n                <Card\r\n                  key={book.id}\r\n                  className=\"hover:shadow-md transition-shadow cursor-pointer group\"\r\n                  onClick={() => {\r\n                    // Navigate to book details\r\n                    if (onNavigateToDetails) {\r\n                      onNavigateToDetails(book.id);\r\n                    } else {\r\n                      // Fallback to hash navigation for simple routing\r\n                      window.location.hash = `book/${book.id}`;\r\n                    }\r\n                    console.debug('Navigate to recommended book:', book.id);\r\n                  }}\r\n                >\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"space-y-3\">\r\n                      {/* Book Cover */}\r\n                      <div className=\"relative mx-auto w-20 h-28\">\r\n                        {book.coverUrl ? (\r\n                          <img\r\n                            src={book.coverUrl}\r\n                            alt={book.title}\r\n                            className=\"w-full h-full object-cover rounded-lg\"\r\n                            onError={(e) => {\r\n                              (e.target as HTMLImageElement).style.display =\r\n                                'none';\r\n                              (e.target as HTMLImageElement).style.background =\r\n                                '#f3f4f6';\r\n                              (e.target as HTMLImageElement).innerHTML =\r\n                                '<BookOpen className=\"w-6 h-6 text-muted-foreground m-auto\" />';\r\n                            }}\r\n                          />\r\n                        ) : (\r\n                          <div className=\"w-full h-full bg-muted rounded-lg flex items-center justify-center\">\r\n                            <BookOpen className=\"w-6 h-6 text-muted-foreground\" />\r\n                          </div>\r\n                        )}\r\n\r\n                        {/* Reason Badge */}\r\n                        <div className=\"absolute top-2 right-2\">\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            {book.recommendationReason}\r\n                          </Badge>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Book Info */}\r\n                      <div className=\"space-y-2\">\r\n                        <h4 className=\"font-medium text-sm line-clamp-2\">\r\n                          {book.title}\r\n                        </h4>\r\n                        <p className=\"text-xs text-muted-foreground line-clamp-1\">\r\n                          {book.author}\r\n                        </p>\r\n\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">\r\n                            {book.category}\r\n                          </Badge>\r\n                          {getAvailabilityBadge(book)}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\EquipmentAvailabilitySearch.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1179,1182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1179,1182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":61,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1209,1212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1209,1212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1238,1241],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1238,1241],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Search,\r\n  Monitor,\r\n  Filter,\r\n  X,\r\n  Download,\r\n  Clock,\r\n  CheckCircle,\r\n  XCircle,\r\n  Calendar,\r\n  ChevronDown,\r\n  Zap,\r\n  Settings,\r\n  MapPin,\r\n  UserCheck,\r\n  Users,\r\n} from 'lucide-react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n\r\ninterface Equipment {\r\n  id: string;\r\n  equipment_id: string;\r\n  name: string;\r\n  type: string;\r\n  status: string;\r\n  location: string;\r\n  category?: string;\r\n  requires_supervision: boolean;\r\n  condition_rating: string;\r\n  total_usage_hours: number;\r\n  daily_usage_hours: number;\r\n  max_time_minutes: number;\r\n  currentSession?: any;\r\n  upcomingReservation?: any;\r\n  pendingMaintenance?: any;\r\n  utilizationRate: number;\r\n  recentUsageStats: {\r\n    totalSessions: number;\r\n    totalMinutes: number;\r\n  };\r\n  availabilityStatus: string;\r\n  isReservationRequired: boolean;\r\n  nextAvailableDate?: string;\r\n  qr_code_data?: string;\r\n  purchase_date?: string;\r\n  warranty_expiry?: string;\r\n}\r\n\r\ninterface EquipmentSearchOptions {\r\n  query?: string;\r\n  type?: string;\r\n  status?: string;\r\n  location?: string;\r\n  category?: string;\r\n  isAvailable?: boolean;\r\n  requiresSupervision?: boolean;\r\n  maintenanceDue?: boolean;\r\n  conditionRating?: string;\r\n  minUsageHours?: number;\r\n  maxUsageHours?: number;\r\n  sortBy?: 'name' | 'type' | 'status' | 'usageHours' | 'condition' | 'location';\r\n  sortOrder?: 'asc' | 'desc';\r\n  page?: number;\r\n  limit?: number;\r\n}\r\n\r\ninterface EquipmentSearchResult {\r\n  equipment: Equipment[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n  filters: EquipmentSearchOptions;\r\n  sortBy: string;\r\n  sortOrder: string;\r\n}\r\n\r\ninterface EquipmentSuggestion {\r\n  names: string[];\r\n  types: string[];\r\n  locations: string[];\r\n}\r\n\r\nexport default function EquipmentAvailabilitySearch() {\r\n  const [query, setQuery] = useState('');\r\n  const [suggestions, setSuggestions] = useState<EquipmentSuggestion>({\r\n    names: [],\r\n    types: [],\r\n    locations: [],\r\n  });\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [searchResults, setSearchResults] =\r\n    useState<EquipmentSearchResult | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filters, setFilters] = useState<EquipmentSearchOptions>({\r\n    sortBy: 'name',\r\n    sortOrder: 'asc',\r\n  });\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [selectedEquipment, setSelectedEquipment] = useState<string[]>([]);\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const suggestionTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  // Fetch suggestions with debouncing\r\n  const fetchSuggestions = useCallback(async (searchQuery: string) => {\r\n    if (searchQuery.length < 2) {\r\n      setSuggestions({ names: [], types: [], locations: [] });\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await apiClient.get(\r\n        '/api/_search/equipment/suggestions',\r\n        {\r\n          params: {\r\n            query: searchQuery,\r\n            limit: 5,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (response.success && response.data) {\r\n        setSuggestions(response.data as EquipmentSuggestion);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch equipment suggestions:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Debounced _search input handler\r\n  const handleSearchInput = (value: string) => {\r\n    setQuery(value);\r\n    setCurrentPage(1);\r\n\r\n    // Clear existing timeout\r\n    if (suggestionTimeoutRef.current) {\r\n      clearTimeout(suggestionTimeoutRef.current);\r\n    }\r\n\r\n    // Set new timeout for suggestions\r\n    suggestionTimeoutRef.current = setTimeout(() => {\r\n      fetchSuggestions(value);\r\n    }, 300);\r\n\r\n    if (value.length >= 2) {\r\n      setShowSuggestions(true);\r\n    } else {\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  // Enhanced equipment _search function\r\n  const performSearch = async (page = 1, resetPagination = true) => {\r\n    if (\r\n      !query.trim() &&\r\n      !Object.keys(filters).some(\r\n        (key) =>\r\n          filters[key as keyof EquipmentSearchOptions] !== undefined &&\r\n          filters[key as keyof EquipmentSearchOptions] !== ''\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // Build query params\r\n      const searchParams: Record<string, unknown> = {\r\n        page,\r\n        limit: 20,\r\n      };\r\n\r\n      // Add filters to _search params\r\n      if (query) {\r\n        searchParams.query = query;\r\n      }\r\n      if (filters.type) {\r\n        searchParams.type = filters.type;\r\n      }\r\n      if (filters.status) {\r\n        searchParams.status = filters.status;\r\n      }\r\n      if (filters.location) {\r\n        searchParams.location = filters.location;\r\n      }\r\n      if (filters.category) {\r\n        searchParams.category = filters.category;\r\n      }\r\n      if (filters.isAvailable !== undefined) {\r\n        searchParams.isAvailable = filters.isAvailable;\r\n      }\r\n      if (filters.requiresSupervision !== undefined) {\r\n        searchParams.requiresSupervision = filters.requiresSupervision;\r\n      }\r\n      if (filters.maintenanceDue !== undefined) {\r\n        searchParams.maintenanceDue = filters.maintenanceDue;\r\n      }\r\n      if (filters.conditionRating) {\r\n        searchParams.conditionRating = filters.conditionRating;\r\n      }\r\n      if (filters.minUsageHours !== undefined) {\r\n        searchParams.minUsageHours = filters.minUsageHours;\r\n      }\r\n      if (filters.maxUsageHours !== undefined) {\r\n        searchParams.maxUsageHours = filters.maxUsageHours;\r\n      }\r\n      if (filters.sortBy) {\r\n        searchParams.sortBy = filters.sortBy;\r\n      }\r\n      if (filters.sortOrder) {\r\n        searchParams.sortOrder = filters.sortOrder;\r\n      }\r\n\r\n      const response = await apiClient.get('/api/_search/equipment', {\r\n        params: searchParams,\r\n      });\r\n\r\n      if (response.success && response.data) {\r\n        if (resetPagination) {\r\n          setSearchResults(response.data as EquipmentSearchResult);\r\n        } else {\r\n          // Append results for pagination\r\n          setSearchResults((prev) => ({\r\n            ...(response.data as EquipmentSearchResult),\r\n            equipment: [\r\n              ...(prev?.equipment || []),\r\n              ...(response.data as EquipmentSearchResult).equipment,\r\n            ],\r\n          }));\r\n        }\r\n        setCurrentPage(page);\r\n      }\r\n    } catch (error) {\r\n      console.error('Equipment _search error:', error);\r\n      toast.error('Failed to perform equipment _search');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Load more results (pagination)\r\n  const loadMore = () => {\r\n    if (searchResults && currentPage < searchResults.pagination.pages) {\r\n      performSearch(currentPage + 1, false);\r\n    }\r\n  };\r\n\r\n  // Clear all filters\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      sortBy: 'name',\r\n      sortOrder: 'asc',\r\n    });\r\n    setQuery('');\r\n    setCurrentPage(1);\r\n    setSearchResults(null);\r\n    setShowSuggestions(false);\r\n  };\r\n\r\n  // Apply suggestion\r\n  const applySuggestion = (\r\n    type: 'name' | 'type' | 'location',\r\n    value: string\r\n  ) => {\r\n    setQuery(value);\r\n    setShowSuggestions(false);\r\n\r\n    // Update filters based on suggestion type\r\n    if (type === 'type') {\r\n      setFilters({ ...filters, type: value });\r\n    } else if (type === 'location') {\r\n      setFilters({ ...filters, location: value });\r\n    }\r\n\r\n    setCurrentPage(1);\r\n    performSearch();\r\n  };\r\n\r\n  // Toggle equipment selection\r\n  const toggleEquipmentSelection = (equipmentId: string) => {\r\n    setSelectedEquipment((prev) =>\r\n      prev.includes(equipmentId)\r\n        ? prev.filter((id) => id !== equipmentId)\r\n        : [...prev, equipmentId]\r\n    );\r\n  };\r\n\r\n  // Export results\r\n  const exportResults = () => {\r\n    if (!searchResults || searchResults.equipment.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const data = searchResults.equipment.map((equipment) => ({\r\n      'Equipment ID': equipment.equipment_id,\r\n      Name: equipment.name,\r\n      Type: equipment.type,\r\n      Location: equipment.location,\r\n      Status: equipment.status,\r\n      Condition: equipment.condition_rating,\r\n      'Usage Hours': equipment.total_usage_hours.toFixed(1),\r\n      'Utilization Rate': `${equipment.utilizationRate.toFixed(1)}%`,\r\n      'Sessions (30d)': equipment.recentUsageStats.totalSessions,\r\n      'Max Session': `${equipment.max_time_minutes} min`,\r\n      Supervision: equipment.requires_supervision ? 'Required' : 'Not Required',\r\n      'Next Available': equipment.nextAvailableDate || 'Available Now',\r\n    }));\r\n\r\n    const csvRows = [Object.keys(data[0] || {}).join(',')];\r\n    data.forEach((row) => {\r\n      const values: string[] = [];\r\n      Object.keys(row).forEach((key) => {\r\n        const value = row[key as keyof typeof row];\r\n        values.push(`\"${String(value ?? '')}\"`);\r\n      });\r\n      csvRows.push(values.join(','));\r\n    });\r\n    const csv = csvRows.join('\\n');\r\n\r\n    const blob = new Blob([csv], { type: 'text/csv' });\r\n    const url = window.URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `equipment-_search-results-${new Date().toISOString().split('T')[0]}.csv`;\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Get status badge for equipment\r\n  const getStatusBadge = (equipment: Equipment) => {\r\n    switch (equipment.status) {\r\n      case 'AVAILABLE':\r\n        return (\r\n          <Badge className=\"bg-green-500\">\r\n            <CheckCircle className=\"w-3 h-3 mr-1\" />\r\n            Available\r\n          </Badge>\r\n        );\r\n      case 'IN_USE':\r\n        return (\r\n          <Badge className=\"bg-blue-500\">\r\n            <Users className=\"w-3 h-3 mr-1\" />\r\n            In Use\r\n          </Badge>\r\n        );\r\n      case 'MAINTENANCE':\r\n        return (\r\n          <Badge className=\"bg-orange-500\">\r\n            <Settings className=\"w-3 h-3 mr-1\" />\r\n            Maintenance\r\n          </Badge>\r\n        );\r\n      case 'OUT_OF_ORDER':\r\n        return (\r\n          <Badge variant=\"destructive\">\r\n            <XCircle className=\"w-3 h-3 mr-1\" />\r\n            Out of Order\r\n          </Badge>\r\n        );\r\n      case 'RESERVED':\r\n        return (\r\n          <Badge className=\"bg-purple-500\">\r\n            <Calendar className=\"w-3 h-3 mr-1\" />\r\n            Reserved\r\n          </Badge>\r\n        );\r\n      case 'RETIRED':\r\n        return (\r\n          <Badge variant=\"secondary\">\r\n            <XCircle className=\"w-3 h-3 mr-1\" />\r\n            Retired\r\n          </Badge>\r\n        );\r\n      default:\r\n        return <Badge variant=\"outline\">{equipment.status}</Badge>;\r\n    }\r\n  };\r\n\r\n  // Get condition rating badge\r\n  const getConditionBadge = (condition: string) => {\r\n    const colors: Record<string, string> = {\r\n      EXCELLENT: 'bg-green-500',\r\n      GOOD: 'bg-blue-500',\r\n      FAIR: 'bg-yellow-500',\r\n      POOR: 'bg-orange-500',\r\n      DAMAGED: 'bg-red-500',\r\n    };\r\n\r\n    return (\r\n      <Badge className={colors[condition] || 'bg-gray-500'}>{condition}</Badge>\r\n    );\r\n  };\r\n\r\n  // Get utilization rate badge\r\n  const getUtilizationBadge = (rate: number) => {\r\n    if (rate >= 80) {\r\n      return (\r\n        <Badge className=\"bg-red-500\">\r\n          <Zap className=\"w-3 h-3 mr-1\" />\r\n          High Usage\r\n        </Badge>\r\n      );\r\n    } else if (rate >= 50) {\r\n      return (\r\n        <Badge className=\"bg-orange-500\">\r\n          <Zap className=\"w-3 h-3 mr-1\" />\r\n          Moderate\r\n        </Badge>\r\n      );\r\n    } else if (rate >= 20) {\r\n      return (\r\n        <Badge className=\"bg-green-500\">\r\n          <Zap className=\"w-3 h-3 mr-1\" />\r\n          Low Usage\r\n        </Badge>\r\n      );\r\n    }\r\n    return (\r\n      <Badge variant=\"outline\">\r\n        <Zap className=\"w-3 h-3 mr-1\" />\r\n        Minimal\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* _Search Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Monitor className=\"w-5 h-5\" />\r\n            Equipment Availability _Search\r\n          </CardTitle>\r\n          <CardDescription>\r\n            _Search and filter equipment by type, location, availability, and\r\n            usage statistics\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* _Search Bar with Suggestions */}\r\n          <div className=\"relative\">\r\n            <div className=\"flex gap-2\">\r\n              <div className=\"flex-1 relative\">\r\n                <Search className=\"absolute left-3 top-3 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  ref={searchInputRef}\r\n                  placeholder=\"_Search by name, equipment ID, type, or location...\"\r\n                  value={query}\r\n                  onChange={(e) => handleSearchInput(e.target.value)}\r\n                  onFocus={() => query.length >= 2 && setShowSuggestions(true)}\r\n                  onBlur={() =>\r\n                    setTimeout(() => setShowSuggestions(false), 200)\r\n                  }\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === 'Enter') {\r\n                      setShowSuggestions(false);\r\n                      performSearch();\r\n                    }\r\n                  }}\r\n                  className=\"pl-10\"\r\n                />\r\n\r\n                {/* Suggestions Dropdown */}\r\n                {showSuggestions &&\r\n                  (suggestions.names.length > 0 ||\r\n                    suggestions.types.length > 0 ||\r\n                    suggestions.locations.length > 0) && (\r\n                    <div className=\"absolute top-full left-0 right-0 z-50 mt-1 bg-background border rounded-md shadow-lg\">\r\n                      <div className=\"p-2 space-y-2\">\r\n                        {suggestions.names.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Equipment Names\r\n                            </div>\r\n                            {suggestions.names.map((name, index) => (\r\n                              <div\r\n                                key={`name-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() => applySuggestion('name', name)}\r\n                              >\r\n                                <Monitor className=\"w-3 h-3 mr-2 inline\" />\r\n                                {name}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.types.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Types\r\n                            </div>\r\n                            {suggestions.types.map((type, index) => (\r\n                              <div\r\n                                key={`type-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() => applySuggestion('type', type)}\r\n                              >\r\n                                <Monitor className=\"w-3 h-3 mr-2 inline\" />\r\n                                {type}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n\r\n                        {suggestions.locations.length > 0 && (\r\n                          <div>\r\n                            <div className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\r\n                              Locations\r\n                            </div>\r\n                            {suggestions.locations.map((location, index) => (\r\n                              <div\r\n                                key={`location-${index}`}\r\n                                className=\"px-2 py-1 text-sm hover:bg-accent cursor-pointer rounded\"\r\n                                onClick={() =>\r\n                                  applySuggestion('location', location)\r\n                                }\r\n                              >\r\n                                <MapPin className=\"w-3 h-3 mr-2 inline\" />\r\n                                {location}\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n              </div>\r\n\r\n              <Button onClick={() => performSearch()} disabled={loading}>\r\n                {loading ? 'Searching...' : '_Search'}\r\n              </Button>\r\n\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => setShowFilters(!showFilters)}\r\n              >\r\n                <Filter className=\"w-4 h-4 mr-2\" />\r\n                Filters\r\n                {(filters.type ||\r\n                  filters.status ||\r\n                  filters.location ||\r\n                  filters.isAvailable) && (\r\n                  <ChevronDown className=\"w-4 h-4 ml-2\" />\r\n                )}\r\n              </Button>\r\n\r\n              {searchResults && searchResults.equipment.length > 0 && (\r\n                <Button variant=\"outline\" onClick={exportResults}>\r\n                  <Download className=\"w-4 h-4 mr-2\" />\r\n                  Export\r\n                </Button>\r\n              )}\r\n            </div>\r\n\r\n            {/* Quick Filters */}\r\n            <div className=\"flex gap-2 flex-wrap\">\r\n              <Button\r\n                variant={filters.isAvailable ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({ ...filters, isAvailable: !filters.isAvailable });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <CheckCircle className=\"w-3 h-3 mr-1\" />\r\n                Available Only\r\n              </Button>\r\n\r\n              <Button\r\n                variant={filters.maintenanceDue ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({\r\n                    ...filters,\r\n                    maintenanceDue: !filters.maintenanceDue,\r\n                  });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <Settings className=\"w-3 h-3 mr-1\" />\r\n                Maintenance Due\r\n              </Button>\r\n\r\n              <Button\r\n                variant={filters.requiresSupervision ? 'default' : 'outline'}\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  setFilters({\r\n                    ...filters,\r\n                    requiresSupervision: !filters.requiresSupervision,\r\n                  });\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <UserCheck className=\"w-3 h-3 mr-1\" />\r\n                Supervision Required\r\n              </Button>\r\n\r\n              <Select\r\n                value={filters.sortBy || ''}\r\n                onValueChange={(value: string) => {\r\n                  const sortBy = value as\r\n                    | 'name'\r\n                    | 'type'\r\n                    | 'status'\r\n                    | 'usageHours'\r\n                    | 'condition'\r\n                    | 'location';\r\n                  const newFilters = { ...filters };\r\n                  if (value) {\r\n                    newFilters.sortBy = sortBy;\r\n                  } else {\r\n                    delete newFilters.sortBy;\r\n                  }\r\n                  setFilters(newFilters);\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-32\">\r\n                  <SelectValue placeholder=\"Sort by\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"name\">Name</SelectItem>\r\n                  <SelectItem value=\"type\">Type</SelectItem>\r\n                  <SelectItem value=\"status\">Status</SelectItem>\r\n                  <SelectItem value=\"usageHours\">Usage Hours</SelectItem>\r\n                  <SelectItem value=\"condition\">Condition</SelectItem>\r\n                  <SelectItem value=\"location\">Location</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select\r\n                value={filters.sortOrder || ''}\r\n                onValueChange={(value: string) => {\r\n                  const sortOrder = value as 'asc' | 'desc';\r\n                  const newFilters = { ...filters };\r\n                  if (value) {\r\n                    newFilters.sortOrder = sortOrder;\r\n                  } else {\r\n                    delete newFilters.sortOrder;\r\n                  }\r\n                  setFilters(newFilters);\r\n                  setCurrentPage(1);\r\n                  performSearch();\r\n                }}\r\n              >\r\n                <SelectTrigger className=\"w-24\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"asc\">A-Z</SelectItem>\r\n                  <SelectItem value=\"desc\">Z-A</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Advanced Filters */}\r\n          {showFilters && (\r\n            <Card className=\"p-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-3 lg:grid-cols-6\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Type</label>\r\n                  <Select\r\n                    value={filters.type || ''}\r\n                    onValueChange={(value: string) => {\r\n                      setFilters({ ...filters, type: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Types\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Types</SelectItem>\r\n                      <SelectItem value=\"COMPUTER\">Computer</SelectItem>\r\n                      <SelectItem value=\"GAMING\">Gaming</SelectItem>\r\n                      <SelectItem value=\"AVR\">AVR</SelectItem>\r\n                      <SelectItem value=\"PRINTER\">Printer</SelectItem>\r\n                      <SelectItem value=\"SCANNER\">Scanner</SelectItem>\r\n                      <SelectItem value=\"OTHER\">Other</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Status</label>\r\n                  <Select\r\n                    value={filters.status || ''}\r\n                    onValueChange={(value: string) => {\r\n                      setFilters({ ...filters, status: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Status\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Status</SelectItem>\r\n                      <SelectItem value=\"AVAILABLE\">Available</SelectItem>\r\n                      <SelectItem value=\"IN_USE\">In Use</SelectItem>\r\n                      <SelectItem value=\"MAINTENANCE\">Maintenance</SelectItem>\r\n                      <SelectItem value=\"OUT_OF_ORDER\">Out of Order</SelectItem>\r\n                      <SelectItem value=\"RESERVED\">Reserved</SelectItem>\r\n                      <SelectItem value=\"RETIRED\">Retired</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Location</label>\r\n                  <Input\r\n                    placeholder=\"Filter by location...\"\r\n                    value={filters.location || ''}\r\n                    onChange={(e) => {\r\n                      setFilters({ ...filters, location: e.target.value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Condition</label>\r\n                  <Select\r\n                    value={filters.conditionRating || ''}\r\n                    onValueChange={(value: string) => {\r\n                      setFilters({ ...filters, conditionRating: value });\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Conditions\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Conditions</SelectItem>\r\n                      <SelectItem value=\"EXCELLENT\">Excellent</SelectItem>\r\n                      <SelectItem value=\"GOOD\">Good</SelectItem>\r\n                      <SelectItem value=\"FAIR\">Fair</SelectItem>\r\n                      <SelectItem value=\"POOR\">Poor</SelectItem>\r\n                      <SelectItem value=\"DAMAGED\">Damaged</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Min Usage Hours</label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    placeholder=\"0\"\r\n                    value={filters.minUsageHours || ''}\r\n                    onChange={(e) => {\r\n                      const minUsageHours = e.target.value\r\n                        ? parseInt(e.target.value)\r\n                        : undefined;\r\n                      const newFilters = { ...filters };\r\n                      if (minUsageHours !== undefined) {\r\n                        newFilters.minUsageHours = minUsageHours;\r\n                      } else {\r\n                        delete newFilters.minUsageHours;\r\n                      }\r\n                      setFilters(newFilters);\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"text-sm font-medium\">Max Usage Hours</label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    placeholder=\"9999\"\r\n                    value={filters.maxUsageHours || ''}\r\n                    onChange={(e) => {\r\n                      const maxUsageHours = e.target.value\r\n                        ? parseInt(e.target.value)\r\n                        : undefined;\r\n                      const newFilters = { ...filters };\r\n                      if (maxUsageHours !== undefined) {\r\n                        newFilters.maxUsageHours = maxUsageHours;\r\n                      } else {\r\n                        delete newFilters.maxUsageHours;\r\n                      }\r\n                      setFilters(newFilters);\r\n                      setCurrentPage(1);\r\n                      performSearch();\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2 md:col-span-3 lg:col-span-6\">\r\n                  <label className=\"text-sm font-medium\">Actions</label>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                      <X className=\"w-4 h-4 mr-1\" />\r\n                      Clear All\r\n                    </Button>\r\n                    {selectedEquipment.length > 0 && (\r\n                      <Badge variant=\"outline\">\r\n                        {selectedEquipment.length} selected\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* _Search Results */}\r\n      {searchResults && (\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <CardTitle>Equipment _Search Results</CardTitle>\r\n                <CardDescription>\r\n                  Found {searchResults.pagination.total} equipment items\r\n                  {query && ` for \"${query}\"`}\r\n                  {filters.type && ` of type ${filters.type}`}\r\n                </CardDescription>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                {searchResults.pagination.total > 20 && (\r\n                  <Badge variant=\"outline\">\r\n                    Page {searchResults.pagination.page} of{' '}\r\n                    {searchResults.pagination.pages}\r\n                  </Badge>\r\n                )}\r\n                <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                  <X className=\"w-4 h-4 mr-1\" />\r\n                  Clear\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"p-0\">\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead className=\"w-12\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={\r\n                          selectedEquipment.length ===\r\n                          searchResults.equipment.length\r\n                        }\r\n                        onChange={(e) => {\r\n                          if (e.target.checked) {\r\n                            setSelectedEquipment(\r\n                              searchResults.equipment.map((e) => e.id)\r\n                            );\r\n                          } else {\r\n                            setSelectedEquipment([]);\r\n                          }\r\n                        }}\r\n                      />\r\n                    </TableHead>\r\n                    <TableHead>Name</TableHead>\r\n                    <TableHead>Type</TableHead>\r\n                    <TableHead>Location</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead>Condition</TableHead>\r\n                    <TableHead>Usage</TableHead>\r\n                    <TableHead>Next Available</TableHead>\r\n                    <TableHead className=\"w-24\">Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {searchResults.equipment.map((equipment) => (\r\n                    <TableRow key={equipment.id}>\r\n                      <TableCell>\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedEquipment.includes(equipment.id)}\r\n                          onChange={() =>\r\n                            toggleEquipmentSelection(equipment.id)\r\n                          }\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell className=\"font-medium\">\r\n                        <div>\r\n                          <div className=\"font-medium\">{equipment.name}</div>\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            ID: {equipment.equipment_id}\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant=\"outline\">{equipment.type}</Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <MapPin className=\"w-3 h-3\" />\r\n                          {equipment.location}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"space-y-1\">\r\n                          {getStatusBadge(equipment)}\r\n                          {equipment.requires_supervision && (\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              <UserCheck className=\"w-3 h-3 mr-1\" />\r\n                              Supervision Required\r\n                            </Badge>\r\n                          )}\r\n                          {equipment.isReservationRequired && (\r\n                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                              <Calendar className=\"w-3 h-3 mr-1\" />\r\n                              Reserved\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        {getConditionBadge(equipment.condition_rating)}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"space-y-1\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Clock className=\"w-3 h-3\" />\r\n                            <span className=\"text-sm\">\r\n                              {equipment.total_usage_hours.toFixed(1)}h total\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-1\">\r\n                            {getUtilizationBadge(equipment.utilizationRate)}\r\n                          </div>\r\n                          <div className=\"text-xs text-muted-foreground\">\r\n                            {equipment.recentUsageStats.totalSessions} sessions\r\n                            (30d)\r\n                          </div>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"text-sm\">\r\n                          {equipment.nextAvailableDate ? (\r\n                            <div>\r\n                              <div>\r\n                                {new Date(\r\n                                  equipment.nextAvailableDate\r\n                                ).toLocaleDateString()}\r\n                              </div>\r\n                              <div className=\"text-xs text-muted-foreground\">\r\n                                {new Date(\r\n                                  equipment.nextAvailableDate\r\n                                ).toLocaleTimeString([], {\r\n                                  hour: '2-digit',\r\n                                  minute: '2-digit',\r\n                                })}\r\n                              </div>\r\n                            </div>\r\n                          ) : (\r\n                            <Badge className=\"bg-green-500\">\r\n                              Available Now\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex gap-1\">\r\n                          <Button variant=\"ghost\" size=\"sm\">\r\n                            View\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n\r\n            {/* Load More Button */}\r\n            {searchResults.pagination.page < searchResults.pagination.pages && (\r\n              <div className=\"flex justify-center mt-6 p-4\">\r\n                <Button onClick={loadMore} disabled={loading} variant=\"outline\">\r\n                  {loading ? 'Loading...' : 'Load More'}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {!searchResults && (\r\n        <Card>\r\n          <CardContent className=\"flex items-center justify-center h-32\">\r\n            <p className=\"text-muted-foreground\">\r\n              {query ? 'No results found' : 'Enter a _search query to begin'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\SavedSearches.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1245,1248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1245,1248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3335,3338],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3335,3338],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":290,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":290,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8617,8620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8617,8620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":701,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":701,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[24677,24680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[24677,24680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport {\r\n  Search,\r\n  Star,\r\n  Bookmark,\r\n  Edit,\r\n  Trash2,\r\n  Eye,\r\n  Users,\r\n  BookOpen,\r\n  Monitor,\r\n  Plus,\r\n  Copy,\r\n  Share2,\r\n  Bell,\r\n  Clock,\r\n  TrendingUp,\r\n} from 'lucide-react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\nimport { useMultipleLoadingStates, useMultipleModals, useForm } from '@/hooks';\r\n\r\ninterface SavedSearch {\r\n  id: string;\r\n  userId: string;\r\n  name: string;\r\n  description?: string;\r\n  entityType: 'books' | 'students' | 'equipment' | 'global';\r\n  searchParams: any;\r\n  isPublic: boolean;\r\n  enableNotifications: boolean;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  lastUsedAt?: string;\r\n  useCount: number;\r\n}\r\n\r\nexport default function SavedSearches() {\r\n  const [savedSearches, setSavedSearches] = useState<SavedSearch[]>([]);\r\n  const [popularSearches, setPopularSearches] = useState<SavedSearch[]>([]);\r\n\r\n  // Consolidated loading states\r\n  const [loadingStates, loadingActions] = useMultipleLoadingStates({\r\n    loadSearches: { isLoading: false },\r\n    createSearch: { isLoading: false },\r\n    updateSearch: { isLoading: false },\r\n    deleteSearch: { isLoading: false },\r\n  });\r\n\r\n  // Consolidated modal/dialog states\r\n  const [modalStates, modalActions] = useMultipleModals({\r\n    createDialog: false,\r\n    editDialog: false,\r\n    deleteDialog: false,\r\n    shareDialog: false,\r\n  });\r\n\r\n  // _Search/filter state\r\n  const [searchFilters, searchFilterActions] = useForm({\r\n    initialValues: {\r\n      activeTab: 'my-searches',\r\n      filterEntityType: 'all',\r\n      searchQuery: '',\r\n      editingSearch: null as SavedSearch | null,\r\n    },\r\n    validationSchema: {},\r\n  });\r\n\r\n  // Derived state for easier access\r\n  const searchQuery = searchFilters.values.searchQuery;\r\n  const loading = loadingStates.loadSearches.isLoading;\r\n  const setShowCreateDialog = (show: boolean) =>\r\n    modalActions.createDialog.setState(show);\r\n  const setFormData = (data: unknown) => formActions.setValues(data);\r\n\r\n  // Form state for create/edit\r\n  const [formData, formActions] = useForm({\r\n    initialValues: {\r\n      name: '',\r\n      description: '',\r\n      entityType: 'books',\r\n      searchParams: {},\r\n      isPublic: false,\r\n      enableNotifications: false,\r\n    },\r\n    validationSchema: {\r\n      name: { required: true },\r\n      entityType: { required: true },\r\n    },\r\n  });\r\n\r\n  const loadSavedSearches = useCallback(async () => {\r\n    loadingActions.loadSearches.start();\r\n    try {\r\n      const response = await apiClient.get('/api/_search/saved');\r\n      if (response.success && response.data) {\r\n        setSavedSearches((response.data as any).searches || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load saved searches:', error);\r\n      toast.error('Failed to load saved searches');\r\n    } finally {\r\n      loadingActions.loadSearches.finish();\r\n    }\r\n  }, [loadingActions.loadSearches]);\r\n\r\n  const loadPopularSearches = useCallback(async () => {\r\n    try {\r\n      const response = await apiClient.get('/api/_search/saved/popular');\r\n      if (response.success && response.data) {\r\n        setPopularSearches(Array.isArray(response.data) ? response.data : []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load popular searches:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Load saved searches on mount\r\n  useEffect(() => {\r\n    loadSavedSearches();\r\n    loadPopularSearches();\r\n  }, [loadSavedSearches, loadPopularSearches]);\r\n\r\n  const createSavedSearch = async () => {\r\n    if (!formData.values.name.trim() || !formData.values.entityType) {\r\n      toast.error('Name and entity type are required');\r\n      return;\r\n    }\r\n\r\n    loadingActions.createSearch.start();\r\n    try {\r\n      const response = await apiClient.post(\r\n        '/api/_search/saved',\r\n        formData.values\r\n      );\r\n      if (response.success) {\r\n        toast.success('Saved _search created successfully');\r\n        modalActions.createDialog.close();\r\n        formActions.reset();\r\n        loadSavedSearches();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to create saved _search:', error);\r\n      toast.error('Failed to create saved _search');\r\n    } finally {\r\n      loadingActions.createSearch.finish();\r\n    }\r\n  };\r\n\r\n  const updateSavedSearch = async () => {\r\n    if (!searchFilters.values.editingSearch || !formData.values.name.trim()) {\r\n      toast.error('Name is required');\r\n      return;\r\n    }\r\n\r\n    loadingActions.updateSearch.start();\r\n    try {\r\n      const response = await apiClient.put(\r\n        `/api/_search/saved/${searchFilters.values.editingSearch.id}`,\r\n        formData.values\r\n      );\r\n      if (response.success) {\r\n        toast.success('Saved _search updated successfully');\r\n        searchFilterActions.setValue('editingSearch', null);\r\n        formActions.reset();\r\n        loadSavedSearches();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to update saved _search:', error);\r\n      toast.error('Failed to update saved _search');\r\n    } finally {\r\n      loadingActions.updateSearch.finish();\r\n    }\r\n  };\r\n\r\n  const deleteSavedSearch = async (id: string) => {\r\n    if (!confirm('Are you sure you want to delete this saved _search?')) {\r\n      return;\r\n    }\r\n\r\n    loadingActions.deleteSearch.start();\r\n    try {\r\n      const response = await apiClient.delete(`/api/_search/saved/${id}`);\r\n      if (response.success) {\r\n        toast.success('Saved _search deleted successfully');\r\n        loadSavedSearches();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to delete saved _search:', error);\r\n      toast.error('Failed to delete saved _search');\r\n    } finally {\r\n      loadingActions.deleteSearch.finish();\r\n    }\r\n  };\r\n\r\n  const applySavedSearch = async (_search: SavedSearch) => {\r\n    try {\r\n      // Record the usage\r\n      await apiClient.get(`/api/_search/saved/${_search.id}`);\r\n\r\n      // Navigate to appropriate _search page with the saved parameters\r\n      const baseUrl = '/_search';\r\n      const entityPath =\r\n        _search.entityType === 'global' ? '' : `/${_search.entityType}`;\r\n      const params = new URLSearchParams(_search.searchParams);\r\n\r\n      // This would typically trigger a navigation\r\n      window.location.href = `${baseUrl}${entityPath}?${params.toString()}`;\r\n    } catch (error) {\r\n      console.error('Failed to use saved _search:', error);\r\n      toast.error('Failed to load saved _search');\r\n    }\r\n  };\r\n\r\n  const editSavedSearch = (_search: SavedSearch) => {\r\n    searchFilterActions.setFieldValue('editingSearch', _search);\r\n    formActions.setValues({\r\n      name: _search.name,\r\n      description: _search.description || '',\r\n      entityType: _search.entityType,\r\n      searchParams: _search.searchParams,\r\n      isPublic: _search.isPublic,\r\n      enableNotifications: _search.enableNotifications,\r\n    });\r\n  };\r\n\r\n  const resetForm = () => {\r\n    formActions.setValues({\r\n      name: '',\r\n      description: '',\r\n      entityType: 'books',\r\n      searchParams: {},\r\n      isPublic: false,\r\n      enableNotifications: false,\r\n    });\r\n  };\r\n\r\n  const getEntityTypeIcon = (entityType: string) => {\r\n    switch (entityType) {\r\n      case 'books':\r\n        return <BookOpen className=\"w-4 h-4\" />;\r\n      case 'students':\r\n        return <Users className=\"w-4 h-4\" />;\r\n      case 'equipment':\r\n        return <Monitor className=\"w-4 h-4\" />;\r\n      case 'global':\r\n        return <Search className=\"w-4 h-4\" />;\r\n      default:\r\n        return <Search className=\"w-4 h-4\" />;\r\n    }\r\n  };\r\n\r\n  const getEntityTypeLabel = (entityType: string) => {\r\n    switch (entityType) {\r\n      case 'books':\r\n        return 'Books';\r\n      case 'students':\r\n        return 'Students';\r\n      case 'equipment':\r\n        return 'Equipment';\r\n      case 'global':\r\n        return 'Global';\r\n      default:\r\n        return entityType;\r\n    }\r\n  };\r\n\r\n  const getSearchParamsSummary = (searchParams: any) => {\r\n    const params = [];\r\n\r\n    if (searchParams.query) {\r\n      params.push(`\"${searchParams.query}\"`);\r\n    }\r\n    if (searchParams.category) {\r\n      params.push(`Category: ${searchParams.category}`);\r\n    }\r\n    if (searchParams.gradeCategory) {\r\n      params.push(`Grade: ${searchParams.gradeCategory}`);\r\n    }\r\n    if (searchParams.type) {\r\n      params.push(`Type: ${searchParams.type}`);\r\n    }\r\n    if (searchParams.location) {\r\n      params.push(`Location: ${searchParams.location}`);\r\n    }\r\n    if (searchParams.isAvailable) {\r\n      params.push('Available only');\r\n    }\r\n    if (searchParams.hasFines) {\r\n      params.push('Has fines');\r\n    }\r\n\r\n    return params.slice(0, 3).join(', ') + (params.length > 3 ? '...' : '');\r\n  };\r\n\r\n  const filteredSearches = savedSearches.filter((_search) => {\r\n    const matchesQuery =\r\n      _search.name\r\n        .toLowerCase()\r\n        .includes(searchFilters.values.searchQuery.toLowerCase()) ||\r\n      _search.description\r\n        ?.toLowerCase()\r\n        .includes(searchFilters.values.searchQuery.toLowerCase());\r\n    const matchesEntityType =\r\n      searchFilters.values.filterEntityType === 'all' ||\r\n      _search.entityType === searchFilters.values.filterEntityType;\r\n    return matchesQuery && matchesEntityType;\r\n  });\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <Bookmark className=\"w-6 h-6\" />\r\n            Saved Searches\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Manage your saved _search queries and discover popular searches\r\n          </p>\r\n        </div>\r\n\r\n        <Button onClick={() => modalActions.createDialog.open()}>\r\n          <Plus className=\"w-4 h-4 mr-2\" />\r\n          Create New _Search\r\n        </Button>\r\n      </div>\r\n\r\n      {/* _Search and Filter Bar */}\r\n      <Card>\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"flex gap-4 items-center\">\r\n            <div className=\"flex-1 relative\">\r\n              <Search className=\"absolute left-3 top-3 w-4 h-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"_Search your saved searches...\"\r\n                value={searchFilters.values.searchQuery}\r\n                onChange={(e) =>\r\n                  searchFilterActions.setFieldValue(\r\n                    'searchQuery',\r\n                    e.target.value\r\n                  )\r\n                }\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n\r\n            <Select\r\n              value={searchFilters.values.filterEntityType}\r\n              onValueChange={(value) =>\r\n                searchFilterActions.setFieldValue('filterEntityType', value)\r\n              }\r\n            >\r\n              <SelectTrigger className=\"w-48\">\r\n                <SelectValue placeholder=\"Filter by type\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">All Types</SelectItem>\r\n                <SelectItem value=\"books\">Books</SelectItem>\r\n                <SelectItem value=\"students\">Students</SelectItem>\r\n                <SelectItem value=\"equipment\">Equipment</SelectItem>\r\n                <SelectItem value=\"global\">Global</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Main Content */}\r\n      <Tabs\r\n        value={searchFilters.values.activeTab}\r\n        onValueChange={(value) =>\r\n          searchFilterActions.setFieldValue('activeTab', value)\r\n        }\r\n      >\r\n        <TabsList>\r\n          <TabsTrigger value=\"my-searches\">\r\n            <Star className=\"w-4 h-4 mr-2\" />\r\n            My Searches ({savedSearches.length})\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"popular\">\r\n            <TrendingUp className=\"w-4 h-4 mr-2\" />\r\n            Popular Searches\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"my-searches\" className=\"space-y-4\">\r\n          {loading ? (\r\n            <div className=\"text-center py-8\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\r\n              <p className=\"text-muted-foreground mt-2\">\r\n                Loading saved searches...\r\n              </p>\r\n            </div>\r\n          ) : filteredSearches.length > 0 ? (\r\n            <div className=\"grid gap-4\">\r\n              {filteredSearches.map((_search) => (\r\n                <Card\r\n                  key={_search.id}\r\n                  className=\"hover:shadow-md transition-shadow\"\r\n                >\r\n                  <CardContent className=\"p-6\">\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            {getEntityTypeIcon(_search.entityType)}\r\n                            <h3 className=\"font-semibold text-lg\">\r\n                              {_search.name}\r\n                            </h3>\r\n                          </div>\r\n\r\n                          <div className=\"flex gap-2\">\r\n                            <Badge variant=\"outline\">\r\n                              {getEntityTypeLabel(_search.entityType)}\r\n                            </Badge>\r\n\r\n                            {_search.isPublic && (\r\n                              <Badge variant=\"secondary\">\r\n                                <Share2 className=\"w-3 h-3 mr-1\" />\r\n                                Public\r\n                              </Badge>\r\n                            )}\r\n\r\n                            {_search.enableNotifications && (\r\n                              <Badge variant=\"outline\">\r\n                                <Bell className=\"w-3 h-3 mr-1\" />\r\n                                Notifications\r\n                              </Badge>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        {_search.description && (\r\n                          <p className=\"text-muted-foreground mb-3\">\r\n                            {_search.description}\r\n                          </p>\r\n                        )}\r\n\r\n                        <div className=\"space-y-2\">\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            <strong>Parameters:</strong>{' '}\r\n                            {getSearchParamsSummary(_search.searchParams)}\r\n                          </div>\r\n\r\n                          <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\r\n                            <span className=\"flex items-center gap-1\">\r\n                              <Clock className=\"w-3 h-3\" />\r\n                              Used {_search.useCount} times\r\n                            </span>\r\n\r\n                            {_search.lastUsedAt && (\r\n                              <span>\r\n                                Last used{' '}\r\n                                {new Date(\r\n                                  _search.lastUsedAt\r\n                                ).toLocaleDateString()}\r\n                              </span>\r\n                            )}\r\n\r\n                            <span>\r\n                              Created{' '}\r\n                              {new Date(_search.createdAt).toLocaleDateString()}\r\n                            </span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex gap-2 ml-4\">\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => applySavedSearch(_search)}\r\n                        >\r\n                          <Eye className=\"w-4 h-4 mr-1\" />\r\n                          Use\r\n                        </Button>\r\n\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => editSavedSearch(_search)}\r\n                        >\r\n                          <Edit className=\"w-4 h-4 mr-1\" />\r\n                          Edit\r\n                        </Button>\r\n\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => deleteSavedSearch(_search.id)}\r\n                        >\r\n                          <Trash2 className=\"w-4 h-4 mr-1\" />\r\n                          Delete\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"flex flex-col items-center justify-center h-32\">\r\n                <Bookmark className=\"w-8 h-8 text-muted-foreground mb-2\" />\r\n                <p className=\"text-muted-foreground\">\r\n                  {searchQuery\r\n                    ? 'No saved searches found matching your criteria'\r\n                    : 'No saved searches yet'}\r\n                </p>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  className=\"mt-4\"\r\n                  onClick={() => setShowCreateDialog(true)}\r\n                >\r\n                  <Plus className=\"w-4 h-4 mr-2\" />\r\n                  Create Your First _Search\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"popular\" className=\"space-y-4\">\r\n          {popularSearches.length > 0 ? (\r\n            <div className=\"grid gap-4\">\r\n              {popularSearches.map((_search) => (\r\n                <Card\r\n                  key={_search.id}\r\n                  className=\"hover:shadow-md transition-shadow\"\r\n                >\r\n                  <CardContent className=\"p-6\">\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"flex items-center gap-3 mb-2\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            {getEntityTypeIcon(_search.entityType)}\r\n                            <h3 className=\"font-semibold text-lg\">\r\n                              {_search.name}\r\n                            </h3>\r\n                          </div>\r\n\r\n                          <div className=\"flex gap-2\">\r\n                            <Badge variant=\"outline\">\r\n                              {getEntityTypeLabel(_search.entityType)}\r\n                            </Badge>\r\n\r\n                            <Badge className=\"bg-green-500\">\r\n                              <TrendingUp className=\"w-3 h-3 mr-1\" />\r\n                              {_search.useCount} uses\r\n                            </Badge>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {_search.description && (\r\n                          <p className=\"text-muted-foreground mb-3\">\r\n                            {_search.description}\r\n                          </p>\r\n                        )}\r\n\r\n                        <div className=\"space-y-2\">\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            <strong>Parameters:</strong>{' '}\r\n                            {getSearchParamsSummary(_search.searchParams)}\r\n                          </div>\r\n\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            Created by {_search.userId} ΓÇó{' '}\r\n                            {new Date(_search.createdAt).toLocaleDateString()}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex gap-2 ml-4\">\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => applySavedSearch(_search)}\r\n                        >\r\n                          <Eye className=\"w-4 h-4 mr-1\" />\r\n                          Use\r\n                        </Button>\r\n\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => {\r\n                            // Copy _search parameters to create new _search\r\n                            setFormData({\r\n                              name: `Copy of ${_search.name}`,\r\n                              description: _search.description || '',\r\n                              entityType: _search.entityType,\r\n                              searchParams: _search.searchParams,\r\n                              isPublic: false,\r\n                              enableNotifications: false,\r\n                            });\r\n                            setShowCreateDialog(true);\r\n                          }}\r\n                        >\r\n                          <Copy className=\"w-4 h-4 mr-1\" />\r\n                          Copy\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <Card>\r\n              <CardContent className=\"flex flex-col items-center justify-center h-32\">\r\n                <TrendingUp className=\"w-8 h-8 text-muted-foreground mb-2\" />\r\n                <p className=\"text-muted-foreground\">\r\n                  No popular searches available yet\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* Create/Edit Dialog */}\r\n      <Dialog\r\n        open={\r\n          modalStates.createDialog.isOpen ||\r\n          !!searchFilters.values.editingSearch\r\n        }\r\n        onOpenChange={(open) => {\r\n          if (!open) {\r\n            modalActions.createDialog.close();\r\n            searchFilterActions.setFieldValue('editingSearch', null);\r\n            resetForm();\r\n          }\r\n        }}\r\n      >\r\n        <DialogContent className=\"max-w-md\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {searchFilters.values.editingSearch\r\n                ? 'Edit Saved _Search'\r\n                : 'Create New Saved _Search'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {searchFilters.values.editingSearch\r\n                ? 'Update your saved _search parameters'\r\n                : 'Save your current _search for future use'}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Name *</label>\r\n              <Input\r\n                placeholder=\"Enter _search name...\"\r\n                value={formData.values.name}\r\n                onChange={(e) =>\r\n                  formActions.setFieldValue('name', e.target.value)\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Description</label>\r\n              <Textarea\r\n                placeholder=\"Optional description...\"\r\n                value={formData.values.description}\r\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\r\n                  formActions.setFieldValue('description', e.target.value)\r\n                }\r\n                rows={3}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium\">Entity Type *</label>\r\n              <Select\r\n                value={formData.values.entityType}\r\n                onValueChange={(value: any) =>\r\n                  formActions.setFieldValue('entityType', value)\r\n                }\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"books\">Books</SelectItem>\r\n                  <SelectItem value=\"students\">Students</SelectItem>\r\n                  <SelectItem value=\"equipment\">Equipment</SelectItem>\r\n                  <SelectItem value=\"global\">Global</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"space-y-0.5\">\r\n                <label className=\"text-sm font-medium\">Public _Search</label>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Allow other users to see and use this _search\r\n                </p>\r\n              </div>\r\n              <Switch\r\n                checked={formData.values.isPublic}\r\n                onCheckedChange={(checked) =>\r\n                  formActions.setFieldValue('isPublic', checked)\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"space-y-0.5\">\r\n                <label className=\"text-sm font-medium\">\r\n                  Enable Notifications\r\n                </label>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Get notified when new items match this _search\r\n                </p>\r\n              </div>\r\n              <Switch\r\n                checked={formData.values.enableNotifications}\r\n                onCheckedChange={(checked) =>\r\n                  formActions.setFieldValue('enableNotifications', checked)\r\n                }\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                modalActions.createDialog.close();\r\n                searchFilterActions.setFieldValue('editingSearch', null);\r\n                resetForm();\r\n              }}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={\r\n                searchFilters.values.editingSearch\r\n                  ? updateSavedSearch\r\n                  : createSavedSearch\r\n              }\r\n            >\r\n              {searchFilters.values.editingSearch ? 'Update' : 'Create'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\search\\SearchAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\security\\AccessRequest.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3725,3728],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3725,3728],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":546,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":546,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17156,17159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17156,17159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":568,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":568,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18108,18111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18108,18111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":591,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":591,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19135,19138],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19135,19138],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":857,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":857,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[29101,29104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[29101,29104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Clock,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertTriangle,\r\n  FileText,\r\n  Send,\r\n  Eye,\r\n  Users,\r\n  Info,\r\n  Loader2,\r\n} from 'lucide-react';\r\nimport { useMultipleLoadingStates, useMultipleModals, useForm } from '@/hooks';\r\n\r\n// Types\r\ninterface AccessRequest {\r\n  id: string;\r\n  requesterId: string;\r\n  requesterName: string;\r\n  requesterRole: string;\r\n  targetType: 'student' | 'students' | 'activity' | 'activities';\r\n  targetId?: string;\r\n  targetDescription?: string;\r\n  accessType: 'VIEW' | 'EDIT' | 'EXPORT' | 'PRINT' | 'SHARE' | 'ANALYTICS';\r\n  justification:\r\n    | 'EDUCATIONAL_PURPOSE'\r\n    | 'LEGAL_REQUIREMENT'\r\n    | 'HEALTH_SAFETY'\r\n    | 'CONSENT'\r\n    | 'DIRECTORY_INFO'\r\n    | 'ADMINISTRATIVE'\r\n    | 'RESEARCH'\r\n    | 'AUDIT';\r\n  justificationText: string;\r\n  duration: number;\r\n  status: 'pending' | 'approved' | 'denied' | 'expired' | 'revoked';\r\n  createdAt: string;\r\n  approvedBy?: string;\r\n  approvedAt?: string;\r\n  expiresAt?: string;\r\n  metadata: {\r\n    ipAddress: string;\r\n    userAgent: string;\r\n  };\r\n}\r\n\r\ninterface _NewAccessRequest {\r\n  targetType: 'student' | 'students' | 'activity' | 'activities';\r\n  targetId?: string;\r\n  accessType: 'VIEW' | 'EDIT' | 'EXPORT' | 'PRINT' | 'SHARE' | 'ANALYTICS';\r\n  justification:\r\n    | 'EDUCATIONAL_PURPOSE'\r\n    | 'LEGAL_REQUIREMENT'\r\n    | 'HEALTH_SAFETY'\r\n    | 'CONSENT'\r\n    | 'DIRECTORY_INFO'\r\n    | 'ADMINISTRATIVE'\r\n    | 'RESEARCH'\r\n    | 'AUDIT';\r\n  justificationText: string;\r\n  duration: number;\r\n}\r\n\r\nconst AccessRequestManager: React.FC = () => {\r\n  const [requests, setRequests] = useState<AccessRequest[]>([]);\r\n\r\n  // Consolidated loading states\r\n  const [loadingStates, loadingActions] = useMultipleLoadingStates({\r\n    fetchRequests: { isLoading: false },\r\n    submitRequest: { isLoading: false },\r\n    approveRequest: { isLoading: false },\r\n    denyRequest: { isLoading: false },\r\n  });\r\n\r\n  // Consolidated modal/dialog states\r\n  const [modalStates, modalActions] = useMultipleModals({\r\n    newRequestDialog: false,\r\n    requestDetailsDialog: false,\r\n  });\r\n\r\n  // UI state management\r\n  const [uiState, uiActions] = useForm({\r\n    initialValues: {\r\n      activeTab: 'my-requests',\r\n      selectedRequest: null as AccessRequest | null,\r\n    },\r\n    validationSchema: {},\r\n  });\r\n\r\n  // Form state for new request\r\n  const [newRequestForm, formActions] = useForm({\r\n    initialValues: {\r\n      targetType: 'student',\r\n      accessType: 'VIEW',\r\n      justification: 'EDUCATIONAL_PURPOSE',\r\n      justificationText: '',\r\n      duration: 24,\r\n    },\r\n    validationSchema: {\r\n      justificationText: { required: true },\r\n      duration: {\r\n        required: true,\r\n        minLength: 1,\r\n        custom: (value: any) => {\r\n          if (!value || value < 1 || value > 168) {\r\n            return 'Duration must be between 1 and 168 hours';\r\n          }\r\n          return null;\r\n        },\r\n      },\r\n    },\r\n  });\r\n\r\n  // Mock user data - in real app, this would come from auth context\r\n  const currentUser = {\r\n    id: 'user_123',\r\n    name: 'John Teacher',\r\n    role: 'TEACHER',\r\n  };\r\n\r\n  const isApprover = ['SUPER_ADMIN', 'ADMIN'].includes(currentUser.role);\r\n\r\n  // Fetch access requests\r\n  const fetchAccessRequests = useCallback(async () => {\r\n    try {\r\n      loadingActions.fetchRequests.start();\r\n\r\n      // Mock API call - in real app, this would be an actual API call\r\n      const mockRequests: AccessRequest[] = [\r\n        {\r\n          id: 'req_001',\r\n          requesterId: 'user_123',\r\n          requesterName: 'John Teacher',\r\n          requesterRole: 'TEACHER',\r\n          targetType: 'students',\r\n          accessType: 'VIEW',\r\n          justification: 'EDUCATIONAL_PURPOSE',\r\n          justificationText:\r\n            'Need to access student grades for report card preparation',\r\n          duration: 48,\r\n          status: 'approved',\r\n          createdAt: '2024-01-14T10:30:00Z',\r\n          approvedBy: 'admin_001',\r\n          approvedAt: '2024-01-14T11:15:00Z',\r\n          expiresAt: '2024-01-16T10:30:00Z',\r\n          metadata: {\r\n            ipAddress: '192.168.1.100',\r\n            userAgent:\r\n              'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',\r\n          },\r\n        },\r\n        {\r\n          id: 'req_002',\r\n          requesterId: 'user_456',\r\n          requesterName: 'Jane Librarian',\r\n          requesterRole: 'LIBRARIAN',\r\n          targetType: 'student',\r\n          targetId: 'student_789',\r\n          targetDescription: 'Student: Sarah Smith (Grade 10)',\r\n          accessType: 'EXPORT',\r\n          justification: 'ADMINISTRATIVE',\r\n          justificationText:\r\n            'Export student contact information for library card renewal notices',\r\n          duration: 8,\r\n          status: 'pending',\r\n          createdAt: '2024-01-15T09:15:00Z',\r\n          metadata: {\r\n            ipAddress: '192.168.1.101',\r\n            userAgent:\r\n              'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',\r\n          },\r\n        },\r\n      ];\r\n\r\n      // Filter requests based on user role and active tab\r\n      let filteredRequests = mockRequests;\r\n\r\n      if (uiState.values.activeTab === 'my-requests') {\r\n        filteredRequests = mockRequests.filter(\r\n          (req) => req.requesterId === currentUser.id\r\n        );\r\n      } else if (\r\n        uiState.values.activeTab === 'pending-approval' &&\r\n        isApprover\r\n      ) {\r\n        filteredRequests = mockRequests.filter(\r\n          (req) => req.status === 'pending'\r\n        );\r\n      }\r\n\r\n      setRequests(filteredRequests);\r\n    } catch (error) {\r\n      console.error('Failed to fetch access requests:', error);\r\n    } finally {\r\n      loadingActions.fetchRequests.finish();\r\n    }\r\n  }, [\r\n    loadingActions.fetchRequests,\r\n    uiState.values.activeTab,\r\n    currentUser.id,\r\n    isApprover,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    fetchAccessRequests();\r\n  }, [fetchAccessRequests]);\r\n\r\n  const handleSubmitRequest = async () => {\r\n    try {\r\n      loadingActions.submitRequest.start();\r\n\r\n      // Validate form\r\n      if (!newRequestForm.values.justificationText.trim()) {\r\n        alert('Please provide a justification for your request');\r\n        return;\r\n      }\r\n\r\n      // Mock API call - in real app, this would be an actual API call\r\n      const newRequestData: AccessRequest = {\r\n        id: `req_${Date.now()}`,\r\n        requesterId: currentUser.id,\r\n        requesterName: currentUser.name,\r\n        requesterRole: currentUser.role,\r\n        targetType: newRequestForm.values.targetType,\r\n        accessType: newRequestForm.values.accessType,\r\n        justification: newRequestForm.values.justification,\r\n        justificationText: newRequestForm.values.justificationText,\r\n        duration: newRequestForm.values.duration,\r\n        status: 'pending',\r\n        createdAt: new Date().toISOString(),\r\n        metadata: {\r\n          ipAddress: '192.168.1.100', // Would get from actual request\r\n          userAgent: navigator.userAgent,\r\n        },\r\n      };\r\n\r\n      setRequests((prev) => [newRequestData, ...prev]);\r\n      modalActions.newRequestDialog.close();\r\n      formActions.reset();\r\n\r\n      alert('Access request submitted successfully');\r\n    } catch (error) {\r\n      console.error('Failed to submit request:', error);\r\n      alert('Failed to submit request. Please try again.');\r\n    } finally {\r\n      loadingActions.submitRequest.finish();\r\n    }\r\n  };\r\n\r\n  const handleApproveRequest = async (requestId: string) => {\r\n    try {\r\n      loadingActions.approveRequest.start();\r\n\r\n      // Mock API call\r\n      setRequests((prev) =>\r\n        prev.map((req) =>\r\n          req.id === requestId\r\n            ? {\r\n                ...req,\r\n                status: 'approved' as const,\r\n                approvedBy: currentUser.id,\r\n                approvedAt: new Date().toISOString(),\r\n                expiresAt: new Date(\r\n                  Date.now() + req.duration * 60 * 60 * 1000\r\n                ).toISOString(),\r\n              }\r\n            : req\r\n        )\r\n      );\r\n\r\n      alert('Request approved successfully');\r\n    } catch (error) {\r\n      console.error('Failed to approve request:', error);\r\n      alert('Failed to approve request. Please try again.');\r\n    } finally {\r\n      loadingActions.approveRequest.finish();\r\n    }\r\n  };\r\n\r\n  const handleDenyRequest = async (requestId: string) => {\r\n    try {\r\n      loadingActions.denyRequest.start();\r\n\r\n      const reason = prompt(\r\n        'Please provide a reason for denying this request:'\r\n      );\r\n      if (!reason) {\r\n        return;\r\n      }\r\n\r\n      // Mock API call\r\n      setRequests((prev) =>\r\n        prev.map((req) =>\r\n          req.id === requestId ? { ...req, status: 'denied' as const } : req\r\n        )\r\n      );\r\n\r\n      alert('Request denied successfully');\r\n    } catch (error) {\r\n      console.error('Failed to deny request:', error);\r\n      alert('Failed to deny request. Please try again.');\r\n    } finally {\r\n      loadingActions.denyRequest.finish();\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'denied':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\r\n      case 'pending':\r\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'expired':\r\n        return <AlertTriangle className=\"h-4 w-4 text-gray-500\" />;\r\n      case 'revoked':\r\n        return <XCircle className=\"h-4 w-4 text-orange-500\" />;\r\n      default:\r\n        return <Clock className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'denied':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'pending':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'expired':\r\n        return 'bg-gray-100 text-gray-800';\r\n      case 'revoked':\r\n        return 'bg-orange-100 text-orange-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getJustificationLabel = (justification: string) => {\r\n    return justification\r\n      .replace(/_/g, ' ')\r\n      .toLowerCase()\r\n      .replace(/\\b\\w/g, (l) => l.toUpperCase());\r\n  };\r\n\r\n  if (loadingStates.fetchRequests.isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n        <span className=\"ml-2\">Loading access requests...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6 p-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n            <FileText className=\"h-8 w-8\" />\r\n            Access Request Management\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Manage FERPA compliance access requests and approvals\r\n          </p>\r\n        </div>\r\n\r\n        <Button onClick={() => modalActions.newRequestDialog.open()}>\r\n          <Send className=\"h-4 w-4 mr-2\" />\r\n          New Access Request\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Info Alert */}\r\n      <Alert>\r\n        <Info className=\"h-4 w-4\" />\r\n        <AlertTitle>FERPA Compliance Notice</AlertTitle>\r\n        <AlertDescription>\r\n          All access to sensitive student data requires proper justification and\r\n          approval. Requests are logged and audited to ensure compliance with\r\n          FERPA regulations.\r\n        </AlertDescription>\r\n      </Alert>\r\n\r\n      {/* Tabs */}\r\n      <Tabs\r\n        value={uiState.values.activeTab}\r\n        onValueChange={(value) => uiActions.setFieldValue('activeTab', value)}\r\n      >\r\n        <TabsList>\r\n          <TabsTrigger value=\"my-requests\">My Requests</TabsTrigger>\r\n          <TabsTrigger value=\"pending-approval\" disabled={!isApprover}>\r\n            Pending Approval\r\n            {requests.filter((req) => req.status === 'pending').length > 0 && (\r\n              <Badge className=\"ml-2\" variant=\"destructive\">\r\n                {requests.filter((req) => req.status === 'pending').length}\r\n              </Badge>\r\n            )}\r\n          </TabsTrigger>\r\n          {isApprover && (\r\n            <TabsTrigger value=\"all-requests\">All Requests</TabsTrigger>\r\n          )}\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"my-requests\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Users className=\"h-5 w-5\" />\r\n                My Access Requests\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Track the status of your access requests\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <AccessRequestTable\r\n                requests={requests}\r\n                currentUser={currentUser}\r\n                isApprover={isApprover}\r\n                onApprove={handleApproveRequest}\r\n                onDeny={handleDenyRequest}\r\n                onSelect={(request) =>\r\n                  uiActions.setFieldValue('selectedRequest', request)\r\n                }\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"pending-approval\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Clock className=\"h-5 w-5\" />\r\n                Pending Approval\r\n              </CardTitle>\r\n              <CardDescription>\r\n                Review and approve access requests from other users\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <AccessRequestTable\r\n                requests={requests}\r\n                currentUser={currentUser}\r\n                isApprover={isApprover}\r\n                onApprove={handleApproveRequest}\r\n                onDeny={handleDenyRequest}\r\n                onSelect={(request) =>\r\n                  uiActions.setFieldValue('selectedRequest', request)\r\n                }\r\n                showActions={true}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"all-requests\" className=\"space-y-4\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                All Access Requests\r\n              </CardTitle>\r\n              <CardDescription>\r\n                View all access requests in the system\r\n              </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <AccessRequestTable\r\n                requests={requests}\r\n                currentUser={currentUser}\r\n                isApprover={isApprover}\r\n                onApprove={handleApproveRequest}\r\n                onDeny={handleDenyRequest}\r\n                onSelect={(request) =>\r\n                  uiActions.setFieldValue('selectedRequest', request)\r\n                }\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      {/* New Request Dialog */}\r\n      <Dialog\r\n        open={modalStates.newRequestDialog.isOpen}\r\n        onOpenChange={(open) => modalActions.newRequestDialog.setIsOpen(open)}\r\n      >\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>New Access Request</DialogTitle>\r\n            <DialogDescription>\r\n              Submit a request for access to sensitive data. All requests\r\n              require proper justification.\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 py-4\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"targetType\">Target Type</Label>\r\n                <Select\r\n                  value={newRequestForm.values.targetType}\r\n                  onValueChange={(value: any) =>\r\n                    formActions.setFieldValue('targetType', value)\r\n                  }\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"student\">Specific Student</SelectItem>\r\n                    <SelectItem value=\"students\">Multiple Students</SelectItem>\r\n                    <SelectItem value=\"activity\">Student Activity</SelectItem>\r\n                    <SelectItem value=\"activities\">\r\n                      Multiple Activities\r\n                    </SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"accessType\">Access Type</Label>\r\n                <Select\r\n                  value={newRequestForm.values.accessType}\r\n                  onValueChange={(value: any) =>\r\n                    formActions.setFieldValue('accessType', value)\r\n                  }\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"VIEW\">View Only</SelectItem>\r\n                    <SelectItem value=\"EDIT\">Edit/Modify</SelectItem>\r\n                    <SelectItem value=\"EXPORT\">Export Data</SelectItem>\r\n                    <SelectItem value=\"PRINT\">Print</SelectItem>\r\n                    <SelectItem value=\"SHARE\">Share</SelectItem>\r\n                    <SelectItem value=\"ANALYTICS\">Analytics</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"justification\">Justification Category</Label>\r\n              <Select\r\n                value={newRequestForm.values.justification}\r\n                onValueChange={(value: any) =>\r\n                  formActions.setFieldValue('justification', value)\r\n                }\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"EDUCATIONAL_PURPOSE\">\r\n                    Educational Purpose\r\n                  </SelectItem>\r\n                  <SelectItem value=\"LEGAL_REQUIREMENT\">\r\n                    Legal Requirement\r\n                  </SelectItem>\r\n                  <SelectItem value=\"HEALTH_SAFETY\">Health & Safety</SelectItem>\r\n                  <SelectItem value=\"CONSENT\">With Consent</SelectItem>\r\n                  <SelectItem value=\"DIRECTORY_INFO\">\r\n                    Directory Information\r\n                  </SelectItem>\r\n                  <SelectItem value=\"ADMINISTRATIVE\">Administrative</SelectItem>\r\n                  <SelectItem value=\"RESEARCH\">Research</SelectItem>\r\n                  <SelectItem value=\"AUDIT\">Audit</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"justificationText\">Detailed Justification</Label>\r\n              <Textarea\r\n                id=\"justificationText\"\r\n                placeholder=\"Please provide a detailed explanation of why you need this access...\"\r\n                value={newRequestForm.values.justificationText}\r\n                onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\r\n                  formActions.setFieldValue('justificationText', e.target.value)\r\n                }\r\n                rows={4}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"duration\">Duration (hours)</Label>\r\n              <Input\r\n                id=\"duration\"\r\n                type=\"number\"\r\n                min=\"1\"\r\n                max=\"168\"\r\n                value={newRequestForm.values.duration}\r\n                onChange={(e) =>\r\n                  formActions.setFieldValue(\r\n                    'duration',\r\n                    parseInt(e.target.value) || 1\r\n                  )\r\n                }\r\n              />\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Maximum duration is 168 hours (7 days)\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => modalActions.newRequestDialog.close()}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSubmitRequest}\r\n              disabled={loadingStates.submitRequest.isLoading}\r\n            >\r\n              {loadingStates.submitRequest.isLoading ? (\r\n                <>\r\n                  <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n                  Submitting...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Send className=\"h-4 w-4 mr-2\" />\r\n                  Submit Request\r\n                </>\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Request Details Dialog */}\r\n      {uiState.values.selectedRequest && (\r\n        <Dialog\r\n          open={!!uiState.values.selectedRequest}\r\n          onOpenChange={() => uiActions.setFieldValue('selectedRequest', null)}\r\n        >\r\n          <DialogContent className=\"max-w-2xl\">\r\n            <DialogHeader>\r\n              <DialogTitle className=\"flex items-center gap-2\">\r\n                {getStatusIcon(uiState.values.selectedRequest.status)}\r\n                Access Request Details\r\n              </DialogTitle>\r\n            </DialogHeader>\r\n\r\n            <ScrollArea className=\"max-h-96\">\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Request ID</Label>\r\n                    <p className=\"font-mono text-sm\">\r\n                      {uiState.values.selectedRequest.id}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Status</Label>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      {getStatusIcon(uiState.values.selectedRequest.status)}\r\n                      <Badge\r\n                        className={getStatusColor(\r\n                          uiState.values.selectedRequest.status\r\n                        )}\r\n                      >\r\n                        {uiState.values.selectedRequest.status.toUpperCase()}\r\n                      </Badge>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Requester</Label>\r\n                    <p>\r\n                      {uiState.values.selectedRequest.requesterName} (\r\n                      {uiState.values.selectedRequest.requesterRole})\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Created</Label>\r\n                    <p>\r\n                      {new Date(\r\n                        uiState.values.selectedRequest.createdAt\r\n                      ).toLocaleString()}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Target Type</Label>\r\n                    <p className=\"capitalize\">\r\n                      {uiState.values.selectedRequest.targetType}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Access Type</Label>\r\n                    <p className=\"capitalize\">\r\n                      {uiState.values.selectedRequest.accessType}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label>Justification</Label>\r\n                  <p className=\"font-medium\">\r\n                    {getJustificationLabel(\r\n                      uiState.values.selectedRequest.justification\r\n                    )}\r\n                  </p>\r\n                </div>\r\n\r\n                <div>\r\n                  <Label>Detailed Justification</Label>\r\n                  <p className=\"text-sm text-muted-foreground mt-1\">\r\n                    {uiState.values.selectedRequest.justificationText}\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Duration</Label>\r\n                    <p>{uiState.values.selectedRequest.duration} hours</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Expires</Label>\r\n                    <p>\r\n                      {uiState.values.selectedRequest.expiresAt\r\n                        ? new Date(\r\n                            uiState.values.selectedRequest.expiresAt\r\n                          ).toLocaleString()\r\n                        : 'N/A'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {uiState.values.selectedRequest.approvedBy && (\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Approved By</Label>\r\n                      <p>{uiState.values.selectedRequest.approvedBy}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Approved At</Label>\r\n                      <p>\r\n                        {uiState.values.selectedRequest.approvedAt\r\n                          ? new Date(\r\n                              uiState.values.selectedRequest.approvedAt\r\n                            ).toLocaleString()\r\n                          : 'N/A'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Metadata</Label>\r\n                  <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                    <p>\r\n                      IP Address:{' '}\r\n                      {uiState.values.selectedRequest.metadata.ipAddress}\r\n                    </p>\r\n                    <p>\r\n                      User Agent:{' '}\r\n                      {uiState.values.selectedRequest.metadata.userAgent}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </ScrollArea>\r\n\r\n            <div className=\"flex justify-end gap-2 mt-4\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => uiActions.setFieldValue('selectedRequest', null)}\r\n              >\r\n                Close\r\n              </Button>\r\n              {isApprover &&\r\n                uiState.values.selectedRequest.status === 'pending' && (\r\n                  <>\r\n                    <Button\r\n                      variant=\"destructive\"\r\n                      onClick={() => {\r\n                        handleDenyRequest(uiState.values.selectedRequest.id);\r\n                        uiActions.setFieldValue('selectedRequest', null);\r\n                      }}\r\n                    >\r\n                      Deny\r\n                    </Button>\r\n                    <Button\r\n                      onClick={() => {\r\n                        handleApproveRequest(uiState.values.selectedRequest.id);\r\n                        uiActions.setFieldValue('selectedRequest', null);\r\n                      }}\r\n                    >\r\n                      Approve\r\n                    </Button>\r\n                  </>\r\n                )}\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Access Request Table Component\r\ninterface AccessRequestTableProps {\r\n  requests: AccessRequest[];\r\n  currentUser: any;\r\n  isApprover: boolean;\r\n  onApprove: (id: string) => void;\r\n  onDeny: (id: string) => void;\r\n  onSelect: (request: AccessRequest) => void;\r\n  showActions?: boolean;\r\n}\r\n\r\nconst AccessRequestTable: React.FC<AccessRequestTableProps> = ({\r\n  requests,\r\n  onApprove,\r\n  onDeny,\r\n  onSelect,\r\n  showActions = false,\r\n}) => {\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'denied':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\r\n      case 'pending':\r\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'expired':\r\n        return <AlertTriangle className=\"h-4 w-4 text-gray-500\" />;\r\n      case 'revoked':\r\n        return <XCircle className=\"h-4 w-4 text-orange-500\" />;\r\n      default:\r\n        return <Clock className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'approved':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'denied':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'pending':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'expired':\r\n        return 'bg-gray-100 text-gray-800';\r\n      case 'revoked':\r\n        return 'bg-orange-100 text-orange-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getJustificationLabel = (justification: string) => {\r\n    return justification\r\n      .replace(/_/g, ' ')\r\n      .toLowerCase()\r\n      .replace(/\\b\\w/g, (l) => l.toUpperCase());\r\n  };\r\n\r\n  return (\r\n    <Table>\r\n      <TableHeader>\r\n        <TableRow>\r\n          <TableHead>Request ID</TableHead>\r\n          <TableHead>Requester</TableHead>\r\n          <TableHead>Target</TableHead>\r\n          <TableHead>Access Type</TableHead>\r\n          <TableHead>Justification</TableHead>\r\n          <TableHead>Duration</TableHead>\r\n          <TableHead>Status</TableHead>\r\n          <TableHead>Created</TableHead>\r\n          {showActions && <TableHead>Actions</TableHead>}\r\n          <TableHead></TableHead>\r\n        </TableRow>\r\n      </TableHeader>\r\n      <TableBody>\r\n        {requests.map((request) => (\r\n          <TableRow key={request.id}>\r\n            <TableCell className=\"font-mono text-sm\">\r\n              {request.id.substring(0, 12)}...\r\n            </TableCell>\r\n            <TableCell>\r\n              <div>\r\n                <p className=\"font-medium\">{request.requesterName}</p>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  {request.requesterRole}\r\n                </p>\r\n              </div>\r\n            </TableCell>\r\n            <TableCell>\r\n              <div>\r\n                <p className=\"capitalize\">{request.targetType}</p>\r\n                {request.targetDescription && (\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    {request.targetDescription}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </TableCell>\r\n            <TableCell>\r\n              <Badge variant=\"outline\">{request.accessType}</Badge>\r\n            </TableCell>\r\n            <TableCell>\r\n              <div>\r\n                <p className=\"text-sm\">\r\n                  {getJustificationLabel(request.justification)}\r\n                </p>\r\n                <p className=\"text-xs text-muted-foreground truncate max-w-xs\">\r\n                  {request.justificationText}\r\n                </p>\r\n              </div>\r\n            </TableCell>\r\n            <TableCell>{request.duration}h</TableCell>\r\n            <TableCell>\r\n              <div className=\"flex items-center gap-2\">\r\n                {getStatusIcon(request.status)}\r\n                <Badge className={getStatusColor(request.status)}>\r\n                  {request.status.toUpperCase()}\r\n                </Badge>\r\n              </div>\r\n            </TableCell>\r\n            <TableCell>\r\n              {new Date(request.createdAt).toLocaleDateString()}\r\n            </TableCell>\r\n            {showActions && request.status === 'pending' && (\r\n              <TableCell>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    size=\"sm\"\r\n                    variant=\"outline\"\r\n                    onClick={() => onApprove(request.id)}\r\n                  >\r\n                    <CheckCircle className=\"h-3 w-3\" />\r\n                  </Button>\r\n                  <Button\r\n                    size=\"sm\"\r\n                    variant=\"outline\"\r\n                    onClick={() => onDeny(request.id)}\r\n                  >\r\n                    <XCircle className=\"h-3 w-3\" />\r\n                  </Button>\r\n                </div>\r\n              </TableCell>\r\n            )}\r\n            <TableCell>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                onClick={() => onSelect(request)}\r\n              >\r\n                <Eye className=\"h-4 w-4\" />\r\n              </Button>\r\n            </TableCell>\r\n          </TableRow>\r\n        ))}\r\n      </TableBody>\r\n    </Table>\r\n  );\r\n};\r\n\r\nexport default AccessRequestManager;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\security\\AuditLogViewer.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":495,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":495,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16007,16010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16007,16010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r\nimport {\r\n  Download,\r\n  Filter,\r\n  Search,\r\n  Eye,\r\n  Shield,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  XCircle,\r\n  Database,\r\n  FileText,\r\n  RefreshCw,\r\n  ChevronDown,\r\n  Activity,\r\n} from 'lucide-react';\r\n\r\n// Types\r\ninterface AuditLogEntry {\r\n  id: string;\r\n  timestamp: string;\r\n  userId: string;\r\n  userRole?: string;\r\n  sessionId?: string;\r\n  requestId?: string;\r\n  endpoint?: string;\r\n  method?: string;\r\n  ipAddress: string;\r\n  userAgent?: string;\r\n  entityType: string;\r\n  entityId?: string;\r\n  action: 'CREATE' | 'READ' | 'UPDATE' | 'DELETE' | 'EXPORT' | '_SEARCH';\r\n  fieldsAccessed: string[];\r\n  sensitiveFieldsAccessed: string[];\r\n  encryptedFieldsAccessed: string[];\r\n  dataAccessLevel:\r\n    | 'PUBLIC'\r\n    | 'LIMITED'\r\n    | 'SENSITIVE'\r\n    | 'RESTRICTED'\r\n    | 'CONFIDENTIAL';\r\n  recordsAffected: number;\r\n  dataSize: number;\r\n  responseStatus: number;\r\n  success: boolean;\r\n  errorType?: string;\r\n  errorMessage?: string;\r\n  duration: number;\r\n  ferpaCompliance: {\r\n    required: boolean;\r\n    verified: boolean;\r\n    accessRequestId?: string;\r\n    justificationProvided: boolean;\r\n  };\r\n  securityFlags: {\r\n    suspiciousActivity: boolean;\r\n    unusualAccessPattern: boolean;\r\n    dataExfiltrationRisk: boolean;\r\n    privilegeEscalationAttempt: boolean;\r\n    bruteForceIndicator: boolean;\r\n  };\r\n  metadata: {\r\n    requestSize: number;\r\n    responseSize: number;\r\n    cacheHit: boolean;\r\n    databaseQueryCount: number;\r\n    apiRate: number;\r\n  };\r\n}\r\n\r\ninterface FilterOptions {\r\n  dateRange: '1h' | '24h' | '7d' | '30d' | 'custom';\r\n  startDate?: string;\r\n  endDate?: string;\r\n  userId?: string;\r\n  userRole?: string;\r\n  entityType?: string;\r\n  action?: string;\r\n  success?: boolean;\r\n  dataAccessLevel?: string;\r\n  hasSecurityFlags?: boolean;\r\n  ferpaRequired?: boolean;\r\n  endpoint?: string;\r\n  ipAddress?: string;\r\n  minRecordsAffected?: number;\r\n  maxRecordsAffected?: number;\r\n  minDuration?: number;\r\n  maxDuration?: number;\r\n}\r\n\r\nconst AuditLogViewer: React.FC = () => {\r\n  const [logs, setLogs] = useState<AuditLogEntry[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedLog, setSelectedLog] = useState<AuditLogEntry | null>(null);\r\n  const [filters, setFilters] = useState<FilterOptions>({\r\n    dateRange: '24h',\r\n  });\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(1);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [exporting, setExporting] = useState(false);\r\n\r\n  const logsPerPage = 50;\r\n\r\n  // Fetch audit logs\r\n  const fetchAuditLogs = useCallback(\r\n    async (page: number = 1) => {\r\n      try {\r\n        setLoading(true);\r\n\r\n        // Mock API call - in real app, this would be an actual API call\r\n        const mockLogs = Array.from({ length: 150 }, (_, index) => ({\r\n          id: `audit_${Date.now()}_${index}`,\r\n          timestamp: new Date(\r\n            Date.now() - Math.random() * 24 * 60 * 60 * 1000\r\n          ).toISOString(),\r\n          userId: `user_${Math.floor(Math.random() * 100)}`,\r\n          userRole: ['TEACHER', 'LIBRARIAN', 'ADMIN', 'STAFF'][\r\n            Math.floor(Math.random() * 4)\r\n          ] as AuditLogEntry['userRole'],\r\n          sessionId: `session_${Math.random().toString(36).substr(2, 9)}`,\r\n          requestId: `req_${Math.random().toString(36).substr(2, 9)}`,\r\n          endpoint: [\r\n            '/api/students',\r\n            '/api/activities',\r\n            '/api/books',\r\n            '/api/equipment',\r\n          ][Math.floor(Math.random() * 4)] as AuditLogEntry['endpoint'],\r\n          method: ['GET', 'POST', 'PUT', 'DELETE'][\r\n            Math.floor(Math.random() * 4)\r\n          ] as AuditLogEntry['method'],\r\n          ipAddress: `192.168.1.${Math.floor(Math.random() * 255)}`,\r\n          userAgent:\r\n            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',\r\n          entityType: ['student', 'activity', 'book', 'equipment'][\r\n            Math.floor(Math.random() * 4)\r\n          ],\r\n          entityId: `entity_${Math.floor(Math.random() * 1000)}`,\r\n          action: ['READ', 'CREATE', 'UPDATE', 'DELETE', 'EXPORT', '_SEARCH'][\r\n            Math.floor(Math.random() * 6)\r\n          ] as AuditLogEntry['action'],\r\n          fieldsAccessed: ['name', 'email', 'grade', 'section'].slice(\r\n            0,\r\n            Math.floor(Math.random() * 4) + 1\r\n          ),\r\n          sensitiveFieldsAccessed:\r\n            Math.random() > 0.7 ? ['email', 'phone'] : [],\r\n          encryptedFieldsAccessed:\r\n            Math.random() > 0.8 ? ['ssn', 'medical_info'] : [],\r\n          dataAccessLevel: [\r\n            'PUBLIC',\r\n            'LIMITED',\r\n            'SENSITIVE',\r\n            'RESTRICTED',\r\n            'CONFIDENTIAL',\r\n          ][Math.floor(Math.random() * 5)] as AuditLogEntry['dataAccessLevel'],\r\n          recordsAffected: Math.floor(Math.random() * 100),\r\n          dataSize: Math.floor(Math.random() * 10000),\r\n          responseStatus:\r\n            Math.random() > 0.1\r\n              ? 200\r\n              : [400, 401, 403, 404, 500][Math.floor(Math.random() * 5)],\r\n          success: Math.random() > 0.1,\r\n          duration: Math.floor(Math.random() * 1000) + 10,\r\n          ferpaCompliance: {\r\n            required: Math.random() > 0.5,\r\n            verified: Math.random() > 0.3,\r\n            accessRequestId:\r\n              Math.random() > 0.7\r\n                ? `req_${Math.random().toString(36).substr(2, 9)}`\r\n                : undefined,\r\n            justificationProvided: Math.random() > 0.4,\r\n          },\r\n          securityFlags: {\r\n            suspiciousActivity: Math.random() > 0.9,\r\n            unusualAccessPattern: Math.random() > 0.85,\r\n            dataExfiltrationRisk: Math.random() > 0.95,\r\n            privilegeEscalationAttempt: Math.random() > 0.98,\r\n            bruteForceIndicator: Math.random() > 0.95,\r\n          },\r\n          metadata: {\r\n            requestSize: Math.floor(Math.random() * 1000),\r\n            responseSize: Math.floor(Math.random() * 5000),\r\n            cacheHit: Math.random() > 0.5,\r\n            databaseQueryCount: Math.floor(Math.random() * 10) + 1,\r\n            apiRate: Math.floor(Math.random() * 100),\r\n          },\r\n        })) as AuditLogEntry[];\r\n\r\n        // Apply filters\r\n        const filteredLogs = mockLogs.filter((log) => {\r\n          // Date range filter\r\n          const logDate = new Date(log.timestamp);\r\n          const now = new Date();\r\n\r\n          if (filters.dateRange === '1h') {\r\n            const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);\r\n            if (logDate < oneHourAgo) {\r\n              return false;\r\n            }\r\n          } else if (filters.dateRange === '24h') {\r\n            const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);\r\n            if (logDate < oneDayAgo) {\r\n              return false;\r\n            }\r\n          } else if (filters.dateRange === '7d') {\r\n            const oneWeekAgo = new Date(\r\n              now.getTime() - 7 * 24 * 60 * 60 * 1000\r\n            );\r\n            if (logDate < oneWeekAgo) {\r\n              return false;\r\n            }\r\n          } else if (filters.dateRange === '30d') {\r\n            const oneMonthAgo = new Date(\r\n              now.getTime() - 30 * 24 * 60 * 60 * 1000\r\n            );\r\n            if (logDate < oneMonthAgo) {\r\n              return false;\r\n            }\r\n          }\r\n\r\n          // _Search filter\r\n          if (\r\n            searchTerm &&\r\n            !JSON.stringify(log)\r\n              .toLowerCase()\r\n              .includes(searchTerm.toLowerCase())\r\n          ) {\r\n            return false;\r\n          }\r\n\r\n          // Other filters\r\n          if (filters.userId && log.userId !== filters.userId) {\r\n            return false;\r\n          }\r\n          if (filters.userRole && log.userRole !== filters.userRole) {\r\n            return false;\r\n          }\r\n          if (filters.entityType && log.entityType !== filters.entityType) {\r\n            return false;\r\n          }\r\n          if (filters.action && log.action !== filters.action) {\r\n            return false;\r\n          }\r\n          if (\r\n            filters.success !== undefined &&\r\n            log.success !== filters.success\r\n          ) {\r\n            return false;\r\n          }\r\n          if (\r\n            filters.dataAccessLevel &&\r\n            log.dataAccessLevel !== filters.dataAccessLevel\r\n          ) {\r\n            return false;\r\n          }\r\n          if (\r\n            filters.hasSecurityFlags &&\r\n            !Object.values(log.securityFlags).some(Boolean)\r\n          ) {\r\n            return false;\r\n          }\r\n          if (\r\n            filters.ferpaRequired !== undefined &&\r\n            log.ferpaCompliance.required !== filters.ferpaRequired\r\n          ) {\r\n            return false;\r\n          }\r\n\r\n          return true;\r\n        });\r\n\r\n        // Pagination\r\n        const startIndex = (page - 1) * logsPerPage;\r\n        const endIndex = startIndex + logsPerPage;\r\n        const paginatedLogs = filteredLogs.slice(startIndex, endIndex);\r\n\r\n        setLogs(paginatedLogs);\r\n        setTotalPages(Math.ceil(filteredLogs.length / logsPerPage));\r\n        setCurrentPage(page);\r\n      } catch (error) {\r\n        console.error('Failed to fetch audit logs:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    },\r\n    [filters, searchTerm, logsPerPage]\r\n  );\r\n\r\n  useEffect(() => {\r\n    fetchAuditLogs(currentPage);\r\n  }, [currentPage, fetchAuditLogs]);\r\n\r\n  const handleExport = async (format: 'csv' | 'json' | 'pdf') => {\r\n    try {\r\n      setExporting(true);\r\n\r\n      // Mock export functionality\r\n      const exportData = logs.map((log) => ({\r\n        timestamp: log.timestamp,\r\n        userId: log.userId,\r\n        userRole: log.userRole,\r\n        endpoint: log.endpoint,\r\n        method: log.method,\r\n        action: log.action,\r\n        entityType: log.entityType,\r\n        recordsAffected: log.recordsAffected,\r\n        success: log.success,\r\n        dataAccessLevel: log.dataAccessLevel,\r\n        hasSecurityFlags: Object.values(log.securityFlags).some(Boolean),\r\n        ferpaRequired: log.ferpaCompliance.required,\r\n      }));\r\n\r\n      // In a real app, this would trigger an actual download\r\n      const blob = new Blob([JSON.stringify(exportData, null, 2)], {\r\n        type: format === 'json' ? 'application/json' : 'text/csv',\r\n      });\r\n\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `audit_logs_${new Date().toISOString().split('T')[0]}.${format}`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n\r\n      alert(`Audit logs exported as ${format.toUpperCase()}`);\r\n    } catch (error) {\r\n      console.error('Failed to export logs:', error);\r\n      alert('Failed to export logs. Please try again.');\r\n    } finally {\r\n      setExporting(false);\r\n    }\r\n  };\r\n\r\n  const getActionIcon = (action: string) => {\r\n    switch (action) {\r\n      case 'CREATE':\r\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\r\n      case 'READ':\r\n        return <Eye className=\"h-4 w-4 text-blue-500\" />;\r\n      case 'UPDATE':\r\n        return <RefreshCw className=\"h-4 w-4 text-yellow-500\" />;\r\n      case 'DELETE':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />;\r\n      case 'EXPORT':\r\n        return <Download className=\"h-4 w-4 text-purple-500\" />;\r\n      case '_SEARCH':\r\n        return <Search className=\"h-4 w-4 text-gray-500\" />;\r\n      default:\r\n        return <Activity className=\"h-4 w-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getAccessLevelColor = (level: string) => {\r\n    switch (level) {\r\n      case 'PUBLIC':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'LIMITED':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'SENSITIVE':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'RESTRICTED':\r\n        return 'bg-orange-100 text-orange-800';\r\n      case 'CONFIDENTIAL':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const hasSecurityFlags = (log: AuditLogEntry) => {\r\n    return Object.values(log.securityFlags).some(Boolean);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <RefreshCw className=\"h-8 w-8 animate-spin\" />\r\n        <span className=\"ml-2\">Loading audit logs...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6 p-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n            <FileText className=\"h-8 w-8\" />\r\n            Audit Log Viewer\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">\r\n            Comprehensive audit trail for all system access and data operations\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setShowFilters(!showFilters)}\r\n          >\r\n            <Filter className=\"h-4 w-4 mr-2\" />\r\n            Filters\r\n          </Button>\r\n\r\n          <DropdownMenu>\r\n            <DropdownMenuTrigger asChild>\r\n              <Button variant=\"outline\" size=\"sm\" disabled={exporting}>\r\n                <Download className=\"h-4 w-4 mr-2\" />\r\n                Export\r\n                <ChevronDown className=\"h-4 w-4 ml-2\" />\r\n              </Button>\r\n            </DropdownMenuTrigger>\r\n            <DropdownMenuContent>\r\n              <DropdownMenuItem onClick={() => handleExport('csv')}>\r\n                Export as CSV\r\n              </DropdownMenuItem>\r\n              <DropdownMenuItem onClick={() => handleExport('json')}>\r\n                Export as JSON\r\n              </DropdownMenuItem>\r\n              <DropdownMenuItem onClick={() => handleExport('pdf')}>\r\n                Export as PDF\r\n              </DropdownMenuItem>\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => fetchAuditLogs(currentPage)}\r\n          >\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* _Search and Filters */}\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex gap-4\">\r\n          <div className=\"flex-1\">\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"_Search audit logs...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <Select\r\n            value={filters.dateRange}\r\n            onValueChange={(value: any) =>\r\n              setFilters((prev) => ({ ...prev, dateRange: value }))\r\n            }\r\n          >\r\n            <SelectTrigger className=\"w-32\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"1h\">Last Hour</SelectItem>\r\n              <SelectItem value=\"24h\">Last 24 Hours</SelectItem>\r\n              <SelectItem value=\"7d\">Last 7 Days</SelectItem>\r\n              <SelectItem value=\"30d\">Last 30 Days</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n\r\n        {showFilters && (\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle className=\"text-lg\">Advanced Filters</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>User Role</Label>\r\n                  <Select\r\n                    value={filters.userRole || ''}\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.userRole;\r\n                        } else {\r\n                          newFilters.userRole = value;\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Roles\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Roles</SelectItem>\r\n                      <SelectItem value=\"TEACHER\">Teacher</SelectItem>\r\n                      <SelectItem value=\"LIBRARIAN\">Librarian</SelectItem>\r\n                      <SelectItem value=\"ADMIN\">Admin</SelectItem>\r\n                      <SelectItem value=\"STAFF\">Staff</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Entity Type</Label>\r\n                  <Select\r\n                    value={filters.entityType || ''}\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.entityType;\r\n                        } else {\r\n                          newFilters.entityType = value;\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Entities\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Entities</SelectItem>\r\n                      <SelectItem value=\"student\">Student</SelectItem>\r\n                      <SelectItem value=\"activity\">Activity</SelectItem>\r\n                      <SelectItem value=\"book\">Book</SelectItem>\r\n                      <SelectItem value=\"equipment\">Equipment</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Action</Label>\r\n                  <Select\r\n                    value={filters.action || ''}\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.action;\r\n                        } else {\r\n                          newFilters.action = value;\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Actions\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Actions</SelectItem>\r\n                      <SelectItem value=\"READ\">Read</SelectItem>\r\n                      <SelectItem value=\"CREATE\">Create</SelectItem>\r\n                      <SelectItem value=\"UPDATE\">Update</SelectItem>\r\n                      <SelectItem value=\"DELETE\">Delete</SelectItem>\r\n                      <SelectItem value=\"EXPORT\">Export</SelectItem>\r\n                      <SelectItem value=\"_SEARCH\">_Search</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Data Access Level</Label>\r\n                  <Select\r\n                    value={filters.dataAccessLevel || ''}\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.dataAccessLevel;\r\n                        } else {\r\n                          newFilters.dataAccessLevel = value;\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Levels\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Levels</SelectItem>\r\n                      <SelectItem value=\"PUBLIC\">Public</SelectItem>\r\n                      <SelectItem value=\"LIMITED\">Limited</SelectItem>\r\n                      <SelectItem value=\"SENSITIVE\">Sensitive</SelectItem>\r\n                      <SelectItem value=\"RESTRICTED\">Restricted</SelectItem>\r\n                      <SelectItem value=\"CONFIDENTIAL\">Confidential</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Success Status</Label>\r\n                  <Select\r\n                    value={\r\n                      filters.success !== undefined\r\n                        ? filters.success\r\n                          ? 'true'\r\n                          : 'false'\r\n                        : ''\r\n                    }\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.success;\r\n                        } else {\r\n                          newFilters.success = value === 'true';\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All Status\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All Status</SelectItem>\r\n                      <SelectItem value=\"true\">Success</SelectItem>\r\n                      <SelectItem value=\"false\">Failed</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>Security Flags</Label>\r\n                  <div className=\"space-y-2\">\r\n                    <Checkbox\r\n                      checked={filters.hasSecurityFlags || false}\r\n                      onCheckedChange={(checked) =>\r\n                        setFilters((prev: FilterOptions): FilterOptions => {\r\n                          const newFilters = { ...prev };\r\n                          if (checked === true) {\r\n                            newFilters.hasSecurityFlags = true;\r\n                          } else {\r\n                            delete newFilters.hasSecurityFlags;\r\n                          }\r\n                          return newFilters;\r\n                        })\r\n                      }\r\n                    >\r\n                      Has Security Flags\r\n                    </Checkbox>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label>FERPA Required</Label>\r\n                  <Select\r\n                    value={\r\n                      filters.ferpaRequired !== undefined\r\n                        ? filters.ferpaRequired\r\n                          ? 'true'\r\n                          : 'false'\r\n                        : ''\r\n                    }\r\n                    onValueChange={(value) =>\r\n                      setFilters((prev: FilterOptions): FilterOptions => {\r\n                        const newFilters = { ...prev };\r\n                        if (value === '') {\r\n                          delete newFilters.ferpaRequired;\r\n                        } else {\r\n                          newFilters.ferpaRequired = value === 'true';\r\n                        }\r\n                        return newFilters;\r\n                      })\r\n                    }\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"All\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"\">All</SelectItem>\r\n                      <SelectItem value=\"true\">Required</SelectItem>\r\n                      <SelectItem value=\"false\">Not Required</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"flex items-end\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setFilters({ dateRange: '24h' })}\r\n                  >\r\n                    Clear Filters\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n\r\n      {/* Logs Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center justify-between\">\r\n            <span className=\"flex items-center gap-2\">\r\n              <Database className=\"h-5 w-5\" />\r\n              Audit Logs ({logs.length} entries)\r\n            </span>\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              Page {currentPage} of {totalPages}\r\n            </div>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ScrollArea className=\"h-96\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Timestamp</TableHead>\r\n                  <TableHead>User</TableHead>\r\n                  <TableHead>Action</TableHead>\r\n                  <TableHead>Entity</TableHead>\r\n                  <TableHead>Records</TableHead>\r\n                  <TableHead>Data Level</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead>Duration</TableHead>\r\n                  <TableHead>Security</TableHead>\r\n                  <TableHead>FERPA</TableHead>\r\n                  <TableHead></TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {logs.map((log) => (\r\n                  <TableRow key={log.id}>\r\n                    <TableCell>\r\n                      <div className=\"text-sm\">\r\n                        {new Date(log.timestamp).toLocaleString()}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div>\r\n                        <p className=\"font-medium\">{log.userId}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {log.userRole}\r\n                        </p>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {getActionIcon(log.action)}\r\n                        <span className=\"capitalize\">{log.action}</span>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"text-sm\">\r\n                        <p className=\"capitalize\">{log.entityType}</p>\r\n                        <p className=\"text-muted-foreground\">{log.endpoint}</p>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>{log.recordsAffected}</TableCell>\r\n                    <TableCell>\r\n                      <Badge\r\n                        className={getAccessLevelColor(log.dataAccessLevel)}\r\n                      >\r\n                        {log.dataAccessLevel}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {log.success ? (\r\n                          <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                        ) : (\r\n                          <XCircle className=\"h-4 w-4 text-red-500\" />\r\n                        )}\r\n                        <span className=\"text-sm\">{log.responseStatus}</span>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>{log.duration}ms</TableCell>\r\n                    <TableCell>\r\n                      {hasSecurityFlags(log) && (\r\n                        <Badge variant=\"destructive\" className=\"text-xs\">\r\n                          <AlertTriangle className=\"h-3 w-3 mr-1\" />\r\n                          Flags\r\n                        </Badge>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      {log.ferpaCompliance.required && (\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <Shield\r\n                            className={`h-4 w-4 ${log.ferpaCompliance.verified ? 'text-green-500' : 'text-yellow-500'}`}\r\n                          />\r\n                          <span className=\"text-xs\">\r\n                            {log.ferpaCompliance.verified ? 'OK' : 'Required'}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        onClick={() => setSelectedLog(log)}\r\n                      >\r\n                        <Eye className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </ScrollArea>\r\n\r\n          {/* Pagination */}\r\n          <div className=\"flex items-center justify-between mt-4\">\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              Showing {logs.length} of {logs.length} entries\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => setCurrentPage((prev) => Math.max(1, prev - 1))}\r\n                disabled={currentPage === 1}\r\n              >\r\n                Previous\r\n              </Button>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() =>\r\n                  setCurrentPage((prev) => Math.min(totalPages, prev + 1))\r\n                }\r\n                disabled={currentPage === totalPages}\r\n              >\r\n                Next\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Log Details Dialog */}\r\n      {selectedLog && (\r\n        <Dialog open={!!selectedLog} onOpenChange={() => setSelectedLog(null)}>\r\n          <DialogContent className=\"max-w-4xl max-h-[80vh]\">\r\n            <DialogHeader>\r\n              <DialogTitle className=\"flex items-center gap-2\">\r\n                <FileText className=\"h-5 w-5\" />\r\n                Audit Log Details\r\n              </DialogTitle>\r\n              <DialogDescription>\r\n                Detailed information about the selected audit event\r\n              </DialogDescription>\r\n            </DialogHeader>\r\n\r\n            <ScrollArea className=\"max-h-[60vh]\">\r\n              <div className=\"space-y-6\">\r\n                {/* Basic Information */}\r\n                <div className=\"grid grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <Label>Log ID</Label>\r\n                    <p className=\"font-mono text-sm\">{selectedLog.id}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Timestamp</Label>\r\n                    <p>{new Date(selectedLog.timestamp).toLocaleString()}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>User</Label>\r\n                    <p>\r\n                      {selectedLog.userId} ({selectedLog.userRole})\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Session ID</Label>\r\n                    <p className=\"font-mono text-sm\">{selectedLog.sessionId}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>Request ID</Label>\r\n                    <p className=\"font-mono text-sm\">{selectedLog.requestId}</p>\r\n                  </div>\r\n                  <div>\r\n                    <Label>IP Address</Label>\r\n                    <p>{selectedLog.ipAddress}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Request Information */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">Request Information</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Endpoint</Label>\r\n                      <p>{selectedLog.endpoint}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Method</Label>\r\n                      <p>{selectedLog.method}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Action</Label>\r\n                      <p className=\"capitalize\">{selectedLog.action}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Entity</Label>\r\n                      <p className=\"capitalize\">\r\n                        {selectedLog.entityType} ({selectedLog.entityId})\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Data Access Information */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">Data Access Information</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Fields Accessed</Label>\r\n                      <p className=\"text-sm\">\r\n                        {selectedLog.fieldsAccessed.join(', ') || 'None'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Sensitive Fields</Label>\r\n                      <p className=\"text-sm text-red-600\">\r\n                        {selectedLog.sensitiveFieldsAccessed.join(', ') ||\r\n                          'None'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Encrypted Fields</Label>\r\n                      <p className=\"text-sm text-blue-600\">\r\n                        {selectedLog.encryptedFieldsAccessed.join(', ') ||\r\n                          'None'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Data Access Level</Label>\r\n                      <Badge\r\n                        className={getAccessLevelColor(\r\n                          selectedLog.dataAccessLevel\r\n                        )}\r\n                      >\r\n                        {selectedLog.dataAccessLevel}\r\n                      </Badge>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Records Affected</Label>\r\n                      <p>{selectedLog.recordsAffected}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Data Size</Label>\r\n                      <p>{(selectedLog.dataSize / 1024).toFixed(2)} KB</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Response Information */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">Response Information</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Status</Label>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {selectedLog.success ? (\r\n                          <CheckCircle className=\"h-4 w-4 text-green-500\" />\r\n                        ) : (\r\n                          <XCircle className=\"h-4 w-4 text-red-500\" />\r\n                        )}\r\n                        <span>{selectedLog.responseStatus}</span>\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Duration</Label>\r\n                      <p>{selectedLog.duration}ms</p>\r\n                    </div>\r\n                    {selectedLog.errorMessage && (\r\n                      <div className=\"col-span-2\">\r\n                        <Label>Error Message</Label>\r\n                        <p className=\"text-sm text-red-600\">\r\n                          {selectedLog.errorMessage}\r\n                        </p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* FERPA Compliance */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">FERPA Compliance</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>FERPA Required</Label>\r\n                      <p>\r\n                        {selectedLog.ferpaCompliance.required ? 'Yes' : 'No'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>FERPA Verified</Label>\r\n                      <p>\r\n                        {selectedLog.ferpaCompliance.verified ? 'Yes' : 'No'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Justification Provided</Label>\r\n                      <p>\r\n                        {selectedLog.ferpaCompliance.justificationProvided\r\n                          ? 'Yes'\r\n                          : 'No'}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Access Request ID</Label>\r\n                      <p className=\"font-mono text-sm\">\r\n                        {selectedLog.ferpaCompliance.accessRequestId || 'N/A'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Security Flags */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">Security Flags</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertTriangle\r\n                        className={`h-4 w-4 ${selectedLog.securityFlags.suspiciousActivity ? 'text-red-500' : 'text-gray-400'}`}\r\n                      />\r\n                      <Label>Suspicious Activity</Label>\r\n                      <span>\r\n                        {selectedLog.securityFlags.suspiciousActivity\r\n                          ? 'Yes'\r\n                          : 'No'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertTriangle\r\n                        className={`h-4 w-4 ${selectedLog.securityFlags.unusualAccessPattern ? 'text-orange-500' : 'text-gray-400'}`}\r\n                      />\r\n                      <Label>Unusual Access Pattern</Label>\r\n                      <span>\r\n                        {selectedLog.securityFlags.unusualAccessPattern\r\n                          ? 'Yes'\r\n                          : 'No'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertTriangle\r\n                        className={`h-4 w-4 ${selectedLog.securityFlags.dataExfiltrationRisk ? 'text-red-500' : 'text-gray-400'}`}\r\n                      />\r\n                      <Label>Data Exfiltration Risk</Label>\r\n                      <span>\r\n                        {selectedLog.securityFlags.dataExfiltrationRisk\r\n                          ? 'Yes'\r\n                          : 'No'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <AlertTriangle\r\n                        className={`h-4 w-4 ${selectedLog.securityFlags.privilegeEscalationAttempt ? 'text-red-500' : 'text-gray-400'}`}\r\n                      />\r\n                      <Label>Privilege Escalation Attempt</Label>\r\n                      <span>\r\n                        {selectedLog.securityFlags.privilegeEscalationAttempt\r\n                          ? 'Yes'\r\n                          : 'No'}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Metadata */}\r\n                <div className=\"border rounded-lg p-4\">\r\n                  <h3 className=\"font-medium mb-3\">Metadata</h3>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <Label>Request Size</Label>\r\n                      <p>{selectedLog.metadata.requestSize} bytes</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Response Size</Label>\r\n                      <p>{selectedLog.metadata.responseSize} bytes</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Cache Hit</Label>\r\n                      <p>{selectedLog.metadata.cacheHit ? 'Yes' : 'No'}</p>\r\n                    </div>\r\n                    <div>\r\n                      <Label>Database Queries</Label>\r\n                      <p>{selectedLog.metadata.databaseQueryCount}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </ScrollArea>\r\n\r\n            <div className=\"flex justify-end mt-4\">\r\n              <Button variant=\"outline\" onClick={() => setSelectedLog(null)}>\r\n                Close\r\n              </Button>\r\n            </div>\r\n          </DialogContent>\r\n        </Dialog>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AuditLogViewer;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\security\\SecurityDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\server\\BookCatalog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\AttendanceSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":235,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":235,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7251,7254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7251,7254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Clock,\r\n  Users,\r\n  Save,\r\n  RefreshCw,\r\n  Download,\r\n  FileSpreadsheet,\r\n  FileText,\r\n} from 'lucide-react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface AttendanceSetting {\r\n  key: string;\r\n  value: string;\r\n  description?: string;\r\n  category: string;\r\n}\r\n\r\nexport default function AttendanceSettings() {\r\n  const { user: _user } = useAuth();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const [_settings, setSettings] = useState<AttendanceSetting[]>([]);\r\n  const [minCheckInInterval, setMinCheckInInterval] = useState(10);\r\n  const [defaultSessionTime, setDefaultSessionTime] = useState(30);\r\n\r\n  // Date range for export\r\n  const [startDate, setStartDate] = useState(() => {\r\n    const date = new Date();\r\n    date.setDate(date.getDate() - 30); // Default: last 30 days\r\n    return date.toISOString().split('T')[0];\r\n  });\r\n  const [endDate, setEndDate] = useState(() => {\r\n    return new Date().toISOString().split('T')[0];\r\n  });\r\n\r\n  // Load settings on mount\r\n  useEffect(() => {\r\n    loadSettings();\r\n  }, []);\r\n\r\n  const loadSettings = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await fetch('/api/settings/category/attendance', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to load settings');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success && data.data) {\r\n        setSettings(data.data);\r\n\r\n        // Extract specific settings\r\n        const minInterval = data.data.find(\r\n          (s: AttendanceSetting) =>\r\n            s.key === 'attendance.min_check_in_interval_minutes'\r\n        );\r\n        const defaultSession = data.data.find(\r\n          (s: AttendanceSetting) =>\r\n            s.key === 'attendance.default_session_time_minutes'\r\n        );\r\n\r\n        if (minInterval) {\r\n          setMinCheckInInterval(parseInt(minInterval.value));\r\n        }\r\n        if (defaultSession) {\r\n          setDefaultSessionTime(parseInt(defaultSession.value));\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading settings:', error);\r\n      toast.error('Failed to load attendance settings');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    setIsSaving(true);\r\n    try {\r\n      const settingsToUpdate = [\r\n        {\r\n          key: 'attendance.min_check_in_interval_minutes',\r\n          value: minCheckInInterval.toString(),\r\n        },\r\n        {\r\n          key: 'attendance.default_session_time_minutes',\r\n          value: defaultSessionTime.toString(),\r\n        },\r\n      ];\r\n\r\n      const response = await fetch('/api/settings/batch', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')}`,\r\n        },\r\n        body: JSON.stringify({ settings: settingsToUpdate }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to save settings');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        toast.success('Attendance settings saved successfully');\r\n        // Reload settings to reflect changes\r\n        loadSettings();\r\n      } else {\r\n        throw new Error(data.message || 'Failed to save settings');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error saving settings:', error);\r\n      toast.error('Failed to save attendance settings');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleInitializeDefaults = async () => {\r\n    setIsSaving(true);\r\n    try {\r\n      const response = await fetch('/api/settings/initialize', {\r\n        method: 'POST',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to initialize settings');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        toast.success('Default attendance settings initialized');\r\n        loadSettings();\r\n      } else {\r\n        throw new Error(data.message || 'Failed to initialize settings');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error initializing settings:', error);\r\n      toast.error('Failed to initialize default settings');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  // Export to CSV\r\n  const handleExportCSV = async () => {\r\n    setIsExporting(true);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/attendance-export/export/csv?startDate=${startDate}&endDate=${endDate}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to export CSV');\r\n      }\r\n\r\n      const blob = await response.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `clms-attendance-${startDate}-to-${endDate}.csv`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success('Attendance data exported to CSV successfully');\r\n    } catch (error) {\r\n      console.error('Error exporting CSV:', error);\r\n      toast.error('Failed to export CSV');\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  // Export to Excel (will be CSV that Excel can open)\r\n  const handleExportExcel = async () => {\r\n    // CSV works with Excel, so we use the same function\r\n    await handleExportCSV();\r\n    toast.success('Data exported - open with Microsoft Excel or Google Sheets');\r\n  };\r\n\r\n  // Export to Google Sheets (get data that can be copied)\r\n  const handleExportGoogleSheets = async () => {\r\n    setIsExporting(true);\r\n    try {\r\n      const response = await fetch(\r\n        `/api/attendance-export/google-sheets?startDate=${startDate}&endDate=${endDate}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to get Google Sheets data');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.success && data.data) {\r\n        // Create a copyable format\r\n        const { headers, rows } = data.data;\r\n        const csvContent = [\r\n          headers.join('\\t'),\r\n          ...rows.map((r: any[]) => r.join('\\t')),\r\n        ].join('\\n');\r\n\r\n        // Copy to clipboard\r\n        await navigator.clipboard.writeText(csvContent);\r\n        toast.success(\r\n          'Attendance data copied to clipboard! Paste into Google Sheets'\r\n        );\r\n      } else {\r\n        throw new Error(data.message || 'Failed to get data');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error exporting to Google Sheets:', error);\r\n      toast.error('Failed to export to Google Sheets');\r\n    } finally {\r\n      setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <RefreshCw className=\"h-8 w-8 animate-spin mx-auto mb-4 text-muted-foreground\" />\r\n            <p className=\"text-muted-foreground\">\r\n              Loading attendance settings...\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Clock className=\"h-5 w-5\" />\r\n            Attendance Scanner Settings\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Configure attendance scanner rules and time limits. These settings\r\n            apply to all student check-ins through the library scanner.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Minimum Check-In Interval */}\r\n          <div className=\"space-y-2\">\r\n            <Label\r\n              htmlFor=\"min-check-in-interval\"\r\n              className=\"text-base font-semibold\"\r\n            >\r\n              Minimum Time Between Check-Ins (Minutes)\r\n            </Label>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Students must wait this amount of time before they can check in\r\n              again after checking out. Default is 10 minutes.\r\n            </p>\r\n            <Input\r\n              id=\"min-check-in-interval\"\r\n              type=\"number\"\r\n              min=\"1\"\r\n              max=\"60\"\r\n              value={minCheckInInterval}\r\n              onChange={(e) =>\r\n                setMinCheckInInterval(parseInt(e.target.value) || 10)\r\n              }\r\n              className=\"max-w-xs\"\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Current setting:{' '}\r\n              <span className=\"font-semibold\">\r\n                {minCheckInInterval} minute(s)\r\n              </span>\r\n            </p>\r\n          </div>\r\n\r\n          {/* Default Session Time */}\r\n          <div className=\"space-y-2\">\r\n            <Label\r\n              htmlFor=\"default-session-time\"\r\n              className=\"text-base font-semibold\"\r\n            >\r\n              Default Session Time (Minutes)\r\n            </Label>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Default time limit for student activities when checking in.\r\n              Students can use the library for this duration.\r\n            </p>\r\n            <Input\r\n              id=\"default-session-time\"\r\n              type=\"number\"\r\n              min=\"5\"\r\n              max=\"180\"\r\n              value={defaultSessionTime}\r\n              onChange={(e) =>\r\n                setDefaultSessionTime(parseInt(e.target.value) || 30)\r\n              }\r\n              className=\"max-w-xs\"\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Current setting:{' '}\r\n              <span className=\"font-semibold\">\r\n                {defaultSessionTime} minute(s)\r\n              </span>\r\n            </p>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex items-center gap-3 pt-4 border-t\">\r\n            <Button onClick={handleSave} disabled={isSaving} className=\"gap-2\">\r\n              {isSaving ? (\r\n                <RefreshCw className=\"h-4 w-4 animate-spin\" />\r\n              ) : (\r\n                <Save className=\"h-4 w-4\" />\r\n              )}\r\n              Save Settings\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleInitializeDefaults}\r\n              disabled={isSaving}\r\n              className=\"gap-2\"\r\n            >\r\n              {isSaving ? (\r\n                <RefreshCw className=\"h-4 w-4 animate-spin\" />\r\n              ) : (\r\n                <RefreshCw className=\"h-4 w-4\" />\r\n              )}\r\n              Reset to Defaults\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Export Attendance Data Card */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Download className=\"h-5 w-5\" />\r\n            Export Attendance Data\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Export student attendance records to CSV, Excel, or Google Sheets\r\n            for external analysis.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Date Range Selection */}\r\n          <div className=\"space-y-4\">\r\n            <Label className=\"text-base font-semibold\">Select Date Range</Label>\r\n            <div className=\"flex items-end gap-4\">\r\n              <div className=\"space-y-2 flex-1\">\r\n                <Label htmlFor=\"start-date\" className=\"text-sm font-normal\">\r\n                  Start Date\r\n                </Label>\r\n                <Input\r\n                  id=\"start-date\"\r\n                  type=\"date\"\r\n                  value={startDate}\r\n                  onChange={(e) => setStartDate(e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2 flex-1\">\r\n                <Label htmlFor=\"end-date\" className=\"text-sm font-normal\">\r\n                  End Date\r\n                </Label>\r\n                <Input\r\n                  id=\"end-date\"\r\n                  type=\"date\"\r\n                  value={endDate}\r\n                  onChange={(e) => setEndDate(e.target.value)}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Export Buttons */}\r\n          <div className=\"space-y-4\">\r\n            <Label className=\"text-base font-semibold\">Export Format</Label>\r\n            <div className=\"grid gap-3 md:grid-cols-3\">\r\n              <Button\r\n                onClick={handleExportCSV}\r\n                disabled={isExporting}\r\n                variant=\"outline\"\r\n                className=\"gap-2 h-auto py-4\"\r\n              >\r\n                {isExporting ? (\r\n                  <RefreshCw className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <FileText className=\"h-5 w-5\" />\r\n                )}\r\n                <div className=\"text-left\">\r\n                  <div className=\"font-semibold\">Export CSV</div>\r\n                  <div className=\"text-xs text-muted-foreground\">\r\n                    Download as CSV file\r\n                  </div>\r\n                </div>\r\n              </Button>\r\n\r\n              <Button\r\n                onClick={handleExportExcel}\r\n                disabled={isExporting}\r\n                variant=\"outline\"\r\n                className=\"gap-2 h-auto py-4\"\r\n              >\r\n                {isExporting ? (\r\n                  <RefreshCw className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <FileSpreadsheet className=\"h-5 w-5\" />\r\n                )}\r\n                <div className=\"text-left\">\r\n                  <div className=\"font-semibold\">Export Excel</div>\r\n                  <div className=\"text-xs text-muted-foreground\">\r\n                    Open with Excel\r\n                  </div>\r\n                </div>\r\n              </Button>\r\n\r\n              <Button\r\n                onClick={handleExportGoogleSheets}\r\n                disabled={isExporting}\r\n                variant=\"outline\"\r\n                className=\"gap-2 h-auto py-4\"\r\n              >\r\n                {isExporting ? (\r\n                  <RefreshCw className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <Download className=\"h-5 w-5\" />\r\n                )}\r\n                <div className=\"text-left\">\r\n                  <div className=\"font-semibold\">Google Sheets</div>\r\n                  <div className=\"text-xs text-muted-foreground\">\r\n                    Copy to clipboard\r\n                  </div>\r\n                </div>\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Export Info */}\r\n          <div className=\"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md\">\r\n            <p className=\"font-semibold mb-1\">Exported data includes:</p>\r\n            <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n              <li>Student ID and Name</li>\r\n              <li>Grade Level</li>\r\n              <li>Check-in and Check-out Times</li>\r\n              <li>Duration in Minutes</li>\r\n              <li>Session Status (Active/Completed)</li>\r\n              <li>Activity Type</li>\r\n            </ul>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Information Card */}\r\n      <Card className=\"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/20\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2 text-blue-700 dark:text-blue-300\">\r\n            <Users className=\"h-5 w-5\" />\r\n            How It Works\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-3 text-sm\">\r\n          <div className=\"space-y-2\">\r\n            <p className=\"font-semibold text-blue-800 dark:text-blue-200\">\r\n              Check-In Process:\r\n            </p>\r\n            <ul className=\"list-disc list-inside space-y-1 text-blue-700 dark:text-blue-300 ml-4\">\r\n              <li>Student scans their ID card at the library scanner</li>\r\n              <li>If they don't have an active session, they are checked in</li>\r\n              <li>\r\n                If the minimum time hasn't passed since last check-out, a\r\n                cooldown warning is shown\r\n              </li>\r\n              <li>\r\n                The scanner shows how much time is remaining before they can\r\n                check in again\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <p className=\"font-semibold text-blue-800 dark:text-blue-200\">\r\n              Check-Out Process:\r\n            </p>\r\n            <ul className=\"list-disc list-inside space-y-1 text-blue-700 dark:text-blue-300 ml-4\">\r\n              <li>Student scans their ID card again while checked in</li>\r\n              <li>They are automatically checked out</li>\r\n              <li>The cooldown timer starts counting down</li>\r\n              <li>\r\n                They cannot check in again until the cooldown period is over\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\AutomationSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\BackupRestore.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\GoogleSheetsConfig.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\SystemLogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\SystemSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3836,3839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3836,3839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport { settingsApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\nimport {\r\n  Save,\r\n  RotateCcw,\r\n  Clock,\r\n  DollarSign,\r\n  BookOpen,\r\n  Calendar,\r\n  AlertCircle,\r\n  Users,\r\n  Building2,\r\n} from 'lucide-react';\r\n\r\ninterface SystemConfig {\r\n  libraryName?: string;\r\n  fineRatePerDay: number;\r\n  defaultCheckoutPeriod: number;\r\n  overdueGracePeriod: number;\r\n  maxBooksPerStudent: number;\r\n  sessionTimeout: number;\r\n  libraryHours: {\r\n    open: string;\r\n    close: string;\r\n  };\r\n  sessionLimits?: {\r\n    PRIMARY: number;\r\n    GRADE_SCHOOL: number;\r\n    JUNIOR_HIGH: number;\r\n    SENIOR_HIGH: number;\r\n  };\r\n}\r\n\r\nconst DEFAULT_CONFIG: SystemConfig = {\r\n  libraryName: 'School Library',\r\n  fineRatePerDay: 5.0,\r\n  defaultCheckoutPeriod: 7,\r\n  overdueGracePeriod: 0,\r\n  maxBooksPerStudent: 5,\r\n  sessionTimeout: 30,\r\n  libraryHours: {\r\n    open: '08:00',\r\n    close: '18:00',\r\n  },\r\n  sessionLimits: {\r\n    PRIMARY: 30,\r\n    GRADE_SCHOOL: 60,\r\n    JUNIOR_HIGH: 90,\r\n    SENIOR_HIGH: 120,\r\n  },\r\n};\r\n\r\nexport default function SystemSettings() {\r\n  const queryClient = useQueryClient();\r\n  const [settings, setSettings] = useState<SystemConfig>(DEFAULT_CONFIG);\r\n  const [hasChanges, setHasChanges] = useState(false);\r\n\r\n  // Fetch settings with TanStack Query\r\n  const {\r\n    data: settingsData,\r\n    isLoading,\r\n    error,\r\n  } = useQuery({\r\n    queryKey: ['system-settings'],\r\n    queryFn: async () => {\r\n      const response = await settingsApi.getSystemSettings();\r\n      return (response.data as SystemConfig) || DEFAULT_CONFIG;\r\n    },\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n  });\r\n\r\n  // Update mutation\r\n  const updateMutation = useMutation({\r\n    mutationFn: (newSettings: SystemConfig) =>\r\n      settingsApi.updateSystemSettings(newSettings),\r\n    onSuccess: (response) => {\r\n      queryClient.invalidateQueries({ queryKey: ['system-settings'] });\r\n      toast.success('Settings saved successfully!');\r\n      if (response.data) {\r\n        setSettings(response.data as SystemConfig);\r\n      }\r\n      setHasChanges(false);\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to save settings'));\r\n    },\r\n  });\r\n\r\n  // Reset mutation\r\n  const resetMutation = useMutation({\r\n    mutationFn: () => settingsApi.resetSystemSettings(),\r\n    onSuccess: (response) => {\r\n      queryClient.invalidateQueries({ queryKey: ['system-settings'] });\r\n      toast.success('Settings reset to defaults');\r\n      setSettings((response.data as SystemConfig) || DEFAULT_CONFIG);\r\n      setHasChanges(false);\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to reset settings');\r\n    },\r\n  });\r\n\r\n  // Initialize settings from query data\r\n  useEffect(() => {\r\n    if (settingsData) {\r\n      setSettings(settingsData);\r\n    }\r\n  }, [settingsData]);\r\n\r\n  // Track changes\r\n  useEffect(() => {\r\n    if (settingsData) {\r\n      const changed = JSON.stringify(settings) !== JSON.stringify(settingsData);\r\n      setHasChanges(changed);\r\n    }\r\n  }, [settings, settingsData]);\r\n\r\n  const saveSettings = () => {\r\n    updateMutation.mutate(settings);\r\n  };\r\n\r\n  const resetToDefaults = () => {\r\n    if (confirm('Are you sure you want to reset all settings to defaults?')) {\r\n      resetMutation.mutate();\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (field: keyof SystemConfig, value: any) => {\r\n    setSettings((prev) => ({\r\n      ...prev,\r\n      [field]: value,\r\n    }));\r\n  };\r\n\r\n  const handleLibraryHoursChange = (field: 'open' | 'close', value: string) => {\r\n    setSettings((prev) => ({\r\n      ...prev,\r\n      libraryHours: {\r\n        ...prev.libraryHours,\r\n        [field]: value,\r\n      },\r\n    }));\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading settings...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Error Message */}\r\n      {error && (\r\n        <Alert variant=\"destructive\">\r\n          <AlertCircle className=\"h-4 w-4\" />\r\n          <AlertDescription>\r\n            Failed to load settings. Please try refreshing the page.\r\n          </AlertDescription>\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Library Name */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Building2 className=\"w-5 h-5\" />\r\n            Library Information\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Configure your library's basic information\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"libraryName\">Library Name</Label>\r\n            <Input\r\n              id=\"libraryName\"\r\n              type=\"text\"\r\n              value={settings.libraryName || ''}\r\n              onChange={(e) => handleInputChange('libraryName', e.target.value)}\r\n              placeholder=\"School Library\"\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">\r\n              Your library's display name shown throughout the system\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Fine Configuration */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <DollarSign className=\"w-5 h-5\" />\r\n            Fine Configuration\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Configure fine rates and grace periods for overdue books\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"fineRate\">Fine Rate (per day)</Label>\r\n              <div className=\"relative\">\r\n                <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground\">\r\n                  Γé▒\r\n                </span>\r\n                <Input\r\n                  id=\"fineRate\"\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  step=\"0.5\"\r\n                  value={settings.fineRatePerDay}\r\n                  onChange={(e) =>\r\n                    handleInputChange(\r\n                      'fineRatePerDay',\r\n                      parseFloat(e.target.value) || 0\r\n                    )\r\n                  }\r\n                  className=\"pl-7\"\r\n                />\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Amount charged per day for overdue books\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"gracePeriod\">Grace Period</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"gracePeriod\"\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  value={settings.overdueGracePeriod}\r\n                  onChange={(e) =>\r\n                    handleInputChange(\r\n                      'overdueGracePeriod',\r\n                      parseInt(e.target.value) || 0\r\n                    )\r\n                  }\r\n                  className=\"pr-16\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  days\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Days before fines start accumulating\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Checkout Configuration */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <BookOpen className=\"w-5 h-5\" />\r\n            Checkout Configuration\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Set default checkout periods and borrowing limits\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"checkoutPeriod\">Default Checkout Period</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"checkoutPeriod\"\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  value={settings.defaultCheckoutPeriod}\r\n                  onChange={(e) =>\r\n                    handleInputChange(\r\n                      'defaultCheckoutPeriod',\r\n                      parseInt(e.target.value) || 7\r\n                    )\r\n                  }\r\n                  className=\"pr-16\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  days\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Default number of days for book checkouts\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"maxBooks\">Max Books Per Student</Label>\r\n              <Input\r\n                id=\"maxBooks\"\r\n                type=\"number\"\r\n                min=\"1\"\r\n                value={settings.maxBooksPerStudent}\r\n                onChange={(e) =>\r\n                  handleInputChange(\r\n                    'maxBooksPerStudent',\r\n                    parseInt(e.target.value) || 5\r\n                  )\r\n                }\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Maximum books a student can borrow simultaneously\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Library Hours */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Clock className=\"w-5 h-5\" />\r\n            Library Hours\r\n          </CardTitle>\r\n          <CardDescription>Set your library's operating hours</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"openTime\">Opening Time</Label>\r\n              <Input\r\n                id=\"openTime\"\r\n                type=\"time\"\r\n                value={settings.libraryHours.open}\r\n                onChange={(e) =>\r\n                  handleLibraryHoursChange('open', e.target.value)\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"closeTime\">Closing Time</Label>\r\n              <Input\r\n                id=\"closeTime\"\r\n                type=\"time\"\r\n                value={settings.libraryHours.close}\r\n                onChange={(e) =>\r\n                  handleLibraryHoursChange('close', e.target.value)\r\n                }\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Session Configuration */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Calendar className=\"w-5 h-5\" />\r\n            Session Configuration\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Configure session timeout and security settings\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"sessionTimeout\">Session Timeout</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"sessionTimeout\"\r\n                  type=\"number\"\r\n                  min=\"5\"\r\n                  value={settings.sessionTimeout}\r\n                  onChange={(e) =>\r\n                    handleInputChange(\r\n                      'sessionTimeout',\r\n                      parseInt(e.target.value) || 30\r\n                    )\r\n                  }\r\n                  className=\"pr-20\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  minutes\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Time before inactive users are logged out\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Student Session Limits by Grade */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Users className=\"w-5 h-5\" />\r\n            Student Session Limits\r\n          </CardTitle>\r\n          <CardDescription>\r\n            Configure maximum session time limits for different grade levels\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"primaryLimit\">Primary (Preschool)</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"primaryLimit\"\r\n                  type=\"number\"\r\n                  min=\"15\"\r\n                  max=\"120\"\r\n                  value={settings.sessionLimits?.PRIMARY || 30}\r\n                  onChange={(e) => {\r\n                    const newLimits = {\r\n                      ...settings.sessionLimits,\r\n                      PRIMARY: parseInt(e.target.value) || 30,\r\n                    };\r\n                    handleInputChange('sessionLimits', newLimits);\r\n                  }}\r\n                  className=\"pr-20\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  minutes\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"gradeSchoolLimit\">Grade School (1-6)</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"gradeSchoolLimit\"\r\n                  type=\"number\"\r\n                  min=\"15\"\r\n                  max=\"180\"\r\n                  value={settings.sessionLimits?.GRADE_SCHOOL || 60}\r\n                  onChange={(e) => {\r\n                    const newLimits = {\r\n                      ...settings.sessionLimits,\r\n                      GRADE_SCHOOL: parseInt(e.target.value) || 60,\r\n                    };\r\n                    handleInputChange('sessionLimits', newLimits);\r\n                  }}\r\n                  className=\"pr-20\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  minutes\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"juniorHighLimit\">Junior High (7-10)</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"juniorHighLimit\"\r\n                  type=\"number\"\r\n                  min=\"15\"\r\n                  max=\"180\"\r\n                  value={settings.sessionLimits?.JUNIOR_HIGH || 90}\r\n                  onChange={(e) => {\r\n                    const newLimits = {\r\n                      ...settings.sessionLimits,\r\n                      JUNIOR_HIGH: parseInt(e.target.value) || 90,\r\n                    };\r\n                    handleInputChange('sessionLimits', newLimits);\r\n                  }}\r\n                  className=\"pr-20\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  minutes\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"seniorHighLimit\">Senior High (11-12)</Label>\r\n              <div className=\"relative\">\r\n                <Input\r\n                  id=\"seniorHighLimit\"\r\n                  type=\"number\"\r\n                  min=\"15\"\r\n                  max=\"240\"\r\n                  value={settings.sessionLimits?.SENIOR_HIGH || 120}\r\n                  onChange={(e) => {\r\n                    const newLimits = {\r\n                      ...settings.sessionLimits,\r\n                      SENIOR_HIGH: parseInt(e.target.value) || 120,\r\n                    };\r\n                    handleInputChange('sessionLimits', newLimits);\r\n                  }}\r\n                  className=\"pr-20\"\r\n                />\r\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm\">\r\n                  minutes\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <p className=\"text-xs text-muted-foreground\">\r\n            Maximum time students can use computers/equipment per session based\r\n            on their grade level\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Action Buttons */}\r\n      <div className=\"flex items-center justify-between gap-4 pt-4 border-t\">\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={resetToDefaults}\r\n          disabled={resetMutation.isPending || updateMutation.isPending}\r\n        >\r\n          <RotateCcw className=\"w-4 h-4 mr-2\" />\r\n          {resetMutation.isPending ? 'Resetting...' : 'Reset to Defaults'}\r\n        </Button>\r\n\r\n        <div className=\"flex gap-2\">\r\n          {hasChanges && (\r\n            <span className=\"text-sm text-muted-foreground flex items-center\">\r\n              <AlertCircle className=\"w-4 h-4 mr-1\" />\r\n              Unsaved changes\r\n            </span>\r\n          )}\r\n          <Button\r\n            onClick={saveSettings}\r\n            disabled={\r\n              updateMutation.isPending || resetMutation.isPending || !hasChanges\r\n            }\r\n          >\r\n            <Save className=\"w-4 h-4 mr-2\" />\r\n            {updateMutation.isPending ? 'Saving...' : 'Save Changes'}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\settings\\UserManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":429,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":429,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13379,13382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13379,13382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { toast } from 'sonner';\r\nimport {\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from '@/components/ui/table';\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  UserPlus,\r\n  Edit,\r\n  Trash2,\r\n  Search,\r\n  AlertCircle,\r\n  UserCheck,\r\n  UserX,\r\n} from 'lucide-react';\r\nimport { settingsApi } from '@/lib/api';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\ninterface User {\r\n  id: string;\r\n  username: string;\r\n  role: 'ADMIN' | 'LIBRARIAN' | 'STAFF';\r\n  isActive: boolean;\r\n  lastLoginAt: Date | null;\r\n  createdAt: Date;\r\n}\r\n\r\ninterface UserFormData {\r\n  username: string;\r\n  password?: string; // Make password optional\r\n  role: 'ADMIN' | 'LIBRARIAN' | 'STAFF';\r\n  isActive: boolean;\r\n}\r\n\r\nconst EMPTY_FORM: UserFormData = {\r\n  username: '',\r\n  password: '',\r\n  role: 'LIBRARIAN',\r\n  isActive: true,\r\n};\r\n\r\nexport default function UserManagement() {\r\n  const queryClient = useQueryClient();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [editingUser, setEditingUser] = useState<User | null>(null);\r\n  const [formData, setFormData] = useState<UserFormData>(EMPTY_FORM);\r\n\r\n  // Fetch users with TanStack Query\r\n  const {\r\n    data: users = [],\r\n    isLoading,\r\n    error,\r\n  } = useQuery({\r\n    queryKey: ['users'],\r\n    queryFn: async () => {\r\n      const response = await settingsApi.getUsers();\r\n      return (response.data as User[]) || [];\r\n    },\r\n    staleTime: 2 * 60 * 1000, // 2 minutes\r\n  });\r\n\r\n  // Create user mutation\r\n  const createMutation = useMutation({\r\n    mutationFn: (userData: UserFormData) => settingsApi.createUser(userData),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['users'] });\r\n      toast.success('User created successfully!');\r\n      setDialogOpen(false);\r\n      setFormData(EMPTY_FORM);\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to create user'));\r\n    },\r\n  });\r\n\r\n  // Update user mutation\r\n  const updateMutation = useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: Partial<UserFormData> }) =>\r\n      settingsApi.updateUser(id, data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['users'] });\r\n      toast.success('User updated successfully!');\r\n      setDialogOpen(false);\r\n      setFormData(EMPTY_FORM);\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to update user'));\r\n    },\r\n  });\r\n\r\n  // Delete user mutation\r\n  const deleteMutation = useMutation({\r\n    mutationFn: (userId: string) => settingsApi.deleteUser(userId),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['users'] });\r\n      toast.success('User deleted successfully!');\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to delete user'));\r\n    },\r\n  });\r\n\r\n  const handleAddUser = () => {\r\n    setEditingUser(null);\r\n    setFormData(EMPTY_FORM);\r\n    setDialogOpen(true);\r\n  };\r\n\r\n  const handleEditUser = (user: User) => {\r\n    setEditingUser(user);\r\n    setFormData({\r\n      username: user.username,\r\n      password: '', // Don't show existing password\r\n      role: user.role,\r\n      isActive: user.isActive,\r\n    });\r\n    setDialogOpen(true);\r\n  };\r\n\r\n  const handleDeleteUser = async (userId: string) => {\r\n    if (!confirm('Are you sure you want to delete this user?')) {\r\n      return;\r\n    }\r\n\r\n    deleteMutation.mutate(userId);\r\n  };\r\n\r\n  const handleSaveUser = async () => {\r\n    // Validation\r\n    if (!formData.username.trim()) {\r\n      toast.error('Username is required');\r\n      return;\r\n    }\r\n\r\n    if (!editingUser && !formData.password) {\r\n      toast.error('Password is required for new users');\r\n      return;\r\n    }\r\n\r\n    if (formData.password && formData.password.length < 6) {\r\n      toast.error('Password must be at least 6 characters');\r\n      return;\r\n    }\r\n\r\n    const userData: Partial<UserFormData> & {\r\n      username: string;\r\n      role: UserFormData['role'];\r\n      isActive: boolean;\r\n    } = {\r\n      username: formData.username,\r\n      role: formData.role,\r\n      isActive: formData.isActive,\r\n    };\r\n\r\n    // Only include password if provided\r\n    if (formData.password) {\r\n      userData.password = formData.password;\r\n    }\r\n\r\n    if (editingUser) {\r\n      updateMutation.mutate({ id: editingUser.id, data: userData });\r\n    } else {\r\n      createMutation.mutate(userData as UserFormData);\r\n    }\r\n  };\r\n\r\n  const handleToggleUserStatus = async (user: User) => {\r\n    updateMutation.mutate({\r\n      id: user.id,\r\n      data: {\r\n        username: user.username,\r\n        role: user.role,\r\n        isActive: !user.isActive,\r\n      },\r\n    });\r\n  };\r\n\r\n  const formatDate = (date: Date | null) => {\r\n    if (!date) {\r\n      return 'Never';\r\n    }\r\n    return new Date(date).toLocaleString();\r\n  };\r\n\r\n  const getRoleBadgeVariant = (role: string) => {\r\n    switch (role) {\r\n      case 'ADMIN':\r\n        return 'destructive';\r\n      case 'LIBRARIAN':\r\n        return 'default';\r\n      case 'STAFF':\r\n        return 'secondary';\r\n      default:\r\n        return 'default';\r\n    }\r\n  };\r\n\r\n  const filteredUsers = users.filter((user) =>\r\n    user.username.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"flex items-center justify-center h-64\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4\"></div>\r\n            <p className=\"text-muted-foreground\">Loading users...</p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <Alert variant=\"destructive\">\r\n        <AlertCircle className=\"h-4 w-4\" />\r\n        <AlertDescription>\r\n          Failed to load users. Please try refreshing the page.\r\n        </AlertDescription>\r\n      </Alert>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>User Management</CardTitle>\r\n          <CardDescription>\r\n            Manage system users, roles, and permissions\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {/* _Search and Add User */}\r\n          <div className=\"flex items-center justify-between gap-4\">\r\n            <div className=\"relative flex-1 max-w-sm\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"_Search users...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n            <Button onClick={handleAddUser}>\r\n              <UserPlus className=\"w-4 h-4 mr-2\" />\r\n              Add User\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Users Table */}\r\n          <div className=\"border rounded-lg overflow-x-auto\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Username</TableHead>\r\n                  <TableHead>Role</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead>Last Login</TableHead>\r\n                  <TableHead>Created</TableHead>\r\n                  <TableHead className=\"text-right\">Actions</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {filteredUsers.length === 0 ? (\r\n                  <TableRow>\r\n                    <TableCell\r\n                      colSpan={6}\r\n                      className=\"text-center text-muted-foreground\"\r\n                    >\r\n                      No users found\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ) : (\r\n                  filteredUsers.map((user) => (\r\n                    <TableRow key={user.id}>\r\n                      <TableCell className=\"font-medium\">\r\n                        {user.username}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge variant={getRoleBadgeVariant(user.role)}>\r\n                          {user.role}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant={user.isActive ? 'default' : 'secondary'}\r\n                          className=\"cursor-pointer\"\r\n                          onClick={() => handleToggleUserStatus(user)}\r\n                        >\r\n                          {user.isActive ? (\r\n                            <>\r\n                              <UserCheck className=\"w-3 h-3 mr-1\" />\r\n                              Active\r\n                            </>\r\n                          ) : (\r\n                            <>\r\n                              <UserX className=\"w-3 h-3 mr-1\" />\r\n                              Inactive\r\n                            </>\r\n                          )}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"text-muted-foreground\">\r\n                        {formatDate(user.lastLoginAt)}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-muted-foreground\">\r\n                        {formatDate(user.createdAt)}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        <div className=\"flex justify-end gap-2\">\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleEditUser(user)}\r\n                          >\r\n                            <Edit className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleDeleteUser(user.id)}\r\n                            className=\"text-destructive hover:text-destructive\"\r\n                          >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))\r\n                )}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n\r\n          {/* Summary */}\r\n          <div className=\"text-sm text-muted-foreground\">\r\n            Showing {filteredUsers.length} of {users.length} users\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Add/Edit User Dialog */}\r\n      <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingUser ? 'Edit User' : 'Add New User'}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {editingUser\r\n                ? 'Update user information and permissions'\r\n                : 'Create a new user account'}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"username\">Username</Label>\r\n              <Input\r\n                id=\"username\"\r\n                placeholder=\"Enter username\"\r\n                value={formData.username}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, username: e.target.value })\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"password\">\r\n                Password {editingUser && '(leave blank to keep current)'}\r\n              </Label>\r\n              <Input\r\n                id=\"password\"\r\n                type=\"password\"\r\n                placeholder={\r\n                  editingUser ? 'Enter new password' : 'Enter password'\r\n                }\r\n                value={formData.password}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, password: e.target.value })\r\n                }\r\n              />\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                Minimum 6 characters\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"role\">Role</Label>\r\n              <Select\r\n                value={formData.role}\r\n                onValueChange={(value: any) =>\r\n                  setFormData({ ...formData, role: value })\r\n                }\r\n              >\r\n                <SelectTrigger>\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"ADMIN\">Admin</SelectItem>\r\n                  <SelectItem value=\"LIBRARIAN\">Librarian</SelectItem>\r\n                  <SelectItem value=\"STAFF\">Staff</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"isActive\"\r\n                checked={formData.isActive}\r\n                onChange={(e) =>\r\n                  setFormData({ ...formData, isActive: e.target.checked })\r\n                }\r\n                className=\"h-4 w-4\"\r\n              />\r\n              <Label htmlFor=\"isActive\" className=\"cursor-pointer\">\r\n                Active\r\n              </Label>\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => setDialogOpen(false)}\r\n              disabled={createMutation.isPending || updateMutation.isPending}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSaveUser}\r\n              disabled={createMutation.isPending || updateMutation.isPending}\r\n            >\r\n              {createMutation.isPending || updateMutation.isPending\r\n                ? 'Saving...'\r\n                : editingUser\r\n                  ? 'Update User'\r\n                  : 'Create User'}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\BarcodeDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\BookCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\QRCodeDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":36,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":36,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/lib/utils';\n\nconst badgeVariants = cva(\n  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        destructive:\n          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',\n        outline: 'text-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants };\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":57,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":57,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\nimport { Slot } from '@radix-ui/react-slot';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/lib/utils';\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95',\n  {\n    variants: {\n      variant: {\n        default:\n          'bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md',\n        destructive:\n          'bg-destructive text-destructive-foreground hover:bg-destructive/90',\n        outline:\n          'border border-input bg-background hover:bg-accent hover:text-accent-foreground hover:border-primary/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost: 'hover:bg-accent hover:text-accent-foreground',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-10 px-4 py-2',\n        sm: 'h-9 rounded-md px-3',\n        lg: 'h-11 rounded-md px-8',\n        icon: 'h-10 w-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  }\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button';\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nButton.displayName = 'Button';\n\nexport { Button, buttonVariants };\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\mobile-card-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\responsive-table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\responsive-utils.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":431,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":431,"endColumn":37}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { ReactNode } from 'react';\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\nimport { cn } from '@/lib/utils';\n\ninterface ResponsiveContainerProps {\n  children: ReactNode;\n  className?: string;\n  size?: 'sm' | 'md' | 'lg' | 'xl' | 'full';\n}\n\n/**\n * Container that adapts its padding and max-width based on screen size\n * Following mobile-first principles\n */\nexport function ResponsiveContainer({\n  children,\n  className = '',\n  size = 'lg',\n}: ResponsiveContainerProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const sizeClasses = {\n    sm: 'max-w-2xl',\n    md: 'max-w-4xl',\n    lg: 'max-w-6xl',\n    xl: 'max-w-7xl',\n    full: 'max-w-full',\n  };\n\n  const paddingClasses = {\n    mobile: 'px-4 py-3',\n    tablet: 'px-6 py-4',\n    desktop: 'px-8 py-6',\n    large: 'px-12 py-8',\n  };\n\n  const responsivePadding = isMobile\n    ? paddingClasses.mobile\n    : isTablet\n      ? paddingClasses.tablet\n      : isDesktop\n        ? paddingClasses.desktop\n        : paddingClasses.large;\n\n  return (\n    <div\n      className={cn(\n        'w-full mx-auto',\n        sizeClasses[size],\n        responsivePadding,\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\ninterface ResponsiveGridProps {\n  children: ReactNode;\n  className?: string;\n  cols?: {\n    mobile?: number;\n    tablet?: number;\n    desktop?: number;\n    large?: number;\n  };\n  gap?: {\n    mobile?: string;\n    tablet?: string;\n    desktop?: string;\n    large?: string;\n  };\n}\n\n/**\n * Grid that automatically adjusts columns based on screen size\n * Mobile-first: defaults to 1 column on mobile\n */\nexport function ResponsiveGrid({\n  children,\n  className = '',\n  cols = { mobile: 1, tablet: 2, desktop: 3, large: 4 },\n  gap = { mobile: 'gap-3', tablet: 'gap-4', desktop: 'gap-6', large: 'gap-8' },\n}: ResponsiveGridProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const getCols = () => {\n    if (isMobile) {\n      return cols.mobile || 1;\n    }\n    if (isTablet) {\n      return cols.tablet || 2;\n    }\n    if (isDesktop) {\n      return cols.desktop || 3;\n    }\n    return cols.large || 4;\n  };\n\n  const getGap = () => {\n    if (isMobile) {\n      return gap.mobile || 'gap-3';\n    }\n    if (isTablet) {\n      return gap.tablet || 'gap-4';\n    }\n    if (isDesktop) {\n      return gap.desktop || 'gap-6';\n    }\n    return gap.large || 'gap-8';\n  };\n\n  const gridColsClasses = {\n    1: 'grid-cols-1',\n    2: 'grid-cols-2',\n    3: 'grid-cols-3',\n    4: 'grid-cols-4',\n    5: 'grid-cols-5',\n    6: 'grid-cols-6',\n  };\n\n  return (\n    <div\n      className={cn(\n        'grid',\n        gridColsClasses[getCols() as keyof typeof gridColsClasses] ||\n          'grid-cols-1',\n        getGap(),\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\ninterface ResponsiveFlexProps {\n  children: ReactNode;\n  className?: string;\n  direction?: {\n    mobile?: 'row' | 'col';\n    tablet?: 'row' | 'col';\n    desktop?: 'row' | 'col';\n    large?: 'row' | 'col';\n  };\n  justify?: 'start' | 'center' | 'end' | 'between' | 'around' | 'evenly';\n  align?: 'start' | 'center' | 'end' | 'stretch';\n  wrap?: boolean;\n  gap?: string;\n}\n\n/**\n * Flex container that adapts direction and spacing based on screen size\n */\nexport function ResponsiveFlex({\n  children,\n  className = '',\n  direction = { mobile: 'col', tablet: 'row', desktop: 'row', large: 'row' },\n  justify = 'start',\n  align = 'start',\n  wrap = false,\n  gap = 'gap-4',\n}: ResponsiveFlexProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const getDirection = () => {\n    if (isMobile) {\n      return direction.mobile || 'col';\n    }\n    if (isTablet) {\n      return direction.tablet || 'row';\n    }\n    if (isDesktop) {\n      return direction.desktop || 'row';\n    }\n    return direction.large || 'row';\n  };\n\n  const directionClasses = {\n    row: 'flex-row',\n    col: 'flex-col',\n  };\n\n  const justifyClasses = {\n    start: 'justify-start',\n    center: 'justify-center',\n    end: 'justify-end',\n    between: 'justify-between',\n    around: 'justify-around',\n    evenly: 'justify-evenly',\n  };\n\n  const alignClasses = {\n    start: 'items-start',\n    center: 'items-center',\n    end: 'items-end',\n    stretch: 'items-stretch',\n  };\n\n  return (\n    <div\n      className={cn(\n        'flex',\n        directionClasses[getDirection()],\n        justifyClasses[justify],\n        alignClasses[align],\n        wrap && 'flex-wrap',\n        gap,\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\ninterface ResponsiveTextProps {\n  children: ReactNode;\n  className?: string;\n  size?: {\n    mobile?: string;\n    tablet?: string;\n    desktop?: string;\n    large?: string;\n  };\n  weight?: 'light' | 'normal' | 'medium' | 'semibold' | 'bold';\n  align?: 'left' | 'center' | 'right' | 'justify';\n  color?: string;\n}\n\n/**\n * Text that adapts size based on screen size\n */\nexport function ResponsiveText({\n  children,\n  className = '',\n  size = {\n    mobile: 'text-sm',\n    tablet: 'text-base',\n    desktop: 'text-lg',\n    large: 'text-xl',\n  },\n  weight = 'normal',\n  align = 'left',\n  color = '',\n}: ResponsiveTextProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const getSize = () => {\n    if (isMobile) {\n      return size.mobile || 'text-sm';\n    }\n    if (isTablet) {\n      return size.tablet || 'text-base';\n    }\n    if (isDesktop) {\n      return size.desktop || 'text-lg';\n    }\n    return size.large || 'text-xl';\n  };\n\n  const weightClasses = {\n    light: 'font-light',\n    normal: 'font-normal',\n    medium: 'font-medium',\n    semibold: 'font-semibold',\n    bold: 'font-bold',\n  };\n\n  const alignClasses = {\n    left: 'text-left',\n    center: 'text-center',\n    right: 'text-right',\n    justify: 'text-justify',\n  };\n\n  return (\n    <p\n      className={cn(\n        getSize(),\n        weightClasses[weight],\n        alignClasses[align],\n        color,\n        className\n      )}\n    >\n      {children}\n    </p>\n  );\n}\n\ninterface ResponsiveButtonProps {\n  children: ReactNode;\n  onClick?: () => void;\n  className?: string;\n  variant?: 'primary' | 'secondary' | 'outline' | 'ghost';\n  size?: {\n    mobile?: 'sm' | 'md' | 'lg';\n    tablet?: 'sm' | 'md' | 'lg';\n    desktop?: 'sm' | 'md' | 'lg';\n    large?: 'sm' | 'md' | 'lg';\n  };\n  disabled?: boolean;\n  loading?: boolean;\n  icon?: ReactNode;\n  iconPosition?: 'left' | 'right';\n}\n\n/**\n * Button that adapts size and padding for touch-friendly interaction\n */\nexport function ResponsiveButton({\n  children,\n  onClick,\n  className = '',\n  variant = 'primary',\n  size = { mobile: 'md', tablet: 'md', desktop: 'md', large: 'md' },\n  disabled = false,\n  loading = false,\n  icon,\n  iconPosition = 'left',\n}: ResponsiveButtonProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const getSize = () => {\n    if (isMobile) {\n      return size.mobile || 'md';\n    }\n    if (isTablet) {\n      return size.tablet || 'md';\n    }\n    if (isDesktop) {\n      return size.desktop || 'md';\n    }\n    return size.large || 'md';\n  };\n\n  const sizeClasses = {\n    sm: 'px-3 py-1.5 text-sm min-h-[36px]',\n    md: 'px-4 py-2 text-base min-h-[44px]', // Touch-friendly minimum\n    lg: 'px-6 py-3 text-lg min-h-[48px]',\n  };\n\n  const variantClasses = {\n    primary: 'bg-primary text-primary-foreground hover:bg-primary/90',\n    secondary: 'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n    outline:\n      'border border-input bg-background hover:bg-accent hover:text-accent-foreground',\n    ghost: 'hover:bg-accent hover:text-accent-foreground',\n  };\n\n  const currentSize = getSize();\n\n  return (\n    <button\n      onClick={onClick}\n      disabled={disabled || loading}\n      className={cn(\n        'inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none touch-manipulation', // Better touch handling\n        sizeClasses[currentSize],\n        variantClasses[variant],\n        className\n      )}\n    >\n      {loading && (\n        <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent mr-2\" />\n      )}\n      {icon && iconPosition === 'left' && <span className=\"mr-2\">{icon}</span>}\n      {children}\n      {icon && iconPosition === 'right' && <span className=\"ml-2\">{icon}</span>}\n    </button>\n  );\n}\n\ninterface ResponsiveCardProps {\n  children: ReactNode;\n  className?: string;\n  padding?: {\n    mobile?: string;\n    tablet?: string;\n    desktop?: string;\n    large?: string;\n  };\n  hover?: boolean;\n  interactive?: boolean;\n}\n\n/**\n * Card that adapts padding and behavior for different screen sizes\n */\nexport function ResponsiveCard({\n  children,\n  className = '',\n  padding = { mobile: 'p-4', tablet: 'p-6', desktop: 'p-6', large: 'p-8' },\n  hover = false,\n  interactive = false,\n}: ResponsiveCardProps) {\n  const { isMobile, isTablet, isDesktop } = useMobileOptimization();\n\n  const getPadding = () => {\n    if (isMobile) {\n      return padding.mobile || 'p-4';\n    }\n    if (isTablet) {\n      return padding.tablet || 'p-6';\n    }\n    if (isDesktop) {\n      return padding.desktop || 'p-6';\n    }\n    return padding.large || 'p-8';\n  };\n\n  return (\n    <div\n      className={cn(\n        'rounded-lg border bg-card text-card-foreground shadow-sm',\n        getPadding(),\n        hover && 'hover:shadow-md transition-shadow',\n        interactive &&\n          'cursor-pointer hover:shadow-lg transition-all hover:scale-[1.02] active:scale-[0.98]',\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// Utility for creating responsive className strings\nexport const createResponsiveClasses = (\n  base: string,\n  responsive: {\n    sm?: string;\n    md?: string;\n    lg?: string;\n    xl?: string;\n    '2xl'?: string;\n  }\n) => {\n  let classes = base;\n\n  Object.entries(responsive).forEach(([breakpoint, cls]) => {\n    if (cls) {\n      classes += ` ${breakpoint}:${cls}`;\n    }\n  });\n\n  return classes;\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\tabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2319,2322],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2319,2322],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":7,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":10,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2336,2339],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2336,2339],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4789,4792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4789,4792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":7,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":10,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4816,4819],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4816,4819],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6045,6048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6045,6048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":7,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":10,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6072,6075],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6072,6075],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from 'react';\r\nimport * as TabsPrimitive from '@radix-ui/react-tabs';\r\n\r\nimport { cn } from '@/lib/utils';\r\n\r\n/**\r\n * Tabs value type\r\n *\r\n * By default, Radix Tabs expects `string` values. To enable stricter typing\r\n * across your app, each wrapper below supports a generic `TValue extends string`.\r\n * You can keep using it as-is (defaults to `string`) or provide a string union\r\n * for compile-time safety:\r\n *\r\n * Example:\r\n *   type TabId = \"overview\" | \"reports\" | \"settings\"\r\n *   <Tabs<TabId> defaultValue=\"overview\">\r\n *     <TabsList>\r\n *       <TabsTrigger<TabId> value=\"overview\" />\r\n *       <TabsTrigger<TabId> value=\"reports\" />\r\n *       <TabsTrigger<TabId> value=\"settings\" />\r\n *     </TabsList>\r\n *     <TabsContent<TabId> value=\"overview\" />\r\n *     <TabsContent<TabId> value=\"reports\" />\r\n *     <TabsContent<TabId> value=\"settings\" />\r\n *   </Tabs>\r\n *\r\n * This preserves the existing shadcn-style API while allowing stricter typing.\r\n */\r\nexport type TabsValue = string;\r\n\r\n/**\r\n * Props for the typed Tabs Root component.\r\n *\r\n * - Narrow `value`/`defaultValue` to a string union via `TValue extends string`.\r\n * - Keep compatibility with Radix by forwarding all other props.\r\n * - `onValueChange` is aligned to the same `TValue` type.\r\n */\r\nexport type TabsProps<TValue extends TabsValue = TabsValue> = Omit<\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Root>,\r\n  'value' | 'defaultValue' | 'onValueChange'\r\n> & {\r\n  /**\r\n   * Controlled selected tab value. Provide a union for strict typing.\r\n   */\r\n  value?: TValue;\r\n  /**\r\n   * Uncontrolled initial tab value. Provide a union for strict typing.\r\n   */\r\n  defaultValue?: TValue;\r\n  /**\r\n   * Change handler aligned to your union-typed tab values.\r\n   */\r\n  onValueChange?: (value: TValue) => void;\r\n};\r\n\r\n/**\r\n * Tabs Root wrapper with generics.\r\n *\r\n * We cast the `forwardRef` to a callable type to expose the generic `TValue` to\r\n * consumers without changing the runtime behavior.\r\n */\r\nconst Tabs = React.forwardRef(function TabsInternal<\r\n  TValue extends TabsValue = TabsValue,\r\n>(\r\n  { className, ...props }: TabsProps<TValue>,\r\n  ref: React.Ref<React.ElementRef<typeof TabsPrimitive.Root>>\r\n) {\r\n  const cls = className ?? undefined;\r\n  return <TabsPrimitive.Root ref={ref} className={cls} {...(props as any)} />;\r\n}) as any as <TValue extends TabsValue = TabsValue>(\r\n  props: TabsProps<TValue> & {\r\n    ref?: React.Ref<React.ElementRef<typeof TabsPrimitive.Root>>;\r\n  }\r\n) => React.ReactElement;\r\n\r\n/**\r\n * TabsList keeps existing API. No `value` props here, so no extra typing.\r\n */\r\nconst TabsList = React.forwardRef<\r\n  React.ElementRef<typeof TabsPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <TabsPrimitive.List\r\n    ref={ref}\r\n    className={cn(\r\n      'inline-flex h-11 items-center justify-center rounded-lg bg-slate-100 dark:bg-slate-900 p-1.5 text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-800 shadow-sm',\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\nTabsList.displayName = TabsPrimitive.List.displayName;\r\n\r\n/**\r\n * Props for a typed TabsTrigger. The `value` prop is narrowed using generics.\r\n */\r\nexport type TabsTriggerProps<TValue extends TabsValue = TabsValue> = Omit<\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>,\r\n  'value'\r\n> & {\r\n  /**\r\n   * The tab value this trigger represents. Use a union for stronger typing.\r\n   */\r\n  value: TValue;\r\n};\r\n\r\n/**\r\n * Trigger wrapper\r\n *\r\n * Aligns with Radix's `string` value prop while enabling union typing through\r\n * `TValue extends string`. Usage without generics remains fully compatible.\r\n */\r\nconst TabsTrigger = React.forwardRef(function TabsTriggerInternal<\r\n  TValue extends TabsValue = TabsValue,\r\n>(\r\n  { className, ...props }: TabsTriggerProps<TValue>,\r\n  ref: React.Ref<React.ElementRef<typeof TabsPrimitive.Trigger>>\r\n) {\r\n  const cls = className ?? undefined;\r\n  return (\r\n    <TabsPrimitive.Trigger\r\n      ref={ref}\r\n      className={cn(\r\n        'inline-flex items-center justify-center whitespace-nowrap rounded-md px-4 py-2 text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-slate-200/50 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-slate-100 data-[state=active]:bg-white dark:data-[state=active]:bg-slate-800 data-[state=active]:text-slate-900 dark:data-[state=active]:text-slate-100 data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-slate-300 dark:data-[state=active]:border-slate-700',\r\n        cls\r\n      )}\r\n      {...(props as any)}\r\n    />\r\n  );\r\n}) as any as <TValue extends TabsValue = TabsValue>(\r\n  props: TabsTriggerProps<TValue> & {\r\n    ref?: React.Ref<React.ElementRef<typeof TabsPrimitive.Trigger>>;\r\n  }\r\n) => React.ReactElement;\r\n\r\n/**\r\n * Props for a typed TabsContent. The `value` prop is narrowed using generics.\r\n */\r\nexport type TabsContentProps<TValue extends TabsValue = TabsValue> = Omit<\r\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>,\r\n  'value'\r\n> & {\r\n  /**\r\n   * The tab value this content is associated with.\r\n   */\r\n  value: TValue;\r\n};\r\n\r\n/**\r\n * Content wrapper\r\n *\r\n * Enables union typing for the `value` prop while preserving the shadcn-style\r\n * API and runtime behavior.\r\n */\r\nconst TabsContent = React.forwardRef(function TabsContentInternal<\r\n  TValue extends TabsValue = TabsValue,\r\n>(\r\n  { className, ...props }: TabsContentProps<TValue>,\r\n  ref: React.Ref<React.ElementRef<typeof TabsPrimitive.Content>>\r\n) {\r\n  const cls = className ?? undefined;\r\n  return (\r\n    <TabsPrimitive.Content\r\n      ref={ref}\r\n      className={cn(\r\n        'mt-4 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 animate-fade-in',\r\n        cls\r\n      )}\r\n      {...(props as any)}\r\n    />\r\n  );\r\n}) as any as <TValue extends TabsValue = TabsValue>(\r\n  props: TabsContentProps<TValue> & {\r\n    ref?: React.Ref<React.ElementRef<typeof TabsPrimitive.Content>>;\r\n  }\r\n) => React.ReactElement;\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent };\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\components\\users\\UserManagement.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1128,1131],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1128,1131],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'toast'. Either include it or remove the dependency array.","line":93,"column":6,"nodeType":"ArrayExpression","endLine":93,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [roleFilter, statusFilter, searchQuery, toast]","fix":{"range":[2849,2888],"text":"[roleFilter, statusFilter, searchQuery, toast]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3731,3734],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3731,3734],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8321,8324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8321,8324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":288,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":288,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9498,9501],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9498,9501],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":303,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":303,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10200,10203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10200,10203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Users,\r\n  Plus,\r\n  Edit,\r\n  Trash2,\r\n  Shield,\r\n  ShieldAlert,\r\n  ShieldCheck,\r\n  Key,\r\n  Search,\r\n  RefreshCw,\r\n  CheckCircle,\r\n  XCircle,\r\n  Eye,\r\n} from 'lucide-react';\r\nimport userApi, {\r\n  type User,\r\n  type UserRole,\r\n  type CreateUserInput,\r\n} from '../../services/userApi';\r\nimport { useToast } from '../ToastContainer';\r\nimport { useForm } from '../../hooks';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\nconst UserManagement: React.FC = () => {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [roleFilter, setRoleFilter] = useState<UserRole | 'ALL'>('ALL');\r\n  const [statusFilter, setStatusFilter] = useState<\r\n    'ALL' | 'ACTIVE' | 'INACTIVE'\r\n  >('ALL');\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\r\n  const [statistics, setStatistics] = useState<any>(null);\r\n\r\n  const toast = useToast();\r\n\r\n  const roleColors: Record<UserRole, string> = {\r\n    SUPER_ADMIN: 'bg-purple-100 text-purple-800 border-purple-300',\r\n    ADMIN: 'bg-red-100 text-red-800 border-red-300',\r\n    LIBRARIAN: 'bg-blue-100 text-blue-800 border-blue-300',\r\n    ASSISTANT: 'bg-green-100 text-green-800 border-green-300',\r\n    TEACHER: 'bg-orange-100 text-orange-800 border-orange-300',\r\n    VIEWER: 'bg-gray-100 text-gray-800 border-gray-300',\r\n  };\r\n\r\n  const roleIcons: Record<UserRole, React.ReactNode> = {\r\n    SUPER_ADMIN: <ShieldAlert className=\"w-4 h-4\" />,\r\n    ADMIN: <ShieldCheck className=\"w-4 h-4\" />,\r\n    LIBRARIAN: <Shield className=\"w-4 h-4\" />,\r\n    ASSISTANT: <Users className=\"w-4 h-4\" />,\r\n    TEACHER: <Users className=\"w-4 h-4\" />,\r\n    VIEWER: <Eye className=\"w-4 h-4\" />,\r\n  };\r\n\r\n  const roleLabels: Record<UserRole, string> = {\r\n    SUPER_ADMIN: 'Super Admin',\r\n    ADMIN: 'Admin',\r\n    LIBRARIAN: 'Librarian',\r\n    ASSISTANT: 'Assistant',\r\n    TEACHER: 'Teacher',\r\n    VIEWER: 'Viewer',\r\n  };\r\n\r\n  const fetchUsers = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params: Record<string, unknown> = {};\r\n\r\n      if (roleFilter !== 'ALL') {\r\n        params.role = roleFilter;\r\n      }\r\n\r\n      if (statusFilter !== 'ALL') {\r\n        params.isActive = statusFilter === 'ACTIVE';\r\n      }\r\n\r\n      if (searchQuery) {\r\n        params._search = searchQuery;\r\n      }\r\n\r\n      const response = await userApi.getUsers(params);\r\n      setUsers(response.data.users);\r\n    } catch (error) {\r\n      toast.error('Error', 'Failed to fetch users');\r\n      console.error('Error fetching users:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [roleFilter, statusFilter, searchQuery]); // toast is stable from useToast hook\r\n\r\n  const fetchStatistics = useCallback(async () => {\r\n    try {\r\n      const response = await userApi.getStatistics();\r\n      setStatistics(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching statistics:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchStatistics();\r\n  }, [fetchUsers, fetchStatistics]);\r\n\r\n  const handleCreateUser = async (data: CreateUserInput) => {\r\n    try {\r\n      await userApi.createUser(data);\r\n      toast.success('Success', 'User created successfully');\r\n      setShowCreateModal(false);\r\n      fetchUsers();\r\n      fetchStatistics();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to create user'));\r\n    }\r\n  };\r\n\r\n  const handleUpdateUser = async (userId: string, data: any) => {\r\n    try {\r\n      await userApi.updateUser(userId, data);\r\n      toast.success('Success', 'User updated successfully');\r\n      setShowEditModal(false);\r\n      setSelectedUser(null);\r\n      fetchUsers();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to update user'));\r\n    }\r\n  };\r\n\r\n  const handleToggleUserStatus = async (user: User) => {\r\n    try {\r\n      if (user.isActive) {\r\n        await userApi.deactivateUser(user.id);\r\n        toast.success('Success', 'User deactivated');\r\n      } else {\r\n        await userApi.activateUser(user.id);\r\n        toast.success('Success', 'User activated');\r\n      }\r\n      fetchUsers();\r\n      fetchStatistics();\r\n    } catch (error: unknown) {\r\n      toast.error(\r\n        'Error',\r\n        getErrorMessage(error, 'Failed to update user status')\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleDeleteUser = async (user: User) => {\r\n    if (\r\n      !window.confirm(\r\n        `Are you sure you want to delete user \"${user.username}\"?`\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await userApi.deleteUser(user.id);\r\n      toast.success('Success', 'User deleted successfully');\r\n      fetchUsers();\r\n      fetchStatistics();\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to delete user'));\r\n    }\r\n  };\r\n\r\n  const handleResetPassword = async (user: User) => {\r\n    const newPassword = window.prompt(\r\n      `Enter new password for ${user.username}:`\r\n    );\r\n    if (!newPassword) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await userApi.resetPassword(user.id, newPassword);\r\n      toast.success('Success', 'Password reset successfully');\r\n    } catch (error: unknown) {\r\n      toast.error('Error', getErrorMessage(error, 'Failed to reset password'));\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric',\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">User Management</h1>\r\n          <p className=\"text-gray-600 mt-1\">\r\n            Manage system users, roles, and permissions\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowCreateModal(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n        >\r\n          <Plus className=\"w-5 h-5\" />\r\n          Add User\r\n        </button>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      {statistics && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total Users</p>\r\n                <p className=\"text-2xl font-bold text-gray-900\">\r\n                  {statistics.total}\r\n                </p>\r\n              </div>\r\n              <Users className=\"w-8 h-8 text-blue-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Active Users</p>\r\n                <p className=\"text-2xl font-bold text-green-600\">\r\n                  {statistics.active}\r\n                </p>\r\n              </div>\r\n              <CheckCircle className=\"w-8 h-8 text-green-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Inactive Users</p>\r\n                <p className=\"text-2xl font-bold text-gray-600\">\r\n                  {statistics.inactive}\r\n                </p>\r\n              </div>\r\n              <XCircle className=\"w-8 h-8 text-gray-600\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Admins</p>\r\n                <p className=\"text-2xl font-bold text-red-600\">\r\n                  {statistics.byRole.find((r: any) => r.role === 'ADMIN')\r\n                    ?._count || 0}\r\n                </p>\r\n              </div>\r\n              <ShieldCheck className=\"w-8 h-8 text-red-600\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-white p-4 rounded-lg border border-gray-200 space-y-4\">\r\n        <div className=\"flex items-center gap-4 flex-wrap\">\r\n          {/* _Search */}\r\n          <div className=\"flex-1 min-w-[200px]\">\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"_Search users...\"\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Role Filter */}\r\n          <select\r\n            value={roleFilter}\r\n            onChange={(e) => setRoleFilter(e.target.value as any)}\r\n            className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          >\r\n            <option value=\"ALL\">All Roles</option>\r\n            <option value=\"SUPER_ADMIN\">Super Admin</option>\r\n            <option value=\"ADMIN\">Admin</option>\r\n            <option value=\"LIBRARIAN\">Librarian</option>\r\n            <option value=\"ASSISTANT\">Assistant</option>\r\n            <option value=\"TEACHER\">Teacher</option>\r\n            <option value=\"VIEWER\">Viewer</option>\r\n          </select>\r\n\r\n          {/* Status Filter */}\r\n          <select\r\n            value={statusFilter}\r\n            onChange={(e) => setStatusFilter(e.target.value as any)}\r\n            className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          >\r\n            <option value=\"ALL\">All Status</option>\r\n            <option value=\"ACTIVE\">Active</option>\r\n            <option value=\"INACTIVE\">Inactive</option>\r\n          </select>\r\n\r\n          {/* Refresh Button */}\r\n          <button\r\n            onClick={fetchUsers}\r\n            disabled={loading}\r\n            className=\"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\r\n          >\r\n            <RefreshCw className={`w-5 h-5 ${loading ? 'animate-spin' : ''}`} />\r\n            Refresh\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Users Table */}\r\n      <div className=\"bg-white rounded-lg border border-gray-200 overflow-hidden\">\r\n        {loading ? (\r\n          <div className=\"flex items-center justify-center p-12\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n          </div>\r\n        ) : users.length === 0 ? (\r\n          <div className=\"flex flex-col items-center justify-center p-12\">\r\n            <Users className=\"w-16 h-16 text-gray-400 mb-4\" />\r\n            <p className=\"text-gray-600\">No users found</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full\">\r\n              <thead className=\"bg-gray-50 border-b border-gray-200\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    User\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Role\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Status\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Last Login\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Created\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {users.map((user) => (\r\n                  <tr key={user.id} className=\"hover:bg-gray-50\">\r\n                    <td className=\"px-6 py-4\">\r\n                      <div>\r\n                        <div className=\"font-medium text-gray-900\">\r\n                          {user.username}\r\n                        </div>\r\n                        {user.fullName && (\r\n                          <div className=\"text-sm text-gray-500\">\r\n                            {user.fullName}\r\n                          </div>\r\n                        )}\r\n                        {user.email && (\r\n                          <div className=\"text-sm text-gray-500\">\r\n                            {user.email}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <span\r\n                        className={`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border ${\r\n                          roleColors[user.role]\r\n                        }`}\r\n                      >\r\n                        {roleIcons[user.role]}\r\n                        {roleLabels[user.role]}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      {user.isActive ? (\r\n                        <span className=\"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\r\n                          <CheckCircle className=\"w-3 h-3\" />\r\n                          Active\r\n                        </span>\r\n                      ) : (\r\n                        <span className=\"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\r\n                          <XCircle className=\"w-3 h-3\" />\r\n                          Inactive\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-sm text-gray-600\">\r\n                      {user.lastLoginAt\r\n                        ? formatDate(user.lastLoginAt)\r\n                        : 'Never'}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-sm text-gray-600\">\r\n                      {formatDate(user.createdAt)}\r\n                    </td>\r\n                    <td className=\"px-6 py-4\">\r\n                      <div className=\"flex items-center justify-end gap-2\">\r\n                        <button\r\n                          onClick={() => {\r\n                            setSelectedUser(user);\r\n                            setShowEditModal(true);\r\n                          }}\r\n                          className=\"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                          title=\"Edit user\"\r\n                        >\r\n                          <Edit className=\"w-4 h-4\" />\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleResetPassword(user)}\r\n                          className=\"p-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors\"\r\n                          title=\"Reset password\"\r\n                        >\r\n                          <Key className=\"w-4 h-4\" />\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleToggleUserStatus(user)}\r\n                          className={`p-1.5 rounded transition-colors ${\r\n                            user.isActive\r\n                              ? 'text-gray-600 hover:bg-gray-50'\r\n                              : 'text-green-600 hover:bg-green-50'\r\n                          }`}\r\n                          title={user.isActive ? 'Deactivate' : 'Activate'}\r\n                        >\r\n                          {user.isActive ? (\r\n                            <XCircle className=\"w-4 h-4\" />\r\n                          ) : (\r\n                            <CheckCircle className=\"w-4 h-4\" />\r\n                          )}\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleDeleteUser(user)}\r\n                          className=\"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors\"\r\n                          title=\"Delete user\"\r\n                        >\r\n                          <Trash2 className=\"w-4 h-4\" />\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Create User Modal - Simplified for now */}\r\n      {showCreateModal && (\r\n        <CreateUserModal\r\n          onClose={() => setShowCreateModal(false)}\r\n          onSubmit={handleCreateUser}\r\n        />\r\n      )}\r\n\r\n      {/* Edit User Modal */}\r\n      {showEditModal && selectedUser && (\r\n        <EditUserModal\r\n          user={selectedUser}\r\n          onClose={() => {\r\n            setShowEditModal(false);\r\n            setSelectedUser(null);\r\n          }}\r\n          onSubmit={(data) => handleUpdateUser(selectedUser.id, data)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Create User Modal Component\r\nconst CreateUserModal: React.FC<{\r\n  onClose: () => void;\r\n  onSubmit: (data: CreateUserInput) => void;\r\n}> = ({ onClose, onSubmit }) => {\r\n  const [createForm, createFormActions] = useForm({\r\n    initialValues: {\r\n      username: '',\r\n      password: '',\r\n      email: '',\r\n      fullName: '',\r\n      role: 'LIBRARIAN',\r\n    },\r\n    validationSchema: {\r\n      username: { required: true },\r\n      password: { required: true },\r\n      email: { required: false },\r\n      fullName: { required: false },\r\n      role: { required: true },\r\n    },\r\n  });\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onSubmit(createForm.values as CreateUserInput);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Create New User</h2>\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Username *\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              required\r\n              value={createForm.values.username}\r\n              onChange={(e) =>\r\n                createFormActions.setValue('username', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Password *\r\n            </label>\r\n            <input\r\n              type=\"password\"\r\n              required\r\n              value={createForm.values.password}\r\n              onChange={(e) =>\r\n                createFormActions.setValue('password', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Full Name\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={createForm.values.fullName}\r\n              onChange={(e) =>\r\n                createFormActions.setValue('fullName', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Email\r\n            </label>\r\n            <input\r\n              type=\"email\"\r\n              value={createForm.values.email}\r\n              onChange={(e) =>\r\n                createFormActions.setValue('email', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Role *\r\n            </label>\r\n            <select\r\n              required\r\n              value={createForm.values.role}\r\n              onChange={(e) =>\r\n                createFormActions.setValue('role', e.target.value as UserRole)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"LIBRARIAN\">Librarian</option>\r\n              <option value=\"ASSISTANT\">Assistant</option>\r\n              <option value=\"TEACHER\">Teacher</option>\r\n              <option value=\"VIEWER\">Viewer</option>\r\n              <option value=\"ADMIN\">Admin</option>\r\n              <option value=\"SUPER_ADMIN\">Super Admin</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 justify-end mt-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n            >\r\n              Create User\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Edit User Modal Component\r\nconst EditUserModal: React.FC<{\r\n  user: User;\r\n  onClose: () => void;\r\n  onSubmit: (data: unknown) => void;\r\n}> = ({ user, onClose, onSubmit }) => {\r\n  const [editForm, editFormActions] = useForm({\r\n    initialValues: {\r\n      username: user.username,\r\n      fullName: user.fullName || '',\r\n      email: user.email || '',\r\n      role: user.role,\r\n    },\r\n    validationSchema: {\r\n      username: { required: true },\r\n      fullName: { required: false },\r\n      email: { required: false },\r\n      role: { required: true },\r\n    },\r\n  });\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    onSubmit(editForm.values);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\r\n        <h2 className=\"text-xl font-bold mb-4\">Edit User</h2>\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Username *\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              required\r\n              value={editForm.values.username}\r\n              onChange={(e) =>\r\n                editFormActions.setValue('username', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Full Name\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={editForm.values.fullName}\r\n              onChange={(e) =>\r\n                editFormActions.setValue('fullName', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Email\r\n            </label>\r\n            <input\r\n              type=\"email\"\r\n              value={editForm.values.email}\r\n              onChange={(e) =>\r\n                editFormActions.setValue('email', e.target.value)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Role *\r\n            </label>\r\n            <select\r\n              required\r\n              value={editForm.values.role}\r\n              onChange={(e) =>\r\n                editFormActions.setValue('role', e.target.value as UserRole)\r\n              }\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              <option value=\"LIBRARIAN\">Librarian</option>\r\n              <option value=\"ASSISTANT\">Assistant</option>\r\n              <option value=\"TEACHER\">Teacher</option>\r\n              <option value=\"VIEWER\">Viewer</option>\r\n              <option value=\"ADMIN\">Admin</option>\r\n              <option value=\"SUPER_ADMIN\">Super Admin</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex gap-2 justify-end mt-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n            >\r\n              Update User\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserManagement;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\contexts\\AuthContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4207,4210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4207,4210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4258,4261],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4258,4261],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4296,4299],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4296,4299],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":229,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":229,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n  type ReactNode,\n} from 'react';\nimport { useQuery, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\n\nimport {\n  apiClient,\n  setAccessTokenProvider,\n  setUnauthorizedHandler,\n  type LoginResponse,\n} from '@/lib/api';\nimport {\n  authKeys,\n  clearAuthState,\n  fetchCurrentUser,\n  primeAuthState,\n  type AuthUser,\n} from '@/lib/auth-queries';\n\ninterface AuthContextType {\n  user: AuthUser | null;\n  token: string | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: (\n    username: string,\n    password: string,\n    rememberMe?: boolean\n  ) => Promise<boolean>;\n  logout: () => void;\n  checkAuth: () => Promise<boolean>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\ninterface LogoutOptions {\n  message?: string;\n  silent?: boolean;\n  severity?: 'info' | 'error';\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const queryClient = useQueryClient();\n  const [token, setToken] = useState<string | null>(\n    () =>\n      localStorage.getItem('clms_token') || sessionStorage.getItem('clms_token')\n  );\n\n  const performLogout = useCallback(\n    ({ message, silent, severity = 'info' }: LogoutOptions = {}) => {\n      // Clear both localStorage and sessionStorage\n      localStorage.removeItem('clms_token');\n      localStorage.removeItem('clms_user');\n      sessionStorage.removeItem('clms_token');\n      sessionStorage.removeItem('clms_user');\n      setToken(null);\n      clearAuthState(queryClient);\n\n      if (!silent) {\n        const text = message ?? 'You have been logged out';\n        if (severity === 'error') {\n          toast.error(text);\n        } else {\n          toast.info(text);\n        }\n      }\n    },\n    [queryClient]\n  );\n\n  const authQuery = useQuery<AuthUser>({\n    queryKey: authKeys.current(),\n    queryFn: fetchCurrentUser,\n    enabled: Boolean(token),\n    staleTime: 5 * 60 * 1000,\n    gcTime: 15 * 60 * 1000,\n    retry: false,\n  });\n\n  // Handle successful auth query with useEffect (React Query v5 pattern)\n  useEffect(() => {\n    if (authQuery.data) {\n      localStorage.setItem('clms_user', JSON.stringify(authQuery.data));\n    }\n  }, [authQuery.data]);\n\n  const logout = useCallback(() => {\n    performLogout();\n  }, [performLogout]);\n\n  useEffect(() => {\n    setAccessTokenProvider(\n      () =>\n        localStorage.getItem('clms_token') ||\n        sessionStorage.getItem('clms_token')\n    );\n\n    setUnauthorizedHandler(() => {\n      performLogout({\n        message: 'Session expired. Please log in again.',\n        severity: 'error',\n      });\n    });\n\n    return () => {\n      setAccessTokenProvider(() => null);\n      setUnauthorizedHandler(null);\n    };\n  }, [performLogout]);\n\n  const login = useCallback(\n    async (username: string, password: string, rememberMe: boolean = false) => {\n      try {\n        const response = await apiClient.post<LoginResponse>(\n          '/api/auth/login',\n          {\n            username,\n            password,\n            rememberMe,\n          }\n        );\n\n        if (response.success && response.data) {\n          const { accessToken, user } = response.data;\n\n          // Store token in localStorage or sessionStorage based on rememberMe\n          if (rememberMe) {\n            localStorage.setItem('clms_token', accessToken);\n            localStorage.setItem('clms_user', JSON.stringify(user));\n          } else {\n            // For session-only, use sessionStorage\n            sessionStorage.setItem('clms_token', accessToken);\n            sessionStorage.setItem('clms_user', JSON.stringify(user));\n          }\n\n          setToken(accessToken);\n\n          queryClient.setQueryData(authKeys.current(), user);\n\n          try {\n            await primeAuthState(queryClient);\n          } catch (primeError) {\n            console.error(\n              'Failed to prime auth state after login:',\n              primeError\n            );\n          }\n\n          toast.success(`Welcome back, ${user.username}!`);\n          return true;\n        }\n\n        toast.error(\n          typeof (response as any).error === 'string'\n            ? (response as any).error\n            : (response as any).error?.message || 'Login failed'\n        );\n        return false;\n      } catch (error) {\n        console.error('Login error:', error);\n        toast.error('An error occurred during login');\n        return false;\n      }\n    },\n    [queryClient]\n  );\n\n  const checkAuth = useCallback(async (): Promise<boolean> => {\n    const storedToken =\n      localStorage.getItem('clms_token') ||\n      sessionStorage.getItem('clms_token');\n\n    if (!storedToken) {\n      performLogout({ silent: true });\n      return false;\n    }\n\n    setToken(storedToken);\n\n    try {\n      const currentUser: AuthUser = await primeAuthState(queryClient);\n      queryClient.setQueryData(authKeys.current(), currentUser);\n      return true;\n    } catch (error) {\n      console.error('Auth check failed:', error);\n      performLogout({\n        message: 'Session expired. Please log in again.',\n        severity: 'error',\n      });\n      return false;\n    }\n  }, [performLogout, queryClient]);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  const user: AuthUser | null = authQuery.data || null;\n  const isAuthenticated = Boolean(token && user);\n  const isLoading = token ? authQuery.isPending : false;\n\n  const value = useMemo<AuthContextType>(\n    () => ({\n      user,\n      token,\n      isAuthenticated,\n      isLoading,\n      login,\n      logout,\n      checkAuth,\n    }),\n    [checkAuth, isAuthenticated, isLoading, login, logout, token, user]\n  );\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth(): AuthContextType {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\nexport default AuthContext;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\contexts\\ThemeContext.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'resolveTheme' and 'theme'. Either include them or remove the dependency array.","line":111,"column":6,"nodeType":"ArrayExpression","endLine":111,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [resolveTheme, theme]","fix":{"range":[3261,3263],"text":"[resolveTheme, theme]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'resolveTheme'. Either include it or remove the dependency array.","line":116,"column":6,"nodeType":"ArrayExpression","endLine":116,"endColumn":13,"suggestions":[{"desc":"Update the dependencies array to be: [resolveTheme, theme]","fix":{"range":[3375,3382],"text":"[resolveTheme, theme]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":127,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":127,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react';\n\ntype Theme = 'light' | 'dark' | 'system';\ntype ResolvedTheme = 'light' | 'dark';\n\ninterface ThemeContextType {\n  theme: Theme;\n  resolvedTheme: ResolvedTheme;\n  setTheme: (theme: Theme) => void;\n  toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setThemeState] = useState<Theme>('system');\n  const [resolvedTheme, setResolvedTheme] = useState<ResolvedTheme>('light');\n\n  // Get system theme preference\n  const getSystemTheme = (): ResolvedTheme => {\n    if (typeof window === 'undefined') {\n      return 'light';\n    }\n    return window.matchMedia('(prefers-color-scheme: dark)').matches\n      ? 'dark'\n      : 'light';\n  };\n\n  // Resolve the actual theme to apply\n  const resolveTheme = (themeValue: Theme): ResolvedTheme => {\n    if (themeValue === 'system') {\n      return getSystemTheme();\n    }\n    return themeValue;\n  };\n\n  // Apply theme to document\n  const applyTheme = (resolved: ResolvedTheme) => {\n    const root = document.documentElement;\n\n    // Add transitioning class for smooth animation\n    root.classList.add('theme-transitioning');\n\n    // Apply the theme\n    if (resolved === 'dark') {\n      root.classList.add('dark');\n    } else {\n      root.classList.remove('dark');\n    }\n\n    // Update meta theme-color for mobile browsers\n    const metaThemeColor = document.querySelector('meta[name=\"theme-color\"]');\n    if (metaThemeColor) {\n      metaThemeColor.setAttribute(\n        'content',\n        resolved === 'dark' ? '#141b2e' : '#f8fafc'\n      );\n    }\n\n    // Remove transitioning class after animation\n    setTimeout(() => {\n      root.classList.remove('theme-transitioning');\n    }, 300);\n\n    setResolvedTheme(resolved);\n  };\n\n  // Set theme and persist\n  const setTheme = (newTheme: Theme) => {\n    setThemeState(newTheme);\n    localStorage.setItem('clms_theme', newTheme);\n    applyTheme(resolveTheme(newTheme));\n  };\n\n  // Toggle between light and dark (skip system)\n  const toggleTheme = () => {\n    const newTheme = resolvedTheme === 'light' ? 'dark' : 'light';\n    setTheme(newTheme);\n  };\n\n  // Initialize theme on mount\n  useEffect(() => {\n    // Get saved theme or default to system\n    const savedTheme = localStorage.getItem('clms_theme') as Theme | null;\n    const initialTheme = savedTheme || 'system';\n\n    setThemeState(initialTheme);\n    applyTheme(resolveTheme(initialTheme));\n\n    // Listen for system theme changes\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = (e: MediaQueryListEvent) => {\n      if (theme === 'system') {\n        applyTheme(e.matches ? 'dark' : 'light');\n      }\n    };\n\n    // Modern browsers\n    if (mediaQuery.addEventListener) {\n      mediaQuery.addEventListener('change', handleChange);\n      return () => mediaQuery.removeEventListener('change', handleChange);\n    }\n    // Legacy browsers\n    else if (mediaQuery.addListener) {\n      mediaQuery.addListener(handleChange);\n      return () => mediaQuery.removeListener(handleChange);\n    }\n\n    // Fallback for unsupported browsers\n    return undefined;\n  }, []);\n\n  // Update resolved theme when theme changes\n  useEffect(() => {\n    applyTheme(resolveTheme(theme));\n  }, [theme]);\n\n  return (\n    <ThemeContext.Provider\n      value={{ theme, resolvedTheme, setTheme, toggleTheme }}\n    >\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\contexts\\WebSocketContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[439,442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[439,442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[665,668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[665,668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1010,1013],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1010,1013],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1037,1040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1037,1040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1060,1063],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1060,1063],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":45,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1085,1088],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1085,1088],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1199,1202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1199,1202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1543,1546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1543,1546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1613,1616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1613,1616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1677,1680],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1677,1680],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1743,1746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1743,1746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":74,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2055,2058],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2055,2058],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2240,2243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2240,2243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2434,2437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2434,2437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":92,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2608,2611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2608,2611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3233,3236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3233,3236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'ws'. Either include it or remove the dependency array.","line":120,"column":5,"nodeType":"ArrayExpression","endLine":120,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [ws]","fix":{"range":[3307,3332],"text":"[ws]"}}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":155,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":155,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n  useCallback,\r\n  type ReactNode,\r\n} from 'react';\r\nimport { useWebSocket, type WebSocketState } from '@/hooks/useWebSocket';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\nexport interface WebSocketContextType extends WebSocketState {\r\n  // Connection methods\r\n  connect: () => void;\r\n  disconnect: () => void;\r\n\r\n  // Message methods\r\n  sendMessage: (message: any) => boolean;\r\n\r\n  // Subscription methods\r\n  subscribe: (subscription: string) => boolean;\r\n  unsubscribe: (subscription: string) => boolean;\r\n\r\n  // Dashboard methods\r\n  requestDashboardData: (dataType: string, filters?: any) => boolean;\r\n\r\n  // Communication methods\r\n  sendChatMessage: (\r\n    message: string,\r\n    targetRole?: string,\r\n    targetUserId?: string\r\n  ) => boolean;\r\n\r\n  // Emergency methods\r\n  triggerEmergencyAlert: (\r\n    alertType: string,\r\n    message: string,\r\n    location?: string\r\n  ) => boolean;\r\n\r\n  // Real-time data\r\n  recentActivities: any[];\r\n  equipmentStatus: any;\r\n  notifications: any[];\r\n  dashboardData: any;\r\n\r\n  // Utility methods\r\n  clearNotifications: () => void;\r\n  refreshDashboard: (dataType: string, filters?: any) => void;\r\n}\r\n\r\nconst WebSocketContext = createContext<WebSocketContextType | undefined>(\r\n  undefined\r\n);\r\n\r\ninterface WebSocketProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function WebSocketProvider({ children }: WebSocketProviderProps) {\r\n  const { user } = useAuth();\r\n  const [recentActivities, setRecentActivities] = useState<any[]>([]);\r\n  const [equipmentStatus, setEquipmentStatus] = useState<any>({});\r\n  const [notifications, setNotifications] = useState<any[]>([]);\r\n  const [dashboardData, setDashboardData] = useState<any>({});\r\n\r\n  // WebSocket connection\r\n  const ws = useWebSocket({\r\n    autoConnect: true,\r\n    subscriptions: ['activities', 'equipment', 'notifications', 'dashboard'],\r\n    onMessage: (message) => {\r\n      switch (message.type) {\r\n        case 'student_activity_update':\r\n          setRecentActivities((prev: any[]) => [\r\n            message.data,\r\n            ...prev.slice(0, 49),\r\n          ]);\r\n          break;\r\n        case 'equipment_status_update':\r\n          setEquipmentStatus((prev: any) => ({\r\n            ...prev,\r\n            [message.data.equipmentId]: message.data,\r\n          }));\r\n          break;\r\n        case 'system_notification':\r\n          setNotifications((prev: any[]) => [\r\n            message.data,\r\n            ...prev.slice(0, 49),\r\n          ]);\r\n          break;\r\n        case 'dashboard_data':\r\n          setDashboardData((prev: any) => ({\r\n            ...prev,\r\n            [message.data.dataType]: message.data.data,\r\n          }));\r\n          break;\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      console.error('WebSocket connection error:', error);\r\n    },\r\n    onDisconnect: () => {\r\n      console.debug('WebSocket disconnected');\r\n    },\r\n    onConnect: () => {\r\n      console.debug('WebSocket connected');\r\n    },\r\n  });\r\n\r\n  // Clear notifications\r\n  const clearNotifications = useCallback(() => {\r\n    setNotifications([]);\r\n  }, []);\r\n\r\n  // Refresh dashboard data\r\n  const refreshDashboard = useCallback(\r\n    (dataType: string, filters?: any) => {\r\n      ws.requestDashboardData(dataType, filters);\r\n    },\r\n    [ws.requestDashboardData]\r\n  );\r\n\r\n  // Auto-refresh dashboard data when connected\r\n  useEffect(() => {\r\n    if (ws.isConnected && user) {\r\n      // Request initial dashboard data\r\n      const timeoutId = setTimeout(() => {\r\n        refreshDashboard('overview');\r\n        refreshDashboard('activities');\r\n        refreshDashboard('equipment');\r\n      }, 1000);\r\n\r\n      return () => clearTimeout(timeoutId);\r\n    }\r\n    return undefined;\r\n  }, [ws.isConnected, user, refreshDashboard]);\r\n\r\n  const contextValue: WebSocketContextType = {\r\n    ...ws,\r\n    recentActivities,\r\n    equipmentStatus,\r\n    notifications,\r\n    dashboardData,\r\n    clearNotifications,\r\n    refreshDashboard,\r\n  };\r\n\r\n  return (\r\n    <WebSocketContext.Provider value={contextValue}>\r\n      {children}\r\n    </WebSocketContext.Provider>\r\n  );\r\n}\r\n\r\nexport const useWebSocketContext = (): WebSocketContextType => {\r\n  const context = useContext(WebSocketContext);\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      'useWebSocketContext must be used within a WebSocketProvider'\r\n    );\r\n  }\r\n  return context;\r\n};\r\n\r\nexport default WebSocketProvider;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\examples\\state-management-examples.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7399,7402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7399,7402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":573,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":573,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17320,17323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17320,17323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Example: Using New State Management Hooks\r\n *\r\n * This file demonstrates how to use the new custom hooks to simplify components\r\n * and consolidate state management patterns across the CLMS application.\r\n */\r\n\r\n// No React import needed - using JSX transform\r\nimport {\r\n  useLoadingState,\r\n  useModalState,\r\n  useSearchFilters,\r\n  useForm,\r\n  useDataRefresh,\r\n  useMultipleModals,\r\n  useActionState,\r\n} from '@/hooks';\r\n\r\n// ============================================================================\r\n// Example 1: Simplified Loading State Management\r\n// ============================================================================\r\n\r\ninterface Student {\r\n  id: string;\r\n  name: string;\r\n  gradeLevel: string;\r\n  isActive: boolean;\r\n}\r\n\r\nfunction StudentListExample() {\r\n  // Instead of multiple useState calls:\r\n  // const [isLoading, setIsLoading] = useState(false);\r\n  // const [error, setError] = useState<string | null>(null);\r\n  // const [data, setData] = useState<Student[]>([]);\r\n\r\n  // Use the new loading state hook:\r\n  const [state, actions] = useLoadingState({\r\n    data: [],\r\n  });\r\n\r\n  const fetchStudents = async () => {\r\n    actions.start();\r\n    try {\r\n      const response = await fetch('/api/students');\r\n      const students = await response.json();\r\n      actions.finish(students);\r\n    } catch (error) {\r\n      actions.error('Failed to fetch students');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button onClick={fetchStudents} disabled={state.isLoading}>\r\n        {state.isLoading ? 'Loading...' : 'Fetch Students'}\r\n      </button>\r\n\r\n      {state.error && <div className=\"error\">{state.error}</div>}\r\n      {state.data && state.data.length > 0 && (\r\n        <ul>\r\n          {state.data.map((student: Student) => (\r\n            <li key={student.id}>{student.name}</li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 2: Modal State Management\r\n// ============================================================================\r\n\r\nfunction StudentModalExample() {\r\n  // Instead of managing modal state manually:\r\n  // const [isModalOpen, setIsModalOpen] = useState(false);\r\n  // const [modalData, setModalData] = useState(null);\r\n\r\n  // Use the new modal state hook:\r\n  const [state, actions] = useModalState();\r\n\r\n  const openStudentForm = (student?: Student) => {\r\n    actions.open(student || null);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <button onClick={() => openStudentForm()}>Add New Student</button>\r\n\r\n      <dialog open={state.isOpen}>\r\n        <form onSubmit={() => actions.close()}>\r\n          <h3>{state.data ? 'Edit Student' : 'Add New Student'}</h3>\r\n\r\n          {state.data && (\r\n            <input\r\n              type=\"text\"\r\n              defaultValue={state.data.name}\r\n              placeholder=\"Student Name\"\r\n            />\r\n          )}\r\n\r\n          <div>\r\n            <button type=\"submit\">Save</button>\r\n            <button type=\"button\" onClick={actions.close}>\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </dialog>\r\n    </>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 3: _Search and Filter State Management\r\n// ============================================================================\r\n\r\nfunction StudentSearchExample() {\r\n  // Instead of managing multiple filter states:\r\n  // const [searchTerm, setSearchTerm] = useState('');\r\n  // const [gradeFilter, setGradeFilter] = useState('');\r\n  // const [statusFilter, setStatusFilter] = useState('');\r\n  // const [sortBy, setSortBy] = useState('name');\r\n  // const [sortOrder, setSortOrder] = useState('asc');\r\n\r\n  // Use the new _search filters hook:\r\n  const [state, actions, computed] = useSearchFilters({\r\n    defaultFilters: { gradeLevel: '', isActive: '' },\r\n    defaultSortBy: 'name',\r\n    defaultSortOrder: 'asc',\r\n  });\r\n\r\n  const students: Student[] = [\r\n    { id: '1', name: 'John Doe', gradeLevel: '10', isActive: true },\r\n    { id: '2', name: 'Jane Smith', gradeLevel: '11', isActive: false },\r\n    // ... more students\r\n  ];\r\n\r\n  // Apply filters to data\r\n  const filteredStudents = students.filter((student) => {\r\n    const matchesSearch =\r\n      !state.searchTerm ||\r\n      student.name.toLowerCase().includes(state.searchTerm.toLowerCase());\r\n\r\n    const matchesGrade =\r\n      !state.filters.gradeLevel ||\r\n      student.gradeLevel === state.filters.gradeLevel;\r\n\r\n    const matchesStatus =\r\n      !state.filters.isActive ||\r\n      student.isActive.toString() === state.filters.isActive;\r\n\r\n    return matchesSearch && matchesGrade && matchesStatus;\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      {/* _Search Input */}\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"_Search students...\"\r\n        value={state.searchTerm}\r\n        onChange={(e) => actions.setSearchTerm(e.target.value)}\r\n      />\r\n\r\n      {/* Filter Controls */}\r\n      <select\r\n        value={state.filters.gradeLevel || ''}\r\n        onChange={(e) => actions.setFilter('gradeLevel', e.target.value)}\r\n      >\r\n        <option value=\"\">All Grades</option>\r\n        <option value=\"9\">Grade 9</option>\r\n        <option value=\"10\">Grade 10</option>\r\n        <option value=\"11\">Grade 11</option>\r\n      </select>\r\n\r\n      <select\r\n        value={state.filters.isActive || ''}\r\n        onChange={(e) => actions.setFilter('isActive', e.target.value)}\r\n      >\r\n        <option value=\"\">All Status</option>\r\n        <option value=\"true\">Active</option>\r\n        <option value=\"false\">Inactive</option>\r\n      </select>\r\n\r\n      {/* Sort Controls */}\r\n      <button onClick={() => actions.setSortBy('name')}>\r\n        Sort by Name {state.sortBy === 'name' && `(${state.sortOrder})`}\r\n      </button>\r\n\r\n      {/* Clear Filters */}\r\n      {computed.hasActiveFilters && (\r\n        <button onClick={actions.clearFilters}>Clear Filters</button>\r\n      )}\r\n\r\n      {/* Results */}\r\n      <div>\r\n        Found {filteredStudents.length} students\r\n        {computed.hasActiveFilters && ' (filtered)'}\r\n      </div>\r\n\r\n      <ul>\r\n        {filteredStudents.map((student) => (\r\n          <li key={student.id}>\r\n            {student.name} - Grade {student.gradeLevel} -\r\n            {student.isActive ? 'Active' : 'Inactive'}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 4: Form State Management\r\n// ============================================================================\r\n\r\nfunction StudentFormExample() {\r\n  // Instead of managing form state manually:\r\n  // const [formData, setFormData] = useState({});\r\n  // const [errors, setErrors] = useState({});\r\n  // const [touched, setTouched] = useState({});\r\n  // const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  // Use the new form state hook:\r\n  const [state, actions] = useForm({\r\n    initialValues: {\r\n      name: '',\r\n      email: '',\r\n      gradeLevel: '',\r\n      isActive: true,\r\n    },\r\n    validationSchema: {\r\n      name: { required: true, minLength: 2 },\r\n      email: {\r\n        required: true,\r\n        pattern: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\r\n      },\r\n      gradeLevel: { required: true },\r\n    },\r\n    onSubmit: async (values) => {\r\n      await submitStudent(values);\r\n    },\r\n  });\r\n\r\n  const submitStudent = async (values: any) => {\r\n    try {\r\n      await fetch('/api/students', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(values),\r\n      });\r\n      // Handle success\r\n    } catch (error) {\r\n      // Handle error\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={actions.submit}>\r\n      <div>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Student Name\"\r\n          value={state.values.name}\r\n          onChange={(e) => actions.setValue('name', e.target.value)}\r\n          onBlur={() => actions.setTouched('name')}\r\n        />\r\n        {state.touched.name && state.errors.name && (\r\n          <span className=\"error\">{state.errors.name}</span>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <input\r\n          type=\"email\"\r\n          placeholder=\"Email\"\r\n          value={state.values.email}\r\n          onChange={(e) => actions.setValue('email', e.target.value)}\r\n          onBlur={() => actions.setTouched('email')}\r\n        />\r\n        {state.touched.email && state.errors.email && (\r\n          <span className=\"error\">{state.errors.email}</span>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        <select\r\n          value={state.values.gradeLevel}\r\n          onChange={(e) => actions.setValue('gradeLevel', e.target.value)}\r\n          onBlur={() => actions.setTouched('gradeLevel')}\r\n        >\r\n          <option value=\"\">Select Grade</option>\r\n          <option value=\"9\">Grade 9</option>\r\n          <option value=\"10\">Grade 10</option>\r\n          <option value=\"11\">Grade 11</option>\r\n        </select>\r\n        {state.touched.gradeLevel && state.errors.gradeLevel && (\r\n          <span className=\"error\">{state.errors.gradeLevel}</span>\r\n        )}\r\n      </div>\r\n\r\n      <button\r\n        type=\"submit\"\r\n        disabled={state.isSubmitting || Object.keys(state.errors).length > 0}\r\n      >\r\n        {state.isSubmitting ? 'Submitting...' : 'Submit'}\r\n      </button>\r\n    </form>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 5: Data Refresh and Polling\r\n// ============================================================================\r\n\r\nfunction DashboardExample() {\r\n  // Instead of managing refresh intervals manually:\r\n  // const [data, setData] = useState(null);\r\n  // const [lastRefresh, setLastRefresh] = useState<Date | null>(null);\r\n  // const [isRefreshing, setIsRefreshing] = useState(false);\r\n  // const refreshInterval = useRef<NodeJS.Timeout>();\r\n\r\n  // Use the new data refresh hook:\r\n  const [state, actions] = useDataRefresh(\r\n    () => fetch('/api/dashboard-metrics').then((res) => res.json()),\r\n    {\r\n      interval: 30000, // Refresh every 30 seconds\r\n      onSuccess: (data) => {\r\n        console.debug('Dashboard data refreshed:', data);\r\n      },\r\n      onError: (error) => {\r\n        console.error('Dashboard refresh failed:', error);\r\n      },\r\n    }\r\n  );\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <h2>Dashboard Metrics</h2>\r\n\r\n        <div>\r\n          <button onClick={actions.refresh} disabled={state.isRefreshing}>\r\n            {state.isRefreshing ? 'Refreshing...' : 'Refresh Now'}\r\n          </button>\r\n\r\n          {state.lastRefreshTime && (\r\n            <span>\r\n              Last updated: {state.lastRefreshTime.toLocaleTimeString()}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {state.error && (\r\n          <div className=\"error\">\r\n            Failed to refresh: {state.error.message}\r\n            <button onClick={actions.clearError}>Dismiss</button>\r\n          </div>\r\n        )}\r\n\r\n        {state.data && (\r\n          <div>\r\n            <h3>Today's Activity</h3>\r\n            <p>Total Students: {state.data.totalStudents}</p>\r\n            <p>Active Sessions: {state.data.activeSessions}</p>\r\n            <p>Equipment in Use: {state.data.equipmentInUse}</p>\r\n          </div>\r\n        )}\r\n\r\n        {!state.data && !state.error && <div>Loading dashboard...</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 6: Multiple Modals with Consistent Patterns\r\n// ============================================================================\r\n\r\nfunction MultiModalExample() {\r\n  // Use multiple modals with shared interface:\r\n  const [states, actions] = useMultipleModals({\r\n    addStudent: null,\r\n    editStudent: null,\r\n    deleteConfirm: null,\r\n    importDialog: null,\r\n  });\r\n\r\n  return (\r\n    <div>\r\n      {/* Buttons to open different modals */}\r\n      <button onClick={() => actions.addStudent.open()}>Add Student</button>\r\n\r\n      <button\r\n        onClick={() => actions.editStudent.open({ id: '1', name: 'John' })}\r\n      >\r\n        Edit Student\r\n      </button>\r\n\r\n      <button\r\n        onClick={() =>\r\n          actions.deleteConfirm.open({\r\n            studentId: '1',\r\n            studentName: 'John Doe',\r\n          })\r\n        }\r\n      >\r\n        Delete Student\r\n      </button>\r\n\r\n      {/* Student Form Modal */}\r\n      <dialog open={states.addStudent.isOpen}>\r\n        <form onSubmit={() => actions.addStudent.close()}>\r\n          <h3>Add New Student</h3>\r\n          {/* Form fields */}\r\n          <button type=\"submit\">Save</button>\r\n          <button type=\"button\" onClick={actions.addStudent.close}>\r\n            Cancel\r\n          </button>\r\n        </form>\r\n      </dialog>\r\n\r\n      {/* Edit Student Modal */}\r\n      <dialog open={states.editStudent.isOpen}>\r\n        <form onSubmit={() => actions.editStudent.close()}>\r\n          <h3>Edit Student</h3>\r\n          {states.editStudent.data && (\r\n            <input type=\"text\" defaultValue={states.editStudent.data.name} />\r\n          )}\r\n          <button type=\"submit\">Save</button>\r\n          <button type=\"button\" onClick={actions.editStudent.close}>\r\n            Cancel\r\n          </button>\r\n        </form>\r\n      </dialog>\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      <dialog open={states.deleteConfirm.isOpen}>\r\n        <form onSubmit={() => actions.deleteConfirm.close()}>\r\n          <h3>Confirm Delete</h3>\r\n          {states.deleteConfirm.data && (\r\n            <p>\r\n              Are you sure you want to delete{' '}\r\n              <strong>{states.deleteConfirm.data.studentName}</strong>?\r\n            </p>\r\n          )}\r\n          <button type=\"submit\">Delete</button>\r\n          <button type=\"button\" onClick={actions.deleteConfirm.close}>\r\n            Cancel\r\n          </button>\r\n        </form>\r\n      </dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 7: Export and Action States\r\n// ============================================================================\r\n\r\nfunction ExportExample() {\r\n  const [state, actions] = useActionState(\r\n    async ({ format, data }) => {\r\n      // Simulate export process\r\n      const response = await fetch('/api/export', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ format, data }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Export failed');\r\n      }\r\n\r\n      const blob = await response.blob();\r\n      return blob;\r\n    },\r\n    {\r\n      onSuccess: (blob) => {\r\n        // Download the file\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `export.${state.data?.format || 'csv'}`;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n      },\r\n      onError: (error) => {\r\n        console.error('Export failed:', error);\r\n      },\r\n    }\r\n  );\r\n\r\n  const handleExport = (format: string) => {\r\n    const data = getStudentData(); // Your data here\r\n    actions.start({ format, data });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h3>Export Student Data</h3>\r\n\r\n      <div>\r\n        <button onClick={() => handleExport('csv')} disabled={state.isLoading}>\r\n          Export as CSV\r\n        </button>\r\n\r\n        <button onClick={() => handleExport('xlsx')} disabled={state.isLoading}>\r\n          Export as Excel\r\n        </button>\r\n\r\n        <button onClick={() => handleExport('pdf')} disabled={state.isLoading}>\r\n          Export as PDF\r\n        </button>\r\n      </div>\r\n\r\n      {state.isLoading && (\r\n        <div>\r\n          <div className=\"progress-bar\">\r\n            <div\r\n              className=\"progress-fill\"\r\n              style={{ width: `${state.progress}%` }}\r\n            />\r\n          </div>\r\n          <p>Exporting... {Math.round(state.progress)}%</p>\r\n          <button onClick={actions.cancel}>Cancel</button>\r\n        </div>\r\n      )}\r\n\r\n      {state.error && (\r\n        <div className=\"error\">\r\n          Export failed: {state.error}\r\n          <button onClick={actions.reset}>Try Again</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ============================================================================\r\n// Example 8: Complete Component Using Multiple Hooks\r\n// ============================================================================\r\n\r\nfunction CompleteStudentManagerExample() {\r\n  // Combine multiple hooks for a complete solution\r\n  const [loadingState, loadingActions] = useLoadingState();\r\n  const [modalState, modalActions] = useModalState();\r\n  const [formState, formActions] = useForm({\r\n    initialValues: {\r\n      name: '',\r\n      email: '',\r\n      gradeLevel: '',\r\n      isActive: true,\r\n    },\r\n    validationSchema: {\r\n      name: { required: true, minLength: 2 },\r\n      email: { required: true, pattern: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/ },\r\n      gradeLevel: { required: true },\r\n    },\r\n  });\r\n\r\n  const [refreshState, refreshActions] = useDataRefresh(\r\n    () => fetch('/api/students').then((res) => res.json()),\r\n    {\r\n      interval: 60000, // Refresh every minute\r\n      onSuccess: (students) => {\r\n        loadingActions.finish(students);\r\n      },\r\n    }\r\n  );\r\n\r\n  const handleSubmit = async (values: any) => {\r\n    try {\r\n      await fetch('/api/students', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(values),\r\n      });\r\n\r\n      modalActions.close();\r\n      refreshActions.refresh();\r\n      formActions.resetForm();\r\n    } catch (error) {\r\n      formActions.setError('general', 'Failed to save student');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"header\">\r\n        <h2>Student Management</h2>\r\n        <div>\r\n          <button\r\n            onClick={refreshActions.refresh}\r\n            disabled={refreshState.isRefreshing}\r\n          >\r\n            {refreshState.isRefreshing ? 'Refreshing...' : 'Refresh'}\r\n          </button>\r\n          <button onClick={() => modalActions.open()}>Add Student</button>\r\n        </div>\r\n      </div>\r\n\r\n      {loadingState.error && (\r\n        <div className=\"error\">\r\n          {loadingState.error}\r\n          <button onClick={loadingActions.reset}>Dismiss</button>\r\n        </div>\r\n      )}\r\n\r\n      {loadingState.isLoading ? (\r\n        <div>Loading students...</div>\r\n      ) : (\r\n        <div className=\"student-list\">{/* Render student list */}</div>\r\n      )}\r\n\r\n      <dialog open={modalState.isOpen}>\r\n        <form\r\n          onSubmit={(e) => {\r\n            e.preventDefault();\r\n            handleSubmit(formState.values);\r\n          }}\r\n        >\r\n          <h3>Add New Student</h3>\r\n\r\n          {formState.errors.general && (\r\n            <div className=\"error\">{formState.errors.general}</div>\r\n          )}\r\n\r\n          <div>\r\n            <input\r\n              placeholder=\"Student Name\"\r\n              value={formState.values.name}\r\n              onChange={(e) => formActions.setValue('name', e.target.value)}\r\n              onBlur={() => formActions.setTouched('name')}\r\n            />\r\n            {formState.touched.name && formState.errors.name && (\r\n              <span className=\"error\">{formState.errors.name}</span>\r\n            )}\r\n          </div>\r\n\r\n          <div>\r\n            <input\r\n              type=\"email\"\r\n              placeholder=\"Email\"\r\n              value={formState.values.email}\r\n              onChange={(e) => formActions.setValue('email', e.target.value)}\r\n              onBlur={() => formActions.setTouched('email')}\r\n            />\r\n            {formState.touched.email && formState.errors.email && (\r\n              <span className=\"error\">{formState.errors.email}</span>\r\n            )}\r\n          </div>\r\n\r\n          <div>\r\n            <select\r\n              value={formState.values.gradeLevel}\r\n              onChange={(e) =>\r\n                formActions.setValue('gradeLevel', e.target.value)\r\n              }\r\n              onBlur={() => formActions.setTouched('gradeLevel')}\r\n            >\r\n              <option value=\"\">Select Grade</option>\r\n              <option value=\"9\">Grade 9</option>\r\n              <option value=\"10\">Grade 10</option>\r\n              <option value=\"11\">Grade 11</option>\r\n            </select>\r\n            {formState.touched.gradeLevel && formState.errors.gradeLevel && (\r\n              <span className=\"error\">{formState.errors.gradeLevel}</span>\r\n            )}\r\n          </div>\r\n\r\n          <div>\r\n            <label>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={formState.values.isActive}\r\n                onChange={(e) =>\r\n                  formActions.setValue('isActive', e.target.checked)\r\n                }\r\n              />\r\n              Active Student\r\n            </label>\r\n          </div>\r\n\r\n          <div>\r\n            <button type=\"submit\" disabled={formState.isSubmitting}>\r\n              {formState.isSubmitting ? 'Saving...' : 'Save'}\r\n            </button>\r\n            <button type=\"button\" onClick={modalActions.close}>\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper function\r\nfunction getStudentData() {\r\n  // Return student data for export\r\n  return [];\r\n}\r\n\r\nexport {\r\n  StudentListExample,\r\n  StudentModalExample,\r\n  StudentSearchExample,\r\n  StudentFormExample,\r\n  DashboardExample,\r\n  MultiModalExample,\r\n  ExportExample,\r\n  CompleteStudentManagerExample,\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\api-hooks.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[841,844],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[841,844],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1918,1921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1918,1921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3059,3062],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3059,3062],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3379,3382],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3379,3382],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4104,4107],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4104,4107],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4532,4535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4532,4535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7119,7122],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7119,7122],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7499,7502],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7499,7502],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8428,8431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8428,8431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  automationApi,\r\n  studentsApi,\r\n  equipmentApi,\r\n  analyticsApi,\r\n} from '@/lib/api';\r\nimport { useAppStore } from '@/store/useAppStore';\r\nimport { toast } from 'sonner';\r\nimport { getErrorMessage } from '@/utils/errorHandling';\r\n\r\n// Health check hook\r\nexport const useHealthCheck = () => {\r\n  const setBackendConnection = useAppStore(\r\n    (state) => state.setBackendConnection\r\n  );\r\n\r\n  return useQuery({\r\n    queryKey: ['health'],\r\n    queryFn: async () => {\r\n      try {\r\n        const result = await automationApi.health();\r\n        setBackendConnection(true);\r\n\r\n        // Ensure we return a safe object with timestamp\r\n        if (result.success && result.data) {\r\n          return {\r\n            timestamp:\r\n              (result.data as any).timestamp || new Date().toISOString(),\r\n            connected: true,\r\n          };\r\n        }\r\n\r\n        // If result exists but success is false\r\n        return {\r\n          timestamp: new Date().toISOString(),\r\n          connected: false,\r\n        };\r\n      } catch (error) {\r\n        console.debug('Health check error:', error);\r\n        setBackendConnection(false);\r\n        // Return a safe fallback instead of throwing\r\n        return {\r\n          timestamp: new Date().toISOString(),\r\n          connected: false,\r\n        };\r\n      }\r\n    },\r\n    refetchInterval: 30000, // Check every 30 seconds\r\n    retry: false, // Don't retry to avoid constant errors\r\n    staleTime: 30000, // Consider data fresh for 30 seconds\r\n  });\r\n};\r\n\r\n// Automation hooks\r\nexport const useAutomationJobs = () => {\r\n  const setAutomationJobs = useAppStore((state) => state.setAutomationJobs);\r\n\r\n  const query = useQuery({\r\n    queryKey: ['automation-jobs'],\r\n    queryFn: async () => {\r\n      const response = await automationApi.getJobs();\r\n      const jobs = (response.data || []) as any[];\r\n      setAutomationJobs(jobs);\r\n      return jobs;\r\n    },\r\n    refetchInterval: 10000, // Refresh every 10 seconds\r\n  });\r\n\r\n  return query;\r\n};\r\n\r\nexport const useTriggerJob = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (jobId: string) => automationApi.triggerJob(jobId),\r\n    onSuccess: () => {\r\n      toast.success('Job triggered successfully');\r\n      queryClient.invalidateQueries({ queryKey: ['automation-jobs'] });\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to trigger job'));\r\n    },\r\n  });\r\n};\r\n\r\nexport const useGoogleSheetsTest = () => {\r\n  return useQuery({\r\n    queryKey: ['google-sheets-test'],\r\n    queryFn: automationApi.testGoogleSheets,\r\n    refetchInterval: 60000, // Check every minute\r\n  });\r\n};\r\n\r\n// Students hooks\r\nexport const useStudents = () => {\r\n  const setStudents = useAppStore((state) => state.setStudents);\r\n\r\n  const query = useQuery({\r\n    queryKey: ['students'],\r\n    queryFn: async () => {\r\n      const response = await studentsApi.getStudents();\r\n      const students = (response.data || []) as any[];\r\n      setStudents(students);\r\n      return students;\r\n    },\r\n    enabled: false, // Don't fetch automatically until we have the endpoint\r\n  });\r\n\r\n  return query;\r\n};\r\n\r\nexport const useStudentActivity = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (activityData: any) => studentsApi.logActivity(activityData),\r\n    onSuccess: () => {\r\n      toast.success('Activity logged successfully');\r\n      queryClient.invalidateQueries({ queryKey: ['activities'] });\r\n      queryClient.invalidateQueries({ queryKey: ['dashboard-metrics'] });\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to log activity'));\r\n    },\r\n  });\r\n};\r\n\r\n// Equipment hooks\r\nexport const useEquipment = () => {\r\n  const setEquipment = useAppStore((state) => state.setEquipment);\r\n\r\n  const query = useQuery({\r\n    queryKey: ['equipment'],\r\n    queryFn: async () => {\r\n      const response = await equipmentApi.getEquipment();\r\n      const equipment = (response.data || []) as any[];\r\n      setEquipment(equipment);\r\n      return equipment;\r\n    },\r\n    enabled: false, // Don't fetch automatically until we have the endpoint\r\n    refetchInterval: 5000, // Refresh every 5 seconds for real-time status\r\n  });\r\n\r\n  return query;\r\n};\r\n\r\nexport const useStartSession = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ equipmentId, studentId, timeLimitMinutes }: any) =>\r\n      equipmentApi.startSession(equipmentId, studentId, timeLimitMinutes),\r\n    onSuccess: () => {\r\n      toast.success('Session started successfully');\r\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\r\n      queryClient.invalidateQueries({ queryKey: ['activities'] });\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to start session'));\r\n    },\r\n  });\r\n};\r\n\r\nexport const useEndSession = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: (sessionId: string) => equipmentApi.endSession(sessionId),\r\n    onSuccess: () => {\r\n      toast.success('Session ended successfully');\r\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\r\n      queryClient.invalidateQueries({ queryKey: ['activities'] });\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to end session'));\r\n    },\r\n  });\r\n};\r\n\r\n// Analytics hooks\r\nexport const useDashboardMetrics = () => {\r\n  return useQuery({\r\n    queryKey: ['dashboard-metrics'],\r\n    queryFn: async () => {\r\n      try {\r\n        const response = await analyticsApi.getMetrics();\r\n        return response.data;\r\n      } catch (error) {\r\n        // Return real data structure initialized to 0\r\n        return {\r\n          totalStudents: 0,\r\n          activeSessions: 0,\r\n          pendingTasks: 0,\r\n          equipmentInUse: 0,\r\n          availableComputers: 8,\r\n          availableGamingStations: 4,\r\n          availableAVR: 1,\r\n          todayActivities: 0,\r\n          weeklyActivities: 0,\r\n          monthlyActivities: 0,\r\n          overdueBooks: 0,\r\n          dueSoonBooks: 0,\r\n          returnedBooks: 0,\r\n        };\r\n      }\r\n    },\r\n    enabled: true, // Enable fetching when ready\r\n    refetchInterval: 30000, // Refresh every 30 seconds\r\n    retry: false,\r\n  });\r\n};\r\n\r\nexport const useUsageStats = (period: 'day' | 'week' | 'month' = 'day') => {\r\n  return useQuery({\r\n    queryKey: ['usage-stats', period],\r\n    queryFn: async () => {\r\n      const response = await analyticsApi.getUsageStats(period);\r\n      return response.data;\r\n    },\r\n    enabled: false, // Don't fetch automatically until we have the endpoint\r\n  });\r\n};\r\n\r\nexport const useActivityTimeline = (limit?: number) => {\r\n  const setActivities = useAppStore((state) => state.setActivities);\r\n\r\n  return useQuery({\r\n    queryKey: ['activity-timeline', limit],\r\n    queryFn: async () => {\r\n      try {\r\n        const response = await analyticsApi.getTimeline(limit);\r\n        const rawTimeline = response.data as any;\r\n        const activities = Array.isArray(rawTimeline?.timeline)\r\n          ? rawTimeline.timeline\r\n          : Array.isArray(rawTimeline)\r\n            ? rawTimeline\r\n            : [];\r\n        setActivities(activities);\r\n        return activities;\r\n      } catch (error) {\r\n        // Return real data structure initialized to empty array\r\n        const fallbackActivities: any[] = [];\r\n        setActivities(fallbackActivities);\r\n        return fallbackActivities;\r\n      }\r\n    },\r\n    enabled: false, // Disable until endpoint exists\r\n    refetchInterval: false,\r\n    retry: false,\r\n  });\r\n};\r\n\r\n// Notifications hook for calendar integration\r\nexport const useNotifications = () => {\r\n  return useQuery({\r\n    queryKey: ['notifications'],\r\n    queryFn: async () => {\r\n      try {\r\n        const response = await analyticsApi.getNotifications();\r\n        return response.data || [];\r\n      } catch (error) {\r\n        // Return real data structure initialized to empty array\r\n        return [];\r\n      }\r\n    },\r\n    enabled: false, // Disable until endpoint exists\r\n    refetchInterval: false,\r\n    retry: false,\r\n  });\r\n};\r\n\r\nexport const useExportData = () => {\r\n  return useMutation({\r\n    mutationFn: ({\r\n      format,\r\n      dateRange,\r\n    }: {\r\n      format: 'csv' | 'json';\r\n      dateRange?: any;\r\n    }) => analyticsApi.exportData(format, dateRange),\r\n    onSuccess: (response, variables) => {\r\n      toast.success('Data exported successfully');\r\n      // Handle file download if needed\r\n      if (response.data) {\r\n        // Create download link\r\n        const blob = new Blob([JSON.stringify(response.data, null, 2)], {\r\n          type: variables.format === 'csv' ? 'text/csv' : 'application/json',\r\n        });\r\n        const url = window.URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `clms-export.${variables.format}`;\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n      }\r\n    },\r\n    onError: (error: unknown) => {\r\n      toast.error(getErrorMessage(error, 'Failed to export data'));\r\n    },\r\n  });\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\perf_hooks.ts","messages":[{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":12,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":12,"endColumn":65,"suggestions":[{"fix":{"range":[243,299],"text":"window?.performance?.now"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":19,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":19,"endColumn":66,"suggestions":[{"fix":{"range":[426,483],"text":"window?.performance?.mark"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":25,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":25,"endColumn":69,"suggestions":[{"fix":{"range":[624,684],"text":"window?.performance?.measure"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":31,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":31,"endColumn":78,"suggestions":[{"fix":{"range":[849,918],"text":"window?.performance?.getEntriesByName"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":38,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":38,"endColumn":78,"suggestions":[{"fix":{"range":[1086,1155],"text":"window?.performance?.getEntriesByType"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":63,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":63,"endColumn":68,"suggestions":[{"fix":{"range":[1739,1798],"text":"window?.PerformanceObserver"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1840,1843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1840,1843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2858,2861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2858,2861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'startTime'. Either include it or remove the dependency array.","line":107,"column":6,"nodeType":"ArrayExpression","endLine":107,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [componentName, startTime]","fix":{"range":[3043,3058],"text":"[componentName, startTime]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect contains a call to 'setCount'. Without a list of dependencies, this can lead to an infinite chain of updates. To fix this, pass [componentName, count] as a second argument to the useEffect Hook.","line":116,"column":3,"nodeType":"Identifier","endLine":116,"endColumn":12,"suggestions":[{"desc":"Add dependencies array: [componentName, count]","fix":{"range":[3346,3346],"text":", [componentName, count]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":175,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":175,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4645,4648],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4645,4648],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4706,4709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4706,4709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":192,"column":5,"nodeType":null,"messageId":"preferOptionalChain","endLine":192,"endColumn":64,"suggestions":[{"fix":{"range":[5120,5179],"text":"window?.performance?.timing"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":198,"column":7,"nodeType":null,"messageId":"preferOptionalChain","endLine":198,"endColumn":76,"suggestions":[{"fix":{"range":[5349,5418],"text":"window?.performance?.getEntriesByType"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":208,"column":7,"nodeType":null,"messageId":"preferOptionalChain","endLine":208,"endColumn":76,"suggestions":[{"fix":{"range":[5672,5741],"text":"window?.performance?.getEntriesByType"},"messageId":"optionalChainSuggest","desc":"Change to an optional chain."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6210,6213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6210,6213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":237,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":237,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6605,6608],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6605,6608],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9810,9813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9810,9813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\n/**\r\n * Performance Hooks\r\n *\r\n * Browser-compatible performance API for React components\r\n */\r\n\r\n// Performance API with fallbacks\r\nexport const performance = {\r\n  now: (): number => {\r\n    if (typeof window !== 'undefined' && window.performance?.now) {\r\n      return window.performance.now();\r\n    }\r\n    return Date.now();\r\n  },\r\n\r\n  mark: (name: string): void => {\r\n    if (typeof window !== 'undefined' && window.performance?.mark) {\r\n      window.performance.mark(name);\r\n    }\r\n  },\r\n\r\n  measure: (name: string, startMark: string, endMark?: string): void => {\r\n    if (typeof window !== 'undefined' && window.performance?.measure) {\r\n      window.performance.measure(name, startMark, endMark);\r\n    }\r\n  },\r\n\r\n  getEntriesByName: (name: string, type?: string): PerformanceEntry[] => {\r\n    if (typeof window !== 'undefined' && window.performance?.getEntriesByName) {\r\n      return window.performance.getEntriesByName(name, type);\r\n    }\r\n    return [];\r\n  },\r\n\r\n  getEntriesByType: (type: string): PerformanceEntry[] => {\r\n    if (typeof window !== 'undefined' && window.performance?.getEntriesByType) {\r\n      return window.performance.getEntriesByType(type);\r\n    }\r\n    return [];\r\n  },\r\n};\r\n\r\n// Performance observer for monitoring\r\nexport class PerformanceObserver {\r\n  private callback: (\r\n    entries: PerformanceObserverEntryList,\r\n    observer: PerformanceObserver\r\n  ) => void;\r\n  private observer: PerformanceObserver | null = null;\r\n\r\n  constructor(\r\n    callback: (\r\n      entries: PerformanceObserverEntryList,\r\n      observer: PerformanceObserver\r\n    ) => void\r\n  ) {\r\n    this.callback = callback;\r\n  }\r\n\r\n  observe(options: PerformanceObserverInit): void {\r\n    if (typeof window !== 'undefined' && window.PerformanceObserver) {\r\n      this.observer = new (window as any).PerformanceObserver(\r\n        this.callback\r\n      ) as PerformanceObserver;\r\n      this.observer?.observe(options);\r\n    }\r\n  }\r\n\r\n  disconnect(): void {\r\n    if (this.observer) {\r\n      this.observer.disconnect();\r\n      this.observer = null;\r\n    }\r\n  }\r\n}\r\n\r\n// React hook for performance monitoring\r\nexport function usePerformanceMonitor(componentName: string) {\r\n  const [metrics, setMetrics] = useState<Record<string, number>>({});\r\n  const startTime = performance.now();\r\n\r\n  useEffect(() => {\r\n    const endTime = performance.now();\r\n    const renderTime = endTime - startTime;\r\n\r\n    setMetrics((prev) => ({\r\n      ...prev,\r\n      [`${componentName}_render`]: renderTime,\r\n    }));\r\n\r\n    performance.mark(`${componentName}_render_end`);\r\n    performance.measure(\r\n      `${componentName}_render`,\r\n      `${componentName}_render_start`,\r\n      `${componentName}_render_end`\r\n    );\r\n\r\n    return () => {\r\n      // Type cast to access non-standard performance methods\r\n      const perf = performance as any;\r\n      perf.clearMarks(`${componentName}_render_start`);\r\n      perf.clearMarks(`${componentName}_render_end`);\r\n      perf.clearMeasures(`${componentName}_render`);\r\n    };\r\n  }, [componentName]);\r\n\r\n  return metrics;\r\n}\r\n\r\n// Custom performance hooks\r\nexport function useRenderCount(componentName: string) {\r\n  const [count, setCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    setCount((prev) => prev + 1);\r\n    performance.mark(`${componentName}_render_count_${count + 1}`);\r\n  });\r\n\r\n  return count;\r\n}\r\n\r\nexport function useRenderTime(_componentName: string) {\r\n  const [renderTime, setRenderTime] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const start = performance.now();\r\n    return () => {\r\n      const end = performance.now();\r\n      setRenderTime(end - start);\r\n    };\r\n  });\r\n\r\n  return renderTime;\r\n}\r\n\r\n// Types\r\nexport interface PerformanceEntry {\r\n  name: string;\r\n  entryType: string;\r\n  startTime: number;\r\n  duration: number;\r\n}\r\n\r\nexport interface PerformanceObserverCallback {\r\n  (entries: PerformanceObserverEntryList, observer: PerformanceObserver): void;\r\n}\r\n\r\nexport interface PerformanceObserverInit {\r\n  entryTypes: string[];\r\n  buffered?: boolean;\r\n}\r\n\r\nexport interface PerformanceObserverEntryList {\r\n  getEntries(): PerformanceEntry[];\r\n  getEntriesByName(name: string, type?: string): PerformanceEntry[];\r\n  getEntriesByType(type: string): PerformanceEntry[];\r\n}\r\n\r\nexport interface IPerformanceObserver {\r\n  observe(options: PerformanceObserverInit): void;\r\n  disconnect(): void;\r\n  takeRecords(): PerformanceObserverEntryList;\r\n}\r\n\r\n// Memory API with fallbacks\r\nexport const memory = {\r\n  usedJSHeapSize: 0,\r\n  totalJSHeapSize: 0,\r\n  jsHeapSizeLimit: 0,\r\n};\r\n\r\n// Update memory stats if available\r\nif (typeof window !== 'undefined' && (window as any).performance?.memory) {\r\n  const perfMemory = (window as any).performance.memory;\r\n  Object.assign(memory, {\r\n    usedJSHeapSize: perfMemory.usedJSHeapSize || 0,\r\n    totalJSHeapSize: perfMemory.totalJSHeapSize || 0,\r\n    jsHeapSizeLimit: perfMemory.jsHeapSizeLimit || 0,\r\n  });\r\n}\r\n\r\n// Timing API with fallbacks\r\nexport const timing = {\r\n  navigationStart: Date.now(),\r\n  loadEventEnd: 0,\r\n  domContentLoadedEventEnd: 0,\r\n};\r\n\r\n// Update timing stats if available\r\nif (typeof window !== 'undefined' && window.performance?.timing) {\r\n  Object.assign(timing, window.performance.timing);\r\n}\r\n\r\n// Resource timing utilities\r\nexport const getResourceTiming = (): PerformanceResourceTiming[] => {\r\n  if (typeof window !== 'undefined' && window.performance?.getEntriesByType) {\r\n    return window.performance.getEntriesByType(\r\n      'resource'\r\n    ) as PerformanceResourceTiming[];\r\n  }\r\n  return [];\r\n};\r\n\r\n// Navigation timing utilities\r\nexport const getNavigationTiming = (): PerformanceNavigationTiming | null => {\r\n  if (typeof window !== 'undefined' && window.performance?.getEntriesByType) {\r\n    const entries = window.performance.getEntriesByType('navigation');\r\n    return entries.length > 0\r\n      ? (entries[0] as PerformanceNavigationTiming)\r\n      : null;\r\n  }\r\n  return null;\r\n};\r\n\r\n// Performance metrics calculation\r\nexport const calculateMetrics = {\r\n  // Calculate page load time\r\n  pageLoadTime: (): number => {\r\n    const navTiming = getNavigationTiming();\r\n    if (navTiming) {\r\n      return (\r\n        navTiming.loadEventEnd - (navTiming as any).navigationStart ||\r\n        navTiming.loadEventEnd - navTiming.startTime\r\n      );\r\n    }\r\n    return timing.loadEventEnd - timing.navigationStart;\r\n  },\r\n\r\n  // Calculate DOM content load time\r\n  domContentLoadedTime: (): number => {\r\n    const navTiming = getNavigationTiming();\r\n    if (navTiming) {\r\n      return (\r\n        navTiming.domContentLoadedEventEnd -\r\n          (navTiming as any).navigationStart ||\r\n        navTiming.domContentLoadedEventEnd - navTiming.startTime\r\n      );\r\n    }\r\n    return timing.domContentLoadedEventEnd - timing.navigationStart;\r\n  },\r\n\r\n  // Calculate first paint time\r\n  firstPaintTime: (): number => {\r\n    const paintEntries =\r\n      (typeof window !== 'undefined'\r\n        ? window.performance?.getEntriesByType('paint')\r\n        : undefined) || [];\r\n    const firstPaint = paintEntries.find(\r\n      (entry) => entry.name === 'first-paint'\r\n    );\r\n    return firstPaint ? firstPaint.startTime : 0;\r\n  },\r\n\r\n  // Calculate first contentful paint time\r\n  firstContentfulPaintTime: (): number => {\r\n    const paintEntries =\r\n      (typeof window !== 'undefined'\r\n        ? window.performance?.getEntriesByType('paint')\r\n        : undefined) || [];\r\n    const firstContentfulPaint = paintEntries.find(\r\n      (entry) => entry.name === 'first-contentful-paint'\r\n    );\r\n    return firstContentfulPaint ? firstContentfulPaint.startTime : 0;\r\n  },\r\n\r\n  // Calculate resource load time\r\n  resourceLoadTime: (url: string): number => {\r\n    const resources = getResourceTiming();\r\n    const resource = resources.find((r) => r.name === url);\r\n    return resource ? resource.responseEnd - resource.requestStart : 0;\r\n  },\r\n\r\n  // Calculate total resource load time\r\n  totalResourceLoadTime: (): number => {\r\n    const resources = getResourceTiming();\r\n    return resources.reduce((total, resource) => {\r\n      return total + (resource.responseEnd - resource.requestStart);\r\n    }, 0);\r\n  },\r\n};\r\n\r\n// Performance monitoring utilities\r\nexport const performanceUtils = {\r\n  // Mark performance points\r\n  mark: (name: string): void => {\r\n    performance.mark(name);\r\n  },\r\n\r\n  // Measure performance between marks\r\n  measure: (name: string, startMark: string, endMark?: string): number => {\r\n    performance.measure(name, startMark, endMark);\r\n    const entries = performance.getEntriesByName(name, 'measure');\r\n    const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n    return lastEntry?.duration || 0;\r\n  },\r\n\r\n  // Get memory usage\r\n  getMemoryUsage: () => ({\r\n    used: memory.usedJSHeapSize,\r\n    total: memory.totalJSHeapSize,\r\n    limit: memory.jsHeapSizeLimit,\r\n    percentage: (memory.usedJSHeapSize / memory.jsHeapSizeLimit) * 100,\r\n  }),\r\n\r\n  // Get resource timing summary\r\n  getResourceTimingSummary: () => {\r\n    const resources = getResourceTiming();\r\n    const summary = {\r\n      count: resources.length,\r\n      totalSize: 0,\r\n      totalTransferSize: 0,\r\n      totalTime: 0,\r\n      averageTime: 0,\r\n      slowestResource: null as PerformanceResourceTiming | null,\r\n      fastestResource: null as PerformanceResourceTiming | null,\r\n    };\r\n\r\n    if (resources.length === 0) {\r\n      return summary;\r\n    }\r\n\r\n    let totalSize = 0;\r\n    let totalTransferSize = 0;\r\n    let totalTime = 0;\r\n    let slowestTime = 0;\r\n    let fastestTime = Infinity;\r\n    let slowestResource: PerformanceResourceTiming | null = null;\r\n    let fastestResource: PerformanceResourceTiming | null = null;\r\n\r\n    resources.forEach((resource) => {\r\n      const loadTime = resource.responseEnd - resource.requestStart;\r\n      totalSize += (resource as any).decodedBodySize || 0;\r\n      totalTransferSize += resource.transferSize || 0;\r\n      totalTime += loadTime;\r\n\r\n      if (loadTime > slowestTime) {\r\n        slowestTime = loadTime;\r\n        slowestResource = resource;\r\n      }\r\n\r\n      if (loadTime < fastestTime) {\r\n        fastestTime = loadTime;\r\n        fastestResource = resource;\r\n      }\r\n    });\r\n\r\n    return {\r\n      ...summary,\r\n      totalSize,\r\n      totalTransferSize,\r\n      totalTime,\r\n      averageTime: totalTime / resources.length,\r\n      slowestResource,\r\n      fastestResource,\r\n    };\r\n  },\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useActionState.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":7,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[192,195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[192,195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[293,296],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[293,296],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[375,378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[375,378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[670,673],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[670,673],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[699,702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[699,702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1710,1713],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1710,1713],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1738,1741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1738,1741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2370,2373],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2370,2373],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'reset'. Either include it or remove the dependency array.","line":159,"column":5,"nodeType":"ArrayExpression","endLine":159,"endColumn":70,"suggestions":[{"desc":"Update the dependencies array to be: [autoReset, resetDelay, actionFn, onProgress, onSuccess, onError, reset]","fix":{"range":[4118,4183],"text":"[autoReset, resetDelay, actionFn, onProgress, onSuccess, onError, reset]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":265,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6585,6588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6585,6588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":268,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6723,6726],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6723,6726],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'controllersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'controllersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":311,"column":22,"nodeType":"Identifier","endLine":311,"endColumn":29},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'autoResetTimersRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'autoResetTimersRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":312,"column":26,"nodeType":"Identifier","endLine":312,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":387,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":387,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10108,10111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10108,10111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":438,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":438,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11548,11551],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11548,11551],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":538,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":538,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14352,14355],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14352,14355],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":542,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":542,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14573,14576],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14573,14576],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":559,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":559,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14958,14961],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14958,14961],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":601,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":601,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16242,16245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16242,16245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":603,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":603,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16283,16286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16283,16286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":611,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":611,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16554,16557],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16554,16557],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":629,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":629,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16925,16928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16925,16928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":645,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":645,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17323,17326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17323,17326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":658,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":658,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17653,17656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17653,17656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":691,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":691,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18577,18580],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18577,18580],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has unnecessary dependencies: 'itemDelay', 'onItemComplete', and 'processItem'. Either exclude them or remove the dependency array.","line":719,"column":5,"nodeType":"ArrayExpression","endLine":727,"endColumn":6,"suggestions":[{"desc":"Update the dependencies array to be: [onSuccess, onError, onProgress, batchFn]","fix":{"range":[19348,19486],"text":"[onSuccess, onError, onProgress, batchFn]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":26,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef, useEffect, useMemo } from 'react';\r\nimport { toast } from 'sonner';\r\n\r\ninterface ActionState {\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  data: any;\r\n  progress: number;\r\n  isCancelled: boolean;\r\n}\r\n\r\ninterface ActionActions {\r\n  start: (data?: any) => void;\r\n  updateProgress: (progress: number) => void;\r\n  complete: (data?: any) => void;\r\n  error: (error: string) => void;\r\n  cancel: () => void;\r\n  reset: () => void;\r\n}\r\n\r\nconst createDefaultActionState = (): ActionState => ({\r\n  isLoading: false,\r\n  error: null,\r\n  data: null,\r\n  progress: 0,\r\n  isCancelled: false,\r\n});\r\n\r\ninterface MultipleActionConfig<TResult = any> {\r\n  actionFn: (params: any) => Promise<TResult>;\r\n  onSuccess?: (data: TResult) => void;\r\n  onError?: (error: Error | string) => void;\r\n  onProgress?: (progress: number) => void;\r\n  autoReset?: boolean;\r\n  resetDelay?: number;\r\n}\r\n\r\n/**\r\n * Hook for managing action states (export, download, bulk operations, etc.)\r\n *\r\n * @param actionFn - Function that performs the action\r\n * @param options - Configuration options for the action\r\n * @returns [state, actions] - Current state and action methods\r\n *\r\n * @example\r\n * const [state, actions] = useActionState(\r\n *   async ({ format, data }) => {\r\n *     // Perform export operation\r\n *     const blob = await exportData(format, data);\r\n *     return blob;\r\n *   },\r\n *   {\r\n *     onSuccess: (blob) => {\r\n *       // Handle successful export\r\n *       downloadFile(blob, `export.${format}`);\r\n *     },\r\n *   }\r\n * );\r\n *\r\n * // Execute action\r\n * const handleExport = () => {\r\n *   actions.start({ format: 'csv', data: studentData });\r\n * };\r\n */\r\nexport function useActionState<T = any>(\r\n  actionFn: (params: any) => Promise<T>,\r\n  options: {\r\n    onSuccess?: (data: T) => void;\r\n    onError?: (error: Error | string) => void;\r\n    onProgress?: (progress: number) => void;\r\n    autoReset?: boolean;\r\n    resetDelay?: number;\r\n  } = {}\r\n) {\r\n  const {\r\n    onSuccess,\r\n    onError,\r\n    onProgress,\r\n    autoReset = true,\r\n    resetDelay = 2000,\r\n  } = options;\r\n\r\n  const [state, setState] = useState<ActionState>({\r\n    isLoading: false,\r\n    error: null,\r\n    data: null,\r\n    progress: 0,\r\n    isCancelled: false,\r\n  });\r\n\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  const start = useCallback(\r\n    (params?: any) => {\r\n      // Cancel any ongoing action\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n\r\n      // Create new abort controller\r\n      abortControllerRef.current = new AbortController();\r\n\r\n      setState({\r\n        isLoading: true,\r\n        error: null,\r\n        data: null,\r\n        progress: 0,\r\n        isCancelled: false,\r\n      });\r\n\r\n      // Execute action\r\n      const executeAction = async () => {\r\n        try {\r\n          const result = await actionFn({\r\n            ...params,\r\n            signal: abortControllerRef.current?.signal,\r\n            onProgress: (progress: number) => {\r\n              setState((prev) => ({ ...prev, progress }));\r\n              onProgress?.(progress);\r\n            },\r\n          });\r\n\r\n          if (!abortControllerRef.current?.signal.aborted) {\r\n            setState((prev) => ({\r\n              ...prev,\r\n              isLoading: false,\r\n              data: result,\r\n              progress: 100,\r\n            }));\r\n\r\n            onSuccess?.(result);\r\n          }\r\n        } catch (error) {\r\n          if (!abortControllerRef.current?.signal.aborted) {\r\n            const errorMessage =\r\n              error instanceof Error ? error.message : 'Action failed';\r\n\r\n            setState((prev) => ({\r\n              ...prev,\r\n              isLoading: false,\r\n              error: errorMessage,\r\n              progress: 0,\r\n            }));\r\n\r\n            onError?.(error instanceof Error ? error : new Error(errorMessage));\r\n          }\r\n        }\r\n      };\r\n\r\n      executeAction();\r\n\r\n      // Auto reset if enabled\r\n      if (autoReset && resetDelay > 0) {\r\n        setTimeout(() => {\r\n          reset();\r\n        }, resetDelay);\r\n      }\r\n    },\r\n    [actionFn, onSuccess, onError, onProgress, autoReset, resetDelay]\r\n  );\r\n\r\n  const updateProgress = useCallback((progress: number) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      progress: Math.max(0, Math.min(100, progress)),\r\n    }));\r\n  }, []);\r\n\r\n  const complete = useCallback(\r\n    (data?: T) => {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isLoading: false,\r\n        data: data ?? prev.data,\r\n        progress: 100,\r\n        error: null,\r\n      }));\r\n\r\n      if (data !== undefined) {\r\n        onSuccess?.(data);\r\n      }\r\n    },\r\n    [onSuccess]\r\n  );\r\n\r\n  const error = useCallback(\r\n    (errorMessage: string) => {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isLoading: false,\r\n        error: errorMessage,\r\n        progress: 0,\r\n      }));\r\n\r\n      onError?.(errorMessage);\r\n    },\r\n    [onError]\r\n  );\r\n\r\n  const cancel = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isLoading: false,\r\n      isCancelled: true,\r\n      progress: 0,\r\n    }));\r\n\r\n    toast.info('Action cancelled');\r\n  }, []);\r\n\r\n  const reset = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n\r\n    setState({\r\n      isLoading: false,\r\n      error: null,\r\n      data: null,\r\n      progress: 0,\r\n      isCancelled: false,\r\n    });\r\n  }, []);\r\n\r\n  const actionHandlers: ActionActions = {\r\n    start,\r\n    updateProgress,\r\n    complete,\r\n    error,\r\n    cancel,\r\n    reset,\r\n  };\r\n\r\n  return [state, actionHandlers] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing multiple action states\r\n *\r\n * @param actions - Object mapping action names to their configurations\r\n * @returns [states, actions] - States and actions for all operations\r\n *\r\n * @example\r\n * const [states, actions] = useMultipleActions({\r\n *   exportCSV: {\r\n *     actionFn: (params) => exportToCSV(params.data),\r\n *     onSuccess: (blob) => downloadFile(blob, 'export.csv'),\r\n *   },\r\n *   exportPDF: {\r\n *     actionFn: (params) => exportToPDF(params.data),\r\n *     onSuccess: (blob) => downloadFile(blob, 'export.pdf'),\r\n *   },\r\n *   deleteSelected: {\r\n *     actionFn: (params) => deleteItems(params.ids),\r\n *     onSuccess: () => toast.success('Items deleted'),\r\n *   },\r\n * });\r\n */\r\nexport function useMultipleActions<\r\n  TConfig extends Record<string, MultipleActionConfig<any>>,\r\n>(actions: TConfig) {\r\n  const actionEntries = useMemo(\r\n    () => Object.entries(actions) as Array<[string, MultipleActionConfig<any>]>,\r\n    [actions]\r\n  );\r\n\r\n  const actionKeys = useMemo(\r\n    () => actionEntries.map(([key]) => key),\r\n    [actionEntries]\r\n  );\r\n\r\n  const [states, setStates] = useState<Record<string, ActionState>>(() => {\r\n    const initialStates: Record<string, ActionState> = {};\r\n    actionKeys.forEach((key) => {\r\n      initialStates[key] = createDefaultActionState();\r\n    });\r\n    return initialStates;\r\n  });\r\n\r\n  useEffect(() => {\r\n    setStates((prev) => {\r\n      const next: Record<string, ActionState> = {};\r\n      actionKeys.forEach((key) => {\r\n        next[key] = prev[key] ?? createDefaultActionState();\r\n      });\r\n      return next;\r\n    });\r\n  }, [actionKeys]);\r\n\r\n  const actionsRef = useRef(actions);\r\n  useEffect(() => {\r\n    actionsRef.current = actions;\r\n  }, [actions]);\r\n\r\n  const controllersRef = useRef(new Map<string, AbortController>());\r\n  const autoResetTimersRef = useRef(\r\n    new Map<string, ReturnType<typeof setTimeout>>()\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      controllersRef.current.forEach((controller) => controller.abort());\r\n      autoResetTimersRef.current.forEach((timeoutId) =>\r\n        clearTimeout(timeoutId)\r\n      );\r\n      controllersRef.current.clear();\r\n      autoResetTimersRef.current.clear();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const validKeys = new Set(actionKeys);\r\n    controllersRef.current.forEach((controller, key) => {\r\n      if (!validKeys.has(key)) {\r\n        controller.abort();\r\n        controllersRef.current.delete(key);\r\n      }\r\n    });\r\n    autoResetTimersRef.current.forEach((timeoutId, key) => {\r\n      if (!validKeys.has(key)) {\r\n        clearTimeout(timeoutId);\r\n        autoResetTimersRef.current.delete(key);\r\n      }\r\n    });\r\n  }, [actionKeys]);\r\n\r\n  const updateActionState = useCallback(\r\n    (actionKey: string, updater: (current: ActionState) => ActionState) => {\r\n      setStates((prev) => {\r\n        const current = prev[actionKey] ?? createDefaultActionState();\r\n        return {\r\n          ...prev,\r\n          [actionKey]: updater(current),\r\n        };\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const clearAutoResetTimeout = useCallback((actionKey: string) => {\r\n    const timeout = autoResetTimersRef.current.get(actionKey);\r\n    if (timeout) {\r\n      clearTimeout(timeout);\r\n      autoResetTimersRef.current.delete(actionKey);\r\n    }\r\n  }, []);\r\n\r\n  const resetAction = useCallback(\r\n    (actionKey: string) => {\r\n      clearAutoResetTimeout(actionKey);\r\n      const controller = controllersRef.current.get(actionKey);\r\n      if (controller) {\r\n        controller.abort();\r\n        controllersRef.current.delete(actionKey);\r\n      }\r\n      setStates((prev) => ({\r\n        ...prev,\r\n        [actionKey]: createDefaultActionState(),\r\n      }));\r\n    },\r\n    [clearAutoResetTimeout]\r\n  );\r\n\r\n  const resetAll = useCallback(() => {\r\n    actionKeys.forEach((key) => resetAction(key));\r\n  }, [actionKeys, resetAction]);\r\n\r\n  const updateProgress = useCallback(\r\n    (actionKey: string, progress: number) => {\r\n      const clamped = Math.max(0, Math.min(100, progress));\r\n      updateActionState(actionKey, (current) => ({\r\n        ...current,\r\n        progress: clamped,\r\n      }));\r\n      const config = actionsRef.current[actionKey];\r\n      config?.onProgress?.(clamped);\r\n    },\r\n    [updateActionState]\r\n  );\r\n\r\n  const completeAction = useCallback(\r\n    (actionKey: string, data?: any) => {\r\n      updateActionState(actionKey, (current) => ({\r\n        ...current,\r\n        isLoading: false,\r\n        data: data ?? current.data,\r\n        error: null,\r\n        progress: 100,\r\n        isCancelled: false,\r\n      }));\r\n      if (data !== undefined) {\r\n        const config = actionsRef.current[actionKey];\r\n        config?.onSuccess?.(data);\r\n      }\r\n    },\r\n    [updateActionState]\r\n  );\r\n\r\n  const failAction = useCallback(\r\n    (actionKey: string, errorValue: Error | string) => {\r\n      const message =\r\n        errorValue instanceof Error ? errorValue.message : errorValue;\r\n      updateActionState(actionKey, (current) => ({\r\n        ...current,\r\n        isLoading: false,\r\n        error: message,\r\n        progress: 0,\r\n      }));\r\n      const config = actionsRef.current[actionKey];\r\n      config?.onError?.(errorValue);\r\n    },\r\n    [updateActionState]\r\n  );\r\n\r\n  const scheduleAutoReset = useCallback(\r\n    (actionKey: string, delay: number) => {\r\n      if (delay <= 0) {\r\n        resetAction(actionKey);\r\n        return;\r\n      }\r\n\r\n      clearAutoResetTimeout(actionKey);\r\n      const timeoutId = setTimeout(() => {\r\n        autoResetTimersRef.current.delete(actionKey);\r\n        resetAction(actionKey);\r\n      }, delay);\r\n      autoResetTimersRef.current.set(actionKey, timeoutId);\r\n    },\r\n    [clearAutoResetTimeout, resetAction]\r\n  );\r\n\r\n  const startAction = useCallback(\r\n    (actionKey: string, params?: any) => {\r\n      const config = actionsRef.current[actionKey];\r\n      if (!config) {\r\n        console.warn(`Action \"${actionKey}\" not found in useMultipleActions`);\r\n        return;\r\n      }\r\n\r\n      clearAutoResetTimeout(actionKey);\r\n      const existingController = controllersRef.current.get(actionKey);\r\n      if (existingController) {\r\n        existingController.abort();\r\n      }\r\n\r\n      const controller = new AbortController();\r\n      controllersRef.current.set(actionKey, controller);\r\n\r\n      updateActionState(actionKey, () => ({\r\n        isLoading: true,\r\n        error: null,\r\n        data: null,\r\n        progress: 0,\r\n        isCancelled: false,\r\n      }));\r\n\r\n      const shouldAutoReset = config.autoReset ?? true;\r\n      const autoResetDelay = config.resetDelay ?? 2000;\r\n\r\n      const execute = async () => {\r\n        try {\r\n          const result = await config.actionFn({\r\n            ...(params ?? {}),\r\n            signal: controller.signal,\r\n            onProgress: (progress: number) => {\r\n              updateProgress(actionKey, progress);\r\n            },\r\n          });\r\n\r\n          if (!controller.signal.aborted) {\r\n            completeAction(actionKey, result);\r\n            if (shouldAutoReset) {\r\n              scheduleAutoReset(actionKey, autoResetDelay);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          if (controller.signal.aborted) {\r\n            return;\r\n          }\r\n\r\n          const normalisedError =\r\n            error instanceof Error ? error : new Error('Action failed');\r\n\r\n          failAction(actionKey, normalisedError);\r\n          if (shouldAutoReset) {\r\n            scheduleAutoReset(actionKey, autoResetDelay);\r\n          }\r\n        }\r\n      };\r\n\r\n      void execute();\r\n    },\r\n    [\r\n      clearAutoResetTimeout,\r\n      updateActionState,\r\n      updateProgress,\r\n      completeAction,\r\n      failAction,\r\n      scheduleAutoReset,\r\n    ]\r\n  );\r\n\r\n  const cancelAction = useCallback(\r\n    (actionKey: string) => {\r\n      const controller = controllersRef.current.get(actionKey);\r\n      if (controller) {\r\n        controller.abort();\r\n        controllersRef.current.delete(actionKey);\r\n      }\r\n\r\n      clearAutoResetTimeout(actionKey);\r\n\r\n      updateActionState(actionKey, (current) => ({\r\n        ...current,\r\n        isLoading: false,\r\n        isCancelled: true,\r\n        progress: 0,\r\n      }));\r\n\r\n      toast.info(`Action ${actionKey} cancelled`);\r\n    },\r\n    [clearAutoResetTimeout, updateActionState]\r\n  );\r\n\r\n  const cancelAll = useCallback(() => {\r\n    actionKeys.forEach((key) => cancelAction(key));\r\n  }, [actionKeys, cancelAction]);\r\n\r\n  const actionsRegistry = useMemo(() => {\r\n    const registry: Record<string, ActionActions> = {};\r\n    actionKeys.forEach((key) => {\r\n      registry[key] = {\r\n        start: (params?: any) => startAction(key, params),\r\n        cancel: () => cancelAction(key),\r\n        reset: () => resetAction(key),\r\n        updateProgress: (progress: number) => updateProgress(key, progress),\r\n        complete: (data?: any) => completeAction(key, data),\r\n        error: (message: string) => failAction(key, message),\r\n      };\r\n    });\r\n    return registry;\r\n  }, [\r\n    actionKeys,\r\n    startAction,\r\n    cancelAction,\r\n    resetAction,\r\n    updateProgress,\r\n    completeAction,\r\n    failAction,\r\n  ]);\r\n\r\n  const globalActions = useMemo(\r\n    () => ({\r\n      startAction: (key: keyof TConfig, params?: any) =>\r\n        startAction(String(key), params),\r\n      cancelAction: (key: keyof TConfig) => cancelAction(String(key)),\r\n      cancelAll,\r\n      resetAction: (key: keyof TConfig) => resetAction(String(key)),\r\n      resetAll,\r\n    }),\r\n    [startAction, cancelAction, cancelAll, resetAction, resetAll]\r\n  );\r\n\r\n  return [\r\n    states as Record<keyof TConfig, ActionState>,\r\n    {\r\n      ...(actionsRegistry as Record<keyof TConfig, ActionActions>),\r\n      ...globalActions,\r\n    },\r\n  ] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing batch operations with progress tracking\r\n *\r\n * @param batchFn - Function that performs batch operations\r\n * @param options - Configuration for batch operations\r\n * @returns [state, actions] - State with batch progress and control actions\r\n *\r\n * @example\r\n * const [state, actions] = useBatchOperation(\r\n *   async ({ items, onProgress }) => {\r\n *     const results = [];\r\n *     for (let i = 0; i < items.length; i++) {\r\n *       const result = await processItem(items[i]);\r\n *       results.push(result);\r\n *       onProgress((i + 1) / items.length * 100);\r\n *     }\r\n *     return results;\r\n *   },\r\n *   {\r\n *     onSuccess: (results) => console.debug('Batch completed:', results.length),\r\n *   }\r\n * );\r\n */\r\nexport function useBatchOperation<T = any>(\r\n  batchFn: (params: {\r\n    items: any[];\r\n    onProgress: (progress: number) => void;\r\n    signal?: AbortSignal;\r\n  }) => Promise<T[]>,\r\n  options: {\r\n    onSuccess?: (results: T[]) => void;\r\n    onError?: (error: Error) => void;\r\n    onProgress?: (progress: number) => void;\r\n    onItemComplete?: (item: any, index: number) => void;\r\n    itemDelay?: number;\r\n  } = {}\r\n) {\r\n  const {\r\n    onSuccess,\r\n    onError,\r\n    onProgress,\r\n    onItemComplete,\r\n    itemDelay = 0,\r\n  } = options;\r\n\r\n  const [state, setState] = useState<{\r\n    isRunning: boolean;\r\n    progress: number;\r\n    currentItem: number;\r\n    totalItems: number;\r\n    results: T[];\r\n    errors: Array<{ item: any; error: string; index: number }>;\r\n    isCancelled: boolean;\r\n  }>({\r\n    isRunning: false,\r\n    progress: 0,\r\n    currentItem: 0,\r\n    totalItems: 0,\r\n    results: [],\r\n    errors: [],\r\n    isCancelled: false,\r\n  });\r\n\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Helper function to process individual items\r\n  const processItem = useCallback(\r\n    async (item: any, signal?: AbortSignal): Promise<T> => {\r\n      if (signal?.aborted) {\r\n        throw new Error('Operation cancelled');\r\n      }\r\n\r\n      // This would call the actual batch function logic\r\n      // For now, return a placeholder\r\n      return item as T;\r\n    },\r\n    []\r\n  );\r\n\r\n  const start = useCallback(\r\n    async (items: any[]) => {\r\n      // Cancel any ongoing operation\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n\r\n      abortControllerRef.current = new AbortController();\r\n\r\n      setState({\r\n        isRunning: true,\r\n        progress: 0,\r\n        currentItem: 0,\r\n        totalItems: items.length,\r\n        results: [],\r\n        errors: [],\r\n        isCancelled: false,\r\n      });\r\n\r\n      try {\r\n        // Use the batchFn parameter properly\r\n        const results: T[] = await batchFn({\r\n          items,\r\n          onProgress: (progress: number) => {\r\n            setState((prev) => ({\r\n              ...prev,\r\n              progress,\r\n              currentItem: Math.floor((progress / 100) * items.length),\r\n            }));\r\n            onProgress?.(progress);\r\n          },\r\n          signal: abortControllerRef.current?.signal,\r\n        });\r\n\r\n        const errors: Array<{ item: any; error: string; index: number }> = [];\r\n\r\n        setState((prev) => ({\r\n          ...prev,\r\n          isRunning: false,\r\n          progress: 100,\r\n          currentItem: items.length,\r\n          results,\r\n          errors,\r\n        }));\r\n\r\n        onSuccess?.(results);\r\n      } catch (error) {\r\n        if (!abortControllerRef.current?.signal.aborted) {\r\n          const errorMessage =\r\n            error instanceof Error ? error.message : 'Batch operation failed';\r\n\r\n          setState((prev) => ({\r\n            ...prev,\r\n            isRunning: false,\r\n            isCancelled: abortControllerRef.current?.signal.aborted || false,\r\n            error: errorMessage,\r\n          }));\r\n\r\n          onError?.(new Error(errorMessage));\r\n        }\r\n      }\r\n    },\r\n    [\r\n      onSuccess,\r\n      onError,\r\n      onProgress,\r\n      onItemComplete,\r\n      itemDelay,\r\n      processItem,\r\n      batchFn,\r\n    ]\r\n  );\r\n\r\n  const cancel = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isCancelled: true,\r\n      isRunning: false,\r\n    }));\r\n  }, []);\r\n\r\n  const retry = useCallback(() => {\r\n    if (state.totalItems > 0) {\r\n      // This would need to store the original items\r\n      console.warn('Retry requires original items to be stored');\r\n    }\r\n  }, [state.totalItems]);\r\n\r\n  const reset = useCallback(() => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n\r\n    setState({\r\n      isRunning: false,\r\n      progress: 0,\r\n      currentItem: 0,\r\n      totalItems: 0,\r\n      results: [],\r\n      errors: [],\r\n      isCancelled: false,\r\n    });\r\n  }, []);\r\n\r\n  const actionHandlers = {\r\n    start,\r\n    cancel,\r\n    retry,\r\n    reset,\r\n  };\r\n\r\n  return [state, actionHandlers] as const;\r\n}\r\n\r\nexport default useActionState;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useAsyncData.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'CACHE_DURATION'. Either include it or remove the dependency array.","line":212,"column":6,"nodeType":"ArrayExpression","endLine":212,"endColumn":11,"suggestions":[{"desc":"Update the dependencies array to be: [CACHE_DURATION, key]","fix":{"range":[4619,4624],"text":"[CACHE_DURATION, key]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\n\ninterface UseAsyncDataOptions<T> {\n  immediate?: boolean;\n  retryCount?: number;\n  retryDelay?: number;\n  onSuccess?: (data: T) => void;\n  onError?: (error: Error) => void;\n}\n\ninterface AsyncDataState<T> {\n  data: T | null;\n  loading: boolean;\n  error: Error | null;\n  lastFetched: Date | null;\n}\n\n/**\n * Custom hook for managing async data with React 18 patterns\n * Supports retry logic, error handling, and loading states\n */\nexport function useAsyncData<T>(\n  asyncFn: () => Promise<T>,\n  options: UseAsyncDataOptions<T> = {}\n) {\n  const {\n    immediate = true,\n    retryCount = 3,\n    retryDelay = 1000,\n    onSuccess,\n    onError,\n  } = options;\n\n  const [state, setState] = useState<AsyncDataState<T>>({\n    data: null,\n    loading: immediate,\n    error: null,\n    lastFetched: null,\n  });\n\n  const retryAttemptRef = useRef(0);\n  const mountedRef = useRef(true);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  const execute = useCallback(async () => {\n    if (!mountedRef.current) {\n      return;\n    }\n\n    setState((prev) => ({ ...prev, loading: true, error: null }));\n\n    try {\n      const data = await asyncFn();\n\n      if (!mountedRef.current) {\n        return;\n      }\n\n      setState({\n        data,\n        loading: false,\n        error: null,\n        lastFetched: new Date(),\n      });\n\n      retryAttemptRef.current = 0;\n      onSuccess?.(data);\n    } catch (error) {\n      if (!mountedRef.current) {\n        return;\n      }\n\n      const errorObj =\n        error instanceof Error ? error : new Error('Unknown error');\n\n      // Retry logic\n      if (retryAttemptRef.current < retryCount) {\n        retryAttemptRef.current++;\n        setTimeout(() => {\n          if (mountedRef.current) {\n            execute();\n          }\n        }, retryDelay * retryAttemptRef.current);\n        return;\n      }\n\n      setState((prev) => ({\n        ...prev,\n        loading: false,\n        error: errorObj,\n      }));\n\n      onError?.(errorObj);\n    }\n  }, [asyncFn, retryCount, retryDelay, onSuccess, onError]);\n\n  // Immediate execution\n  useEffect(() => {\n    if (immediate) {\n      execute();\n    }\n  }, [immediate, execute]);\n\n  // Refetch function\n  const refetch = useCallback(() => {\n    retryAttemptRef.current = 0;\n    execute();\n  }, [execute]);\n\n  // Reset function\n  const reset = useCallback(() => {\n    retryAttemptRef.current = 0;\n    setState({\n      data: null,\n      loading: false,\n      error: null,\n      lastFetched: null,\n    });\n  }, []);\n\n  return {\n    ...state,\n    execute,\n    refetch,\n    reset,\n    retryAttempt: retryAttemptRef.current,\n  };\n}\n\n/**\n * Custom hook for paginated async data\n */\nexport function useAsyncPaginatedData<T>(\n  asyncFn: (\n    page: number,\n    limit: number\n  ) => Promise<{ data: T[]; total: number }>,\n  options: UseAsyncDataOptions<{ data: T[]; total: number }> & {\n    pageSize?: number;\n  } = {}\n) {\n  const { pageSize = 20, ...asyncOptions } = options;\n\n  const [page, setPage] = useState(1);\n  const [limit, setLimit] = useState(pageSize);\n\n  const paginatedAsyncFn = useCallback(\n    () => asyncFn(page, limit),\n    [asyncFn, page, limit]\n  );\n\n  const result = useAsyncData(paginatedAsyncFn, asyncOptions);\n\n  const goToPage = useCallback((newPage: number) => {\n    setPage(newPage);\n  }, []);\n\n  const nextPage = useCallback(() => {\n    setPage((prev) => prev + 1);\n  }, []);\n\n  const prevPage = useCallback(() => {\n    setPage((prev) => Math.max(1, prev - 1));\n  }, []);\n\n  const changePageSize = useCallback((newLimit: number) => {\n    setLimit(newLimit);\n    setPage(1); // Reset to first page\n  }, []);\n\n  const totalPages = result.data ? Math.ceil(result.data.total / limit) : 0;\n  const hasNextPage = page < totalPages;\n  const hasPrevPage = page > 1;\n\n  return {\n    ...result,\n    page,\n    limit,\n    totalPages,\n    hasNextPage,\n    hasPrevPage,\n    data: result.data?.data || [],\n    total: result.data?.total || 0,\n    goToPage,\n    nextPage,\n    prevPage,\n    changePageSize,\n  };\n}\n\n/**\n * Custom hook for cached async data with React 18 Suspense support\n */\nexport function useSuspenseData<T>(key: string, asyncFn: () => Promise<T>): T {\n  const cacheRef = useRef<Map<string, { data: T; timestamp: number }>>(\n    new Map()\n  );\n  const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes\n\n  const getCachedData = useCallback(() => {\n    const cached = cacheRef.current.get(key);\n    if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\n      return cached.data;\n    }\n    return null;\n  }, [key]);\n\n  const setCachedData = useCallback(\n    (data: T) => {\n      cacheRef.current.set(key, {\n        data,\n        timestamp: Date.now(),\n      });\n    },\n    [key]\n  );\n\n  const cachedData = getCachedData();\n\n  if (cachedData !== null) {\n    return cachedData;\n  }\n\n  // Throw promise for Suspense\n  const promise = asyncFn().then((data) => {\n    setCachedData(data);\n    return data;\n  });\n\n  throw promise;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useBreakpoint.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useDataRefresh.ts","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useDataRefresh\" cannot be called inside a callback. React Hooks must be called in a React function component or a custom React Hook function.","line":279,"column":23,"nodeType":"Identifier","endLine":279,"endColumn":37,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useDebounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useDeferredValue.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[310,313],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[310,313],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useDeferredValue, useMemo } from 'react';\n\n/**\n * Custom hook that wraps React 18's useDeferredValue for performance optimization\n * Useful for deferring expensive computations or UI updates\n */\nexport function useDeferredValueWithComputed<T>(\n  initialValue: T,\n  computeFn?: (value: T) => any\n) {\n  const [value, setValue] = useState(initialValue);\n  const deferredValue = useDeferredValue(value);\n\n  const computedValue = useMemo(() => {\n    if (computeFn) {\n      return computeFn(deferredValue);\n    }\n    return deferredValue;\n  }, [deferredValue, computeFn]);\n\n  return {\n    value,\n    deferredValue,\n    computedValue,\n    setValue,\n    isPending: value !== deferredValue,\n  };\n}\n\n/**\n * Hook for managing search with deferred value for better performance\n */\nexport function useDeferredSearch(initialSearch: string = '') {\n  const [searchTerm, setSearchTerm] = useState(initialSearch);\n  const deferredSearchTerm = useDeferredValue(searchTerm);\n\n  return {\n    searchTerm,\n    deferredSearchTerm,\n    setSearchTerm,\n    isSearchPending: searchTerm !== deferredSearchTerm,\n  };\n}\n\n/**\n * Hook for managing lists with deferred filtering\n */\nexport function useDeferredList<T>(\n  items: T[],\n  filterFn: (item: T, filterValue: string) => boolean,\n  initialFilter: string = ''\n) {\n  const [filterValue, setFilterValue] = useState(initialFilter);\n  const deferredFilterValue = useDeferredValue(filterValue);\n\n  const filteredItems = useMemo(() => {\n    return items.filter((item) => filterFn(item, deferredFilterValue));\n  }, [items, filterFn, deferredFilterValue]);\n\n  return {\n    filterValue,\n    deferredFilterValue,\n    filteredItems,\n    setFilterValue,\n    isFilterPending: filterValue !== deferredFilterValue,\n  };\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useDocumentationWebSocket.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[939,942],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[939,942],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1081,1084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1081,1084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":28,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1131,1134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1131,1134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2084,2087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2084,2087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'handleConflict', 'handleDocumentationUpdate', 'handleSnapshotCreated', 'handleSyncStatusChange', 'handleValidationError', and 'handleVersionChange'. Either include them or remove the dependency array.","line":89,"column":6,"nodeType":"ArrayExpression","endLine":89,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [handleConflict, handleDocumentationUpdate, handleSnapshotCreated, handleSyncStatusChange, handleValidationError, handleVersionChange]","fix":{"range":[2913,2915],"text":"[handleConflict, handleDocumentationUpdate, handleSnapshotCreated, handleSyncStatusChange, handleValidationError, handleVersionChange]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3352,3355],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3352,3355],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3681,3684],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3681,3684],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3771,3774],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3771,3774],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3796,3799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3796,3799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3876,3879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3876,3879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":114,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":114,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3901,3904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3901,3904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3987,3990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3987,3990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4012,4015],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4012,4015],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'showUpdateNotification'. Either include it or remove the dependency array.","line":162,"column":5,"nodeType":"ArrayExpression","endLine":162,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [finalConfig.enableAutoApproval, finalConfig.enableNotifications, finalConfig.impactLevels, finalConfig.subscriptionTypes, finalConfig.targetFiles, showUpdateNotification]","fix":{"range":[5396,5409],"text":"[finalConfig.enableAutoApproval, finalConfig.enableNotifications, finalConfig.impactLevels, finalConfig.subscriptionTypes, finalConfig.targetFiles, showUpdateNotification]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":278,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":278,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8965,8968],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8965,8968],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":368,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":368,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11826,11829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11826,11829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":369,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":369,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11905,11908],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11905,11908],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'webSocketContext'. Either include it or remove the dependency array.","line":378,"column":6,"nodeType":"ArrayExpression","endLine":378,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [webSocketContext, finalConfig.subscriptionTypes, finalConfig.targetFiles, finalConfig.impactLevels]","fix":{"range":[12219,12262],"text":"[webSocketContext, finalConfig.subscriptionTypes, finalConfig.targetFiles, finalConfig.impactLevels]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":414,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":414,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13504,13507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13504,13507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":417,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":417,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13595,13598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13595,13598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":417,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":417,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13622,13625],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13622,13625],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":433,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":433,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14024,14027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14024,14027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'webSocketContext'. Either include it or remove the dependency array.","line":435,"column":6,"nodeType":"ArrayExpression","endLine":440,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [webSocketContext.isConnected, handleWebSocketMessage, subscribe, finalConfig.autoSubscribe, webSocketContext]","fix":{"range":[14074,14192],"text":"[webSocketContext.isConnected, handleWebSocketMessage, subscribe, finalConfig.autoSubscribe, webSocketContext]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":23,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useCallback, useRef } from 'react';\r\nimport { useWebSocketContext } from '@/contexts/WebSocketContext';\r\nimport { context7, type DocumentationUpdate } from '@/services/context7';\r\nimport { utilitiesApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\nimport { hasProperty } from '@/utils/errorHandling';\r\n\r\nexport interface DocumentationWebSocketConfig {\r\n  autoSubscribe: boolean;\r\n  subscriptionTypes: Array<\r\n    'content_change' | 'structure_change' | 'metadata_update' | 'version_update'\r\n  >;\r\n  targetFiles?: string[];\r\n  impactLevels?: Array<'low' | 'medium' | 'high' | 'critical'>;\r\n  enableNotifications: boolean;\r\n  enableAutoApproval: boolean;\r\n  conflictResolution: 'auto' | 'manual' | 'disabled';\r\n}\r\n\r\nexport interface DocumentationWebSocketHandlers {\r\n  onUpdate?: (update: DocumentationUpdate) => void;\r\n  onVersionChange?: (version: string) => void;\r\n  onConflict?: (conflictId: string, details: any) => void;\r\n  onSyncStatusChange?: (\r\n    status: 'synced' | 'syncing' | 'error' | 'offline'\r\n  ) => void;\r\n  onValidationError?: (errors: any[]) => void;\r\n  onSnapshotCreated?: (snapshot: any) => void;\r\n}\r\n\r\nconst DEFAULT_CONFIG: DocumentationWebSocketConfig = {\r\n  autoSubscribe: true,\r\n  subscriptionTypes: [\r\n    'content_change',\r\n    'structure_change',\r\n    'metadata_update',\r\n    'version_update',\r\n  ],\r\n  enableNotifications: true,\r\n  enableAutoApproval: false,\r\n  conflictResolution: 'manual',\r\n};\r\n\r\nexport const useDocumentationWebSocket = (\r\n  config: Partial<DocumentationWebSocketConfig> = {},\r\n  handlers: DocumentationWebSocketHandlers = {}\r\n) => {\r\n  const webSocketContext = useWebSocketContext();\r\n  const finalConfig = { ...DEFAULT_CONFIG, ...config };\r\n  const handlersRef = useRef(handlers);\r\n  const subscriptionIdRef = useRef<string | null>(null);\r\n  const isSubscribedRef = useRef(false);\r\n\r\n  // Update handlers ref when handlers change\r\n  useEffect(() => {\r\n    handlersRef.current = handlers;\r\n  }, [handlers]);\r\n\r\n  // Handle incoming WebSocket messages\r\n  const handleWebSocketMessage = useCallback((message: any) => {\r\n    if (!message.type?.startsWith('documentation_')) {\r\n      return;\r\n    }\r\n\r\n    const { type, data } = message;\r\n\r\n    switch (type) {\r\n      case 'documentation_update':\r\n        handleDocumentationUpdate(data);\r\n        break;\r\n      case 'documentation_version_change':\r\n        handleVersionChange(data);\r\n        break;\r\n      case 'documentation_conflict':\r\n        handleConflict(data);\r\n        break;\r\n      case 'documentation_sync_status':\r\n        handleSyncStatusChange(data);\r\n        break;\r\n      case 'documentation_validation_error':\r\n        handleValidationError(data);\r\n        break;\r\n      case 'documentation_snapshot_created':\r\n        handleSnapshotCreated(data);\r\n        break;\r\n      default:\r\n        console.debug('Unknown documentation WebSocket message type:', type);\r\n    }\r\n  }, []);\r\n\r\n  const handleDocumentationUpdate = useCallback(\r\n    (data: unknown) => {\r\n      // Type guard the data object\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid documentation update data:', data);\r\n        return;\r\n      }\r\n\r\n      const update: DocumentationUpdate = {\r\n        id: hasProperty(data, 'id') ? (data.id as string) : '',\r\n        type: hasProperty(data, 'type') ? (data.type as any) : 'content_change',\r\n        timestamp: hasProperty(data, 'timestamp')\r\n          ? (data.timestamp as string)\r\n          : new Date().toISOString(),\r\n        source: hasProperty(data, 'source')\r\n          ? (data.source as string)\r\n          : 'websocket',\r\n        changes: hasProperty(data, 'changes') ? (data.changes as any[]) : [],\r\n        version: hasProperty(data, 'version')\r\n          ? (data.version as any)\r\n          : ({} as any),\r\n        author: hasProperty(data, 'author')\r\n          ? (data.author as any)\r\n          : ({} as any),\r\n        metadata: hasProperty(data, 'metadata')\r\n          ? (data.metadata as any)\r\n          : ({} as any),\r\n      };\r\n\r\n      // Filter by configuration\r\n      if (\r\n        finalConfig.subscriptionTypes &&\r\n        !finalConfig.subscriptionTypes.includes(update.type)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (\r\n        finalConfig.impactLevels &&\r\n        !finalConfig.impactLevels.includes(update.metadata.impactLevel)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (finalConfig.targetFiles && finalConfig.targetFiles.length > 0) {\r\n        const hasTargetFile = update.changes.some((change) =>\r\n          // targetFiles is validated as non-null by the if condition above\r\n          finalConfig.targetFiles.includes(change.file)\r\n        );\r\n        if (!hasTargetFile) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Notify Context7 service via subscription\r\n      // Instead of calling private method, we'll use the public subscribe mechanism\r\n      // The Context7 service should handle this through its WebSocket subscription setup\r\n\r\n      // Show notification if enabled\r\n      if (finalConfig.enableNotifications) {\r\n        showUpdateNotification(update);\r\n      }\r\n\r\n      // Auto-approve if enabled and applicable\r\n      if (finalConfig.enableAutoApproval && update.metadata.autoApproved) {\r\n        context7.approveUpdate(update.id).catch(console.error);\r\n      }\r\n\r\n      // Call custom handler\r\n      handlersRef.current.onUpdate?.(update);\r\n    },\r\n    [finalConfig]\r\n  );\r\n\r\n  const handleVersionChange = useCallback(\r\n    (data: unknown) => {\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid version change data:', data);\r\n        return;\r\n      }\r\n\r\n      const version = hasProperty(data, 'version')\r\n        ? String(data.version)\r\n        : 'unknown';\r\n      const previousVersion = hasProperty(data, 'previousVersion')\r\n        ? String(data.previousVersion)\r\n        : 'unknown';\r\n\r\n      if (finalConfig.enableNotifications) {\r\n        toast.info('Documentation Version Updated', {\r\n          description: `Updated from ${previousVersion} to ${version}`,\r\n        });\r\n      }\r\n\r\n      handlersRef.current.onVersionChange?.(version);\r\n    },\r\n    [finalConfig.enableNotifications]\r\n  );\r\n\r\n  const handleConflict = useCallback(\r\n    (data: unknown) => {\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid conflict data:', data);\r\n        return;\r\n      }\r\n\r\n      const conflictId = hasProperty(data, 'conflictId')\r\n        ? String(data.conflictId)\r\n        : 'unknown';\r\n      const details = hasProperty(data, 'details') ? data.details : {};\r\n\r\n      if (finalConfig.enableNotifications) {\r\n        toast.warning('Documentation Conflict Detected', {\r\n          description: `Conflict in ${\r\n            hasProperty(details, 'file')\r\n              ? String(details.file)\r\n              : 'multiple files'\r\n          }`,\r\n          action: {\r\n            label: 'Resolve',\r\n            onClick: () => {\r\n              // Navigate to conflict resolution UI\r\n              console.debug('Navigate to conflict resolution for:', conflictId);\r\n            },\r\n          },\r\n        });\r\n      }\r\n\r\n      handlersRef.current.onConflict?.(conflictId, details);\r\n    },\r\n    [finalConfig.enableNotifications]\r\n  );\r\n\r\n  const handleSyncStatusChange = useCallback(\r\n    (data: unknown) => {\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid sync status data:', data);\r\n        return;\r\n      }\r\n\r\n      const status = hasProperty(data, 'status')\r\n        ? (String(data.status) as 'synced' | 'syncing' | 'error' | 'offline')\r\n        : 'error';\r\n      const message = hasProperty(data, 'message') ? String(data.message) : '';\r\n\r\n      if (finalConfig.enableNotifications && status === 'error') {\r\n        toast.error('Documentation Sync Error', {\r\n          description: message || 'Failed to sync documentation',\r\n        });\r\n      }\r\n\r\n      handlersRef.current.onSyncStatusChange?.(status);\r\n    },\r\n    [finalConfig.enableNotifications]\r\n  );\r\n\r\n  const handleValidationError = useCallback(\r\n    (data: unknown) => {\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid validation error data:', data);\r\n        return;\r\n      }\r\n\r\n      const errors =\r\n        hasProperty(data, 'errors') && Array.isArray(data.errors)\r\n          ? data.errors\r\n          : [];\r\n\r\n      if (finalConfig.enableNotifications) {\r\n        toast.error('Documentation Validation Failed', {\r\n          description: `${errors.length} validation error(s) found`,\r\n        });\r\n      }\r\n\r\n      handlersRef.current.onValidationError?.(errors);\r\n    },\r\n    [finalConfig.enableNotifications]\r\n  );\r\n\r\n  const handleSnapshotCreated = useCallback(\r\n    (data: unknown) => {\r\n      if (typeof data !== 'object' || data === null) {\r\n        console.error('Invalid snapshot data:', data);\r\n        return;\r\n      }\r\n\r\n      const snapshot = hasProperty(data, 'snapshot')\r\n        ? (data.snapshot as any)\r\n        : null;\r\n\r\n      if (finalConfig.enableNotifications && snapshot) {\r\n        toast.success('Documentation Snapshot Created', {\r\n          description: `Snapshot \"${snapshot.name || 'unnamed'}\" created successfully`,\r\n        });\r\n      }\r\n\r\n      handlersRef.current.onSnapshotCreated?.(snapshot);\r\n    },\r\n    [finalConfig.enableNotifications]\r\n  );\r\n\r\n  const showUpdateNotification = useCallback((update: DocumentationUpdate) => {\r\n    const fileCount = update.changes.length;\r\n    const primaryFile = update.changes[0]?.file || 'unknown';\r\n    const message =\r\n      fileCount === 1 ? `Updated ${primaryFile}` : `Updated ${fileCount} files`;\r\n\r\n    switch (update.metadata.impactLevel) {\r\n      case 'critical':\r\n        toast.error('Critical Documentation Update', {\r\n          description: message,\r\n          action: {\r\n            label: 'Review',\r\n            onClick: () => {\r\n              // Navigate to update review\r\n              console.debug('Review update:', update.id);\r\n            },\r\n          },\r\n        });\r\n        break;\r\n      case 'high':\r\n        toast.warning('Important Documentation Update', {\r\n          description: message,\r\n        });\r\n        break;\r\n      case 'medium':\r\n        toast.info('Documentation Update', {\r\n          description: message,\r\n        });\r\n        break;\r\n      case 'low':\r\n        toast('Documentation Update', {\r\n          description: message,\r\n        });\r\n        break;\r\n    }\r\n  }, []);\r\n\r\n  // Subscribe to documentation updates\r\n  const subscribe = useCallback(async () => {\r\n    if (isSubscribedRef.current || !webSocketContext.isConnected) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Subscribe via WebSocket\r\n      webSocketContext.subscribe('documentation_updates');\r\n      webSocketContext.subscribe('documentation_version_changes');\r\n      webSocketContext.subscribe('documentation_conflicts');\r\n      webSocketContext.subscribe('documentation_sync_status');\r\n      webSocketContext.subscribe('documentation_validation_errors');\r\n      webSocketContext.subscribe('documentation_snapshots');\r\n\r\n      // Subscribe via API for server-side filtering\r\n      const subscriptionData: {\r\n        types: Array<\r\n          | 'content_change'\r\n          | 'structure_change'\r\n          | 'metadata_update'\r\n          | 'version_update'\r\n        >;\r\n        files?: string[];\r\n        impactLevels?: Array<'low' | 'medium' | 'high' | 'critical'>;\r\n      } = {\r\n        types: finalConfig.subscriptionTypes,\r\n      };\r\n\r\n      if (finalConfig.targetFiles) {\r\n        subscriptionData.files = finalConfig.targetFiles;\r\n      }\r\n\r\n      if (finalConfig.impactLevels) {\r\n        subscriptionData.impactLevels = finalConfig.impactLevels;\r\n      }\r\n\r\n      const response = await utilitiesApi.subscribeToUpdates(subscriptionData);\r\n\r\n      if (response.success && (response.data as any)?.subscriptionId) {\r\n        subscriptionIdRef.current = (response.data as any).subscriptionId;\r\n      }\r\n\r\n      isSubscribedRef.current = true;\r\n      console.debug('Subscribed to documentation updates');\r\n    } catch (error) {\r\n      console.error('Failed to subscribe to documentation updates:', error);\r\n      toast.error('Failed to subscribe to documentation updates');\r\n    }\r\n  }, [webSocketContext.isConnected, finalConfig]);\r\n\r\n  // Unsubscribe from documentation updates\r\n  const unsubscribe = useCallback(async () => {\r\n    if (!isSubscribedRef.current) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Unsubscribe from WebSocket topics\r\n      webSocketContext.unsubscribe('documentation_updates');\r\n      webSocketContext.unsubscribe('documentation_version_changes');\r\n      webSocketContext.unsubscribe('documentation_conflicts');\r\n      webSocketContext.unsubscribe('documentation_sync_status');\r\n      webSocketContext.unsubscribe('documentation_validation_errors');\r\n      webSocketContext.unsubscribe('documentation_snapshots');\r\n\r\n      // Unsubscribe via API\r\n      if (subscriptionIdRef.current) {\r\n        await utilitiesApi.unsubscribeFromUpdates(subscriptionIdRef.current);\r\n        subscriptionIdRef.current = null;\r\n      }\r\n\r\n      isSubscribedRef.current = false;\r\n      console.debug('Unsubscribed from documentation updates');\r\n    } catch (error) {\r\n      console.error('Failed to unsubscribe from documentation updates:', error);\r\n    }\r\n  }, [webSocketContext]);\r\n\r\n  // Set up WebSocket message handler\r\n  useEffect(() => {\r\n    if (!webSocketContext.isConnected) {\r\n      return;\r\n    }\r\n\r\n    const originalOnMessage = (webSocketContext as any).onMessage;\r\n\r\n    // Enhance the existing onMessage handler\r\n    (webSocketContext as any).onMessage = (message: any) => {\r\n      handleWebSocketMessage(message);\r\n\r\n      // Call original handler if it exists\r\n      if (originalOnMessage && typeof originalOnMessage === 'function') {\r\n        originalOnMessage(message);\r\n      }\r\n    };\r\n\r\n    // Auto-subscribe if enabled\r\n    if (finalConfig.autoSubscribe) {\r\n      subscribe();\r\n    }\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      (webSocketContext as any).onMessage = originalOnMessage;\r\n    };\r\n  }, [\r\n    webSocketContext.isConnected,\r\n    handleWebSocketMessage,\r\n    subscribe,\r\n    finalConfig.autoSubscribe,\r\n  ]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [unsubscribe]);\r\n\r\n  // Manual subscription control\r\n  const toggleSubscription = useCallback(async () => {\r\n    if (isSubscribedRef.current) {\r\n      await unsubscribe();\r\n    } else {\r\n      await subscribe();\r\n    }\r\n  }, [subscribe, unsubscribe]);\r\n\r\n  // Force sync documentation\r\n  const forceSync = useCallback(async () => {\r\n    try {\r\n      await utilitiesApi.syncDocumentationSources({ forceSync: true });\r\n      toast.success('Documentation sync initiated');\r\n    } catch (error) {\r\n      console.error('Failed to force sync documentation:', error);\r\n      toast.error('Failed to sync documentation');\r\n    }\r\n  }, []);\r\n\r\n  // Validate documentation integrity\r\n  const validateIntegrity = useCallback(async () => {\r\n    try {\r\n      const response = await utilitiesApi.validateDocumentationIntegrity();\r\n      if (response.success) {\r\n        toast.success('Documentation validation completed');\r\n        return response.data;\r\n      } else {\r\n        toast.error('Documentation validation failed');\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to validate documentation:', error);\r\n      toast.error('Failed to validate documentation');\r\n      return null;\r\n    }\r\n  }, []);\r\n\r\n  // Create documentation snapshot\r\n  const createSnapshot = useCallback(\r\n    async (name: string, description?: string, tags?: string[]) => {\r\n      try {\r\n        const snapshotData: {\r\n          name: string;\r\n          description?: string;\r\n          tags?: string[];\r\n        } = {\r\n          name,\r\n        };\r\n\r\n        if (description) {\r\n          snapshotData.description = description;\r\n        }\r\n\r\n        if (tags) {\r\n          snapshotData.tags = tags;\r\n        }\r\n\r\n        const response =\r\n          await utilitiesApi.createDocumentationSnapshot(snapshotData);\r\n\r\n        if (response.success) {\r\n          toast.success(`Snapshot \"${name}\" created successfully`);\r\n          return response.data;\r\n        } else {\r\n          toast.error('Failed to create snapshot');\r\n          return null;\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to create documentation snapshot:', error);\r\n        toast.error('Failed to create snapshot');\r\n        return null;\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  return {\r\n    // State\r\n    isSubscribed: isSubscribedRef.current,\r\n    subscriptionId: subscriptionIdRef.current,\r\n    isConnected: webSocketContext.isConnected,\r\n\r\n    // Actions\r\n    subscribe,\r\n    unsubscribe,\r\n    toggleSubscription,\r\n    forceSync,\r\n    validateIntegrity,\r\n    createSnapshot,\r\n\r\n    // WebSocket context\r\n    webSocketContext,\r\n  };\r\n};\r\n\r\nexport default useDocumentationWebSocket;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useEnhancedState.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3680,3683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3680,3683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3801,3804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3801,3804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4240,4243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4240,4243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4258,4261],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4258,4261],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4374,4377],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4374,4377],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, {\r\n  useCallback,\r\n  useEffect,\r\n  useRef,\r\n  useMemo,\r\n  useState,\r\n} from 'react';\r\nimport type {\r\n  EnhancedStateStore,\r\n  StateSelector,\r\n  StateUpdater,\r\n} from '@/store/state-manager';\r\n\r\n/**\r\n * React hooks for the enhanced state management system\r\n */\r\n\r\n/**\r\n * Hook to use an enhanced state store\r\n */\r\nexport function useEnhancedState<T>(\r\n  store: EnhancedStateStore<T>\r\n): [T, StateUpdater<T>, EnhancedStateStore<T>] {\r\n  const [state, setState] = useState(store.getState());\r\n\r\n  // Subscribe to store changes\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe((newState, previousState) => {\r\n      if (newState !== previousState) {\r\n        setState(newState);\r\n      }\r\n    });\r\n\r\n    // Initial sync\r\n    setState(store.getState());\r\n\r\n    return unsubscribe;\r\n  }, [store]);\r\n\r\n  const updateState = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      store.setState(updater);\r\n    },\r\n    [store]\r\n  );\r\n\r\n  return [state, updateState, store];\r\n}\r\n\r\n/**\r\n * Hook to use a selector from the enhanced state store\r\n */\r\nexport function useSelector<T, R>(\r\n  store: EnhancedStateStore<T>,\r\n  selector: StateSelector<T, R>,\r\n  equalityFn?: (a: R, b: R) => boolean\r\n): R {\r\n  const [selectedState, setSelectedState] = React.useState<R>(() => {\r\n    try {\r\n      return selector(store.getState());\r\n    } catch (error) {\r\n      console.error('Selector error:', error);\r\n      throw error;\r\n    }\r\n  });\r\n\r\n  const previousSelectorRef = useRef(selector);\r\n  const previousEqualityFnRef = useRef(equalityFn);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe((newState) => {\r\n      try {\r\n        const newSelectedState = selector(newState);\r\n\r\n        // Check if selected state has changed\r\n        const hasChanged = !equalityFn\r\n          ? newSelectedState !== selectedState\r\n          : !equalityFn(newSelectedState, selectedState);\r\n\r\n        if (hasChanged) {\r\n          setSelectedState(newSelectedState);\r\n        }\r\n      } catch (error) {\r\n        console.error('Selector error in subscription:', error);\r\n      }\r\n    });\r\n\r\n    // Update selector if it has changed\r\n    if (\r\n      previousSelectorRef.current !== selector ||\r\n      previousEqualityFnRef.current !== equalityFn\r\n    ) {\r\n      previousSelectorRef.current = selector;\r\n      previousEqualityFnRef.current = equalityFn;\r\n\r\n      try {\r\n        const newSelectedState = selector(store.getState());\r\n        setSelectedState(newSelectedState);\r\n      } catch (error) {\r\n        console.error('Selector error on update:', error);\r\n      }\r\n    }\r\n\r\n    return unsubscribe;\r\n  }, [store, selector, equalityFn, selectedState]);\r\n\r\n  return selectedState;\r\n}\r\n\r\n/**\r\n * Hook to use computed values from the enhanced state store\r\n */\r\nexport function useComputed<T, R>(\r\n  store: EnhancedStateStore<T>,\r\n  computedKey: string\r\n): R {\r\n  const [computedValue, setComputedValue] = React.useState<R>(() => {\r\n    return store.computed[computedKey];\r\n  });\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe(() => {\r\n      const newComputedValue = store.computed[computedKey];\r\n      if (newComputedValue !== computedValue) {\r\n        setComputedValue(newComputedValue);\r\n      }\r\n    });\r\n\r\n    // Initial sync\r\n    setComputedValue(store.computed[computedKey]);\r\n\r\n    return unsubscribe;\r\n  }, [store, computedKey, computedValue]);\r\n\r\n  return computedValue;\r\n}\r\n\r\n/**\r\n * Hook to use actions from the enhanced state store\r\n */\r\nexport function useActions<T>(store: EnhancedStateStore<T>) {\r\n  const actions = useMemo(() => store.actions, [store]);\r\n\r\n  const stableActions = useMemo(() => {\r\n    const boundActions: Record<string, (...args: any[]) => void> = {};\r\n\r\n    Object.entries(actions).forEach(([name, action]) => {\r\n      boundActions[name] = (...args: any[]) => {\r\n        action(...args);\r\n      };\r\n    });\r\n\r\n    return boundActions;\r\n  }, [actions]);\r\n\r\n  return stableActions;\r\n}\r\n\r\n/**\r\n * Hook to use async actions from the enhanced state store\r\n */\r\nexport function useAsyncActions<T>(store: EnhancedStateStore<T>) {\r\n  const asyncActions = useMemo(() => store.asyncActions, [store]);\r\n\r\n  const stableAsyncActions = useMemo(() => {\r\n    const boundActions: Record<string, (...args: any[]) => Promise<any>> = {};\r\n\r\n    Object.entries(asyncActions).forEach(([name, action]) => {\r\n      boundActions[name] = (...args: any[]) => {\r\n        return action(...args);\r\n      };\r\n    });\r\n\r\n    return boundActions;\r\n  }, [asyncActions]);\r\n\r\n  return stableAsyncActions;\r\n}\r\n\r\n/**\r\n * Hook to use state with persistence\r\n */\r\nexport function usePersistedState<T>(\r\n  store: EnhancedStateStore<T>,\r\n  persistKey: string\r\n): [T, StateUpdater<T>, () => void] {\r\n  const [state, setState] = useEnhancedState(store);\r\n  const [isHydrated, setIsHydrated] = React.useState(false);\r\n\r\n  // Handle hydration\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setIsHydrated(true);\r\n    }, 100);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n\r\n  const clearPersistedState = useCallback(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.removeItem(persistKey);\r\n      store.resetState();\r\n    }\r\n  }, [store, persistKey]);\r\n\r\n  // Return placeholder state during hydration\r\n  if (!isHydrated) {\r\n    return [store.getState(), setState, clearPersistedState];\r\n  }\r\n\r\n  return [state, setState, clearPersistedState];\r\n}\r\n\r\n/**\r\n * Hook to use state with optimistic updates\r\n */\r\nexport function useOptimisticState<T>(\r\n  store: EnhancedStateStore<T>\r\n): [T, StateUpdater<T>, StateUpdater<T>] {\r\n  const [state, setState] = useEnhancedState(store);\r\n  const [optimisticState, setOptimisticState] = React.useState<T>(state);\r\n\r\n  const updateWithOptimism = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      // Apply optimistic update immediately\r\n      const optimisticUpdate =\r\n        typeof updater === 'function'\r\n          ? (updater as (state: T) => T)(optimisticState)\r\n          : updater;\r\n\r\n      setOptimisticState(optimisticUpdate);\r\n\r\n      // Apply actual update\r\n      setState(updater);\r\n    },\r\n    [optimisticState, setState]\r\n  );\r\n\r\n  const resetOptimistic = useCallback(() => {\r\n    setOptimisticState(state);\r\n  }, [state]);\r\n\r\n  // Sync optimistic state with actual state\r\n  useEffect(() => {\r\n    setOptimisticState(state);\r\n  }, [state]);\r\n\r\n  return [optimisticState, updateWithOptimism, resetOptimistic];\r\n}\r\n\r\n/**\r\n * Hook to use state with debounced updates\r\n */\r\nexport function useDebouncedState<T>(\r\n  store: EnhancedStateStore<T>,\r\n  delay: number = 300\r\n): [T, StateUpdater<T>, T] {\r\n  const [state, setState] = useEnhancedState(store);\r\n  const [debouncedState, setDebouncedState] = React.useState<T>(state);\r\n  const timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  const debouncedSetState = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      setState(updater);\r\n\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n\r\n      timeoutRef.current = setTimeout(() => {\r\n        setDebouncedState(\r\n          typeof updater === 'function'\r\n            ? (updater as (state: T) => T)(store.getState())\r\n            : updater\r\n        );\r\n      }, delay);\r\n    },\r\n    [setState, store, delay]\r\n  );\r\n\r\n  // Cleanup timeout on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Sync debounced state with actual state\r\n  useEffect(() => {\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n    }\r\n    setDebouncedState(state);\r\n  }, [state]);\r\n\r\n  return [state, debouncedSetState, debouncedState];\r\n}\r\n\r\n/**\r\n * Hook to use state with undo/redo functionality\r\n */\r\nexport function useUndoRedoState<T>(\r\n  store: EnhancedStateStore<T>,\r\n  maxHistory: number = 50\r\n): [T, StateUpdater<T>, () => void, () => void, boolean, boolean] {\r\n  const [state, setState] = useEnhancedState(store);\r\n  const [history, setHistory] = React.useState<T[]>([state]);\r\n  const [currentIndex, setCurrentIndex] = React.useState(0);\r\n\r\n  const updateWithHistory = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      const newState =\r\n        typeof updater === 'function'\r\n          ? (updater as (state: T) => T)(state)\r\n          : updater;\r\n\r\n      setState(newState);\r\n\r\n      // Update history\r\n      const newHistory = history.slice(0, currentIndex + 1);\r\n      newHistory.push(newState);\r\n\r\n      // Limit history size\r\n      if (newHistory.length > maxHistory) {\r\n        newHistory.shift();\r\n        setCurrentIndex((prev) => prev - 1);\r\n      } else {\r\n        setCurrentIndex(newHistory.length - 1);\r\n      }\r\n\r\n      setHistory(newHistory);\r\n    },\r\n    [state, setState, history, currentIndex, maxHistory]\r\n  );\r\n\r\n  const undo = useCallback(() => {\r\n    if (currentIndex > 0) {\r\n      const newIndex = currentIndex - 1;\r\n      const previousState = history[newIndex];\r\n      if (previousState !== undefined) {\r\n        setCurrentIndex(newIndex);\r\n        setState(previousState);\r\n      }\r\n    }\r\n  }, [currentIndex, history, setState]);\r\n\r\n  const redo = useCallback(() => {\r\n    if (currentIndex < history.length - 1) {\r\n      const newIndex = currentIndex + 1;\r\n      const nextState = history[newIndex];\r\n      if (nextState !== undefined) {\r\n        setCurrentIndex(newIndex);\r\n        setState(nextState);\r\n      }\r\n    }\r\n  }, [currentIndex, history, setState]);\r\n\r\n  const canUndo = currentIndex > 0;\r\n  const canRedo = currentIndex < history.length - 1;\r\n\r\n  // Reset history when external state changes\r\n  useEffect(() => {\r\n    if (!history.includes(state)) {\r\n      setHistory([state]);\r\n      setCurrentIndex(0);\r\n    }\r\n  }, [state, history]);\r\n\r\n  return [state, updateWithHistory, undo, redo, canUndo, canRedo];\r\n}\r\n\r\n/**\r\n * Hook to use state with validation\r\n */\r\nexport function useValidatedState<T>(\r\n  store: EnhancedStateStore<T>,\r\n  validator: (state: T) => string | null\r\n): [T, StateUpdater<T>, string | null, boolean] {\r\n  const [state, setState] = useEnhancedState(store);\r\n  const [error, setError] = React.useState<string | null>(() =>\r\n    validator(state)\r\n  );\r\n\r\n  const validateAndUpdate = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      const newState =\r\n        typeof updater === 'function'\r\n          ? (updater as (state: T) => T)(state)\r\n          : updater;\r\n\r\n      const validationError = validator(newState);\r\n      setError(validationError);\r\n\r\n      if (!validationError) {\r\n        setState(updater);\r\n      }\r\n    },\r\n    [state, setState, validator]\r\n  );\r\n\r\n  // Re-validate when state changes externally\r\n  useEffect(() => {\r\n    const validationError = validator(state);\r\n    setError(validationError);\r\n  }, [state, validator]);\r\n\r\n  const isValid = error === null;\r\n\r\n  return [state, validateAndUpdate, error, isValid];\r\n}\r\n\r\n/**\r\n * Hook to use state with local caching\r\n */\r\nexport function useCachedState<T>(\r\n  store: EnhancedStateStore<T>,\r\n  cacheKey: string,\r\n  cacheTimeout: number = 5 * 60 * 1000 // 5 minutes\r\n): [T, StateUpdater<T>, () => void] {\r\n  const [state, setState] = useEnhancedState(store);\r\n\r\n  const getFromCache = useCallback((): T | null => {\r\n    try {\r\n      const cached = localStorage.getItem(cacheKey);\r\n      if (cached) {\r\n        const { data, timestamp } = JSON.parse(cached);\r\n        if (Date.now() - timestamp < cacheTimeout) {\r\n          return data;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Cache read error:', error);\r\n    }\r\n    return null;\r\n  }, [cacheKey, cacheTimeout]);\r\n\r\n  const saveToCache = useCallback(\r\n    (data: T) => {\r\n      try {\r\n        localStorage.setItem(\r\n          cacheKey,\r\n          JSON.stringify({\r\n            data,\r\n            timestamp: Date.now(),\r\n          })\r\n        );\r\n      } catch (error) {\r\n        console.error('Cache write error:', error);\r\n      }\r\n    },\r\n    [cacheKey]\r\n  );\r\n\r\n  const updateWithCache = useCallback<StateUpdater<T>>(\r\n    (updater) => {\r\n      const newState =\r\n        typeof updater === 'function'\r\n          ? (updater as (state: T) => T)(state)\r\n          : updater;\r\n\r\n      setState(newState);\r\n      saveToCache(newState);\r\n    },\r\n    [state, setState, saveToCache]\r\n  );\r\n\r\n  const clearCache = useCallback(() => {\r\n    localStorage.removeItem(cacheKey);\r\n  }, [cacheKey]);\r\n\r\n  // Initialize from cache if available\r\n  useEffect(() => {\r\n    const cachedState = getFromCache();\r\n    if (cachedState) {\r\n      setState(cachedState);\r\n    }\r\n  }, [getFromCache, setState]);\r\n\r\n  return [state, updateWithCache, clearCache];\r\n}\r\n\r\nexport default useEnhancedState;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useFormState.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":8,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[202,205],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[202,205],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[409,412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[409,412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":18,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[489,492],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[489,492],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[567,570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[567,570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[875,878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[875,878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1899,1902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1899,1902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2101,2104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2101,2104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2129,2132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2129,2132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":71,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2210,2213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2210,2213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2907,2910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2907,2910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2942,2945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2942,2945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state.values'. Either include it or remove the dependency array.","line":156,"column":5,"nodeType":"ArrayExpression","endLine":156,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [state.values, validationSchema]","fix":{"range":[4314,4332],"text":"[state.values, validationSchema]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4407,4410],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4407,4410],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5078,5081],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5078,5081],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":218,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5899,5902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5899,5902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7662,7665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7662,7665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'validationSchema'. Either include it or remove the dependency array.","line":377,"column":6,"nodeType":"ArrayExpression","endLine":384,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [state.isSubmitting, state.values, validationSchema, validateForm, onSubmit, resetOnSubmit, resetForm]","fix":{"range":[9375,9495],"text":"[state.isSubmitting, state.values, validationSchema, validateForm, onSubmit, resetOnSubmit, resetForm]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":431,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":431,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10641,10644],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10641,10644],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'steps.length'. Either include it or remove the dependency array.","line":472,"column":6,"nodeType":"ArrayExpression","endLine":472,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [currentStep, steps.length]","fix":{"range":[11758,11771],"text":"[currentStep, steps.length]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useRef, useEffect } from 'react';\r\n\r\ninterface FormErrors {\r\n  [key: string]: string | string[] | null | undefined;\r\n}\r\n\r\ninterface FormState {\r\n  values: Record<string, any>;\r\n  errors: FormErrors;\r\n  touched: Record<string, boolean>;\r\n  isSubmitting: boolean;\r\n  isValidating: boolean;\r\n  submitCount: number;\r\n}\r\n\r\ninterface FormActions {\r\n  setValue: (name: string, value: any, shouldValidate?: boolean) => void;\r\n  setFieldValue: (name: string, value: any, shouldValidate?: boolean) => void;\r\n  setValues: (values: Record<string, any>, shouldValidate?: boolean) => void;\r\n  setError: (name: string, error: string | string[]) => void;\r\n  setErrors: (errors: FormErrors) => void;\r\n  clearError: (name: string) => void;\r\n  clearErrors: () => void;\r\n  setTouched: (name: string, touched?: boolean) => void;\r\n  reset: (values?: Record<string, any>) => void;\r\n  validate: () => boolean;\r\n  validateField: (name: string) => boolean;\r\n  submit: () => Promise<void>;\r\n  resetForm: () => void;\r\n}\r\n\r\n/**\r\n * Hook for managing form states with validation and submission handling\r\n *\r\n * @param options - Form configuration options\r\n * @returns [state, actions] - Current state and actions to modify it\r\n *\r\n * @example\r\n * const [state, actions] = useForm({\r\n *   initialValues: { name: '', email: '' },\r\n *   validationSchema: {\r\n *     name: { required: true, minLength: 2 },\r\n *     email: { required: true, pattern: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/ },\r\n *   },\r\n *   onSubmit: async (values) => {\r\n *     await submitStudent(values);\r\n *   },\r\n * });\r\n *\r\n * // In JSX\r\n * <input\r\n *   value={state.values.name}\r\n *   onChange={(e) => actions.setValue('name', e.target.value)}\r\n *   onBlur={() => actions.setTouched('name')}\r\n * />\r\n * {state.errors.name && <span>{state.errors.name}</span>}\r\n */\r\nexport function useForm(\r\n  options: {\r\n    initialValues?: Record<string, any>;\r\n    validationSchema?: Record<\r\n      string,\r\n      {\r\n        required?: boolean;\r\n        minLength?: number;\r\n        maxLength?: number;\r\n        pattern?: RegExp;\r\n        custom?: (value: any, values: Record<string, any>) => string | null;\r\n      }\r\n    >;\r\n    onSubmit?: (values: Record<string, any>) => Promise<void> | void;\r\n    validateOnChange?: boolean;\r\n    validateOnBlur?: boolean;\r\n    resetOnSubmit?: boolean;\r\n  } = {}\r\n) {\r\n  const {\r\n    initialValues = {},\r\n    validationSchema = {},\r\n    onSubmit,\r\n    validateOnChange = true,\r\n    validateOnBlur = true,\r\n    resetOnSubmit = false,\r\n  } = options;\r\n\r\n  const [state, setState] = useState<FormState>({\r\n    values: initialValues,\r\n    errors: {},\r\n    touched: {},\r\n    isSubmitting: false,\r\n    isValidating: false,\r\n    submitCount: 0,\r\n  });\r\n\r\n  const validationCache = useRef(new Map<string, string | null>());\r\n\r\n  // Validation functions\r\n  const validateField = useCallback(\r\n    (\r\n      name: string,\r\n      value: any,\r\n      values: Record<string, any> = state.values\r\n    ): string | null => {\r\n      const rules = validationSchema[name];\r\n      if (!rules) {\r\n        return null;\r\n      }\r\n\r\n      // Required validation\r\n      if (\r\n        rules.required &&\r\n        (!value || (typeof value === 'string' && value.trim() === ''))\r\n      ) {\r\n        return `${name} is required`;\r\n      }\r\n\r\n      // Skip other validations if value is empty and not required\r\n      if (!value || (typeof value === 'string' && value.trim() === '')) {\r\n        return null;\r\n      }\r\n\r\n      // Min length validation\r\n      if (\r\n        rules.minLength &&\r\n        typeof value === 'string' &&\r\n        value.length < rules.minLength\r\n      ) {\r\n        return `${name} must be at least ${rules.minLength} characters`;\r\n      }\r\n\r\n      // Max length validation\r\n      if (\r\n        rules.maxLength &&\r\n        typeof value === 'string' &&\r\n        value.length > rules.maxLength\r\n      ) {\r\n        return `${name} must be no more than ${rules.maxLength} characters`;\r\n      }\r\n\r\n      // Pattern validation\r\n      if (\r\n        rules.pattern &&\r\n        typeof value === 'string' &&\r\n        !rules.pattern.test(value)\r\n      ) {\r\n        return `${name} format is invalid`;\r\n      }\r\n\r\n      // Custom validation\r\n      if (rules.custom) {\r\n        return rules.custom(value, values);\r\n      }\r\n\r\n      return null;\r\n    },\r\n    [validationSchema]\r\n  );\r\n\r\n  const validateForm = useCallback(\r\n    (values: Record<string, any> = state.values): boolean => {\r\n      const errors: FormErrors = {};\r\n      let isValid = true;\r\n\r\n      // Validate all fields\r\n      Object.keys(validationSchema).forEach((fieldName) => {\r\n        const error = validateField(fieldName, values[fieldName], values);\r\n        if (error) {\r\n          errors[fieldName] = error;\r\n          isValid = false;\r\n        }\r\n      });\r\n\r\n      setState((prev) => ({\r\n        ...prev,\r\n        errors,\r\n        isValidating: false,\r\n      }));\r\n\r\n      return isValid;\r\n    },\r\n    [validationSchema, validateField, state.values]\r\n  );\r\n\r\n  // State update functions\r\n  const setValue = useCallback(\r\n    (name: string, value: any, shouldValidate: boolean = validateOnChange) => {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        values: {\r\n          ...prev.values,\r\n          [name]: value,\r\n        },\r\n      }));\r\n\r\n      if (shouldValidate && state.touched[name]) {\r\n        // Clear validation cache for this field\r\n        validationCache.current.delete(name);\r\n\r\n        // Validate the field\r\n        const error = validateField(name, value);\r\n        setState((prev) => ({\r\n          ...prev,\r\n          errors: {\r\n            ...prev.errors,\r\n            [name]: error,\r\n          },\r\n        }));\r\n      }\r\n    },\r\n    [validateOnChange, state.touched, validateField]\r\n  );\r\n\r\n  // Alias for setValue (for compatibility)\r\n  const setFieldValue = setValue;\r\n\r\n  const setValues = useCallback(\r\n    (\r\n      values: Record<string, any>,\r\n      shouldValidate: boolean = validateOnChange\r\n    ) => {\r\n      const newValues = { ...state.values, ...values };\r\n\r\n      setState((prev) => ({\r\n        ...prev,\r\n        values: newValues,\r\n      }));\r\n\r\n      if (shouldValidate) {\r\n        validateForm(newValues);\r\n      }\r\n    },\r\n    [validateOnChange, validateForm, state.values]\r\n  );\r\n\r\n  const setError = useCallback((name: string, error: string | string[]) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      errors: {\r\n        ...prev.errors,\r\n        [name]: error,\r\n      },\r\n    }));\r\n  }, []);\r\n\r\n  const setErrors = useCallback((errors: FormErrors) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      errors,\r\n    }));\r\n  }, []);\r\n\r\n  const clearError = useCallback((name: string) => {\r\n    setState((prev) => {\r\n      const newErrors = { ...prev.errors };\r\n      delete newErrors[name];\r\n      return {\r\n        ...prev,\r\n        errors: newErrors,\r\n      };\r\n    });\r\n  }, []);\r\n\r\n  const clearErrors = useCallback(() => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      errors: {},\r\n    }));\r\n  }, []);\r\n\r\n  const setTouched = useCallback(\r\n    (name: string, touched: boolean = true) => {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        touched: {\r\n          ...prev.touched,\r\n          [name]: touched,\r\n        },\r\n      }));\r\n\r\n      // Validate on blur if enabled\r\n      if (touched && validateOnBlur) {\r\n        const error = validateField(name, state.values[name]);\r\n        setState((prev) => ({\r\n          ...prev,\r\n          errors: {\r\n            ...prev.errors,\r\n            [name]: error,\r\n          },\r\n        }));\r\n      }\r\n    },\r\n    [validateOnBlur, validateField, state.values]\r\n  );\r\n\r\n  const reset = useCallback(\r\n    (values?: Record<string, any>) => {\r\n      const resetValues = values || initialValues;\r\n\r\n      setState((prev) => ({\r\n        ...prev,\r\n        values: resetValues,\r\n        errors: {},\r\n        touched: {},\r\n        isSubmitting: false,\r\n        isValidating: false,\r\n      }));\r\n\r\n      validationCache.current.clear();\r\n    },\r\n    [initialValues]\r\n  );\r\n\r\n  const resetForm = useCallback(() => {\r\n    setState({\r\n      values: initialValues,\r\n      errors: {},\r\n      touched: {},\r\n      isSubmitting: false,\r\n      isValidating: false,\r\n      submitCount: 0,\r\n    });\r\n\r\n    validationCache.current.clear();\r\n  }, [initialValues]);\r\n\r\n  const submit = useCallback(async () => {\r\n    if (state.isSubmitting) {\r\n      return;\r\n    }\r\n\r\n    // Mark all fields as touched\r\n    const allTouched = Object.keys(validationSchema).reduce(\r\n      (acc, key) => {\r\n        acc[key] = true;\r\n        return acc;\r\n      },\r\n      {} as Record<string, boolean>\r\n    );\r\n\r\n    setState((prev) => ({\r\n      ...prev,\r\n      touched: allTouched,\r\n      isSubmitting: true,\r\n      isValidating: true,\r\n      submitCount: prev.submitCount + 1,\r\n    }));\r\n\r\n    // Validate form\r\n    const isValid = validateForm();\r\n\r\n    if (!isValid) {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isSubmitting: false,\r\n        isValidating: false,\r\n      }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (onSubmit) {\r\n        await onSubmit(state.values);\r\n      }\r\n\r\n      if (resetOnSubmit) {\r\n        resetForm();\r\n      }\r\n    } catch (error) {\r\n      console.error('Form submission error:', error);\r\n    } finally {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isSubmitting: false,\r\n        isValidating: false,\r\n      }));\r\n    }\r\n  }, [\r\n    state.isSubmitting,\r\n    state.values,\r\n    onSubmit,\r\n    resetOnSubmit,\r\n    validateForm,\r\n    resetForm,\r\n  ]);\r\n\r\n  const actions: FormActions = {\r\n    setValue,\r\n    setFieldValue,\r\n    setValues,\r\n    setError,\r\n    setErrors,\r\n    clearError,\r\n    clearErrors,\r\n    setTouched,\r\n    reset,\r\n    validate: () => validateForm(),\r\n    validateField: (name: string) => {\r\n      const error = validateField(name, state.values[name]);\r\n      setState((prev) => ({\r\n        ...prev,\r\n        errors: {\r\n          ...prev.errors,\r\n          [name]: error,\r\n        },\r\n      }));\r\n      return !error;\r\n    },\r\n    submit,\r\n    resetForm,\r\n  };\r\n\r\n  return [state, actions] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing multi-step form states\r\n *\r\n * @param steps - Array of step configurations\r\n * @returns [state, actions] - Current state and actions for step navigation\r\n *\r\n * @example\r\n * const [state, actions] = useMultiStepForm([\r\n *   { title: 'Personal Info', validation: personalValidation },\r\n *   { title: 'Contact Info', validation: contactValidation },\r\n *   { title: 'Preferences', validation: preferencesValidation },\r\n * ]);\r\n */\r\nexport function useMultiStepForm(\r\n  steps: Array<{\r\n    title: string;\r\n    validation?: (values: Record<string, any>) => Record<string, string | null>;\r\n    isOptional?: boolean;\r\n  }>\r\n) {\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [completedSteps, setCompletedSteps] = useState<Set<number>>(new Set());\r\n\r\n  const nextStep = useCallback(() => {\r\n    if (currentStep < steps.length - 1) {\r\n      setCurrentStep((prev) => prev + 1);\r\n    }\r\n  }, [currentStep, steps.length]);\r\n\r\n  const prevStep = useCallback(() => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep((prev) => prev - 1);\r\n    }\r\n  }, [currentStep]);\r\n\r\n  const goToStep = useCallback(\r\n    (stepIndex: number) => {\r\n      if (stepIndex >= 0 && stepIndex < steps.length) {\r\n        setCurrentStep(stepIndex);\r\n      }\r\n    },\r\n    [steps.length]\r\n  );\r\n\r\n  const markStepComplete = useCallback((stepIndex: number) => {\r\n    setCompletedSteps((prev) => new Set([...prev, stepIndex]));\r\n  }, []);\r\n\r\n  const isStepComplete = useCallback(\r\n    (stepIndex: number) => {\r\n      return completedSteps.has(stepIndex);\r\n    },\r\n    [completedSteps]\r\n  );\r\n\r\n  const canGoToNext = useCallback(() => {\r\n    return currentStep < steps.length - 1;\r\n  }, [currentStep]);\r\n\r\n  const canGoToPrev = useCallback(() => {\r\n    return currentStep > 0;\r\n  }, [currentStep]);\r\n\r\n  const getStepStatus = useCallback(\r\n    (stepIndex: number) => {\r\n      if (stepIndex === currentStep) {\r\n        return 'current';\r\n      }\r\n      if (completedSteps.has(stepIndex)) {\r\n        return 'completed';\r\n      }\r\n      if (stepIndex < currentStep) {\r\n        return 'completed';\r\n      }\r\n      return 'upcoming';\r\n    },\r\n    [currentStep, completedSteps]\r\n  );\r\n\r\n  const progress = useCallback(() => {\r\n    return (\r\n      ((completedSteps.size + (currentStep < steps.length - 1 ? 0 : 1)) /\r\n        steps.length) *\r\n      100\r\n    );\r\n  }, [completedSteps.size, currentStep, steps.length]);\r\n\r\n  const actions = {\r\n    nextStep,\r\n    prevStep,\r\n    goToStep,\r\n    markStepComplete,\r\n    isStepComplete,\r\n  };\r\n\r\n  const state = {\r\n    currentStep,\r\n    completedSteps: Array.from(completedSteps),\r\n    canGoToNext: canGoToNext(),\r\n    canGoToPrev: canGoToPrev(),\r\n    totalSteps: steps.length,\r\n    progress: progress(),\r\n    stepStatus: getStepStatus(currentStep),\r\n  };\r\n\r\n  return [state, actions] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing form validation in real-time\r\n *\r\n * @param debounceMs - Debounce delay for validation in milliseconds\r\n * @returns [validateDebounced] - Debounced validation function\r\n */\r\n/**\r\n * Hook for managing form validation in real-time\r\n *\r\n * @param debounceMs - Debounce delay for validation in milliseconds\r\n * @returns [validateDebounced] - Debounced validation function\r\n */\r\nexport function useFormValidation(debounceMs: number = 300) {\r\n  const timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  const validateDebounced = useCallback(\r\n    (validateFn: () => void) => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n\r\n      timeoutRef.current = setTimeout(() => {\r\n        validateFn();\r\n      }, debounceMs);\r\n    },\r\n    [debounceMs]\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return { validateDebounced };\r\n}\r\n\r\nexport default useForm;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useLoadingState.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[132,135],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[132,135],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":11,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[211,214],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[211,214],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1162,1165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1162,1165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3119,3122],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3119,3122],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4097,4100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4097,4100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\r\n\r\ninterface LoadingState {\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  data: any;\r\n}\r\n\r\ninterface LoadingActions {\r\n  start: () => void;\r\n  finish: (data?: any) => void;\r\n  error: (error: string) => void;\r\n  reset: () => void;\r\n}\r\n\r\n/**\r\n * Hook for managing loading states consistently across components\r\n *\r\n * @param initialState - Initial loading state\r\n * @returns [state, actions] - Current state and actions to modify it\r\n *\r\n * @example\r\n * const [state, actions] = useLoadingState();\r\n *\r\n * // In async operation\r\n * actions.start();\r\n * try {\r\n *   const result = await fetchData();\r\n *   actions.finish(result);\r\n * } catch (error) {\r\n *   actions.error('Failed to fetch data');\r\n * }\r\n */\r\nexport function useLoadingState(initialState: Partial<LoadingState> = {}) {\r\n  const [state, setState] = useState<LoadingState>({\r\n    isLoading: false,\r\n    error: null,\r\n    data: null,\r\n    ...initialState,\r\n  });\r\n\r\n  const start = useCallback(() => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isLoading: true,\r\n      error: null,\r\n    }));\r\n  }, []);\r\n\r\n  const finish = useCallback((data?: any) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isLoading: false,\r\n      data: data ?? prev.data,\r\n      error: null,\r\n    }));\r\n  }, []);\r\n\r\n  const error = useCallback((errorMessage: string) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isLoading: false,\r\n      error: errorMessage,\r\n    }));\r\n  }, []);\r\n\r\n  const reset = useCallback(() => {\r\n    setState({\r\n      isLoading: false,\r\n      error: null,\r\n      data: null,\r\n    });\r\n  }, []);\r\n\r\n  const actions: LoadingActions = { start, finish, error, reset };\r\n\r\n  return [state, actions] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing multiple loading states with shared interface\r\n *\r\n * @param states - Object mapping state names to initial states\r\n * @returns [states, actions] - Current states and actions to modify them\r\n *\r\n * @example\r\n * const [states, actions] = useMultipleLoadingStates({\r\n *   fetchStudents: {},\r\n *   exportData: {},\r\n *   generateQRCode: {},\r\n * });\r\n *\r\n * // Use in component\r\n * {states.fetchStudents.isLoading && <Spinner />}\r\n * {states.exportData.error && <ErrorMessage error={states.exportData.error} />}\r\n */\r\nexport function useMultipleLoadingStates<\r\n  T extends Record<string, Partial<LoadingState>>,\r\n>(states: T) {\r\n  const [loadingStates, setLoadingStates] = useState<\r\n    Record<keyof T, LoadingState>\r\n  >(() => {\r\n    const result = {} as Record<keyof T, LoadingState>;\r\n    Object.entries(states).forEach(([key, value]) => {\r\n      result[key as keyof T] = {\r\n        isLoading: false,\r\n        error: null,\r\n        data: null,\r\n        ...value,\r\n      };\r\n    });\r\n    return result;\r\n  });\r\n\r\n  const createActions = useCallback(\r\n    (stateKey: keyof T): LoadingActions => ({\r\n      start: () => {\r\n        setLoadingStates((prev) => ({\r\n          ...prev,\r\n          [stateKey]: {\r\n            ...prev[stateKey],\r\n            isLoading: true,\r\n            error: null,\r\n          },\r\n        }));\r\n      },\r\n      finish: (data?: any) => {\r\n        setLoadingStates((prev) => ({\r\n          ...prev,\r\n          [stateKey]: {\r\n            ...prev[stateKey],\r\n            isLoading: false,\r\n            data: data ?? prev[stateKey].data,\r\n            error: null,\r\n          },\r\n        }));\r\n      },\r\n      error: (errorMessage: string) => {\r\n        setLoadingStates((prev) => ({\r\n          ...prev,\r\n          [stateKey]: {\r\n            ...prev[stateKey],\r\n            isLoading: false,\r\n            error: errorMessage,\r\n          },\r\n        }));\r\n      },\r\n      reset: () => {\r\n        setLoadingStates((prev) => ({\r\n          ...prev,\r\n          [stateKey]: {\r\n            isLoading: false,\r\n            error: null,\r\n            data: null,\r\n          },\r\n        }));\r\n      },\r\n    }),\r\n    []\r\n  );\r\n\r\n  // Create actions object with all state keys\r\n  const actions = Object.keys(states).reduce((acc, key) => {\r\n    acc[key as keyof T] = createActions(key as keyof T);\r\n    return acc;\r\n  }, {} as any);\r\n\r\n  return [loadingStates, actions] as const;\r\n}\r\n\r\nexport default useLoadingState;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useLocalStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useMobileOptimization.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'clearTouchStart'. Either include it or remove the dependency array.","line":150,"column":5,"nodeType":"ArrayExpression","endLine":150,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [touchStart, touchConfig.doubleTapTimeout, touchConfig.scrollThreshold, clearTouchStart]","fix":{"range":[4103,4128],"text":"[touchStart, touchConfig.doubleTapTimeout, touchConfig.scrollThreshold, clearTouchStart]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  useMediaQuery,\n  useWindowSize,\n  useIsomorphicLayoutEffect,\n} from 'usehooks-ts';\nimport { useState, useCallback, useEffect } from 'react';\n\nexport interface BreakpointConfig {\n  mobile: number;\n  tablet: number;\n  desktop: number;\n  large: number;\n}\n\nexport interface MobileOptimizationState {\n  isMobile: boolean;\n  isTablet: boolean;\n  isDesktop: boolean;\n  isLarge: boolean;\n  isExtraLarge: boolean;\n  width: number;\n  height: number;\n  breakpoints: BreakpointConfig;\n  orientation: 'portrait' | 'landscape';\n  pixelRatio: number;\n}\n\nexport const defaultBreakpoints: BreakpointConfig = {\n  mobile: 640, // sm breakpoint\n  tablet: 768, // md breakpoint\n  desktop: 1024, // lg breakpoint\n  large: 1280, // xl breakpoint\n};\n\nexport const useMobileOptimization = (\n  customBreakpoints?: Partial<BreakpointConfig>\n): MobileOptimizationState => {\n  const breakpoints = { ...defaultBreakpoints, ...customBreakpoints };\n\n  // First, get window size\n  const { width: windowWidth, height: windowHeight } = useWindowSize();\n\n  // Then use window dimensions for other calculations\n  const width = windowWidth || 1200;\n  const height = windowHeight || 800;\n  const pixelRatio =\n    typeof window !== 'undefined' ? window.devicePixelRatio : 1;\n  const isLandscape = width > height;\n\n  // Then use media queries (React Hooks)\n  const isMobile = useMediaQuery(`(max-width: ${breakpoints.mobile - 1}px)`);\n  const isTablet = useMediaQuery(\n    `(min-width: ${breakpoints.mobile}px) and (max-width: ${breakpoints.tablet - 1}px)`\n  );\n  const isDesktop = useMediaQuery(\n    `(min-width: ${breakpoints.tablet}px) and (max-width: ${breakpoints.desktop - 1}px)`\n  );\n  const isLarge = useMediaQuery(\n    `(min-width: ${breakpoints.desktop}px) and (max-width: ${breakpoints.large - 1}px)`\n  );\n  const isExtraLarge = useMediaQuery(`(min-width: ${breakpoints.large}px)`);\n\n  return {\n    isMobile,\n    isTablet,\n    isDesktop: isDesktop && !isLarge && !isExtraLarge,\n    isLarge: isLarge && !isExtraLarge,\n    isExtraLarge,\n    width: windowWidth || width,\n    height: windowHeight || height,\n    breakpoints,\n    orientation: isLandscape ? 'landscape' : 'portrait',\n    pixelRatio,\n  };\n};\n\nexport interface TouchOptimizationConfig {\n  minTouchTargetSize: number;\n  gestureSensitivity: number;\n  scrollThreshold: number;\n  doubleTapTimeout: number;\n}\n\nexport const defaultTouchConfig: TouchOptimizationConfig = {\n  minTouchTargetSize: 44, // Apple HIG minimum\n  gestureSensitivity: 0.4,\n  scrollThreshold: 10,\n  doubleTapTimeout: 300,\n};\n\nexport const useTouchOptimization = (\n  config: Partial<TouchOptimizationConfig> = {}\n) => {\n  const touchConfig = { ...defaultTouchConfig, ...config };\n  const [touchStart, setTouchStart] = useState<{\n    x: number;\n    y: number;\n    time: number;\n  } | null>(null);\n\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\n    const touch = e.touches[0];\n    if (!touch) {\n      return;\n    }\n    setTouchStart({\n      x: touch.clientX,\n      y: touch.clientY,\n      time: Date.now(),\n    });\n  }, []);\n\n  const handleTouchEnd = useCallback(\n    (e: React.TouchEvent) => {\n      if (!touchStart) {\n        return;\n      }\n\n      const touch = e.changedTouches[0];\n      if (!touch) {\n        return;\n      }\n      const deltaX = Math.abs(touch.clientX - touchStart.x);\n      const deltaY = Math.abs(touch.clientY - touchStart.y);\n      const deltaTime = Date.now() - touchStart.time;\n\n      // Detect gestures\n      if (deltaTime < touchConfig.doubleTapTimeout) {\n        // Double tap detection\n        if (\n          deltaX < touchConfig.scrollThreshold &&\n          deltaY < touchConfig.scrollThreshold\n        ) {\n          return 'double-tap';\n        }\n      }\n\n      // Swipe detection\n      if (deltaX > deltaY && deltaX > touchConfig.scrollThreshold) {\n        return touch.clientX < touchStart.x ? 'swipe-left' : 'swipe-right';\n      }\n\n      if (deltaY > deltaX && deltaY > touchConfig.scrollThreshold) {\n        return touch.clientY < touchStart.y ? 'swipe-up' : 'swipe-down';\n      }\n\n      clearTouchStart();\n      return undefined;\n    },\n    [touchStart, touchConfig]\n  );\n\n  const clearTouchStart = useCallback(() => {\n    setTouchStart(null);\n  }, []);\n\n  return {\n    handleTouchStart,\n    handleTouchEnd,\n    clearTouchStart,\n    touchConfig,\n  };\n};\n\nexport interface AccessibilityConfig {\n  enableReducedMotion: boolean;\n  fontSize: 'small' | 'medium' | 'large';\n  highContrast: boolean;\n  screenReaderAnnouncement: boolean;\n}\n\nexport const useAccessibility = (): AccessibilityConfig => {\n  const [preferences, setPreferences] = useState<AccessibilityConfig>({\n    enableReducedMotion: false,\n    fontSize: 'medium',\n    highContrast: false,\n    screenReaderAnnouncement: false,\n  });\n\n  useIsomorphicLayoutEffect(() => {\n    // Detect user preferences\n    const prefersReducedMotion = window.matchMedia(\n      '(prefers-reduced-motion: reduce)'\n    ).matches;\n    const prefersHighContrast = window.matchMedia(\n      '(prefers-contrast: high)'\n    ).matches;\n\n    setPreferences((prev) => ({\n      ...prev,\n      enableReducedMotion: prefersReducedMotion,\n      highContrast: prefersHighContrast,\n    }));\n  }, []);\n\n  return preferences;\n};\n\n// Utility functions for responsive design\nexport const getResponsiveClasses = (\n  baseClasses: string,\n  state: MobileOptimizationState\n) => {\n  if (!baseClasses.trim()) {\n    return '';\n  }\n\n  // For mobile-first approach, base classes apply to mobile by default\n  let responsiveClasses = baseClasses;\n\n  // Add tablet-specific classes (md:)\n  if (state.isTablet) {\n    const tabletClasses = baseClasses\n      .split(' ')\n      .map((cls) => `md:${cls}`)\n      .join(' ');\n    responsiveClasses += ` ${tabletClasses}`;\n  }\n\n  // Add desktop-specific classes (lg:)\n  if (state.isDesktop) {\n    const desktopClasses = baseClasses\n      .split(' ')\n      .map((cls) => `lg:${cls}`)\n      .join(' ');\n    responsiveClasses += ` ${desktopClasses}`;\n  }\n\n  // Add large desktop-specific classes (xl:)\n  if (state.isLarge) {\n    const largeClasses = baseClasses\n      .split(' ')\n      .map((cls) => `xl:${cls}`)\n      .join(' ');\n    responsiveClasses += ` ${largeClasses}`;\n  }\n\n  // Add extra large classes (2xl:)\n  if (state.isExtraLarge) {\n    const xlargeClasses = baseClasses\n      .split(' ')\n      .map((cls) => `2xl:${cls}`)\n      .join(' ');\n    responsiveClasses += ` ${xlargeClasses}`;\n  }\n\n  return responsiveClasses.trim();\n};\n\nexport const getOptimalImageSize = (\n  state: MobileOptimizationState,\n  baseWidth: number,\n  baseHeight: number\n) => {\n  const scale = state.isMobile ? 0.7 : state.isTablet ? 0.85 : 1;\n  return {\n    width: Math.floor(baseWidth * scale),\n    height: Math.floor(baseHeight * scale),\n  };\n};\n\n// Custom hook for optimized scroll behavior\nexport const useVirtualScrolling = (\n  itemHeight: number,\n  containerHeight: number\n) => {\n  const [scrollTop, setScrollTop] = useState(0);\n  const [visibleRange, setVisibleRange] = useState({ start: 0, end: 0 });\n\n  useEffect(() => {\n    const start = Math.floor(scrollTop / itemHeight);\n    const visibleCount = Math.ceil(containerHeight / itemHeight);\n    const end = start + visibleCount + 1; // +1 for buffer\n\n    setVisibleRange({ start, end });\n  }, [scrollTop, itemHeight, containerHeight]);\n\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    setScrollTop(e.currentTarget.scrollTop);\n  }, []);\n\n  return {\n    visibleRange,\n    handleScroll,\n    getVisibleItems: <T>(items: T[]) =>\n      items.slice(visibleRange.start, visibleRange.end),\n  };\n};\n\n// Performance optimization hook\nexport const usePerformanceOptimization = () => {\n  const { isMobile, isTablet, isDesktop, isLarge } = useMobileOptimization();\n\n  // Determine performance tier\n  const getPerformanceTier = () => {\n    if (isMobile) {\n      return 'mobile';\n    }\n    if (isTablet) {\n      return 'tablet';\n    }\n    if (isDesktop) {\n      return 'desktop';\n    }\n    if (isLarge) {\n      return 'large';\n    }\n    return 'extra-large';\n  };\n\n  const tier = getPerformanceTier();\n\n  return {\n    tier,\n\n    // Debounce timing based on device capability\n    debounceMs: tier === 'mobile' ? 300 : tier === 'tablet' ? 200 : 100,\n\n    // Animation settings\n    enableAnimations: tier !== 'mobile',\n    reducedMotion: tier === 'mobile',\n\n    // Request limits\n    maxConcurrentRequests:\n      tier === 'mobile'\n        ? 2\n        : tier === 'tablet'\n          ? 4\n          : tier === 'desktop'\n            ? 6\n            : 8,\n\n    // Image optimization\n    lazyLoadingEnabled: tier === 'mobile' || tier === 'tablet',\n    imageQuality: tier === 'mobile' ? 70 : tier === 'tablet' ? 80 : 90,\n\n    // Data management\n    dataReductionMode: tier === 'mobile',\n    itemsPerPage:\n      tier === 'mobile'\n        ? 10\n        : tier === 'tablet'\n          ? 25\n          : tier === 'desktop'\n            ? 50\n            : 100,\n\n    // Virtual scrolling\n    enableVirtualScrolling: tier === 'mobile' || tier === 'tablet',\n\n    // Cache settings\n    cacheSize: tier === 'mobile' ? 50 : tier === 'tablet' ? 100 : 200,\n  };\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useModalState.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":5,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":5,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[102,105],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[102,105],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[178,181],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[178,181],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":12,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[233,236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[233,236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[892,895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[892,895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1076,1079],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1076,1079],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1607,1610],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1607,1610],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3047,3050],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3047,3050],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3565,3568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3565,3568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4295,4298],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4295,4298],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":238,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5819,5822],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5819,5822],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state'. Either include it or remove the dependency array.","line":302,"column":6,"nodeType":"ArrayExpression","endLine":302,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [state, hide]","fix":{"range":[7271,7294],"text":"[state, hide]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state'. Either include it or remove the dependency array.","line":307,"column":6,"nodeType":"ArrayExpression","endLine":307,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [state, hide]","fix":{"range":[7381,7403],"text":"[state, hide]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback } from 'react';\r\n\r\ninterface ModalState {\r\n  isOpen: boolean;\r\n  data: any;\r\n  isClosing: boolean;\r\n}\r\n\r\ninterface ModalActions {\r\n  open: (data?: any) => void;\r\n  close: () => void;\r\n  toggle: (data?: any) => void;\r\n  reset: () => void;\r\n}\r\n\r\n/**\r\n * Hook for managing modal/dialog states consistently across components\r\n *\r\n * @param initialData - Initial data to pass to modal\r\n * @returns [state, actions] - Current state and actions to modify it\r\n *\r\n * @example\r\n * const [state, actions] = useModalState();\r\n *\r\n * // In JSX\r\n * <Dialog open={state.isOpen} onOpenChange={actions.toggle}>\r\n *   <DialogContent>\r\n *     <StudentForm\r\n *       data={state.data}\r\n *       onSave={() => actions.close()}\r\n *     />\r\n *   </DialogContent>\r\n * </Dialog>\r\n *\r\n * // Open with data\r\n * actions.open(studentData);\r\n */\r\nexport function useModalState(initialData: any = null) {\r\n  const [state, setState] = useState<ModalState>({\r\n    isOpen: false,\r\n    data: initialData,\r\n    isClosing: false,\r\n  });\r\n\r\n  const open = useCallback(\r\n    (data?: any) => {\r\n      setState({\r\n        isOpen: true,\r\n        data: data ?? initialData,\r\n        isClosing: false,\r\n      });\r\n    },\r\n    [initialData]\r\n  );\r\n\r\n  const close = useCallback(() => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isClosing: true,\r\n    }));\r\n\r\n    // Delay actual close for animation\r\n    setTimeout(() => {\r\n      setState({\r\n        isOpen: false,\r\n        data: initialData,\r\n        isClosing: false,\r\n      });\r\n    }, 150);\r\n  }, [initialData]);\r\n\r\n  const toggle = useCallback(\r\n    (data?: any) => {\r\n      setState((prev) => {\r\n        if (prev.isOpen) {\r\n          return {\r\n            ...prev,\r\n            isClosing: true,\r\n          };\r\n        }\r\n        return {\r\n          isOpen: true,\r\n          data: data ?? initialData,\r\n          isClosing: false,\r\n        };\r\n      });\r\n\r\n      // Handle closing animation\r\n      if (state.isOpen) {\r\n        setTimeout(() => {\r\n          setState((prev) => ({\r\n            ...prev,\r\n            isOpen: false,\r\n            data: initialData,\r\n            isClosing: false,\r\n          }));\r\n        }, 150);\r\n      }\r\n    },\r\n    [initialData, state.isOpen]\r\n  );\r\n\r\n  const reset = useCallback(() => {\r\n    setState({\r\n      isOpen: false,\r\n      data: initialData,\r\n      isClosing: false,\r\n    });\r\n  }, [initialData]);\r\n\r\n  const actions: ModalActions = { open, close, toggle, reset };\r\n\r\n  return [state, actions] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing multiple modals with shared interface\r\n *\r\n * @param modals - Object mapping modal names to initial data\r\n * @returns [states, actions] - Current states and actions to modify them\r\n *\r\n * @example\r\n * const [states, actions] = useMultipleModals({\r\n *   studentForm: null,\r\n *   deleteConfirm: null,\r\n *   importDialog: null,\r\n * });\r\n *\r\n * // Access specific modal\r\n * const studentModal = states.studentForm;\r\n * actions.studentForm.open(studentData);\r\n */\r\nexport function useMultipleModals<T extends Record<string, any>>(modals: T) {\r\n  const [modalStates, setModalStates] = useState<Record<keyof T, ModalState>>(\r\n    () => {\r\n      const result = {} as Record<keyof T, ModalState>;\r\n      Object.entries(modals).forEach(([key, initialData]) => {\r\n        result[key as keyof T] = {\r\n          isOpen: false,\r\n          data: initialData,\r\n          isClosing: false,\r\n        };\r\n      });\r\n      return result;\r\n    }\r\n  );\r\n\r\n  const createActions = useCallback(\r\n    (modalKey: keyof T): ModalActions => ({\r\n      open: (data?: any) => {\r\n        setModalStates((prev) => ({\r\n          ...prev,\r\n          [modalKey]: {\r\n            isOpen: true,\r\n            data: data ?? modals[modalKey],\r\n            isClosing: false,\r\n          },\r\n        }));\r\n      },\r\n      close: () => {\r\n        setModalStates((prev) => ({\r\n          ...prev,\r\n          [modalKey]: {\r\n            ...prev[modalKey],\r\n            isClosing: true,\r\n          },\r\n        }));\r\n\r\n        setTimeout(() => {\r\n          setModalStates((prev) => ({\r\n            ...prev,\r\n            [modalKey]: {\r\n              isOpen: false,\r\n              data: modals[modalKey],\r\n              isClosing: false,\r\n            },\r\n          }));\r\n        }, 150);\r\n      },\r\n      toggle: (data?: any) => {\r\n        setModalStates((prev) => {\r\n          const currentState = prev[modalKey];\r\n          if (currentState.isOpen) {\r\n            return {\r\n              ...prev,\r\n              [modalKey]: {\r\n                ...currentState,\r\n                isClosing: true,\r\n              },\r\n            };\r\n          }\r\n          return {\r\n            ...prev,\r\n            [modalKey]: {\r\n              isOpen: true,\r\n              data: data ?? modals[modalKey],\r\n              isClosing: false,\r\n            },\r\n          };\r\n        });\r\n\r\n        // Handle closing animation\r\n        setTimeout(() => {\r\n          setModalStates((prev) => {\r\n            const currentState = prev[modalKey];\r\n            if (currentState.isClosing) {\r\n              return {\r\n                ...prev,\r\n                [modalKey]: {\r\n                  isOpen: false,\r\n                  data: modals[modalKey],\r\n                  isClosing: false,\r\n                },\r\n              };\r\n            }\r\n            return prev;\r\n          });\r\n        }, 150);\r\n      },\r\n      reset: () => {\r\n        setModalStates((prev) => ({\r\n          ...prev,\r\n          [modalKey]: {\r\n            isOpen: false,\r\n            data: modals[modalKey],\r\n            isClosing: false,\r\n          },\r\n        }));\r\n      },\r\n    }),\r\n    [modals]\r\n  );\r\n\r\n  // Create actions object with all modal keys\r\n  const actions = Object.keys(modals).reduce((acc, key) => {\r\n    acc[key as keyof T] = createActions(key as keyof T);\r\n    return acc;\r\n  }, {} as any);\r\n\r\n  return [modalStates, actions] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing confirm dialog states\r\n *\r\n * @returns [state, actions] - Current state and actions for confirmation\r\n *\r\n * @example\r\n * const [state, actions] = useConfirmDialog();\r\n *\r\n * // Show confirmation\r\n * actions.show({\r\n *   title: 'Delete Student',\r\n *   message: 'Are you sure you want to delete this student?',\r\n *   onConfirm: () => deleteStudent(studentId),\r\n * });\r\n */\r\nexport function useConfirmDialog() {\r\n  const [state, setState] = useState<{\r\n    isOpen: boolean;\r\n    title: string;\r\n    message: string;\r\n    onConfirm?: () => void;\r\n    onCancel?: () => void;\r\n    confirmText?: string;\r\n    cancelText?: string;\r\n    variant?: 'default' | 'destructive';\r\n  }>({\r\n    isOpen: false,\r\n    title: '',\r\n    message: '',\r\n    confirmText: 'Confirm',\r\n    cancelText: 'Cancel',\r\n    variant: 'default',\r\n  });\r\n\r\n  const show = useCallback(\r\n    (options: {\r\n      title: string;\r\n      message: string;\r\n      onConfirm: () => void;\r\n      onCancel?: () => void;\r\n      confirmText?: string;\r\n      cancelText?: string;\r\n      variant?: 'default' | 'destructive';\r\n    }) => {\r\n      setState({\r\n        isOpen: true,\r\n        ...options,\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const hide = useCallback(() => {\r\n    setState((prev) => ({ ...prev, isOpen: false }));\r\n  }, []);\r\n\r\n  const confirm = useCallback(() => {\r\n    state.onConfirm?.();\r\n    hide();\r\n  }, [state.onConfirm, hide]);\r\n\r\n  const cancel = useCallback(() => {\r\n    state.onCancel?.();\r\n    hide();\r\n  }, [state.onCancel, hide]);\r\n\r\n  return [\r\n    {\r\n      ...state,\r\n      hide,\r\n      confirm,\r\n      cancel,\r\n      show,\r\n    },\r\n  ] as const;\r\n}\r\n\r\nexport default useModalState;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useOfflineSync.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[288,291],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[288,291],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":300,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":300,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8941,8944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8941,8944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":436,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":436,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12598,12601],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12598,12601],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":443,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":443,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12748,12751],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12748,12751],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":450,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":450,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12898,12901],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12898,12901],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { useAppStore } from '@/store/useAppStore';\r\n\r\n// Types for offline storage\r\ninterface OfflineAction {\r\n  id: string;\r\n  type: 'create' | 'update' | 'delete';\r\n  endpoint: string;\r\n  data: any;\r\n  timestamp: number;\r\n  retryCount: number;\r\n  maxRetries: number;\r\n}\r\n\r\n// IndexedDB setup\r\nconst DB_NAME = 'clms-offline-db';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'sync-queue';\r\n\r\nclass OfflineSyncService {\r\n  private db: IDBDatabase | null = null;\r\n  private syncInProgress = false;\r\n  private isOnline = navigator.onLine;\r\n\r\n  constructor() {\r\n    this.initializeDB();\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  private async initializeDB(): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(DB_NAME, DB_VERSION);\r\n\r\n      request.onerror = () => {\r\n        console.error('[OfflineSync] Failed to open database');\r\n        reject(new Error('Failed to open database'));\r\n      };\r\n\r\n      request.onsuccess = () => {\r\n        this.db = request.result;\r\n        console.debug('[OfflineSync] Database initialized');\r\n        resolve();\r\n      };\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result;\r\n\r\n        if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n          const store = db.createObjectStore(STORE_NAME, { keyPath: 'id' });\r\n          store.createIndex('timestamp', 'timestamp', { unique: false });\r\n          store.createIndex('endpoint', 'endpoint', { unique: false });\r\n          store.createIndex('type', 'type', { unique: false });\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  private setupEventListeners(): void {\r\n    // Listen for online/offline events\r\n    window.addEventListener('online', () => {\r\n      this.isOnline = true;\r\n      console.debug('[OfflineSync] Online - attempting to sync');\r\n      this.syncWhenOnline();\r\n    });\r\n\r\n    window.addEventListener('offline', () => {\r\n      this.isOnline = false;\r\n      console.debug('[OfflineSync] Offline - queuing actions');\r\n    });\r\n\r\n    // Listen for service worker messages\r\n    if ('serviceWorker' in navigator) {\r\n      navigator.serviceWorker.addEventListener('message', (event) => {\r\n        if (event.data.type === 'SYNC_REQUEST') {\r\n          this.syncWhenOnline();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Queue an action for offline sync\r\n  async queueAction(\r\n    action: Omit<OfflineAction, 'id' | 'timestamp' | 'retryCount'>\r\n  ): Promise<void> {\r\n    if (!this.db) {\r\n      await this.initializeDB();\r\n    }\r\n\r\n    const offlineAction: OfflineAction = {\r\n      ...action,\r\n      id: `action_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      timestamp: Date.now(),\r\n      retryCount: 0,\r\n    };\r\n\r\n    if (!this.db) {\r\n      throw new Error('Database not initialized');\r\n    }\r\n\r\n    try {\r\n      const transaction = this.db.transaction([STORE_NAME], 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      await store.add(offlineAction);\r\n\r\n      console.debug(\r\n        '[OfflineSync] Action queued:',\r\n        offlineAction.type,\r\n        offlineAction.endpoint\r\n      );\r\n\r\n      // Show notification for queued action\r\n      if (!this.isOnline) {\r\n        toast.info(\"Action saved for when you're back online\");\r\n      }\r\n\r\n      // Update app store with queue count\r\n      await this.updateQueueCount();\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Failed to queue action:', error);\r\n      toast.error('Failed to save action for offline sync');\r\n    }\r\n  }\r\n\r\n  // Get all queued actions\r\n  async getQueuedActions(): Promise<OfflineAction[]> {\r\n    if (!this.db) {\r\n      await this.initializeDB();\r\n    }\r\n\r\n    if (!this.db) {\r\n      throw new Error('Database not initialized');\r\n    }\r\n\r\n    try {\r\n      const transaction = this.db.transaction([STORE_NAME], 'readonly');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      const actions: OfflineAction[] = [];\r\n\r\n      return new Promise((resolve, reject) => {\r\n        const request = store.openCursor();\r\n\r\n        request.onsuccess = (event) => {\r\n          const cursor = (event.target as IDBRequest).result;\r\n          if (cursor) {\r\n            actions.push(cursor.value);\r\n            cursor.continue();\r\n          } else {\r\n            // Sort by timestamp\r\n            resolve(actions.sort((a, b) => a.timestamp - b.timestamp));\r\n          }\r\n        };\r\n\r\n        request.onerror = () =>\r\n          reject(new Error('Failed to fetch queued actions'));\r\n      });\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Failed to get queued actions:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Sync when online\r\n  async syncWhenOnline(): Promise<void> {\r\n    if (!this.isOnline || this.syncInProgress) {\r\n      return;\r\n    }\r\n\r\n    this.syncInProgress = true;\r\n    console.debug('[OfflineSync] Starting sync process');\r\n\r\n    try {\r\n      const actions = await this.getQueuedActions();\r\n\r\n      if (actions.length === 0) {\r\n        console.debug('[OfflineSync] No actions to sync');\r\n        return;\r\n      }\r\n\r\n      toast.info(\r\n        `Syncing ${actions.length} action${actions.length > 1 ? 's' : ''}...`\r\n      );\r\n\r\n      const results = await Promise.allSettled(\r\n        actions.map((action) => this.processAction(action))\r\n      );\r\n\r\n      const successful = results.filter((r) => r.status === 'fulfilled').length;\r\n      const failed = results.filter((r) => r.status === 'rejected').length;\r\n\r\n      // Remove successfully synced actions\r\n      for (let i = 0; i < results.length; i++) {\r\n        const result = results[i];\r\n        const action = actions[i];\r\n        if (result?.status === 'fulfilled' && action) {\r\n          await this.removeAction(action.id);\r\n        }\r\n      }\r\n\r\n      // Update queue count\r\n      await this.updateQueueCount();\r\n\r\n      if (successful > 0) {\r\n        toast.success(\r\n          `Synced ${successful} action${successful > 1 ? 's' : ''}`\r\n        );\r\n      }\r\n\r\n      if (failed > 0) {\r\n        toast.error(`${failed} action${failed > 1 ? 's' : ''} failed to sync`);\r\n      }\r\n\r\n      console.debug(\r\n        `[OfflineSync] Sync completed: ${successful} successful, ${failed} failed`\r\n      );\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Sync failed:', error);\r\n      toast.error('Failed to sync offline actions');\r\n    } finally {\r\n      this.syncInProgress = false;\r\n    }\r\n  }\r\n\r\n  // Process individual action\r\n  private async processAction(action: OfflineAction): Promise<void> {\r\n    const { endpoint, type, data, retryCount, maxRetries } = action;\r\n\r\n    try {\r\n      const options: RequestInit = {\r\n        method:\r\n          type === 'create' ? 'POST' : type === 'update' ? 'PUT' : 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          // Add auth headers if available\r\n          ...(localStorage.getItem('token') && {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n          }),\r\n        },\r\n        ...(type !== 'delete' && { body: JSON.stringify(data) }),\r\n      };\r\n\r\n      const response = await fetch(endpoint, options);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      console.debug('[OfflineSync] Action synced successfully:', action.id);\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Action sync failed:', action.id, error);\r\n\r\n      // Update retry count\r\n      if (retryCount < maxRetries) {\r\n        await this.updateActionRetry(action.id, retryCount + 1);\r\n        console.debug(\r\n          `[OfflineSync] Action ${action.id} will be retried (${retryCount + 1}/${maxRetries})`\r\n        );\r\n        throw error; // Will be retried\r\n      } else {\r\n        // Max retries reached, remove action\r\n        await this.removeAction(action.id);\r\n        console.error(\r\n          `[OfflineSync] Action ${action.id} failed after ${maxRetries} retries`\r\n        );\r\n        toast.error('Action failed to sync and was removed');\r\n      }\r\n    }\r\n  }\r\n\r\n  // Remove action from queue\r\n  private async removeAction(id: string): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const transaction = this.db.transaction([STORE_NAME], 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      await store.delete(id);\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Failed to remove action:', error);\r\n    }\r\n  }\r\n\r\n  // Update action retry count\r\n  private async updateActionRetry(\r\n    id: string,\r\n    retryCount: number\r\n  ): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const transaction = this.db.transaction([STORE_NAME], 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n\r\n      const action = await store.get(id);\r\n      if (action) {\r\n        (action as any).retryCount = retryCount;\r\n        await store.put(action);\r\n      }\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Failed to update action retry:', error);\r\n    }\r\n  }\r\n\r\n  // Get queue count for UI\r\n  private async updateQueueCount(): Promise<void> {\r\n    const actions = await this.getQueuedActions();\r\n    useAppStore.getState().setOfflineQueueCount(actions.length);\r\n  }\r\n\r\n  // Clear all queued actions\r\n  async clearQueue(): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const transaction = this.db.transaction([STORE_NAME], 'readwrite');\r\n      const store = transaction.objectStore(STORE_NAME);\r\n      await store.clear();\r\n\r\n      await this.updateQueueCount();\r\n      console.debug('[OfflineSync] Queue cleared');\r\n      toast.success('Offline queue cleared');\r\n    } catch (error) {\r\n      console.error('[OfflineSync] Failed to clear queue:', error);\r\n      toast.error('Failed to clear offline queue');\r\n    }\r\n  }\r\n\r\n  // Get sync status\r\n  getSyncStatus(): {\r\n    isOnline: boolean;\r\n    queueCount: number;\r\n    lastSync: number | null;\r\n  } {\r\n    return {\r\n      isOnline: this.isOnline,\r\n      queueCount: useAppStore.getState().offlineQueueCount,\r\n      lastSync: useAppStore.getState().lastSyncTime,\r\n    };\r\n  }\r\n}\r\n\r\n// React hook for offline sync\r\nexport const useOfflineSync = () => {\r\n  const [syncService] = useState(() => new OfflineSyncService());\r\n  const [queueCount, setQueueCount] = useState(0);\r\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\r\n  const [lastSync, setLastSync] = useState<number | null>(null);\r\n\r\n  // Update sync status\r\n  const updateSyncStatus = useCallback(() => {\r\n    const status = syncService.getSyncStatus();\r\n    setQueueCount(status.queueCount);\r\n    setIsOnline(status.isOnline);\r\n    setLastSync(status.lastSync);\r\n  }, [syncService]);\r\n\r\n  // Listen for online/offline events\r\n  useEffect(() => {\r\n    const handleOnline = () => {\r\n      setIsOnline(true);\r\n      updateSyncStatus();\r\n    };\r\n\r\n    const handleOffline = () => {\r\n      setIsOnline(false);\r\n      updateSyncStatus();\r\n    };\r\n\r\n    window.addEventListener('online', handleOnline);\r\n    window.addEventListener('offline', handleOffline);\r\n\r\n    // Initial update\r\n    updateSyncStatus();\r\n\r\n    // Periodic update\r\n    const interval = setInterval(updateSyncStatus, 5000);\r\n\r\n    return () => {\r\n      window.removeEventListener('online', handleOnline);\r\n      window.removeEventListener('offline', handleOffline);\r\n      clearInterval(interval);\r\n    };\r\n  }, [updateSyncStatus]);\r\n\r\n  // Queue actions\r\n  const queueAction = useCallback(\r\n    async (action: Omit<OfflineAction, 'id' | 'timestamp' | 'retryCount'>) => {\r\n      await syncService.queueAction(action);\r\n      updateSyncStatus();\r\n    },\r\n    [syncService, updateSyncStatus]\r\n  );\r\n\r\n  // Manual sync\r\n  const syncNow = useCallback(async () => {\r\n    if (isOnline) {\r\n      await syncService.syncWhenOnline();\r\n      setLastSync(Date.now());\r\n      updateSyncStatus();\r\n    } else {\r\n      toast.error('Cannot sync while offline');\r\n    }\r\n  }, [syncService, isOnline, updateSyncStatus]);\r\n\r\n  // Clear queue\r\n  const clearQueue = useCallback(async () => {\r\n    await syncService.clearQueue();\r\n    updateSyncStatus();\r\n  }, [syncService, updateSyncStatus]);\r\n\r\n  return {\r\n    // State\r\n    isOnline,\r\n    queueCount,\r\n    lastSync,\r\n\r\n    // Actions\r\n    queueAction,\r\n    syncNow,\r\n    clearQueue,\r\n\r\n    // Utilities\r\n    updateSyncStatus,\r\n  };\r\n};\r\n\r\n// Utility functions for common offline operations\r\nexport const offlineAPI = {\r\n  // Queue API calls\r\n  queueCreate: (endpoint: string, data: any, maxRetries = 3) => ({\r\n    type: 'create' as const,\r\n    endpoint,\r\n    data,\r\n    maxRetries,\r\n  }),\r\n\r\n  queueUpdate: (endpoint: string, data: any, maxRetries = 3) => ({\r\n    type: 'update' as const,\r\n    endpoint,\r\n    data,\r\n    maxRetries,\r\n  }),\r\n\r\n  queueDelete: (endpoint: string, data: any, maxRetries = 3) => ({\r\n    type: 'delete' as const,\r\n    endpoint,\r\n    data,\r\n    maxRetries,\r\n  }),\r\n\r\n  // Check if request should be cached\r\n  shouldCache: (url: string): boolean => {\r\n    const cacheablePatterns = [\r\n      /\\/api\\/students/,\r\n      /\\/api\\/books/,\r\n      /\\/api\\/equipment/,\r\n      /\\/api\\/activities/,\r\n      /\\/api\\/analytics/,\r\n    ];\r\n\r\n    return cacheablePatterns.some((pattern) => pattern.test(url));\r\n  },\r\n\r\n  // Check if request should be queued for offline\r\n  shouldQueue: (method: string, url: string): boolean => {\r\n    const queueableMethods = ['POST', 'PUT', 'DELETE', 'PATCH'];\r\n    const queueablePatterns = [\r\n      /\\/api\\/students/,\r\n      /\\/api\\/books/,\r\n      /\\/api\\/equipment/,\r\n      /\\/api\\/activities/,\r\n    ];\r\n\r\n    return (\r\n      queueableMethods.includes(method.toUpperCase()) &&\r\n      queueablePatterns.some((pattern) => pattern.test(url))\r\n    );\r\n  },\r\n};\r\n\r\nexport default OfflineSyncService;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\usePerformance.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[767,770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[767,770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2617,2620],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2617,2620],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2678,2681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2678,2681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2771,2774],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2771,2774],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2801,2804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2801,2804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3469,3472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3469,3472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3521,3524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3521,3524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":228,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7017,7020],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7017,7020],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":398,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":398,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11611,11614],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11611,11614],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance Hooks for CLMS Frontend\r\n *\r\n * This module provides performance monitoring and optimization hooks\r\n * for tracking render performance, API calls, and user interactions.\r\n */\r\n\r\nimport { useEffect, useRef, useCallback, useState } from 'react';\r\nimport {\r\n  useMutation,\r\n  useQuery,\r\n  type UseQueryOptions,\r\n} from '@tanstack/react-query';\r\n\r\n// Performance monitoring types\r\ninterface PerformanceMetrics {\r\n  renderTime: number;\r\n  componentMountTime: number;\r\n  apiCallTime: number;\r\n  interactionTime: number;\r\n  memoryUsage: number;\r\n  bundleSize: number;\r\n}\r\n\r\ninterface HookPerformanceEntry {\r\n  name: string;\r\n  startTime: number;\r\n  duration: number;\r\n  type: 'render' | 'api' | 'interaction' | 'navigation';\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\ninterface PerformanceConfig {\r\n  enableMonitoring: boolean;\r\n  enableAPITracking: boolean;\r\n  enableRenderTracking: boolean;\r\n  enableInteractionTracking: boolean;\r\n  sampleRate: number;\r\n  maxEntries: number;\r\n  reportingEndpoint?: string;\r\n}\r\n\r\n// Performance monitoring configuration\r\nconst PERFORMANCE_CONFIG: PerformanceConfig = {\r\n  enableMonitoring:\r\n    import.meta.env.PROD ||\r\n    import.meta.env.VITE_ENABLE_PERFORMANCE_MONITORING === 'true',\r\n  enableAPITracking: import.meta.env.VITE_ENABLE_API_TRACKING !== 'false',\r\n  enableRenderTracking: import.meta.env.VITE_ENABLE_RENDER_TRACKING !== 'false',\r\n  enableInteractionTracking:\r\n    import.meta.env.VITE_ENABLE_INTERACTION_TRACKING !== 'false',\r\n  sampleRate: parseFloat(import.meta.env.VITE_PERFORMANCE_SAMPLE_RATE || '0.1'), // 10% sampling\r\n  maxEntries: 100,\r\n  reportingEndpoint: import.meta.env.VITE_PERFORMANCE_ENDPOINT,\r\n};\r\n\r\n// Global performance store\r\nclass PerformanceStore {\r\n  private entries: HookPerformanceEntry[] = [];\r\n  private observers: PerformanceObserver[] = [];\r\n  private isSupported =\r\n    'performance' in window && 'PerformanceObserver' in window;\r\n\r\n  constructor() {\r\n    if (this.isSupported && PERFORMANCE_CONFIG.enableMonitoring) {\r\n      this.setupObservers();\r\n    }\r\n  }\r\n\r\n  private setupObservers(): void {\r\n    try {\r\n      // Observer for navigation timing\r\n      const navObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (entry.entryType === 'navigation') {\r\n            this.addEntry({\r\n              name: 'page-navigation',\r\n              startTime: entry.startTime,\r\n              duration: entry.duration,\r\n              type: 'navigation',\r\n              metadata: {\r\n                domContentLoaded:\r\n                  (entry as any).domContentLoadedEventEnd -\r\n                  (entry as any).domContentLoadedEventStart,\r\n                loadComplete:\r\n                  (entry as any).loadEventEnd - (entry as any).loadEventStart,\r\n              },\r\n            });\r\n          }\r\n        });\r\n      });\r\n      navObserver.observe({ entryTypes: ['navigation'] });\r\n      this.observers.push(navObserver);\r\n\r\n      // Observer for resource timing\r\n      const resourceObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (entry.entryType === 'resource') {\r\n            this.addEntry({\r\n              name: entry.name,\r\n              startTime: entry.startTime,\r\n              duration: entry.duration,\r\n              type: 'api',\r\n              metadata: {\r\n                size: (entry as any).transferSize,\r\n                type: (entry as any).initiatorType,\r\n              },\r\n            });\r\n          }\r\n        });\r\n      });\r\n      resourceObserver.observe({ entryTypes: ['resource'] });\r\n      this.observers.push(resourceObserver);\r\n\r\n      // Observer for paint timing\r\n      const paintObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (entry.entryType === 'paint') {\r\n            this.addEntry({\r\n              name: entry.name,\r\n              startTime: entry.startTime,\r\n              duration: 0,\r\n              type: 'render',\r\n              metadata: { type: 'paint' },\r\n            });\r\n          }\r\n        });\r\n      });\r\n      paintObserver.observe({ entryTypes: ['paint'] });\r\n      this.observers.push(paintObserver);\r\n    } catch (error) {\r\n      console.warn('Performance observers setup failed:', error);\r\n    }\r\n  }\r\n\r\n  addEntry(entry: HookPerformanceEntry): void {\r\n    if (!PERFORMANCE_CONFIG.enableMonitoring) {\r\n      return;\r\n    }\r\n\r\n    // Sample rate filtering\r\n    if (Math.random() > PERFORMANCE_CONFIG.sampleRate) {\r\n      return;\r\n    }\r\n\r\n    this.entries.push(entry);\r\n\r\n    // Keep only the most recent entries\r\n    if (this.entries.length > PERFORMANCE_CONFIG.maxEntries) {\r\n      this.entries = this.entries.slice(-PERFORMANCE_CONFIG.maxEntries);\r\n    }\r\n\r\n    // Report to endpoint if configured\r\n    if (PERFORMANCE_CONFIG.reportingEndpoint) {\r\n      this.reportEntry(entry);\r\n    }\r\n  }\r\n\r\n  private async reportEntry(entry: HookPerformanceEntry): Promise<void> {\r\n    try {\r\n      if (!navigator.sendBeacon) {\r\n        return;\r\n      }\r\n\r\n      const data = {\r\n        ...entry,\r\n        url: window.location.href,\r\n        userAgent: navigator.userAgent,\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      // reportingEndpoint is validated as non-null by the if statement above\r\n      navigator.sendBeacon(\r\n        PERFORMANCE_CONFIG.reportingEndpoint,\r\n        JSON.stringify(data)\r\n      );\r\n    } catch (error) {\r\n      console.warn('Performance reporting failed:', error);\r\n    }\r\n  }\r\n\r\n  getEntries(type?: HookPerformanceEntry['type']): HookPerformanceEntry[] {\r\n    if (type) {\r\n      return this.entries.filter((entry) => entry.type === type);\r\n    }\r\n    return [...this.entries];\r\n  }\r\n\r\n  getMetrics(): PerformanceMetrics {\r\n    const renderEntries = this.getEntries('render');\r\n    const apiEntries = this.getEntries('api');\r\n    const interactionEntries = this.getEntries('interaction');\r\n\r\n    const avgRenderTime =\r\n      renderEntries.length > 0\r\n        ? renderEntries.reduce((sum, entry) => sum + entry.duration, 0) /\r\n          renderEntries.length\r\n        : 0;\r\n\r\n    const avgApiTime =\r\n      apiEntries.length > 0\r\n        ? apiEntries.reduce((sum, entry) => sum + entry.duration, 0) /\r\n          apiEntries.length\r\n        : 0;\r\n\r\n    const avgInteractionTime =\r\n      interactionEntries.length > 0\r\n        ? interactionEntries.reduce((sum, entry) => sum + entry.duration, 0) /\r\n          interactionEntries.length\r\n        : 0;\r\n\r\n    return {\r\n      renderTime: avgRenderTime,\r\n      componentMountTime:\r\n        renderEntries.find((e) => e.name === 'component-mount')?.duration || 0,\r\n      apiCallTime: avgApiTime,\r\n      interactionTime: avgInteractionTime,\r\n      memoryUsage: this.getMemoryUsage(),\r\n      bundleSize: this.getBundleSize(),\r\n    };\r\n  }\r\n\r\n  private getMemoryUsage(): number {\r\n    if ('memory' in performance) {\r\n      return (performance as any).memory.usedJSHeapSize / 1024 / 1024; // MB\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  private getBundleSize(): number {\r\n    // This would be calculated from the actual bundle size\r\n    // For now, return an estimated value\r\n    return 2.5; // MB\r\n  }\r\n\r\n  clear(): void {\r\n    this.entries = [];\r\n  }\r\n\r\n  destroy(): void {\r\n    this.observers.forEach((observer) => observer.disconnect());\r\n    this.observers = [];\r\n    this.entries = [];\r\n  }\r\n}\r\n\r\n// Global performance store instance\r\nconst performanceStore = new PerformanceStore();\r\n\r\n// Performance hooks\r\nexport const usePerformanceMonitor = (componentName: string) => {\r\n  const mountTime = useRef<number>(0);\r\n  const renderCount = useRef<number>(0);\r\n\r\n  useEffect(() => {\r\n    mountTime.current = performance.now();\r\n    renderCount.current = 0;\r\n\r\n    // Track component mount\r\n    if (PERFORMANCE_CONFIG.enableRenderTracking) {\r\n      performanceStore.addEntry({\r\n        name: 'component-mount',\r\n        startTime: 0,\r\n        duration: 0,\r\n        type: 'render',\r\n        metadata: { component: componentName },\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      const duration = performance.now() - mountTime.current;\r\n\r\n      if (PERFORMANCE_CONFIG.enableRenderTracking) {\r\n        performanceStore.addEntry({\r\n          name: 'component-unmount',\r\n          startTime: mountTime.current,\r\n          duration,\r\n          type: 'render',\r\n          metadata: {\r\n            component: componentName,\r\n            renderCount: renderCount.current,\r\n          },\r\n        });\r\n      }\r\n    };\r\n  }, [componentName]);\r\n\r\n  useEffect(() => {\r\n    renderCount.current++;\r\n\r\n    if (PERFORMANCE_CONFIG.enableRenderTracking && renderCount.current > 1) {\r\n      performanceStore.addEntry({\r\n        name: 'component-render',\r\n        startTime: 0,\r\n        duration: 0,\r\n        type: 'render',\r\n        metadata: {\r\n          component: componentName,\r\n          renderCount: renderCount.current,\r\n        },\r\n      });\r\n    }\r\n  });\r\n\r\n  const trackInteraction = useCallback(\r\n    (interactionName: string, startTime?: number) => {\r\n      if (!PERFORMANCE_CONFIG.enableInteractionTracking) {\r\n        return;\r\n      }\r\n\r\n      const start = startTime || performance.now();\r\n\r\n      return {\r\n        end: () => {\r\n          const duration = performance.now() - start;\r\n          performanceStore.addEntry({\r\n            name: interactionName,\r\n            startTime: start,\r\n            duration,\r\n            type: 'interaction',\r\n            metadata: { component: componentName },\r\n          });\r\n        },\r\n      };\r\n    },\r\n    [componentName]\r\n  );\r\n\r\n  return {\r\n    trackInteraction,\r\n    renderCount: renderCount.current,\r\n    mountTime: mountTime.current,\r\n  };\r\n};\r\n\r\n// Enhanced query hook with performance tracking\r\nexport const useTrackedQuery = <T>(\r\n  queryKey: string[],\r\n  queryFn: () => Promise<T>,\r\n  options?: UseQueryOptions<T>\r\n) => {\r\n  const startTime = useRef<number>(0);\r\n\r\n  const query = useQuery({\r\n    queryKey,\r\n    queryFn: () => {\r\n      startTime.current = performance.now();\r\n      return queryFn();\r\n    },\r\n    ...options,\r\n  });\r\n\r\n  // Handle success/error with useEffect (React Query v5 pattern)\r\n  useEffect(() => {\r\n    if (PERFORMANCE_CONFIG.enableAPITracking && startTime.current) {\r\n      const duration = performance.now() - startTime.current;\r\n\r\n      if (query.isSuccess && query.data !== undefined) {\r\n        performanceStore.addEntry({\r\n          name: `api-${Array.isArray(queryKey) ? queryKey.join('-') : String(queryKey)}`,\r\n          startTime: startTime.current,\r\n          duration,\r\n          type: 'api',\r\n          metadata: {\r\n            queryKey: Array.isArray(queryKey)\r\n              ? queryKey.join('.')\r\n              : String(queryKey),\r\n            success: true,\r\n          },\r\n        });\r\n      } else if (query.isError) {\r\n        performanceStore.addEntry({\r\n          name: `api-${Array.isArray(queryKey) ? queryKey.join('-') : String(queryKey)}`,\r\n          startTime: startTime.current,\r\n          duration,\r\n          type: 'api',\r\n          metadata: {\r\n            queryKey: Array.isArray(queryKey)\r\n              ? queryKey.join('.')\r\n              : String(queryKey),\r\n            success: false,\r\n            error: query.error?.message || 'Unknown error',\r\n          },\r\n        });\r\n      }\r\n    }\r\n  }, [query.isSuccess, query.isError, query.data, query.error, queryKey]);\r\n\r\n  return query;\r\n};\r\n\r\n// Enhanced mutation hook with performance tracking\r\nexport const useTrackedMutation = <T, V>(\r\n  mutationFn: (variables: V) => Promise<T>,\r\n  options?: any\r\n) => {\r\n  const startTime = useRef<number>(0);\r\n\r\n  const mutation = useMutation({\r\n    mutationFn,\r\n    onMutate: async (variables: V) => {\r\n      startTime.current = performance.now();\r\n      return options?.onMutate?.(variables);\r\n    },\r\n    ...options,\r\n  });\r\n\r\n  // Handle success/error with useEffect (React Query v5 pattern)\r\n  useEffect(() => {\r\n    if (PERFORMANCE_CONFIG.enableAPITracking && startTime.current) {\r\n      const duration = performance.now() - startTime.current;\r\n\r\n      if (mutation.isSuccess && mutation.data !== undefined) {\r\n        performanceStore.addEntry({\r\n          name: `mutation-${mutationFn.name || 'unknown'}`,\r\n          startTime: startTime.current,\r\n          duration,\r\n          type: 'api',\r\n          metadata: {\r\n            success: true,\r\n            variables: mutation.variables\r\n              ? JSON.stringify(mutation.variables)?.slice(0, 100)\r\n              : '', // Limit size\r\n          },\r\n        });\r\n      } else if (mutation.isError) {\r\n        performanceStore.addEntry({\r\n          name: `mutation-${mutationFn.name || 'unknown'}`,\r\n          startTime: startTime.current,\r\n          duration,\r\n          type: 'api',\r\n          metadata: {\r\n            success: false,\r\n            error: mutation.error?.message || 'Unknown error',\r\n            variables: mutation.variables\r\n              ? JSON.stringify(mutation.variables)?.slice(0, 100)\r\n              : '',\r\n          },\r\n        });\r\n      }\r\n    }\r\n  }, [\r\n    mutation.isSuccess,\r\n    mutation.isError,\r\n    mutation.data,\r\n    mutation.error,\r\n    mutation.variables,\r\n    mutationFn.name,\r\n  ]);\r\n\r\n  return mutation;\r\n};\r\n\r\n// Hook for lazy loading with performance tracking\r\nexport const useLazyLoad = <T>(\r\n  loader: () => Promise<T>,\r\n  options: {\r\n    threshold?: number;\r\n    rootMargin?: string;\r\n    triggerOnce?: boolean;\r\n  } = {}\r\n) => {\r\n  const [data, setData] = useState<T | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const elementRef = useRef<HTMLElement | null>(null);\r\n\r\n  const { threshold = 0.1, rootMargin = '0px', triggerOnce = true } = options;\r\n\r\n  useEffect(() => {\r\n    const element = elementRef.current;\r\n    if (!element) {\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      async (entries) => {\r\n        const [entry] = entries;\r\n\r\n        if (entry && entry.isIntersecting) {\r\n          setLoading(true);\r\n          setError(null);\r\n\r\n          const startTime = performance.now();\r\n\r\n          try {\r\n            const loadedData = await loader();\r\n            const duration = performance.now() - startTime;\r\n\r\n            setData(loadedData);\r\n\r\n            if (PERFORMANCE_CONFIG.enableMonitoring) {\r\n              performanceStore.addEntry({\r\n                name: 'lazy-load',\r\n                startTime,\r\n                duration,\r\n                type: 'interaction',\r\n                metadata: {\r\n                  dataType: typeof loadedData,\r\n                  size: JSON.stringify(loadedData).length,\r\n                },\r\n              });\r\n            }\r\n          } catch (err) {\r\n            setError(err as Error);\r\n          } finally {\r\n            setLoading(false);\r\n\r\n            if (triggerOnce) {\r\n              observer.unobserve(element);\r\n            }\r\n          }\r\n        }\r\n      },\r\n      { threshold, rootMargin }\r\n    );\r\n\r\n    observer.observe(element);\r\n\r\n    return () => {\r\n      observer.unobserve(element);\r\n    };\r\n  }, [loader, threshold, rootMargin, triggerOnce]);\r\n\r\n  return {\r\n    ref: elementRef,\r\n    data,\r\n    loading,\r\n    error,\r\n  };\r\n};\r\n\r\n// Hook for image optimization and lazy loading\r\nexport const useOptimizedImage = (\r\n  src: string,\r\n  options: {\r\n    placeholder?: string;\r\n    threshold?: number;\r\n    sizes?: string;\r\n    quality?: number;\r\n  } = {}\r\n) => {\r\n  const [imageSrc, setImageSrc] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n\r\n  const {\r\n    placeholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMCAyNkMxNy4yMzg2IDI2IDE1IDIzLjc2MTQgMTUgMjFDMTUgMTguMjM4NiAxNy4yMzg2IDE2IDIwIDE2QzIyLjc2MTQgMTYgMjUgMTguMjM4NiAyNSAyMUMyNSAyMy43NjE0IDIyLjc2MTQgMjYgMjAgMjZaIiBmaWxsPSIjOUNBM0FGIi8+Cjwvc3ZnPg==',\r\n    threshold = 0.1,\r\n    sizes = '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw',\r\n    quality = 75,\r\n  } = options;\r\n\r\n  useEffect(() => {\r\n    const image = imgRef.current;\r\n    if (!image) {\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      async (entries) => {\r\n        const [entry] = entries;\r\n\r\n        if (entry && entry.isIntersecting) {\r\n          const startTime = performance.now();\r\n\r\n          try {\r\n            // Create optimized image URL with quality parameter\r\n            const optimizedSrc = `${src}?auto=format&fit=crop&w=${image.offsetWidth}&h=${image.offsetHeight}&q=${quality}`;\r\n\r\n            await new Promise((resolve, reject) => {\r\n              const img = new Image();\r\n              img.onload = resolve;\r\n              img.onerror = reject;\r\n              img.src = optimizedSrc;\r\n            });\r\n\r\n            setImageSrc(optimizedSrc);\r\n            setIsLoading(false);\r\n\r\n            if (PERFORMANCE_CONFIG.enableMonitoring) {\r\n              const duration = performance.now() - startTime;\r\n              performanceStore.addEntry({\r\n                name: 'image-load',\r\n                startTime,\r\n                duration,\r\n                type: 'interaction',\r\n                metadata: {\r\n                  src: src.split('/').pop(),\r\n                  size: `${image.offsetWidth}x${image.offsetHeight}`,\r\n                  quality,\r\n                },\r\n              });\r\n            }\r\n          } catch (err) {\r\n            setError(err as Error);\r\n            setIsLoading(false);\r\n          }\r\n\r\n          observer.unobserve(image);\r\n        }\r\n      },\r\n      { threshold }\r\n    );\r\n\r\n    observer.observe(image);\r\n\r\n    return () => {\r\n      observer.unobserve(image);\r\n    };\r\n  }, [src, threshold, quality]);\r\n\r\n  return {\r\n    ref: imgRef,\r\n    src: imageSrc || placeholder,\r\n    isLoading,\r\n    error,\r\n    sizes,\r\n  };\r\n};\r\n\r\n// Hook for performance metrics\r\nexport const usePerformanceMetrics = () => {\r\n  const [metrics, setMetrics] = useState<PerformanceMetrics>(() =>\r\n    performanceStore.getMetrics()\r\n  );\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setMetrics(performanceStore.getMetrics());\r\n    }, 5000); // Update every 5 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const clearMetrics = useCallback(() => {\r\n    performanceStore.clear();\r\n    setMetrics(performanceStore.getMetrics());\r\n  }, []);\r\n\r\n  return {\r\n    metrics,\r\n    clearMetrics,\r\n    getEntries: performanceStore.getEntries.bind(performanceStore),\r\n  };\r\n};\r\n\r\n// Utility function to measure performance\r\nexport const measurePerformance = <T>(\r\n  name: string,\r\n  fn: () => T | Promise<T>\r\n): T | Promise<T> => {\r\n  if (!PERFORMANCE_CONFIG.enableMonitoring) {\r\n    return fn();\r\n  }\r\n\r\n  const startTime = performance.now();\r\n\r\n  if (fn.constructor.name === 'AsyncFunction') {\r\n    return (async () => {\r\n      try {\r\n        const result = await fn();\r\n        const duration = performance.now() - startTime;\r\n\r\n        performanceStore.addEntry({\r\n          name,\r\n          startTime,\r\n          duration,\r\n          type: 'interaction',\r\n        });\r\n\r\n        return result;\r\n      } catch (error) {\r\n        const duration = performance.now() - startTime;\r\n\r\n        performanceStore.addEntry({\r\n          name,\r\n          startTime,\r\n          duration,\r\n          type: 'interaction',\r\n          metadata: { success: false, error: (error as Error).message },\r\n        });\r\n\r\n        throw error;\r\n      }\r\n    })();\r\n  } else {\r\n    try {\r\n      const result = fn();\r\n      const duration = performance.now() - startTime;\r\n\r\n      performanceStore.addEntry({\r\n        name,\r\n        startTime,\r\n        duration,\r\n        type: 'interaction',\r\n      });\r\n\r\n      return result;\r\n    } catch (error) {\r\n      const duration = performance.now() - startTime;\r\n\r\n      performanceStore.addEntry({\r\n        name,\r\n        startTime,\r\n        duration,\r\n        type: 'interaction',\r\n        metadata: { success: false, error: (error as Error).message },\r\n      });\r\n\r\n      throw error;\r\n    }\r\n  }\r\n};\r\n\r\n// Export performance store for advanced usage\r\nexport { performanceStore };\r\nexport default performanceStore;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\usePerformanceMonitor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":340,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":340,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8835,8838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8835,8838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":354,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":354,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9324,9327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9324,9327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":355,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":355,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9384,9387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9384,9387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":402,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":402,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10719,10722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10719,10722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback, useState } from 'react';\r\nimport { performanceMonitor } from '@/lib/performance-monitor';\r\n\r\n/**\r\n * Hook for performance monitoring with automatic cleanup\r\n */\r\nexport function usePerformanceMonitor(componentName?: string) {\r\n  const metricsRef = useRef<string[]>([]);\r\n\r\n  // Start timing when component mounts\r\n  useEffect(() => {\r\n    const mountTime = performance.now();\r\n    const entryId = performanceMonitor.start('component_mount', {\r\n      componentName: componentName || 'unknown',\r\n    });\r\n\r\n    return () => {\r\n      // Record unmount time\r\n      const unmountTime = performance.now();\r\n      const duration = unmountTime - mountTime;\r\n\r\n      performanceMonitor.end(entryId);\r\n      performanceMonitor.recordMetric('component_lifetime', duration, {\r\n        type: 'duration',\r\n        unit: 'ms',\r\n        tags: { componentName: componentName || 'unknown' },\r\n      });\r\n    };\r\n  }, [componentName]);\r\n\r\n  const startTiming = useCallback(\r\n    (name: string, metadata?: Record<string, unknown>) => {\r\n      const id = performanceMonitor.start(name, {\r\n        ...metadata,\r\n        componentName: componentName || 'unknown',\r\n      });\r\n      metricsRef.current.push(id);\r\n      return id;\r\n    },\r\n    [componentName]\r\n  );\r\n\r\n  const endTiming = useCallback((id: string, error?: Error) => {\r\n    performanceMonitor.end(id, error);\r\n    metricsRef.current = metricsRef.current.filter(\r\n      (existingId) => existingId !== id\r\n    );\r\n  }, []);\r\n\r\n  const recordMetric = useCallback(\r\n    (\r\n      name: string,\r\n      value: number,\r\n      options?: {\r\n        type?: 'duration' | 'counter' | 'gauge' | 'histogram';\r\n        unit?: string;\r\n        tags?: Record<string, string>;\r\n      }\r\n    ) => {\r\n      performanceMonitor.recordMetric(name, value, {\r\n        ...options,\r\n        tags: {\r\n          ...options?.tags,\r\n          componentName: componentName || 'unknown',\r\n        },\r\n      });\r\n    },\r\n    [componentName]\r\n  );\r\n\r\n  const log = useCallback(\r\n    (\r\n      level: 'debug' | 'info' | 'warn' | 'error',\r\n      message: string,\r\n      context?: Record<string, unknown>\r\n    ) => {\r\n      performanceMonitor[level](message, {\r\n        ...context,\r\n        componentName: componentName || 'unknown',\r\n      });\r\n    },\r\n    [componentName]\r\n  );\r\n\r\n  // Cleanup any remaining metrics on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      metricsRef.current.forEach((id) => {\r\n        performanceMonitor.end(\r\n          id,\r\n          new Error('Component unmounted with active timing')\r\n        );\r\n      });\r\n      metricsRef.current = [];\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    startTiming,\r\n    endTiming,\r\n    recordMetric,\r\n    log,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for monitoring API calls\r\n */\r\nexport function useApiPerformance(apiName: string) {\r\n  const { startTiming, endTiming } = usePerformanceMonitor('api_calls');\r\n\r\n  const trackApiCall = useCallback(\r\n    async <T>(\r\n      apiCall: () => Promise<T>,\r\n      options?: {\r\n        metadata?: Record<string, unknown>;\r\n        onError?: (error: Error) => void;\r\n      }\r\n    ): Promise<T> => {\r\n      const id = startTiming(`api_${apiName}`, {\r\n        ...options?.metadata,\r\n      });\r\n\r\n      try {\r\n        const result = await apiCall();\r\n        endTiming(id);\r\n        return result;\r\n      } catch (error) {\r\n        const errorObj =\r\n          error instanceof Error ? error : new Error('API call failed');\r\n        endTiming(id, errorObj);\r\n        options?.onError?.(errorObj);\r\n        throw errorObj;\r\n      }\r\n    },\r\n    [apiName, startTiming, endTiming]\r\n  );\r\n\r\n  return { trackApiCall };\r\n}\r\n\r\n/**\r\n * Hook for monitoring render performance\r\n */\r\nexport function useRenderPerformance(componentName?: string) {\r\n  const renderCountRef = useRef(0);\r\n  const lastRenderTimeRef = useRef(performance.now());\r\n\r\n  useEffect(() => {\r\n    renderCountRef.current += 1;\r\n    const now = performance.now();\r\n    const timeSinceLastRender = now - lastRenderTimeRef.current;\r\n    lastRenderTimeRef.current = now;\r\n\r\n    performanceMonitor.recordMetric('component_render', 1, {\r\n      type: 'counter',\r\n      tags: {\r\n        componentName: componentName || 'unknown',\r\n        renderCount: renderCountRef.current.toString(),\r\n      },\r\n    });\r\n\r\n    performanceMonitor.recordMetric(\r\n      'time_between_renders',\r\n      timeSinceLastRender,\r\n      {\r\n        type: 'duration',\r\n        unit: 'ms',\r\n        tags: {\r\n          componentName: componentName || 'unknown',\r\n        },\r\n      }\r\n    );\r\n  });\r\n\r\n  return {\r\n    renderCount: renderCountRef.current,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for monitoring user interactions\r\n */\r\nexport function useInteractionTracking(componentName?: string) {\r\n  const { recordMetric, log } = usePerformanceMonitor(componentName);\r\n\r\n  const trackInteraction = useCallback(\r\n    (interactionType: string, metadata?: Record<string, unknown>) => {\r\n      recordMetric('user_interaction', 1, {\r\n        type: 'counter',\r\n        tags: {\r\n          interactionType,\r\n          componentName: componentName || 'unknown',\r\n        },\r\n      });\r\n\r\n      log('info', `User interaction: ${interactionType}`, metadata);\r\n    },\r\n    [recordMetric, log, componentName]\r\n  );\r\n\r\n  const trackClick = useCallback(\r\n    (element: string, metadata?: Record<string, unknown>) => {\r\n      trackInteraction('click', { element, ...metadata });\r\n    },\r\n    [trackInteraction]\r\n  );\r\n\r\n  const trackFormSubmit = useCallback(\r\n    (formName: string, metadata?: Record<string, unknown>) => {\r\n      trackInteraction('form_submit', { formName, ...metadata });\r\n    },\r\n    [trackInteraction]\r\n  );\r\n\r\n  const trackPageView = useCallback(\r\n    (page: string, metadata?: Record<string, unknown>) => {\r\n      trackInteraction('page_view', { page, ...metadata });\r\n    },\r\n    [trackInteraction]\r\n  );\r\n\r\n  const trackSearch = useCallback(\r\n    (\r\n      query: string,\r\n      resultsCount?: number,\r\n      metadata?: Record<string, unknown>\r\n    ) => {\r\n      trackInteraction('search', { query, resultsCount, ...metadata });\r\n    },\r\n    [trackInteraction]\r\n  );\r\n\r\n  return {\r\n    trackInteraction,\r\n    trackClick,\r\n    trackFormSubmit,\r\n    trackPageView,\r\n    trackSearch,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for monitoring resource loading\r\n */\r\nexport function useResourceMonitoring() {\r\n  const [resourceMetrics, setResourceMetrics] = useState<{\r\n    totalResources: number;\r\n    totalSize: number;\r\n    slowResources: Array<{ name: string; duration: number; size: number }>;\r\n  }>({\r\n    totalResources: 0,\r\n    totalSize: 0,\r\n    slowResources: [],\r\n  });\r\n\r\n  useEffect(() => {\r\n    const updateResourceMetrics = () => {\r\n      const resources = performance.getEntriesByType(\r\n        'resource'\r\n      ) as PerformanceResourceTiming[];\r\n      const slowThreshold = 1000; // 1 second\r\n\r\n      let totalSize = 0;\r\n      const slowResources: Array<{\r\n        name: string;\r\n        duration: number;\r\n        size: number;\r\n      }> = [];\r\n\r\n      resources.forEach((resource) => {\r\n        const duration = resource.responseEnd - resource.startTime;\r\n        const size = resource.transferSize || 0;\r\n\r\n        totalSize += size;\r\n\r\n        if (duration > slowThreshold) {\r\n          slowResources.push({\r\n            name: resource.name,\r\n            duration,\r\n            size,\r\n          });\r\n        }\r\n      });\r\n\r\n      setResourceMetrics({\r\n        totalResources: resources.length,\r\n        totalSize,\r\n        slowResources,\r\n      });\r\n    };\r\n\r\n    // Update metrics periodically\r\n    const interval = setInterval(updateResourceMetrics, 5000);\r\n\r\n    // Initial update\r\n    updateResourceMetrics();\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return resourceMetrics;\r\n}\r\n\r\n/**\r\n * Hook for monitoring Core Web Vitals\r\n */\r\nexport function useCoreWebVitals() {\r\n  const [vitals, setVitals] = useState<{\r\n    lcp?: number;\r\n    fid?: number;\r\n    cls?: number;\r\n    fcp?: number;\r\n    ttfb?: number;\r\n  }>({});\r\n\r\n  useEffect(() => {\r\n    // Largest Contentful Paint (LCP)\r\n    if ('PerformanceObserver' in window) {\r\n      try {\r\n        const lcpObserver = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          const lastEntry = entries[entries.length - 1];\r\n          if (lastEntry) {\r\n            setVitals((prev) => ({ ...prev, lcp: lastEntry.startTime }));\r\n          }\r\n        });\r\n        lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      } catch (e) {\r\n        console.warn('LCP not supported');\r\n      }\r\n\r\n      // First Input Delay (FID)\r\n      try {\r\n        const fidObserver = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          const firstInput = entries[0];\r\n          if (firstInput) {\r\n            const fid =\r\n              (firstInput as any).processingStart - firstInput.startTime;\r\n            setVitals((prev) => ({ ...prev, fid }));\r\n          }\r\n        });\r\n        fidObserver.observe({ entryTypes: ['first-input'] });\r\n      } catch (e) {\r\n        console.warn('FID not supported');\r\n      }\r\n\r\n      // Cumulative Layout Shift (CLS)\r\n      try {\r\n        let clsValue = 0;\r\n        const clsObserver = new PerformanceObserver((list) => {\r\n          for (const entry of list.getEntries()) {\r\n            if (!(entry as any).hadRecentInput) {\r\n              clsValue += (entry as any).value;\r\n            }\r\n          }\r\n          setVitals((prev) => ({ ...prev, cls: clsValue }));\r\n        });\r\n        clsObserver.observe({ entryTypes: ['layout-shift'] });\r\n      } catch (e) {\r\n        console.warn('CLS not supported');\r\n      }\r\n    }\r\n\r\n    // First Contentful Paint (FCP)\r\n    const paintEntries = performance.getEntriesByType('paint');\r\n    const fcpEntry = paintEntries.find(\r\n      (entry) => entry.name === 'first-contentful-paint'\r\n    );\r\n    if (fcpEntry) {\r\n      setVitals((prev) => ({ ...prev, fcp: fcpEntry.startTime }));\r\n    }\r\n\r\n    // Time to First Byte (TTFB)\r\n    const navigation = performance.getEntriesByType(\r\n      'navigation'\r\n    )[0] as PerformanceNavigationTiming;\r\n    if (navigation) {\r\n      const ttfb = navigation.responseStart - navigation.requestStart;\r\n      setVitals((prev) => ({ ...prev, ttfb }));\r\n    }\r\n  }, []);\r\n\r\n  return vitals;\r\n}\r\n\r\n/**\r\n * Hook for monitoring memory usage\r\n */\r\nexport function useMemoryMonitoring() {\r\n  const [memoryInfo, setMemoryInfo] = useState<{\r\n    usedJSHeapSize?: number;\r\n    totalJSHeapSize?: number;\r\n    jsHeapSizeLimit?: number;\r\n    memoryPressure?: 'low' | 'medium' | 'high';\r\n  }>({});\r\n\r\n  useEffect(() => {\r\n    const updateMemoryInfo = () => {\r\n      if ('memory' in performance) {\r\n        const memory = (performance as any).memory;\r\n        const used = memory.usedJSHeapSize;\r\n        const total = memory.totalJSHeapSize;\r\n        const limit = memory.jsHeapSizeLimit;\r\n\r\n        const usageRatio = used / limit;\r\n        let memoryPressure: 'low' | 'medium' | 'high' = 'low';\r\n        if (usageRatio > 0.8) {\r\n          memoryPressure = 'high';\r\n        } else if (usageRatio > 0.6) {\r\n          memoryPressure = 'medium';\r\n        }\r\n\r\n        setMemoryInfo({\r\n          usedJSHeapSize: used,\r\n          totalJSHeapSize: total,\r\n          jsHeapSizeLimit: limit,\r\n          memoryPressure,\r\n        });\r\n      }\r\n    };\r\n\r\n    // Update memory info every 5 seconds\r\n    const interval = setInterval(updateMemoryInfo, 5000);\r\n\r\n    // Initial update\r\n    updateMemoryInfo();\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return memoryInfo;\r\n}\r\n\r\n/**\r\n * Hook for creating performance-aware async operations\r\n */\r\nexport function useAsyncPerformance<T>(\r\n  asyncFn: () => Promise<T>,\r\n  operationName: string\r\n) {\r\n  const [state, setState] = useState<{\r\n    data: T | null;\r\n    loading: boolean;\r\n    error: Error | null;\r\n    progress: number;\r\n  }>({\r\n    data: null,\r\n    loading: false,\r\n    error: null,\r\n    progress: 0,\r\n  });\r\n\r\n  const { startTiming, endTiming, recordMetric } =\r\n    usePerformanceMonitor('async_operations');\r\n\r\n  const execute = useCallback(async () => {\r\n    setState((prev) => ({ ...prev, loading: true, error: null, progress: 0 }));\r\n    const id = startTiming(operationName);\r\n\r\n    try {\r\n      const result = await asyncFn();\r\n      endTiming(id);\r\n      setState({\r\n        data: result,\r\n        loading: false,\r\n        error: null,\r\n        progress: 100,\r\n      });\r\n      recordMetric(`${operationName}_success`, 1, { type: 'counter' });\r\n      return result;\r\n    } catch (error) {\r\n      const errorObj =\r\n        error instanceof Error ? error : new Error('Async operation failed');\r\n      endTiming(id, errorObj);\r\n      setState({\r\n        data: null,\r\n        loading: false,\r\n        error: errorObj,\r\n        progress: 0,\r\n      });\r\n      recordMetric(`${operationName}_error`, 1, { type: 'counter' });\r\n      throw errorObj;\r\n    }\r\n  }, [asyncFn, operationName, startTiming, endTiming, recordMetric]);\r\n\r\n  return {\r\n    ...state,\r\n    execute,\r\n  };\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useReactPerformance.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6219,6222],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6219,6222],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6229,6232],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6229,6232],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","line":245,"column":6,"nodeType":"Identifier","endLine":245,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'callback' and 'dependencies'. Either include them or remove the dependency array. If 'callback' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":245,"column":6,"nodeType":"Identifier","endLine":245,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [callback, dependencies]","fix":{"range":[6808,6820],"text":"[callback, dependencies]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useCallback, useState } from 'react';\r\nimport { performance } from './perf_hooks';\r\n\r\ninterface ComponentMetrics {\r\n  renders: number;\r\n  totalRenderTime: number;\r\n  averageRenderTime: number;\r\n  lastRenderTime: number;\r\n  slowestRender: number;\r\n  fastestRender: number;\r\n  mountTime: number;\r\n  isMounted: boolean;\r\n}\r\n\r\ninterface PerformanceOptions {\r\n  trackMountTime?: boolean;\r\n  logRenders?: boolean;\r\n  warningThreshold?: number;\r\n  errorThreshold?: number;\r\n}\r\n\r\nexport const useReactPerformance = (\r\n  componentName: string,\r\n  options: PerformanceOptions = {}\r\n) => {\r\n  const {\r\n    trackMountTime = true,\r\n    logRenders = false,\r\n    warningThreshold = 16,\r\n    errorThreshold = 100,\r\n  } = options;\r\n\r\n  const metricsRef = useRef<ComponentMetrics>({\r\n    renders: 0,\r\n    totalRenderTime: 0,\r\n    averageRenderTime: 0,\r\n    lastRenderTime: 0,\r\n    slowestRender: 0,\r\n    fastestRender: Infinity,\r\n    mountTime: 0,\r\n    isMounted: false,\r\n  });\r\n\r\n  const mountTimeRef = useRef<number>(Date.now());\r\n  const renderStartRef = useRef<number>(0);\r\n\r\n  const [, forceUpdate] = useState({});\r\n\r\n  // Track render start\r\n  const startRender = useCallback(() => {\r\n    renderStartRef.current = performance.now();\r\n  }, []);\r\n\r\n  // Track render end\r\n  const endRender = useCallback(() => {\r\n    if (renderStartRef.current === 0) {\r\n      return;\r\n    }\r\n\r\n    const renderTime = performance.now() - renderStartRef.current;\r\n    const metrics = metricsRef.current;\r\n\r\n    metrics.renders++;\r\n    metrics.lastRenderTime = renderTime;\r\n    metrics.totalRenderTime += renderTime;\r\n    metrics.averageRenderTime = metrics.totalRenderTime / metrics.renders;\r\n    metrics.slowestRender = Math.max(metrics.slowestRender, renderTime);\r\n    metrics.fastestRender = Math.min(metrics.fastestRender, renderTime);\r\n\r\n    // Log performance warnings\r\n    if (logRenders || process.env.NODE_ENV === 'development') {\r\n      if (renderTime > errorThreshold) {\r\n        console.error(\r\n          `≡ƒÜ¿ Very slow render in ${componentName}: ${renderTime.toFixed(2)}ms (threshold: ${errorThreshold}ms)`\r\n        );\r\n      } else if (renderTime > warningThreshold) {\r\n        console.warn(\r\n          `ΓÜá∩╕Å Slow render in ${componentName}: ${renderTime.toFixed(2)}ms (threshold: ${warningThreshold}ms)`\r\n        );\r\n      } else if (logRenders) {\r\n        console.debug(\r\n          `Γ£à ${componentName} rendered in ${renderTime.toFixed(2)}ms`\r\n        );\r\n      }\r\n    }\r\n\r\n    // Emit performance event\r\n    window.dispatchEvent(\r\n      new CustomEvent('component-performance', {\r\n        detail: {\r\n          componentName,\r\n          metrics: { ...metrics },\r\n          renderTime,\r\n        },\r\n      })\r\n    );\r\n\r\n    renderStartRef.current = 0;\r\n  }, [componentName, logRenders, warningThreshold, errorThreshold]);\r\n\r\n  // Track mount time\r\n  useEffect(() => {\r\n    if (trackMountTime) {\r\n      const mountTime = Date.now() - mountTimeRef.current;\r\n      metricsRef.current.mountTime = mountTime;\r\n      metricsRef.current.isMounted = true;\r\n\r\n      if (logRenders || process.env.NODE_ENV === 'development') {\r\n        console.debug(`≡ƒÜÇ ${componentName} mounted in ${mountTime}ms`);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      metricsRef.current.isMounted = false;\r\n    };\r\n  }, [componentName, trackMountTime, logRenders]);\r\n\r\n  // Get current metrics\r\n  const getMetrics = useCallback(() => {\r\n    return { ...metricsRef.current };\r\n  }, []);\r\n\r\n  // Reset metrics\r\n  const resetMetrics = useCallback(() => {\r\n    metricsRef.current = {\r\n      renders: 0,\r\n      totalRenderTime: 0,\r\n      averageRenderTime: 0,\r\n      lastRenderTime: 0,\r\n      slowestRender: 0,\r\n      fastestRender: Infinity,\r\n      mountTime: metricsRef.current.mountTime,\r\n      isMounted: metricsRef.current.isMounted,\r\n    };\r\n  }, []);\r\n\r\n  // Force update for testing purposes\r\n  const forceRerender = useCallback(() => {\r\n    forceUpdate({});\r\n  }, []);\r\n\r\n  return {\r\n    startRender,\r\n    endRender,\r\n    getMetrics,\r\n    resetMetrics,\r\n    forceRerender,\r\n  };\r\n};\r\n\r\n// Hook for optimizing expensive calculations\r\nexport const useOptimizedCalculation = <T>(\r\n  calculation: () => T,\r\n  dependencies: React.DependencyList,\r\n  options: {\r\n    memoize?: boolean;\r\n    debounceMs?: number;\r\n    throttleMs?: number;\r\n  } = {}\r\n) => {\r\n  const { memoize = true, debounceMs = 0, throttleMs = 0 } = options;\r\n  const [result, setResult] = useState<T>(() => calculation());\r\n  const [isCalculating, setIsCalculating] = useState(false);\r\n\r\n  const calculateRef = useRef<T>(calculation());\r\n  const dependenciesRef = useRef(dependencies);\r\n\r\n  useEffect(() => {\r\n    dependenciesRef.current = dependencies;\r\n  }, [dependencies]);\r\n\r\n  const performCalculation = useCallback(async () => {\r\n    setIsCalculating(true);\r\n    const startTime = performance.now();\r\n\r\n    try {\r\n      const newResult = calculation();\r\n      calculateRef.current = newResult;\r\n      setResult(newResult);\r\n\r\n      const endTime = performance.now();\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.debug(\r\n          `Calculation completed in ${(endTime - startTime).toFixed(2)}ms`\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Calculation failed:', error);\r\n    } finally {\r\n      setIsCalculating(false);\r\n    }\r\n  }, [calculation]);\r\n\r\n  useEffect(() => {\r\n    if (memoize) {\r\n      const hasDependenciesChanged = !dependencies.every(\r\n        (dep, index) => dep === dependenciesRef.current[index]\r\n      );\r\n\r\n      if (hasDependenciesChanged) {\r\n        if (debounceMs > 0) {\r\n          const timeout = setTimeout(performCalculation, debounceMs);\r\n          return () => clearTimeout(timeout);\r\n        } else if (throttleMs > 0) {\r\n          const timeout = setTimeout(performCalculation, throttleMs);\r\n          return () => clearTimeout(timeout);\r\n        } else {\r\n          performCalculation();\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }, [dependencies, memoize, debounceMs, throttleMs, performCalculation]);\r\n\r\n  return {\r\n    result,\r\n    isCalculating,\r\n    recalculate: performCalculation,\r\n  };\r\n};\r\n\r\n// Hook for stable callbacks\r\nexport const useStableCallback = <T extends (...args: any[]) => any>(\r\n  callback: T,\r\n  dependencies: React.DependencyList = []\r\n): T => {\r\n  const callbackRef = useRef(callback);\r\n  const dependenciesRef = useRef(dependencies);\r\n\r\n  useEffect(() => {\r\n    callbackRef.current = callback;\r\n  }, [callback]);\r\n\r\n  useEffect(() => {\r\n    dependenciesRef.current = dependencies;\r\n  }, [dependencies]);\r\n\r\n  return useCallback((...args: Parameters<T>) => {\r\n    if (\r\n      dependencies.every((dep, index) => dep === dependenciesRef.current[index])\r\n    ) {\r\n      return callbackRef.current(...args);\r\n    }\r\n    return callback(...args);\r\n  }, dependencies) as T;\r\n};\r\n\r\n// Hook for performance monitoring of async operations\r\nexport const useAsyncPerformance = () => {\r\n  const operationsRef = useRef<Map<string, number>>(new Map());\r\n\r\n  const startOperation = useCallback((operationName: string) => {\r\n    const startTime = performance.now();\r\n    operationsRef.current.set(operationName, startTime);\r\n\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.debug(`ΓÅ▒∩╕Å Started ${operationName}`);\r\n    }\r\n\r\n    return startTime;\r\n  }, []);\r\n\r\n  const endOperation = useCallback((operationName: string) => {\r\n    const startTime = operationsRef.current.get(operationName);\r\n    if (!startTime) {\r\n      return null;\r\n    }\r\n\r\n    const endTime = performance.now();\r\n    const duration = endTime - startTime;\r\n    operationsRef.current.delete(operationName);\r\n\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.debug(`Γ£à Completed ${operationName} in ${duration.toFixed(2)}ms`);\r\n    }\r\n\r\n    // Emit performance event\r\n    window.dispatchEvent(\r\n      new CustomEvent('async-operation-performance', {\r\n        detail: {\r\n          operationName,\r\n          duration,\r\n          startTime,\r\n          endTime,\r\n        },\r\n      })\r\n    );\r\n\r\n    return duration;\r\n  }, []);\r\n\r\n  const getActiveOperations = useCallback(() => {\r\n    return Array.from(operationsRef.current.keys());\r\n  }, []);\r\n\r\n  return {\r\n    startOperation,\r\n    endOperation,\r\n    getActiveOperations,\r\n  };\r\n};\r\n\r\n// Performance comparison hook\r\nexport const usePerformanceComparison = (variantName: string) => {\r\n  const metricsRef = useRef<number[]>([]);\r\n\r\n  const recordMetric = useCallback((value: number) => {\r\n    metricsRef.current.push(value);\r\n  }, []);\r\n\r\n  const getStats = useCallback(() => {\r\n    const metrics = metricsRef.current;\r\n    if (metrics.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    const sum = metrics.reduce((a, b) => a + b, 0);\r\n    const average = sum / metrics.length;\r\n    const min = Math.min(...metrics);\r\n    const max = Math.max(...metrics);\r\n    const sorted = [...metrics].sort((a, b) => a - b);\r\n    const median = sorted[Math.floor(sorted.length / 2)];\r\n    const p95 = sorted[Math.floor(sorted.length * 0.95)];\r\n    const p99 = sorted[Math.floor(sorted.length * 0.99)];\r\n\r\n    return {\r\n      variant: variantName,\r\n      count: metrics.length,\r\n      average,\r\n      min,\r\n      max,\r\n      median,\r\n      p95,\r\n      p99,\r\n      sum,\r\n    };\r\n  }, [variantName]);\r\n\r\n  const reset = useCallback(() => {\r\n    metricsRef.current = [];\r\n  }, []);\r\n\r\n  return {\r\n    recordMetric,\r\n    getStats,\r\n    reset,\r\n  };\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useSearchFilters.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":218,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5609,5612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5609,5612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":346,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":346,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9242,9245],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9242,9245],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":348,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9314,9317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9314,9317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9800,9803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9800,9803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":424,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":424,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11531,11534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11531,11534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useCallback, useMemo } from 'react';\r\n\r\ninterface FilterOption {\r\n  label: string;\r\n  value: string;\r\n  count?: number;\r\n}\r\n\r\ninterface SearchFilters {\r\n  searchTerm: string;\r\n  filters: Record<string, string | string[]>;\r\n  sortBy: string;\r\n  sortOrder: 'asc' | 'desc';\r\n  page: number;\r\n  pageSize: number;\r\n}\r\n\r\ninterface FilterActions {\r\n  setSearchTerm: (term: string) => void;\r\n  setFilter: (key: string, value: string | string[]) => void;\r\n  removeFilter: (key: string) => void;\r\n  clearFilters: () => void;\r\n  setSortBy: (field: string) => void;\r\n  toggleSortOrder: () => void;\r\n  setPage: (page: number) => void;\r\n  setPageSize: (size: number) => void;\r\n  reset: () => void;\r\n}\r\n\r\n/**\r\n * Hook for managing search and filter states consistently across components\r\n *\r\n * @param options - Configuration options for the filter system\r\n * @returns [state, actions] - Current state and actions to modify it\r\n *\r\n * @example\r\n * const [state, actions] = useSearchFilters({\r\n *   defaultSearchTerm: '',\r\n *   defaultFilters: { gradeLevel: '', status: 'active' },\r\n *   sortOptions: [\r\n *     { label: 'Name', value: 'name' },\r\n *     { label: 'Grade', value: 'gradeLevel' },\r\n *   ],\r\n *   pageSize: 25,\r\n * });\r\n *\r\n * // Use in component\r\n * const filteredData = useMemo(() => {\r\n *   return applyFilters(data, state);\r\n * }, [data, state]);\r\n */\r\nexport function useSearchFilters(\r\n  options: {\r\n    defaultSearchTerm?: string;\r\n    defaultFilters?: Record<string, string | string[]>;\r\n    defaultSortBy?: string;\r\n    defaultSortOrder?: 'asc' | 'desc';\r\n    defaultPage?: number;\r\n    defaultPageSize?: number;\r\n    availableFilters?: Record<string, FilterOption[]>;\r\n    sortOptions?: FilterOption[];\r\n  } = {}\r\n) {\r\n  const {\r\n    defaultSearchTerm = '',\r\n    defaultFilters = {},\r\n    defaultSortBy = '',\r\n    defaultSortOrder = 'asc',\r\n    defaultPage = 1,\r\n    defaultPageSize = 25,\r\n  } = options;\r\n\r\n  const [state, setState] = useState<SearchFilters>({\r\n    searchTerm: defaultSearchTerm,\r\n    filters: defaultFilters,\r\n    sortBy: defaultSortBy,\r\n    sortOrder: defaultSortOrder,\r\n    page: defaultPage,\r\n    pageSize: defaultPageSize,\r\n  });\r\n\r\n  const setSearchTerm = useCallback((term: string) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      searchTerm: term,\r\n      page: 1, // Reset to first page when searching\r\n    }));\r\n  }, []);\r\n\r\n  const setFilter = useCallback((key: string, value: string | string[]) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      filters: {\r\n        ...prev.filters,\r\n        [key]: value,\r\n      },\r\n      page: 1, // Reset to first page when filtering\r\n    }));\r\n  }, []);\r\n\r\n  const removeFilter = useCallback((key: string) => {\r\n    setState((prev) => {\r\n      const newFilters = { ...prev.filters };\r\n      delete newFilters[key];\r\n      return {\r\n        ...prev,\r\n        filters: newFilters,\r\n        page: 1, // Reset to first page when removing filter\r\n      };\r\n    });\r\n  }, []);\r\n\r\n  const clearFilters = useCallback(() => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      filters: {},\r\n      page: 1,\r\n    }));\r\n  }, []);\r\n\r\n  const setSortBy = useCallback((field: string) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      sortBy: field,\r\n      sortOrder:\r\n        prev.sortBy === field\r\n          ? prev.sortOrder === 'asc'\r\n            ? 'desc'\r\n            : 'asc'\r\n          : 'asc',\r\n      page: 1,\r\n    }));\r\n  }, []);\r\n\r\n  const toggleSortOrder = useCallback(() => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      sortOrder: prev.sortOrder === 'asc' ? 'desc' : 'asc',\r\n      page: 1,\r\n    }));\r\n  }, []);\r\n\r\n  const setPage = useCallback((page: number) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      page: Math.max(1, page),\r\n    }));\r\n  }, []);\r\n\r\n  const setPageSize = useCallback((size: number) => {\r\n    setState((prev) => ({\r\n      ...prev,\r\n      pageSize: Math.max(1, size),\r\n      page: 1, // Reset to first page when changing page size\r\n    }));\r\n  }, []);\r\n\r\n  const reset = useCallback(() => {\r\n    setState({\r\n      searchTerm: defaultSearchTerm,\r\n      filters: defaultFilters,\r\n      sortBy: defaultSortBy,\r\n      sortOrder: defaultSortOrder,\r\n      page: defaultPage,\r\n      pageSize: defaultPageSize,\r\n    });\r\n  }, [\r\n    defaultSearchTerm,\r\n    defaultFilters,\r\n    defaultSortBy,\r\n    defaultSortOrder,\r\n    defaultPage,\r\n    defaultPageSize,\r\n  ]);\r\n\r\n  const actions: FilterActions = {\r\n    setSearchTerm,\r\n    setFilter,\r\n    removeFilter,\r\n    clearFilters,\r\n    setSortBy,\r\n    toggleSortOrder,\r\n    setPage,\r\n    setPageSize,\r\n    reset,\r\n  };\r\n\r\n  // Computed values\r\n  const hasActiveFilters = useMemo(() => {\r\n    return (\r\n      state.searchTerm.trim() !== '' || Object.keys(state.filters).length > 0\r\n    );\r\n  }, [state.searchTerm, state.filters]);\r\n\r\n  const isSortActive = useMemo(() => {\r\n    return state.sortBy !== '' && state.sortOrder !== 'asc';\r\n  }, [state.sortBy, state.sortOrder]);\r\n\r\n  return [state, actions, { hasActiveFilters, isSortActive }] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing table-specific filter states\r\n *\r\n * @param options - Table-specific configuration options\r\n * @returns [state, actions, computed] - State, actions, and computed values\r\n *\r\n * @example\r\n * const [state, actions, computed] = useTableFilters({\r\n *   data: students,\r\n *   searchableFields: ['name', 'gradeLevel', 'section'],\r\n *   filterableFields: {\r\n *     gradeLevel: gradeOptions,\r\n *     isActive: [{ label: 'Active', value: 'true' }, { label: 'Inactive', value: 'false' }],\r\n *   },\r\n * });\r\n */\r\nexport function useTableFilters<T extends Record<string, any>>(options: {\r\n  data: T[];\r\n  searchableFields?: string[];\r\n  filterableFields?: Record<string, FilterOption[]>;\r\n  defaultSortBy?: string;\r\n  defaultSortOrder?: 'asc' | 'desc';\r\n  defaultPageSize?: number;\r\n}) {\r\n  const {\r\n    data,\r\n    searchableFields = [],\r\n    filterableFields: _filterableFields = {},\r\n    ...filterOptions\r\n  } = options;\r\n\r\n  const [state, actions, computed] = useSearchFilters(filterOptions);\r\n\r\n  // Apply filters and search to data\r\n  const filteredData = useMemo(() => {\r\n    let filtered = [...data];\r\n\r\n    // Apply search term\r\n    if (state.searchTerm.trim()) {\r\n      const searchLower = state.searchTerm.toLowerCase().trim();\r\n      filtered = filtered.filter((item) =>\r\n        searchableFields.some((field) => {\r\n          const value = item[field];\r\n          return value?.toString().toLowerCase().includes(searchLower);\r\n        })\r\n      );\r\n    }\r\n\r\n    // Apply filters\r\n    Object.entries(state.filters).forEach(([key, value]) => {\r\n      if (value && value.toString().trim() !== '') {\r\n        if (Array.isArray(value)) {\r\n          // Multi-select filter\r\n          filtered = filtered.filter((item) =>\r\n            value.includes(item[key]?.toString())\r\n          );\r\n        } else {\r\n          // Single-select filter\r\n          filtered = filtered.filter(\r\n            (item) => item[key]?.toString() === value.toString()\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    // Apply sorting\r\n    if (state.sortBy) {\r\n      filtered.sort((a, b) => {\r\n        const aVal = a[state.sortBy];\r\n        const bVal = b[state.sortBy];\r\n\r\n        let comparison = 0;\r\n        if (aVal < bVal) {\r\n          comparison = -1;\r\n        }\r\n        if (aVal > bVal) {\r\n          comparison = 1;\r\n        }\r\n\r\n        return state.sortOrder === 'desc' ? -comparison : comparison;\r\n      });\r\n    }\r\n\r\n    return filtered;\r\n  }, [data, state, searchableFields]);\r\n\r\n  // Apply pagination\r\n  const paginatedData = useMemo(() => {\r\n    const startIndex = (state.page - 1) * state.pageSize;\r\n    const endIndex = startIndex + state.pageSize;\r\n    return filteredData.slice(startIndex, endIndex);\r\n  }, [filteredData, state.page, state.pageSize]);\r\n\r\n  // Compute pagination info\r\n  const paginationInfo = useMemo(() => {\r\n    const totalItems = filteredData.length;\r\n    const totalPages = Math.ceil(totalItems / state.pageSize);\r\n    const currentPageItems = paginatedData.length;\r\n    const startItem =\r\n      totalItems === 0 ? 0 : (state.page - 1) * state.pageSize + 1;\r\n    const endItem = totalItems === 0 ? 0 : startItem + currentPageItems - 1;\r\n\r\n    return {\r\n      totalItems,\r\n      totalPages,\r\n      currentPageItems,\r\n      startItem,\r\n      endItem,\r\n      canGoToPrevPage: state.page > 1,\r\n      canGoToNextPage: state.page < totalPages,\r\n    };\r\n  }, [filteredData, paginatedData, state.page, state.pageSize]);\r\n\r\n  return [\r\n    { ...state, filteredData: paginatedData },\r\n    actions,\r\n    { ...computed, filteredData, paginationInfo, totalData: data },\r\n  ] as const;\r\n}\r\n\r\n/**\r\n * Hook for managing advanced filter builders\r\n *\r\n * @param filterSchema - Schema defining available filters\r\n * @returns [state, actions, filterFunctions] - State and functions for building filters\r\n */\r\nexport function useAdvancedFilters(\r\n  filterSchema: Record<\r\n    string,\r\n    {\r\n      type:\r\n        | 'text'\r\n        | 'select'\r\n        | 'multiselect'\r\n        | 'date'\r\n        | 'daterange'\r\n        | 'number'\r\n        | 'boolean';\r\n      label: string;\r\n      options?: FilterOption[];\r\n      placeholder?: string;\r\n    }\r\n  >\r\n) {\r\n  const [state, setState] = useState<Record<string, any>>({});\r\n\r\n  const setFilterValue = useCallback((key: string, value: any) => {\r\n    setState((prev) => ({ ...prev, [key]: value }));\r\n  }, []);\r\n\r\n  const removeFilter = useCallback((key: string) => {\r\n    setState((prev) => {\r\n      const newState = { ...prev };\r\n      delete newState[key];\r\n      return newState;\r\n    });\r\n  }, []);\r\n\r\n  const clearAllFilters = useCallback(() => {\r\n    setState({});\r\n  }, []);\r\n\r\n  // Build filter functions for applying to data\r\n  const filterFunctions = useMemo(() => {\r\n    const functions: Record<string, (item: any) => boolean> = {};\r\n\r\n    Object.entries(state).forEach(([key, value]) => {\r\n      const schema = filterSchema[key];\r\n      if (!schema || !value) {\r\n        return;\r\n      }\r\n\r\n      switch (schema.type) {\r\n        case 'text':\r\n          functions[key] = (item) =>\r\n            item[key]?.toString().toLowerCase().includes(value.toLowerCase());\r\n          break;\r\n\r\n        case 'select':\r\n          functions[key] = (item) => item[key]?.toString() === value.toString();\r\n          break;\r\n\r\n        case 'multiselect':\r\n          functions[key] = (item) =>\r\n            Array.isArray(value) && value.includes(item[key]?.toString());\r\n          break;\r\n\r\n        case 'date':\r\n          functions[key] = (item) => {\r\n            const itemDate = new Date(item[key]);\r\n            const filterDate = new Date(value);\r\n            return itemDate.toDateString() === filterDate.toDateString();\r\n          };\r\n          break;\r\n\r\n        case 'daterange':\r\n          functions[key] = (item) => {\r\n            const itemDate = new Date(item[key]);\r\n            const startDate = new Date(value.start);\r\n            const endDate = new Date(value.end);\r\n            return itemDate >= startDate && itemDate <= endDate;\r\n          };\r\n          break;\r\n\r\n        case 'number':\r\n          functions[key] = (item) => {\r\n            const itemValue = Number(item[key]);\r\n            const filterValue = Number(value);\r\n            return itemValue === filterValue;\r\n          };\r\n          break;\r\n\r\n        case 'boolean':\r\n          functions[key] = (item) => item[key] === Boolean(value);\r\n          break;\r\n      }\r\n    });\r\n\r\n    return functions;\r\n  }, [state, filterSchema]);\r\n\r\n  const applyFilters = useCallback(\r\n    (data: any[]) => {\r\n      if (Object.keys(filterFunctions).length === 0) {\r\n        return data;\r\n      }\r\n\r\n      return data.filter((item) =>\r\n        Object.values(filterFunctions).every((fn) => fn(item))\r\n      );\r\n    },\r\n    [filterFunctions]\r\n  );\r\n\r\n  const actions = {\r\n    setFilterValue,\r\n    removeFilter,\r\n    clearAllFilters,\r\n  };\r\n\r\n  return [state, actions, filterFunctions, applyFilters] as const;\r\n}\r\n\r\nexport default useSearchFilters;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useTypedApi.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2027,2030],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2027,2030],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":335,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":335,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8283,8286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8283,8286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { apiClient } from '@/lib/api-client';\r\nimport type { ApiError, HttpMethod } from '@/types';\r\n\r\ninterface UseTypedApiOptions<T> {\r\n  immediate?: boolean;\r\n  onSuccess?: (data: T) => void;\r\n  onError?: (error: ApiError) => void;\r\n  retryCount?: number;\r\n  retryDelay?: number;\r\n  transform?: (data: unknown) => T;\r\n  validate?: (data: T) => boolean;\r\n}\r\n\r\ninterface TypedApiState<T> {\r\n  data: T | null;\r\n  loading: boolean;\r\n  error: ApiError | null;\r\n  lastFetched: Date | null;\r\n  retryCount: number;\r\n}\r\n\r\n/**\r\n * Type-safe API hook with comprehensive error handling and retry logic\r\n */\r\nexport function useTypedApi<T>(\r\n  config: {\r\n    method: HttpMethod;\r\n    url: string;\r\n    data?: unknown;\r\n    params?: Record<string, string | number>;\r\n  },\r\n  options: UseTypedApiOptions<T> = {}\r\n) {\r\n  const {\r\n    immediate = true,\r\n    onSuccess,\r\n    onError,\r\n    retryCount = 3,\r\n    retryDelay = 1000,\r\n    transform,\r\n    validate,\r\n  } = options;\r\n\r\n  const [state, setState] = useState<TypedApiState<T>>({\r\n    data: null,\r\n    loading: immediate,\r\n    error: null,\r\n    lastFetched: null,\r\n    retryCount: 0,\r\n  });\r\n\r\n  const mountedRef = useRef(true);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      mountedRef.current = false;\r\n      abortControllerRef.current?.abort();\r\n    };\r\n  }, []);\r\n\r\n  const execute = useCallback(\r\n    async (customConfig?: typeof config) => {\r\n      if (!mountedRef.current) {\r\n        return;\r\n      }\r\n\r\n      // Cancel previous request if still pending\r\n      if (abortControllerRef.current) {\r\n        abortControllerRef.current.abort();\r\n      }\r\n\r\n      abortControllerRef.current = new AbortController();\r\n\r\n      setState((prev) => ({\r\n        ...prev,\r\n        loading: true,\r\n        error: null,\r\n      }));\r\n\r\n      try {\r\n        const finalConfig = { ...config, ...customConfig };\r\n        let response: any;\r\n\r\n        // Use the appropriate public method based on HTTP method\r\n        switch (finalConfig.method) {\r\n          case 'GET':\r\n            response = await apiClient.get<unknown>(\r\n              finalConfig.url,\r\n              finalConfig.params\r\n            );\r\n            break;\r\n          case 'POST':\r\n            response = await apiClient.post<unknown>(\r\n              finalConfig.url,\r\n              finalConfig.data,\r\n              finalConfig.params ? { params: finalConfig.params } : {}\r\n            );\r\n            break;\r\n          case 'PUT':\r\n            response = await apiClient.put<unknown>(\r\n              finalConfig.url,\r\n              finalConfig.data,\r\n              finalConfig.params ? { params: finalConfig.params } : {}\r\n            );\r\n            break;\r\n          case 'PATCH':\r\n            response = await apiClient.patch<unknown>(\r\n              finalConfig.url,\r\n              finalConfig.data,\r\n              finalConfig.params ? { params: finalConfig.params } : {}\r\n            );\r\n            break;\r\n          case 'DELETE':\r\n            response = await apiClient.delete<unknown>(finalConfig.url);\r\n            break;\r\n          default:\r\n            throw new Error(`Unsupported HTTP method: ${finalConfig.method}`);\r\n        }\r\n\r\n        if (!mountedRef.current) {\r\n          return;\r\n        }\r\n\r\n        if (!response.success) {\r\n          throw new Error(response.error || 'Request failed');\r\n        }\r\n\r\n        // Transform data if transformer provided\r\n        let transformedData: T;\r\n        if (transform) {\r\n          transformedData = transform(response.data);\r\n        } else {\r\n          transformedData = response.data as T;\r\n        }\r\n\r\n        // Validate data if validator provided\r\n        if (validate && !validate(transformedData)) {\r\n          throw new Error('Data validation failed');\r\n        }\r\n\r\n        setState({\r\n          data: transformedData,\r\n          loading: false,\r\n          error: null,\r\n          lastFetched: new Date(),\r\n          retryCount: 0,\r\n        });\r\n\r\n        onSuccess?.(transformedData);\r\n      } catch (error) {\r\n        if (!mountedRef.current) {\r\n          return;\r\n        }\r\n\r\n        const apiError: ApiError = {\r\n          message: error instanceof Error ? error.message : 'Unknown error',\r\n          code: 'REQUEST_FAILED',\r\n          status: 500,\r\n        };\r\n\r\n        // Retry logic\r\n        if (state.retryCount < retryCount) {\r\n          setState((prev) => ({ ...prev, retryCount: prev.retryCount + 1 }));\r\n\r\n          setTimeout(\r\n            () => {\r\n              if (mountedRef.current) {\r\n                execute(customConfig);\r\n              }\r\n            },\r\n            retryDelay * Math.pow(2, state.retryCount)\r\n          ); // Exponential backoff\r\n          return;\r\n        }\r\n\r\n        setState((prev) => ({\r\n          ...prev,\r\n          loading: false,\r\n          error: apiError,\r\n        }));\r\n\r\n        onError?.(apiError);\r\n      }\r\n    },\r\n    [\r\n      config,\r\n      transform,\r\n      validate,\r\n      onSuccess,\r\n      onError,\r\n      retryCount,\r\n      retryDelay,\r\n      state.retryCount,\r\n    ]\r\n  );\r\n\r\n  // Immediate execution\r\n  useEffect(() => {\r\n    if (immediate) {\r\n      execute();\r\n    }\r\n  }, [immediate, execute]);\r\n\r\n  const refetch = useCallback(() => {\r\n    setState((prev) => ({ ...prev, retryCount: 0 }));\r\n    execute();\r\n  }, [execute]);\r\n\r\n  const reset = useCallback(() => {\r\n    abortControllerRef.current?.abort();\r\n    setState({\r\n      data: null,\r\n      loading: false,\r\n      error: null,\r\n      lastFetched: null,\r\n      retryCount: 0,\r\n    });\r\n  }, []);\r\n\r\n  return {\r\n    ...state,\r\n    execute,\r\n    refetch,\r\n    reset,\r\n    canRetry: state.retryCount < retryCount,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for paginated API calls with type safety\r\n */\r\nexport function useTypedPaginatedApi<T>(\r\n  config: {\r\n    url: string;\r\n    method?: HttpMethod;\r\n  },\r\n  initialPage: number = 1,\r\n  initialPageSize: number = 20\r\n) {\r\n  const [page, setPage] = useState(initialPage);\r\n  const [pageSize, setPageSize] = useState(initialPageSize);\r\n\r\n  const paginatedConfig = {\r\n    ...config,\r\n    method: config.method || 'GET',\r\n    params: {\r\n      page,\r\n      limit: pageSize,\r\n    },\r\n  };\r\n\r\n  const result = useTypedApi<{\r\n    data: T[];\r\n    total: number;\r\n    page: number;\r\n    totalPages: number;\r\n  }>(paginatedConfig);\r\n\r\n  const goToPage = useCallback((newPage: number) => {\r\n    setPage(newPage);\r\n  }, []);\r\n\r\n  const nextPage = useCallback(() => {\r\n    setPage((prev) => prev + 1);\r\n  }, []);\r\n\r\n  const prevPage = useCallback(() => {\r\n    setPage((prev) => Math.max(1, prev - 1));\r\n  }, []);\r\n\r\n  const changePageSize = useCallback((newPageSize: number) => {\r\n    setPageSize(newPageSize);\r\n    setPage(1); // Reset to first page\r\n  }, []);\r\n\r\n  const totalPages = result.data?.totalPages || 0;\r\n  const hasNextPage = page < totalPages;\r\n  const hasPrevPage = page > 1;\r\n\r\n  return {\r\n    ...result,\r\n    page,\r\n    pageSize,\r\n    totalPages,\r\n    hasNextPage,\r\n    hasPrevPage,\r\n    data: result.data?.data || [],\r\n    total: result.data?.total || 0,\r\n    goToPage,\r\n    nextPage,\r\n    prevPage,\r\n    changePageSize,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for mutation operations (POST, PUT, DELETE)\r\n */\r\nexport function useTypedMutation<TRequest, TResponse>(\r\n  config: {\r\n    method: 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH';\r\n    url: string;\r\n  },\r\n  options: {\r\n    onSuccess?: (data: TResponse) => void;\r\n    onError?: (error: ApiError) => void;\r\n    onMutate?: (data: TRequest) => void;\r\n    optimisticUpdate?: (data: TRequest) => void;\r\n    rollbackOnError?: () => void;\r\n  } = {}\r\n) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<ApiError | null>(null);\r\n  const [data, setData] = useState<TResponse | null>(null);\r\n\r\n  const { onSuccess, onError, onMutate, optimisticUpdate, rollbackOnError } =\r\n    options;\r\n\r\n  const mutate = useCallback(\r\n    async (requestData: TRequest) => {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        onMutate?.(requestData);\r\n\r\n        // Apply optimistic update if provided\r\n        if (optimisticUpdate) {\r\n          optimisticUpdate(requestData);\r\n        }\r\n\r\n        let response: any;\r\n\r\n        // Use the appropriate public method based on HTTP method\r\n        switch (config.method) {\r\n          case 'GET':\r\n            response = await apiClient.get<TResponse>(config.url);\r\n            break;\r\n          case 'POST':\r\n            response = await apiClient.post<TResponse>(config.url, requestData);\r\n            break;\r\n          case 'PUT':\r\n            response = await apiClient.put<TResponse>(config.url, requestData);\r\n            break;\r\n          case 'PATCH':\r\n            response = await apiClient.patch<TResponse>(\r\n              config.url,\r\n              requestData\r\n            );\r\n            break;\r\n          case 'DELETE':\r\n            response = await apiClient.delete<TResponse>(config.url);\r\n            break;\r\n          default:\r\n            throw new Error(`Unsupported HTTP method: ${config.method}`);\r\n        }\r\n\r\n        if (!response.success) {\r\n          throw new Error(response.error || 'Mutation failed');\r\n        }\r\n\r\n        const responseData = response.data ?? null;\r\n        setData(responseData);\r\n        if (responseData) {\r\n          onSuccess?.(responseData);\r\n        }\r\n        return responseData as TResponse;\r\n      } catch (err) {\r\n        const apiError: ApiError = {\r\n          message: err instanceof Error ? err.message : 'Mutation failed',\r\n          code: 'MUTATION_FAILED',\r\n          status: 500,\r\n        };\r\n\r\n        setError(apiError);\r\n        onError?.(apiError);\r\n\r\n        // Rollback optimistic update if provided\r\n        if (rollbackOnError) {\r\n          rollbackOnError();\r\n        }\r\n\r\n        throw apiError;\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    },\r\n    [config, onSuccess, onError, onMutate, optimisticUpdate, rollbackOnError]\r\n  );\r\n\r\n  const reset = useCallback(() => {\r\n    setLoading(false);\r\n    setError(null);\r\n    setData(null);\r\n  }, []);\r\n\r\n  return {\r\n    mutate,\r\n    loading,\r\n    error,\r\n    data,\r\n    reset,\r\n  };\r\n}\r\n\r\n/**\r\n * Hook for real-time data with polling\r\n */\r\nexport function useTypedRealTime<T>(config: {\r\n  url: string;\r\n  interval?: number;\r\n}) {\r\n  const { interval = 30000, ...apiOptions } = config;\r\n  const [isPolling, setIsPolling] = useState(false);\r\n\r\n  const result = useTypedApi<T>(\r\n    {\r\n      method: 'GET',\r\n      url: config.url,\r\n    },\r\n    {\r\n      ...apiOptions,\r\n      immediate: false,\r\n    }\r\n  );\r\n\r\n  const startPolling = useCallback(() => {\r\n    setIsPolling(true);\r\n    result.execute();\r\n  }, [result]);\r\n\r\n  const stopPolling = useCallback(() => {\r\n    setIsPolling(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isPolling && interval > 0) {\r\n      const intervalId = setInterval(() => {\r\n        result.execute();\r\n      }, interval);\r\n\r\n      return () => clearInterval(intervalId);\r\n    }\r\n    return undefined;\r\n  }, [isPolling, interval, result]);\r\n\r\n  return {\r\n    ...result,\r\n    isPolling,\r\n    startPolling,\r\n    stopPolling,\r\n  };\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useUSBScanner.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'videoRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'videoRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":275,"column":18,"nodeType":"Identifier","endLine":275,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\r\nimport QrScanner from 'qr-scanner';\r\nimport { toast } from 'sonner';\r\n\r\ninterface ScannerConfig {\r\n  enabled: boolean;\r\n  minLength?: number;\r\n  maxLength?: number;\r\n  prefix?: string;\r\n  suffix?: string;\r\n  timeout?: number;\r\n  onScan?: (code: string) => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\ninterface ScanResult {\r\n  code: string;\r\n  timestamp: Date;\r\n  raw: string;\r\n}\r\n\r\nexport function useUSBScanner(config: ScannerConfig = { enabled: true }) {\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [lastScan, setLastScan] = useState<ScanResult | null>(null);\r\n  const [buffer, setBuffer] = useState<string>('');\r\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const bufferRef = useRef<string>('');\r\n\r\n  const {\r\n    enabled = true,\r\n    minLength = 3,\r\n    maxLength = 50,\r\n    prefix = '',\r\n    suffix = '',\r\n    timeout = 100,\r\n    onScan,\r\n    onError,\r\n  } = config;\r\n\r\n  const processBuffer = useCallback(\r\n    (finalBuffer: string) => {\r\n      try {\r\n        let code = finalBuffer.trim();\r\n\r\n        // Remove prefix if specified\r\n        if (prefix && code.startsWith(prefix)) {\r\n          code = code.substring(prefix.length);\r\n        }\r\n\r\n        // Remove suffix if specified\r\n        if (suffix && code.endsWith(suffix)) {\r\n          code = code.substring(0, code.length - suffix.length);\r\n        }\r\n\r\n        // Validate length\r\n        if (code.length < minLength || code.length > maxLength) {\r\n          throw new Error(\r\n            `Invalid scan length: ${code.length} (expected ${minLength}-${maxLength})`\r\n          );\r\n        }\r\n\r\n        const result: ScanResult = {\r\n          code,\r\n          raw: finalBuffer,\r\n          timestamp: new Date(),\r\n        };\r\n\r\n        setLastScan(result);\r\n        onScan?.(code);\r\n\r\n        return result;\r\n      } catch (error) {\r\n        const err =\r\n          error instanceof Error ? error : new Error('Unknown scan error');\r\n        onError?.(err);\r\n        throw err;\r\n      }\r\n    },\r\n    [prefix, suffix, minLength, maxLength, onScan, onError]\r\n  );\r\n\r\n  const clearBuffer = useCallback(() => {\r\n    bufferRef.current = '';\r\n    setBuffer('');\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n      timeoutRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const handleKeyPress = useCallback(\r\n    (event: KeyboardEvent) => {\r\n      if (!enabled) {\r\n        return;\r\n      }\r\n\r\n      // Detect scanner input (typically very fast typing)\r\n      const key = event.key;\r\n\r\n      // Start scanning on first character\r\n      if (bufferRef.current === '') {\r\n        setIsScanning(true);\r\n      }\r\n\r\n      // Clear existing timeout\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n\r\n      // Handle Enter key (common scanner suffix)\r\n      if (key === 'Enter') {\r\n        event.preventDefault();\r\n\r\n        if (bufferRef.current.length >= minLength) {\r\n          processBuffer(bufferRef.current);\r\n        }\r\n\r\n        clearBuffer();\r\n        setIsScanning(false);\r\n        return;\r\n      }\r\n\r\n      // Handle Tab key (alternative scanner suffix)\r\n      if (key === 'Tab' && bufferRef.current.length > 0) {\r\n        event.preventDefault();\r\n\r\n        if (bufferRef.current.length >= minLength) {\r\n          processBuffer(bufferRef.current);\r\n        }\r\n\r\n        clearBuffer();\r\n        setIsScanning(false);\r\n        return;\r\n      }\r\n\r\n      // Ignore special keys\r\n      if (key.length > 1 && key !== 'Enter' && key !== 'Tab') {\r\n        return;\r\n      }\r\n\r\n      // Add character to buffer\r\n      bufferRef.current += key;\r\n      setBuffer(bufferRef.current);\r\n\r\n      // Set timeout to clear buffer if no more input\r\n      timeoutRef.current = setTimeout(() => {\r\n        if (bufferRef.current.length >= minLength) {\r\n          try {\r\n            processBuffer(bufferRef.current);\r\n          } catch (error) {\r\n            console.error('Scanner processing error:', error);\r\n          }\r\n        }\r\n        clearBuffer();\r\n        setIsScanning(false);\r\n      }, timeout);\r\n    },\r\n    [enabled, minLength, timeout, processBuffer, clearBuffer]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (enabled) {\r\n      window.addEventListener('keypress', handleKeyPress);\r\n      return () => {\r\n        window.removeEventListener('keypress', handleKeyPress);\r\n        if (timeoutRef.current) {\r\n          clearTimeout(timeoutRef.current);\r\n        }\r\n      };\r\n    }\r\n    return undefined;\r\n  }, [enabled, handleKeyPress]);\r\n\r\n  const reset = useCallback(() => {\r\n    clearBuffer();\r\n    setLastScan(null);\r\n    setIsScanning(false);\r\n  }, [clearBuffer]);\r\n\r\n  return {\r\n    isScanning,\r\n    lastScan,\r\n    buffer,\r\n    reset,\r\n    clearBuffer,\r\n  };\r\n}\r\n\r\n// Hook for QR code scanner (using device camera)\r\nexport function useQRScanner() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [result, setResult] = useState<string | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [stream, setStream] = useState<MediaStream | null>(null);\r\n  const videoRef = useRef<HTMLVideoElement | null>(null);\r\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n  const scanningRef = useRef(false);\r\n\r\n  const startScanning = useCallback(async () => {\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\r\n        video: { facingMode: 'environment' },\r\n      });\r\n\r\n      setStream(mediaStream);\r\n      setIsOpen(true);\r\n      scanningRef.current = true;\r\n\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = mediaStream;\r\n      }\r\n    } catch (err) {\r\n      const error =\r\n        err instanceof Error ? err : new Error('Failed to access camera');\r\n      setError(error);\r\n      toast.error('Failed to access camera');\r\n    }\r\n  }, []);\r\n\r\n  const stopScanning = useCallback(() => {\r\n    if (stream) {\r\n      stream.getTracks().forEach((track) => track.stop());\r\n      setStream(null);\r\n    }\r\n    setIsOpen(false);\r\n    scanningRef.current = false;\r\n  }, [stream]);\r\n\r\n  const captureFrame = useCallback(() => {\r\n    if (!videoRef.current || !canvasRef.current || !scanningRef.current) {\r\n      return;\r\n    }\r\n\r\n    const video = videoRef.current;\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    if (!ctx) {\r\n      return;\r\n    }\r\n\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n    ctx.drawImage(video, 0, 0);\r\n\r\n    // Extract QR code (you would use a QR code library like jsQR here)\r\n    // Camera-based QR scanning using qr-scanner library\r\n\r\n    // Use QrScanner to scan the canvas directly\r\n    QrScanner.scanImage(canvas, { returnDetailedScanResult: true })\r\n      .then((result) => {\r\n        if (result?.data) {\r\n          setResult(result.data);\r\n          stopScanning();\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.warn('QR scan failed:', error);\r\n        // Continue to next frame if QR not found\r\n      });\r\n\r\n    // Continue scanning\r\n    if (scanningRef.current) {\r\n      requestAnimationFrame(captureFrame);\r\n    }\r\n  }, [stopScanning]);\r\n\r\n  useEffect(() => {\r\n    if (isOpen && videoRef.current) {\r\n      videoRef.current.addEventListener('play', captureFrame);\r\n    }\r\n\r\n    return () => {\r\n      if (videoRef.current) {\r\n        videoRef.current.removeEventListener('play', captureFrame);\r\n      }\r\n    };\r\n  }, [isOpen, captureFrame]);\r\n\r\n  const reset = useCallback(() => {\r\n    setResult(null);\r\n    setError(null);\r\n  }, []);\r\n\r\n  return {\r\n    isOpen,\r\n    result,\r\n    error,\r\n    videoRef,\r\n    canvasRef,\r\n    startScanning,\r\n    stopScanning,\r\n    reset,\r\n  };\r\n}\r\n\r\n// Hook for continuous scanner monitoring\r\nexport function useScannerMonitor(\r\n  onScan: (code: string, type: 'barcode' | 'qr') => void\r\n) {\r\n  const [scanCount, setScanCount] = useState(0);\r\n  const [lastScanTime, setLastScanTime] = useState<Date | null>(null);\r\n  const [scanHistory, setScanHistory] = useState<\r\n    Array<{ code: string; timestamp: Date; type: string }>\r\n  >([]);\r\n\r\n  const handleUSBScan = useCallback(\r\n    (code: string) => {\r\n      setScanCount((prev) => prev + 1);\r\n      setLastScanTime(new Date());\r\n      setScanHistory((prev) => [\r\n        ...prev.slice(-9),\r\n        { code, timestamp: new Date(), type: 'usb' },\r\n      ]);\r\n      onScan(code, 'barcode');\r\n    },\r\n    [onScan]\r\n  );\r\n\r\n  const usbScanner = useUSBScanner({\r\n    enabled: true,\r\n    minLength: 3,\r\n    maxLength: 50,\r\n    timeout: 100,\r\n    onScan: handleUSBScan,\r\n  });\r\n\r\n  const clearHistory = useCallback(() => {\r\n    setScanHistory([]);\r\n    setScanCount(0);\r\n  }, []);\r\n\r\n  return {\r\n    usbScanner,\r\n    scanCount,\r\n    lastScanTime,\r\n    scanHistory,\r\n    clearHistory,\r\n    isScanning: usbScanner.isScanning,\r\n  };\r\n}\r\n\r\nexport default useUSBScanner;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\hooks\\useWebSocket.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":8,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[230,233],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[230,233],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'state.connectionAttempts'. Either include it or remove the dependency array.","line":302,"column":6,"nodeType":"ArrayExpression","endLine":314,"endColumn":4,"suggestions":[{"desc":"Update the dependencies array to be: [token, createWebSocket, setupHeartbeat, subscriptions, onConnect, onMessage, onError, clearHeartbeat, onDisconnect, state.connectionAttempts, maxReconnectAttempts, reconnectInterval]","fix":{"range":[8584,8802],"text":"[token, createWebSocket, setupHeartbeat, subscriptions, onConnect, onMessage, onError, clearHeartbeat, onDisconnect, state.connectionAttempts, maxReconnectAttempts, reconnectInterval]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":334,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":334,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9272,9275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9272,9275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":365,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":365,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10022,10025],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10022,10025],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'connect'. Either include it or remove the dependency array.","line":407,"column":6,"nodeType":"ArrayExpression","endLine":407,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [autoConnect, user, token, connect]","fix":{"range":[11050,11076],"text":"[autoConnect, user, token, connect]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":463,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":463,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12415,12418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12415,12418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":467,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":467,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12583,12586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12583,12586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":479,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":479,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12875,12878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12875,12878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":494,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":494,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13176,13179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13176,13179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":514,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":514,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13739,13742],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13739,13742],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":518,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":518,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13918,13921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13918,13921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":537,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":537,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14321,14324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14321,14324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { toast } from 'sonner';\r\n\r\nexport interface WebSocketMessage {\r\n  id: string;\r\n  type: string;\r\n  data: any;\r\n  timestamp: string;\r\n}\r\n\r\nexport interface WebSocketState {\r\n  isConnected: boolean;\r\n  isConnecting: boolean;\r\n  error: string | null;\r\n  lastMessage: WebSocketMessage | null;\r\n  connectionAttempts: number;\r\n}\r\n\r\nexport interface WebSocketOptions {\r\n  autoConnect?: boolean;\r\n  reconnectInterval?: number;\r\n  maxReconnectAttempts?: number;\r\n  heartbeatInterval?: number;\r\n  subscriptions?: string[];\r\n  onConnect?: () => void;\r\n  onDisconnect?: () => void;\r\n  onError?: (error: string) => void;\r\n  onMessage?: (message: WebSocketMessage) => void;\r\n}\r\n\r\nexport const useWebSocket = (options: WebSocketOptions = {}) => {\r\n  const {\r\n    autoConnect = true,\r\n    reconnectInterval = 3000,\r\n    maxReconnectAttempts = 5,\r\n    heartbeatInterval = 30000,\r\n    subscriptions = [],\r\n    onConnect,\r\n    onDisconnect,\r\n    onError,\r\n    onMessage,\r\n  } = options;\r\n\r\n  const { user, token } = useAuth();\r\n  const wsRef = useRef<WebSocket | null>(null);\r\n  const heartbeatRef = useRef<NodeJS.Timeout | null>(null);\r\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const [state, setState] = useState<WebSocketState>({\r\n    isConnected: false,\r\n    isConnecting: false,\r\n    error: null,\r\n    lastMessage: null,\r\n    connectionAttempts: 0,\r\n  });\r\n\r\n  const getWebSocketUrl = useCallback(() => {\r\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\r\n    const host = window.location.hostname;\r\n    const port = import.meta.env.VITE_WS_URL\r\n      ? new URL(import.meta.env.VITE_WS_URL).port\r\n      : '3001'; // Use backend port by default\r\n    const wsUrl = `${protocol}//${host}:${port}/ws?token=${encodeURIComponent(token || '')}`;\r\n    return wsUrl;\r\n  }, [token]);\r\n\r\n  const createWebSocket = useCallback(() => {\r\n    if (!token) {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        error: 'Authentication token required for WebSocket connection',\r\n      }));\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const ws = new WebSocket(getWebSocketUrl());\r\n      return ws;\r\n    } catch (error) {\r\n      const errorMessage = `Failed to create WebSocket connection: ${(error as Error).message}`;\r\n      setState((prev) => ({\r\n        ...prev,\r\n        error: errorMessage,\r\n        isConnecting: false,\r\n      }));\r\n      onError?.(errorMessage);\r\n      return null;\r\n    }\r\n  }, [token, getWebSocketUrl, onError]);\r\n\r\n  const setupHeartbeat = useCallback(() => {\r\n    if (heartbeatRef.current) {\r\n      clearInterval(heartbeatRef.current);\r\n    }\r\n\r\n    heartbeatRef.current = setInterval(() => {\r\n      if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n        wsRef.current.send(JSON.stringify({ type: 'ping' }));\r\n      }\r\n    }, heartbeatInterval);\r\n  }, [heartbeatInterval]);\r\n\r\n  const clearHeartbeat = useCallback(() => {\r\n    if (heartbeatRef.current) {\r\n      clearInterval(heartbeatRef.current);\r\n      heartbeatRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const clearReconnectTimeout = useCallback(() => {\r\n    if (reconnectTimeoutRef.current) {\r\n      clearTimeout(reconnectTimeoutRef.current);\r\n      reconnectTimeoutRef.current = null;\r\n    }\r\n  }, []);\r\n\r\n  const connect = useCallback(() => {\r\n    // Check if already connecting or connected using refs\r\n    if (\r\n      wsRef.current?.readyState === WebSocket.CONNECTING ||\r\n      wsRef.current?.readyState === WebSocket.OPEN\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (!token) {\r\n      setState((prev) => ({\r\n        ...prev,\r\n        error: 'Authentication required for WebSocket connection',\r\n      }));\r\n      return;\r\n    }\r\n\r\n    setState((prev) => ({\r\n      ...prev,\r\n      isConnecting: true,\r\n      error: null,\r\n    }));\r\n\r\n    const ws = createWebSocket();\r\n    if (!ws) {\r\n      return;\r\n    }\r\n\r\n    wsRef.current = ws;\r\n\r\n    ws.onopen = () => {\r\n      console.debug('WebSocket connected');\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isConnected: true,\r\n        isConnecting: false,\r\n        error: null,\r\n        connectionAttempts: 0,\r\n      }));\r\n\r\n      // Setup heartbeat\r\n      setupHeartbeat();\r\n\r\n      // Subscribe to specified channels\r\n      subscriptions.forEach((subscription) => {\r\n        ws.send(\r\n          JSON.stringify({\r\n            type: 'subscribe',\r\n            data: { subscription },\r\n          })\r\n        );\r\n      });\r\n\r\n      onConnect?.();\r\n      toast.success('Real-time connection established');\r\n    };\r\n\r\n    ws.onmessage = (event) => {\r\n      try {\r\n        const message: WebSocketMessage = JSON.parse(event.data);\r\n\r\n        setState((prev) => ({\r\n          ...prev,\r\n          lastMessage: message,\r\n        }));\r\n\r\n        // Handle pong response\r\n        if (message.type === 'pong') {\r\n          return;\r\n        }\r\n\r\n        // Handle welcome message\r\n        if (message.type === 'welcome') {\r\n          console.debug('WebSocket welcome message:', message.data);\r\n          return;\r\n        }\r\n\r\n        // Handle errors\r\n        if (message.type === 'error') {\r\n          console.error('WebSocket error:', message.data.error);\r\n          onError?.(message.data.error);\r\n          return;\r\n        }\r\n\r\n        // Handle subscription confirmations\r\n        if (message.type === 'subscription_confirmed') {\r\n          console.debug('Subscribed to:', message.data.subscription);\r\n          return;\r\n        }\r\n\r\n        // Pass message to custom handler\r\n        onMessage?.(message);\r\n\r\n        // Handle different message types\r\n        switch (message.type) {\r\n          case 'student_activity_update':\r\n            toast.info(\r\n              `Student activity: ${message.data.studentName} - ${message.data.activityType}`\r\n            );\r\n            break;\r\n          case 'equipment_status_update':\r\n            toast.warning(\r\n              `Equipment update: ${message.data.equipmentName} - ${message.data.status}`\r\n            );\r\n            break;\r\n          case 'system_notification': {\r\n            const notificationType = message.data\r\n              .notificationType as keyof typeof toast;\r\n            const title =\r\n              typeof message.data.title === 'string'\r\n                ? message.data.title\r\n                : message.data.title?.message || 'Notification';\r\n            if (\r\n              notificationType &&\r\n              typeof toast[notificationType] === 'function'\r\n            ) {\r\n              (toast[notificationType] as (message: string) => void)(title);\r\n            } else {\r\n              toast.info(title);\r\n            }\r\n            break;\r\n          }\r\n          case 'emergency_alert':\r\n            toast.error(`≡ƒÜ¿ EMERGENCY: ${message.data.message}`);\r\n            break;\r\n          default:\r\n            console.debug('WebSocket message:', message);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error parsing WebSocket message:', error);\r\n      }\r\n    };\r\n\r\n    ws.onclose = (event) => {\r\n      console.debug('WebSocket disconnected:', event.code, event.reason);\r\n      clearHeartbeat();\r\n\r\n      setState((prev) => ({\r\n        ...prev,\r\n        isConnected: false,\r\n        isConnecting: false,\r\n      }));\r\n\r\n      onDisconnect?.();\r\n\r\n      // Attempt reconnection if not a normal closure\r\n      if (\r\n        event.code !== 1000 &&\r\n        state.connectionAttempts < maxReconnectAttempts\r\n      ) {\r\n        const nextAttempt = state.connectionAttempts + 1;\r\n        setState((prev) => ({\r\n          ...prev,\r\n          connectionAttempts: nextAttempt,\r\n        }));\r\n\r\n        reconnectTimeoutRef.current = setTimeout(() => {\r\n          console.debug(\r\n            `Attempting WebSocket reconnection (${nextAttempt}/${maxReconnectAttempts})`\r\n          );\r\n          connect();\r\n        }, reconnectInterval);\r\n      } else if (state.connectionAttempts >= maxReconnectAttempts) {\r\n        const errorMessage =\r\n          'Failed to establish WebSocket connection after maximum attempts';\r\n        setState((prev) => ({\r\n          ...prev,\r\n          error: errorMessage,\r\n        }));\r\n        onError?.(errorMessage);\r\n        toast.error('Real-time connection failed');\r\n      }\r\n    };\r\n\r\n    ws.onerror = (error) => {\r\n      console.error('WebSocket error:', error);\r\n      const errorMessage = 'WebSocket connection error';\r\n      setState((prev) => ({\r\n        ...prev,\r\n        error: errorMessage,\r\n        isConnecting: false,\r\n      }));\r\n      onError?.(errorMessage);\r\n    };\r\n  }, [\r\n    token,\r\n    createWebSocket,\r\n    setupHeartbeat,\r\n    clearHeartbeat,\r\n    subscriptions,\r\n    reconnectInterval,\r\n    maxReconnectAttempts,\r\n    onConnect,\r\n    onDisconnect,\r\n    onError,\r\n    onMessage,\r\n  ]);\r\n\r\n  const disconnect = useCallback(() => {\r\n    clearHeartbeat();\r\n    clearReconnectTimeout();\r\n\r\n    if (wsRef.current) {\r\n      wsRef.current.close(1000, 'User disconnect');\r\n      wsRef.current = null;\r\n    }\r\n\r\n    setState({\r\n      isConnected: false,\r\n      isConnecting: false,\r\n      error: null,\r\n      lastMessage: null,\r\n      connectionAttempts: 0,\r\n    });\r\n  }, [clearHeartbeat, clearReconnectTimeout]);\r\n\r\n  const sendMessage = useCallback((message: any) => {\r\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\r\n      wsRef.current.send(JSON.stringify(message));\r\n      return true;\r\n    } else {\r\n      console.warn('WebSocket not connected, cannot send message');\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  const subscribe = useCallback(\r\n    (subscription: string) => {\r\n      return sendMessage({\r\n        type: 'subscribe',\r\n        data: { subscription },\r\n      });\r\n    },\r\n    [sendMessage]\r\n  );\r\n\r\n  const unsubscribe = useCallback(\r\n    (subscription: string) => {\r\n      return sendMessage({\r\n        type: 'unsubscribe',\r\n        data: { subscription },\r\n      });\r\n    },\r\n    [sendMessage]\r\n  );\r\n\r\n  const requestDashboardData = useCallback(\r\n    (dataType: string, filters?: any) => {\r\n      return sendMessage({\r\n        type: 'dashboard_request',\r\n        data: { dataType, filters },\r\n      });\r\n    },\r\n    [sendMessage]\r\n  );\r\n\r\n  const sendChatMessage = useCallback(\r\n    (message: string, targetRole?: string, targetUserId?: string) => {\r\n      return sendMessage({\r\n        type: 'chat_message',\r\n        data: { message, targetRole, targetUserId },\r\n      });\r\n    },\r\n    [sendMessage]\r\n  );\r\n\r\n  const triggerEmergencyAlert = useCallback(\r\n    (alertType: string, message: string, location?: string) => {\r\n      return sendMessage({\r\n        type: 'emergency_alert',\r\n        data: { alertType, message, location, severity: 'critical' },\r\n      });\r\n    },\r\n    [sendMessage]\r\n  );\r\n\r\n  // Auto-connect on mount\r\n  useEffect(() => {\r\n    if (autoConnect && user && token) {\r\n      connect();\r\n    }\r\n\r\n    // Cleanup on unmount only\r\n    return () => {\r\n      if (wsRef.current) {\r\n        wsRef.current.close(1000, 'Component unmount');\r\n        wsRef.current = null;\r\n      }\r\n    };\r\n  }, [autoConnect, user, token]); // Removed connect and disconnect from dependencies\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      clearHeartbeat();\r\n      clearReconnectTimeout();\r\n      if (wsRef.current) {\r\n        wsRef.current.close();\r\n      }\r\n    };\r\n  }, [clearHeartbeat, clearReconnectTimeout]);\r\n\r\n  return {\r\n    ...state,\r\n    connect,\r\n    disconnect,\r\n    sendMessage,\r\n    subscribe,\r\n    unsubscribe,\r\n    requestDashboardData,\r\n    sendChatMessage,\r\n    triggerEmergencyAlert,\r\n  };\r\n};\r\n\r\n// Hook for specific subscription types\r\nexport const useWebSocketSubscription = (\r\n  subscription: string,\r\n  options: Omit<WebSocketOptions, 'subscriptions'> = {}\r\n) => {\r\n  const [messages, setMessages] = useState<WebSocketMessage[]>([]);\r\n\r\n  const handleNewMessage = useCallback((message: WebSocketMessage) => {\r\n    setMessages((prev) => [...prev.slice(-99), message]); // Keep last 100 messages\r\n  }, []);\r\n\r\n  const ws = useWebSocket({\r\n    ...options,\r\n    subscriptions: [subscription],\r\n    onMessage: handleNewMessage,\r\n  });\r\n\r\n  const clearMessages = useCallback(() => {\r\n    setMessages([]);\r\n  }, []);\r\n\r\n  return {\r\n    ...ws,\r\n    messages,\r\n    clearMessages,\r\n  };\r\n};\r\n\r\n// Hook for real-time dashboard updates\r\nexport const useDashboardWebSocket = () => {\r\n  const [dashboardData, setDashboardData] = useState<any>({});\r\n\r\n  const handleDashboardMessage = useCallback((message: WebSocketMessage) => {\r\n    if (message.type === 'dashboard_data') {\r\n      setDashboardData((prev: any) => ({\r\n        ...prev,\r\n        [message.data.dataType]: message.data.data,\r\n      }));\r\n    }\r\n  }, []);\r\n\r\n  const ws = useWebSocketSubscription('dashboard', {\r\n    onMessage: handleDashboardMessage,\r\n  });\r\n\r\n  const refreshDashboard = useCallback(\r\n    (dataType: string, filters?: any) => {\r\n      ws.requestDashboardData(dataType, filters);\r\n    },\r\n    [ws]\r\n  );\r\n\r\n  return {\r\n    ...ws,\r\n    dashboardData,\r\n    refreshDashboard,\r\n  };\r\n};\r\n\r\n// Hook for activity updates\r\nexport const useActivityWebSocket = () => {\r\n  const [recentActivities, setRecentActivities] = useState<any[]>([]);\r\n\r\n  const handleActivityMessage = useCallback((message: WebSocketMessage) => {\r\n    if (message.type === 'student_activity_update') {\r\n      setRecentActivities((prev) => [message.data, ...prev.slice(0, 49)]); // Keep last 50\r\n    }\r\n  }, []);\r\n\r\n  const ws = useWebSocketSubscription('activities', {\r\n    onMessage: handleActivityMessage,\r\n  });\r\n\r\n  return {\r\n    ...ws,\r\n    recentActivities,\r\n  };\r\n};\r\n\r\n// Hook for equipment status updates\r\nexport const useEquipmentWebSocket = () => {\r\n  const [equipmentStatus, setEquipmentStatus] = useState<any>({});\r\n\r\n  const handleEquipmentMessage = useCallback((message: WebSocketMessage) => {\r\n    if (message.type === 'equipment_status_update') {\r\n      setEquipmentStatus((prev: any) => ({\r\n        ...prev,\r\n        [message.data.equipmentId]: message.data,\r\n      }));\r\n    }\r\n  }, []);\r\n\r\n  const ws = useWebSocketSubscription('equipment', {\r\n    onMessage: handleEquipmentMessage,\r\n  });\r\n\r\n  return {\r\n    ...ws,\r\n    equipmentStatus,\r\n  };\r\n};\r\n\r\n// Hook for notifications\r\nexport const useNotificationWebSocket = () => {\r\n  const [notifications, setNotifications] = useState<any[]>([]);\r\n\r\n  const handleNotificationMessage = useCallback((message: WebSocketMessage) => {\r\n    if (message.type === 'system_notification') {\r\n      setNotifications((prev) => [message.data, ...prev.slice(0, 49)]); // Keep last 50\r\n    }\r\n  }, []);\r\n\r\n  const ws = useWebSocketSubscription('notifications', {\r\n    onMessage: handleNotificationMessage,\r\n  });\r\n\r\n  const clearNotifications = useCallback(() => {\r\n    setNotifications([]);\r\n  }, []);\r\n\r\n  return {\r\n    ...ws,\r\n    notifications,\r\n    clearNotifications,\r\n  };\r\n};\r\n\r\nexport default useWebSocket;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\api-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\api.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":6,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[149,152],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[149,152],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[933,936],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[933,936],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1152,1155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1152,1155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1171,1174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1171,1174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1384,1387],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1384,1387],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3421,3424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3421,3424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3801,3804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3801,3804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":464,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":464,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13735,13738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13735,13738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":468,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":468,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13877,13880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13877,13880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":555,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":555,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16323,16326],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16323,16326],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":561,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":561,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16615,16618],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16615,16618],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":582,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":582,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17426,17429],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17426,17429],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":584,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":584,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17526,17529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17526,17529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import axios from 'axios';\r\n\r\nimport { setupInterceptors } from './api/interceptors';\r\n\r\n// API response interface\r\nexport interface ApiResponse<T = any> {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: string;\r\n  message?: string;\r\n  timestamp?: string;\r\n}\r\n\r\n// Login response interface\r\nexport interface LoginResponse {\r\n  accessToken: string;\r\n  user: {\r\n    id: string;\r\n    username: string;\r\n    role: string;\r\n  };\r\n}\r\n\r\n// API client class\r\nclass ApiClient {\r\n  private client: ReturnType<typeof axios.create>;\r\n  private DEFAULT_API_URL =\r\n    import.meta.env.VITE_API_URL || 'http://localhost:3001';\r\n\r\n  constructor(baseURL: string = this.DEFAULT_API_URL) {\r\n    this.client = axios.create({\r\n      baseURL,\r\n      timeout: 10000,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    setupInterceptors(this.client);\r\n  }\r\n\r\n  // Generic GET request\r\n  async get<T>(url: string, params?: any): Promise<ApiResponse<T>> {\r\n    const response = await this.client.get<ApiResponse<T>>(url, { params });\r\n    return response.data;\r\n  }\r\n\r\n  // Generic POST request\r\n  async post<T>(\r\n    url: string,\r\n    data?: any,\r\n    config?: any\r\n  ): Promise<ApiResponse<T>> {\r\n    const response = await this.client.post<ApiResponse<T>>(url, data, config);\r\n    return response.data;\r\n  }\r\n\r\n  // Generic PUT request\r\n  async put<T>(url: string, data?: any): Promise<ApiResponse<T>> {\r\n    const response = await this.client.put<ApiResponse<T>>(url, data);\r\n    return response.data;\r\n  }\r\n\r\n  // Generic DELETE request\r\n  async delete<T>(url: string): Promise<ApiResponse<T>> {\r\n    const response = await this.client.delete<ApiResponse<T>>(url);\r\n    return response.data;\r\n  }\r\n\r\n  // Health check\r\n  async healthCheck(): Promise<ApiResponse> {\r\n    return this.get('/health');\r\n  }\r\n\r\n  // Test connection\r\n  async testConnection(): Promise<boolean> {\r\n    try {\r\n      await this.healthCheck();\r\n      return true;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\n// Create and export the API client instance\r\nexport const apiClient = new ApiClient();\r\n\r\nexport {\r\n  setAccessTokenProvider,\r\n  setUnauthorizedHandler,\r\n} from './api/interceptors';\r\n\r\n// Specific API services\r\nexport const automationApi = {\r\n  // Health check\r\n  health: () => apiClient.get('/health'),\r\n\r\n  // Get all automation jobs\r\n  getJobs: () => apiClient.get('/api/automation/jobs'),\r\n\r\n  // Get specific job status\r\n  getJob: (id: string) => apiClient.get(`/api/automation/jobs/${id}`),\r\n\r\n  // Trigger job manually\r\n  triggerJob: (id: string) =>\r\n    apiClient.post(`/api/automation/jobs/${id}/trigger`),\r\n\r\n  // Get queue status\r\n  getQueueStatus: () => apiClient.get('/api/automation/queues/status'),\r\n\r\n  // Test Google Sheets connection\r\n  testGoogleSheets: () => apiClient.get('/api/automation/google-sheets/test'),\r\n\r\n  // Generate daily report\r\n  getDailyReport: (date?: Date) => {\r\n    const params = date ? { date: date.toISOString() } : undefined;\r\n    return apiClient.get('/api/automation/reports/daily', params);\r\n  },\r\n};\r\n\r\nexport const studentsApi = {\r\n  // Get all students\r\n  getStudents: () => apiClient.get('/api/students'),\r\n\r\n  // Get student by ID\r\n  getStudent: (id: string) => apiClient.get(`/api/students/${id}`),\r\n\r\n  // Create new student\r\n  createStudent: (data: unknown) => apiClient.post('/api/students', data),\r\n\r\n  // Update student\r\n  updateStudent: (id: string, data: any) =>\r\n    apiClient.put(`/api/students/${id}`, data),\r\n\r\n  // Delete student\r\n  deleteStudent: (id: string) => apiClient.delete(`/api/students/${id}`),\r\n\r\n  // Log student activity\r\n  logActivity: (data: unknown) => apiClient.post('/api/students/activity', data),\r\n\r\n  // Import students (enhanced with field mapping)\r\n  importStudents: (\r\n    file: File,\r\n    fieldMappings?: any[],\r\n    dryRun: boolean = false\r\n  ) => {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    if (fieldMappings) {\r\n      formData.append('fieldMappings', JSON.stringify(fieldMappings));\r\n    }\r\n    formData.append('dryRun', dryRun.toString());\r\n\r\n    return apiClient.post('/api/import/students/enhanced', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n  },\r\n\r\n  // Preview import file\r\n  previewImport: (\r\n    file: File,\r\n    importType: string = 'students',\r\n    maxPreviewRows: number = 10\r\n  ) => {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('importType', importType);\r\n    formData.append('maxPreviewRows', maxPreviewRows.toString());\r\n\r\n    return apiClient.post('/api/import/preview', formData, {\r\n      headers: {\r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    });\r\n  },\r\n\r\n  // Download import template\r\n  downloadTemplate: () => {\r\n    return apiClient.get('/api/import/templates/students');\r\n  },\r\n};\r\n\r\nexport const equipmentApi = {\r\n  // Get all equipment\r\n  getEquipment: () => apiClient.get('/api/equipment'),\r\n\r\n  // Get equipment by ID\r\n  getEquipmentById: (id: string) => apiClient.get(`/api/equipment/${id}`),\r\n\r\n  // Start session\r\n  startSession: (\r\n    equipmentId: string,\r\n    studentId: string,\r\n    timeLimitMinutes: number\r\n  ) =>\r\n    apiClient.post('/api/equipment/session', {\r\n      equipmentId,\r\n      studentId,\r\n      timeLimitMinutes,\r\n    }),\r\n\r\n  // End session\r\n  endSession: (sessionId: string) =>\r\n    apiClient.post(`/api/equipment/session/${sessionId}/end`),\r\n\r\n  // Extend session\r\n  extendSession: (sessionId: string, additionalMinutes: number) =>\r\n    apiClient.post(`/api/equipment/session/${sessionId}/extend`, {\r\n      additionalMinutes,\r\n    }),\r\n};\r\n\r\nexport const analyticsApi = {\r\n  // Get dashboard metrics\r\n  getMetrics: () => apiClient.get('/api/analytics/metrics'),\r\n\r\n  // Get usage statistics\r\n  getUsageStats: (period: 'day' | 'week' | 'month' = 'day') =>\r\n    apiClient.get('/api/analytics/usage', { period }),\r\n\r\n  // Get activity timeline\r\n  getTimeline: (limit?: number) =>\r\n    apiClient.get('/api/analytics/timeline', limit ? { limit } : undefined),\r\n\r\n  // Get notifications for calendar\r\n  getNotifications: () => apiClient.get('/api/analytics/notifications'),\r\n\r\n  // Export data\r\n  exportData: (\r\n    format: 'csv' | 'json' = 'csv',\r\n    dateRange?: { start: Date; end: Date }\r\n  ) => {\r\n    const params: Record<string, unknown> = { format };\r\n    if (dateRange) {\r\n      params.startDate = dateRange.start.toISOString();\r\n      params.endDate = dateRange.end.toISOString();\r\n    }\r\n    return apiClient.get('/api/analytics/export', params);\r\n  },\r\n};\r\n\r\nexport const utilitiesApi = {\r\n  // Documentation Methods\r\n  // Get comprehensive documentation information\r\n  getDocumentation: () => apiClient.get('/api/utilities/documentation'),\r\n\r\n  // Refresh documentation cache\r\n  refreshDocumentation: () =>\r\n    apiClient.post('/api/utilities/documentation/refresh'),\r\n\r\n  // Get documentation health status\r\n  getDocumentationHealth: () =>\r\n    apiClient.get('/api/utilities/documentation/health'),\r\n\r\n  // Real-time Documentation Update Methods\r\n  // Get documentation version information\r\n  getDocumentationVersion: () =>\r\n    apiClient.get('/api/utilities/documentation/version'),\r\n\r\n  // Get documentation change history\r\n  getDocumentationHistory: (params?: {\r\n    limit?: number;\r\n    offset?: number;\r\n    since?: string;\r\n  }) => apiClient.get('/api/utilities/documentation/history', params),\r\n\r\n  // Submit documentation update\r\n  submitDocumentationUpdate: (updateData: {\r\n    type:\r\n      | 'content_change'\r\n      | 'structure_change'\r\n      | 'metadata_update'\r\n      | 'version_update';\r\n    changes: Array<{\r\n      file: string;\r\n      section?: string;\r\n      oldContent?: string;\r\n      newContent?: string;\r\n      changeType: 'added' | 'modified' | 'deleted' | 'moved';\r\n    }>;\r\n    metadata: {\r\n      impactLevel: 'low' | 'medium' | 'high' | 'critical';\r\n      requiresReview: boolean;\r\n      description?: string;\r\n    };\r\n  }) => apiClient.post('/api/utilities/documentation/updates', updateData),\r\n\r\n  // Get pending documentation updates\r\n  getPendingUpdates: () =>\r\n    apiClient.get('/api/utilities/documentation/updates/pending'),\r\n\r\n  // Approve documentation update\r\n  approveDocumentationUpdate: (\r\n    updateId: string,\r\n    approvalData?: { notes?: string }\r\n  ) =>\r\n    apiClient.post(\r\n      `/api/utilities/documentation/updates/${updateId}/approve`,\r\n      approvalData\r\n    ),\r\n\r\n  // Reject documentation update\r\n  rejectDocumentationUpdate: (\r\n    updateId: string,\r\n    rejectionData: { reason: string; notes?: string }\r\n  ) =>\r\n    apiClient.post(\r\n      `/api/utilities/documentation/updates/${updateId}/reject`,\r\n      rejectionData\r\n    ),\r\n\r\n  // Get documentation update status\r\n  getUpdateStatus: (updateId: string) =>\r\n    apiClient.get(`/api/utilities/documentation/updates/${updateId}/status`),\r\n\r\n  // Rollback documentation to previous version\r\n  rollbackDocumentation: (\r\n    versionHash: string,\r\n    rollbackData?: { reason?: string }\r\n  ) =>\r\n    apiClient.post('/api/utilities/documentation/rollback', {\r\n      versionHash,\r\n      ...rollbackData,\r\n    }),\r\n\r\n  // Get documentation conflicts\r\n  getDocumentationConflicts: () =>\r\n    apiClient.get('/api/utilities/documentation/conflicts'),\r\n\r\n  // Resolve documentation conflict\r\n  resolveDocumentationConflict: (\r\n    conflictId: string,\r\n    resolution: {\r\n      strategy: 'accept_incoming' | 'accept_current' | 'merge_manual';\r\n      mergedContent?: string;\r\n      notes?: string;\r\n    }\r\n  ) =>\r\n    apiClient.post(\r\n      `/api/utilities/documentation/conflicts/${conflictId}/resolve`,\r\n      resolution\r\n    ),\r\n\r\n  // Subscribe to real-time documentation updates\r\n  subscribeToUpdates: (subscriptionData: {\r\n    types: Array<\r\n      | 'content_change'\r\n      | 'structure_change'\r\n      | 'metadata_update'\r\n      | 'version_update'\r\n    >;\r\n    files?: string[];\r\n    impactLevels?: Array<'low' | 'medium' | 'high' | 'critical'>;\r\n  }) =>\r\n    apiClient.post('/api/utilities/documentation/subscribe', subscriptionData),\r\n\r\n  // Unsubscribe from real-time documentation updates\r\n  unsubscribeFromUpdates: (subscriptionId: string) =>\r\n    apiClient.delete(\r\n      `/api/utilities/documentation/subscribe/${subscriptionId}`\r\n    ),\r\n\r\n  // Validate documentation integrity\r\n  validateDocumentationIntegrity: () =>\r\n    apiClient.post('/api/utilities/documentation/validate'),\r\n\r\n  // Get documentation metrics\r\n  getDocumentationMetrics: (params?: {\r\n    period?: 'day' | 'week' | 'month';\r\n    includeDetails?: boolean;\r\n  }) => apiClient.get('/api/utilities/documentation/metrics', params),\r\n\r\n  // Sync documentation with external sources\r\n  syncDocumentationSources: (syncData?: {\r\n    sources?: string[];\r\n    forceSync?: boolean;\r\n  }) => apiClient.post('/api/utilities/documentation/sync', syncData),\r\n\r\n  // Get documentation sync status\r\n  getDocumentationSyncStatus: () =>\r\n    apiClient.get('/api/utilities/documentation/sync/status'),\r\n\r\n  // Create documentation snapshot\r\n  createDocumentationSnapshot: (snapshotData: {\r\n    name: string;\r\n    description?: string;\r\n    tags?: string[];\r\n  }) => apiClient.post('/api/utilities/documentation/snapshots', snapshotData),\r\n\r\n  // Get documentation snapshots\r\n  getDocumentationSnapshots: (params?: { limit?: number; offset?: number }) =>\r\n    apiClient.get('/api/utilities/documentation/snapshots', params),\r\n\r\n  // Restore from documentation snapshot\r\n  restoreFromSnapshot: (\r\n    snapshotId: string,\r\n    restoreData?: { preserveCurrentAsSnapshot?: boolean }\r\n  ) =>\r\n    apiClient.post(\r\n      `/api/utilities/documentation/snapshots/${snapshotId}/restore`,\r\n      restoreData\r\n    ),\r\n\r\n  // Delete documentation snapshot\r\n  deleteDocumentationSnapshot: (snapshotId: string) =>\r\n    apiClient.delete(`/api/utilities/documentation/snapshots/${snapshotId}`),\r\n\r\n  // QR Code Methods\r\n  // Generate QR codes for all students\r\n  generateQRCodes: () => apiClient.post('/api/utilities/generate-qr-codes'),\r\n\r\n  // Generate QR code for single student\r\n  generateQRCode: (studentId: string) =>\r\n    apiClient.post(`/api/utilities/generate-qr-code/${studentId}`),\r\n\r\n  // Get QR generation report\r\n  getQRReport: () => apiClient.get('/api/utilities/qr-generation-report'),\r\n\r\n  // Get QR code image URL\r\n  getQRCodeUrl: (studentId: string) => `/api/utilities/qr-code/${studentId}`,\r\n\r\n  // Delete QR code\r\n  deleteQRCode: (studentId: string) =>\r\n    apiClient.delete(`/api/utilities/qr-code/${studentId}`),\r\n\r\n  // Regenerate QR code\r\n  regenerateQRCode: (studentId: string) =>\r\n    apiClient.post(`/api/utilities/regenerate-qr-code/${studentId}`),\r\n\r\n  // Get printable sheet URL\r\n  getPrintableSheetUrl: () => '/api/utilities/qr-codes-sheet',\r\n\r\n  // Barcode Methods\r\n  // Generate barcodes for all students\r\n  generateBarcodes: () => apiClient.post('/api/utilities/generate-barcodes'),\r\n\r\n  // Generate barcode for single student\r\n  generateBarcode: (studentId: string) =>\r\n    apiClient.post(`/api/utilities/generate-barcode/${studentId}`),\r\n\r\n  // Get barcode generation report\r\n  getBarcodeReport: () =>\r\n    apiClient.get('/api/utilities/barcode-generation-report'),\r\n\r\n  // Get barcode image URL\r\n  getBarcodeUrl: (studentId: string) => `/api/utilities/barcode/${studentId}`,\r\n\r\n  // Delete barcode\r\n  deleteBarcode: (studentId: string) =>\r\n    apiClient.delete(`/api/utilities/barcode/${studentId}`),\r\n\r\n  // Regenerate barcode\r\n  regenerateBarcode: (studentId: string) =>\r\n    apiClient.post(`/api/utilities/regenerate-barcode/${studentId}`),\r\n\r\n  // Get printable barcodes sheet URL\r\n  getBarcodesSheetUrl: () => '/api/utilities/barcodes-sheet',\r\n\r\n  // Quick Actions Methods\r\n  // Quick add student\r\n  quickAddStudent: (studentData: any) =>\r\n    apiClient.post('/api/utilities/quick-add-student', studentData),\r\n\r\n  // Quick start session\r\n  quickStartSession: (sessionData: any) =>\r\n    apiClient.post('/api/utilities/quick-start-session', sessionData),\r\n\r\n  // Get quick report\r\n  getQuickReport: () => apiClient.get('/api/utilities/quick-report'),\r\n\r\n  // Quick backup\r\n  quickBackup: () => apiClient.post('/api/utilities/quick-backup'),\r\n};\r\n\r\n// Reports API\r\nexport const reportsApi = {\r\n  // Get daily report\r\n  getDailyReport: (date?: string) => {\r\n    const params = date ? { date } : undefined;\r\n    return apiClient.get('/api/reports/daily', params);\r\n  },\r\n\r\n  // Get weekly report\r\n  getWeeklyReport: (date?: string) => {\r\n    const params = date ? { date } : undefined;\r\n    return apiClient.get('/api/reports/weekly', params);\r\n  },\r\n\r\n  // Get monthly report\r\n  getMonthlyReport: (month?: number, year?: number) => {\r\n    const params: Record<string, unknown> = {};\r\n    if (month) {\r\n      params.month = month;\r\n    }\r\n    if (year) {\r\n      params.year = year;\r\n    }\r\n    return apiClient.get('/api/reports/monthly', params);\r\n  },\r\n\r\n  // Get custom report\r\n  getCustomReport: (startDate: string, endDate: string) => {\r\n    return apiClient.get('/api/reports/custom', {\r\n      start: startDate,\r\n      end: endDate,\r\n    });\r\n  },\r\n};\r\n\r\n// Fines API\r\nexport const finesApi = {\r\n  // Get all fines\r\n  getFines: (status?: 'outstanding' | 'paid', studentId?: string) => {\r\n    const params: Record<string, unknown> = {};\r\n    if (status) {\r\n      params.status = status;\r\n    }\r\n    if (studentId) {\r\n      params.studentId = studentId;\r\n    }\r\n    return apiClient.get('/api/fines', params);\r\n  },\r\n\r\n  // Get fines for a specific student\r\n  getStudentFines: (studentId: string) => {\r\n    return apiClient.get(`/api/fines/student/${studentId}`);\r\n  },\r\n\r\n  // Record fine payment\r\n  recordPayment: (\r\n    checkoutId: string,\r\n    paymentData: { amountPaid: number; paymentMethod?: string; notes?: string }\r\n  ) => {\r\n    return apiClient.post(`/api/fines/${checkoutId}/payment`, paymentData);\r\n  },\r\n\r\n  // Waive fine\r\n  waiveFine: (checkoutId: string, reason: string) => {\r\n    return apiClient.post(`/api/fines/${checkoutId}/waive`, { reason });\r\n  },\r\n\r\n  // Update fine amount\r\n  updateFineAmount: (checkoutId: string, amount: number) => {\r\n    return apiClient.put(`/api/fines/${checkoutId}/amount`, { amount });\r\n  },\r\n};\r\n\r\n// Settings API\r\nexport const settingsApi = {\r\n  // System settings\r\n  getSystemSettings: () => apiClient.get('/api/settings/system'),\r\n  updateSystemSettings: (settings: any) =>\r\n    apiClient.put('/api/settings/system', settings),\r\n  resetSystemSettings: () => apiClient.post('/api/settings/system/reset'),\r\n\r\n  // Google Sheets configuration\r\n  getGoogleSheetsConfig: () => apiClient.get('/api/settings/google-sheets'),\r\n  updateGoogleSheetsSchedule: (config: any) =>\r\n    apiClient.put('/api/settings/google-sheets/schedule', config),\r\n  testGoogleSheetsConnection: (spreadsheetId: string) =>\r\n    apiClient.post('/api/settings/google-sheets/test', { spreadsheetId }),\r\n  syncGoogleSheets: () => apiClient.post('/api/settings/google-sheets/sync'),\r\n\r\n  // Backups\r\n  getBackups: () => apiClient.get('/api/settings/backups'),\r\n  createBackup: () => apiClient.post('/api/settings/backups/create'),\r\n  deleteBackup: (id: string) => apiClient.delete(`/api/settings/backups/${id}`),\r\n\r\n  // System logs\r\n  getLogs: (params?: {\r\n    page?: number;\r\n    pageSize?: number;\r\n    level?: string;\r\n    search?: string;\r\n  }) => apiClient.get('/api/settings/logs', params),\r\n\r\n  // User management\r\n  getUsers: () => apiClient.get('/api/settings/users'),\r\n  createUser: (userData: any) =>\r\n    apiClient.post('/api/settings/users', userData),\r\n  updateUser: (id: string, userData: any) =>\r\n    apiClient.put(`/api/settings/users/${id}`, userData),\r\n  deleteUser: (id: string) => apiClient.delete(`/api/settings/users/${id}`),\r\n  changePassword: (id: string, password: string) =>\r\n    apiClient.post(`/api/settings/users/${id}/change-password`, {\r\n      newPassword: password,\r\n    }),\r\n};\r\n\r\nexport default apiClient;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\api\\errors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\api\\interceptors.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1020,1023],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1020,1023],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1704,1707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1704,1707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type {\r\n  AxiosError,\r\n  AxiosInstance,\r\n  InternalAxiosRequestConfig,\r\n} from 'axios';\r\nimport { toast } from 'sonner';\r\n\r\nimport { normalizeApiError, type ApiErrorPayload } from '@/lib/api/errors';\r\n\r\ntype AccessTokenProvider = () => string | null;\r\ntype UnauthorizedHandler = (error: AxiosError) => Promise<void> | void;\r\n\r\nlet accessTokenProvider: AccessTokenProvider = () =>\r\n  localStorage.getItem('clms_token');\r\nlet unauthorizedHandler: UnauthorizedHandler | null = null;\r\nlet isHandlingUnauthorized = false;\r\n\r\nexport function setAccessTokenProvider(provider: AccessTokenProvider) {\r\n  accessTokenProvider = provider;\r\n}\r\n\r\nexport function setUnauthorizedHandler(handler: UnauthorizedHandler | null) {\r\n  unauthorizedHandler = handler;\r\n}\r\n\r\nexport function setupInterceptors(client: AxiosInstance) {\r\n  client.interceptors.request.use((config: InternalAxiosRequestConfig) => {\r\n    const token = accessTokenProvider?.();\r\n\r\n    if (token) {\r\n      if (!config.headers) {\r\n        config.headers = {} as any;\r\n      }\r\n      if (!config.headers.Authorization) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n      }\r\n    }\r\n\r\n    return config;\r\n  });\r\n\r\n  client.interceptors.response.use(\r\n    (response) => response,\r\n    async (error: AxiosError) => {\r\n      if (!error.response) {\r\n        toast.error('Network error. Please check your connection.');\r\n        return Promise.reject(error);\r\n      }\r\n\r\n      const { status, data } = error.response;\r\n      const apiPayload = data as ApiErrorPayload | undefined;\r\n      const normalizedError = normalizeApiError(\r\n        status,\r\n        apiPayload,\r\n        'An unexpected error occurred'\r\n      );\r\n\r\n      (error as any).appError = normalizedError;\r\n\r\n      const showValidationToast =\r\n        normalizedError.code === 'VALIDATION_ERROR' ||\r\n        normalizedError.validationErrors.length > 0;\r\n\r\n      if (status === 401) {\r\n        if (unauthorizedHandler && !isHandlingUnauthorized) {\r\n          isHandlingUnauthorized = true;\r\n          try {\r\n            await unauthorizedHandler(error);\r\n          } finally {\r\n            isHandlingUnauthorized = false;\r\n          }\r\n        } else if (!isHandlingUnauthorized) {\r\n          toast.error(\r\n            normalizedError.message || 'Session expired. Please log in again.'\r\n          );\r\n        }\r\n      } else if (status === 403) {\r\n        toast.error(normalizedError.message || 'Access denied');\r\n      } else if (status === 404) {\r\n        toast.error(normalizedError.message || 'Resource not found');\r\n      } else if (status >= 500) {\r\n        toast.error(\r\n          normalizedError.message || 'Server error. Please try again later.'\r\n        );\r\n      } else if (showValidationToast) {\r\n        const firstError = normalizedError.validationErrors[0];\r\n        const validationMessage = firstError\r\n          ? `${firstError.field ? `${firstError.field}: ` : ''}${firstError.message}`\r\n          : normalizedError.message;\r\n\r\n        toast.error(validationMessage || 'Validation failed');\r\n      } else if (normalizedError.message) {\r\n        toast.error(normalizedError.message);\r\n      }\r\n\r\n      return Promise.reject(\r\n        Object.assign(error, { appError: normalizedError })\r\n      );\r\n    }\r\n  );\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\api\\tests\\interceptors.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\auth-queries.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":21,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[515,518],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[515,518],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { QueryClient } from '@tanstack/react-query';\r\n\r\nimport { apiClient } from '@/lib/api';\r\n\r\nexport type AuthUser = {\r\n  id: string;\r\n  username: string;\r\n  role: string;\r\n  isActive?: boolean;\r\n  lastLoginAt?: string | Date | null;\r\n};\r\n\r\nexport const authKeys = {\r\n  all: ['auth'] as const,\r\n  current: () => [...authKeys.all, 'current'] as const,\r\n};\r\n\r\nexport async function fetchCurrentUser(): Promise<AuthUser> {\r\n  const response = (await apiClient.get<{ user: AuthUser }>(\r\n    '/api/auth/me'\r\n  )) as any;\r\n\r\n  if (response.success && response.data?.user) {\r\n    return response.data.user;\r\n  }\r\n\r\n  const message =\r\n    typeof response.error === 'string'\r\n      ? response.error\r\n      : response.error?.message ||\r\n        response.message ||\r\n        'Unable to fetch current user';\r\n  throw new Error(message);\r\n}\r\n\r\nexport async function primeAuthState(\r\n  queryClient: QueryClient\r\n): Promise<AuthUser> {\r\n  return queryClient.ensureQueryData({\r\n    queryKey: authKeys.current(),\r\n    queryFn: fetchCurrentUser,\r\n  });\r\n}\r\n\r\nexport function clearAuthState(queryClient: QueryClient) {\r\n  queryClient.removeQueries({ queryKey: authKeys.all });\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\export-utils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":9,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[158,161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[158,161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1128,1131],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1128,1131],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1811,1814],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1811,1814],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2088,2091],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2088,2091],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4005,4008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4005,4008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":157,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5471,5474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5471,5474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Export Utilities\r\n * Handles data export to CSV and Excel formats\r\n */\r\n\r\n/**\r\n * Convert data to CSV format\r\n */\r\nexport function convertToCSV(data: any[], headers?: string[]): string {\r\n  if (data.length === 0) {\r\n    return '';\r\n  }\r\n\r\n  // Get headers from first object if not provided\r\n  const keys = headers || Object.keys(data[0]);\r\n\r\n  // Create CSV header row\r\n  const csvHeaders = keys.join(',');\r\n\r\n  // Create CSV data rows\r\n  const csvRows = data.map((row) => {\r\n    return keys\r\n      .map((key) => {\r\n        const value = row[key];\r\n        // Escape commas and quotes\r\n        if (value === null || value === undefined) {\r\n          return '';\r\n        }\r\n        const stringValue = String(value);\r\n        if (\r\n          stringValue.includes(',') ||\r\n          stringValue.includes('\"') ||\r\n          stringValue.includes('\\n')\r\n        ) {\r\n          return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\r\n        }\r\n        return stringValue;\r\n      })\r\n      .join(',');\r\n  });\r\n\r\n  return [csvHeaders, ...csvRows].join('\\n');\r\n}\r\n\r\n/**\r\n * Download CSV file\r\n */\r\nexport function downloadCSV(\r\n  data: any[],\r\n  filename: string,\r\n  headers?: string[]\r\n): void {\r\n  const csv = convertToCSV(data, headers);\r\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\r\n  downloadBlob(blob, `${filename}.csv`);\r\n}\r\n\r\n/**\r\n * Download blob as file\r\n */\r\nexport function downloadBlob(blob: Blob, filename: string): void {\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  window.URL.revokeObjectURL(url);\r\n}\r\n\r\n/**\r\n * Convert data to JSON and download\r\n */\r\nexport function downloadJSON(data: any, filename: string): void {\r\n  const json = JSON.stringify(data, null, 2);\r\n  const blob = new Blob([json], { type: 'application/json' });\r\n  downloadBlob(blob, `${filename}.json`);\r\n}\r\n\r\n/**\r\n * Export report data to CSV\r\n */\r\nexport function exportReportToCSV(reportData: any, reportType: string): void {\r\n  const timestamp = new Date().toISOString().split('T')[0];\r\n  const filename = `${reportType}-report-${timestamp}`;\r\n\r\n  if (reportType === 'daily' && reportData.summary) {\r\n    const data = [\r\n      { Metric: 'Date', Value: reportData.date },\r\n      { Metric: 'Check-Ins', Value: reportData.summary.checkIns },\r\n      { Metric: 'Check-Outs', Value: reportData.summary.checkOuts },\r\n      { Metric: 'Unique Students', Value: reportData.summary.uniqueStudents },\r\n      { Metric: 'Books Circulated', Value: reportData.summary.booksCirculated },\r\n      {\r\n        Metric: 'Average Duration (min)',\r\n        Value: reportData.summary.avgDuration,\r\n      },\r\n      { Metric: 'Peak Hour', Value: reportData.summary.peakHour },\r\n      { Metric: '', Value: '' }, // Empty row\r\n      { Metric: 'Book Checkouts', Value: reportData.details.bookCheckouts },\r\n      { Metric: 'Book Returns', Value: reportData.details.bookReturns },\r\n      { Metric: 'Computer Use', Value: reportData.details.computerUse },\r\n      { Metric: 'Gaming Sessions', Value: reportData.details.gamingSessions },\r\n      { Metric: 'AVR Sessions', Value: reportData.details.avrSessions },\r\n    ];\r\n    downloadCSV(data, filename);\r\n  } else if (reportType === 'weekly' && reportData.summary) {\r\n    const summaryData = [\r\n      { Metric: 'Week Start', Value: reportData.weekStart },\r\n      { Metric: 'Week End', Value: reportData.weekEnd },\r\n      { Metric: 'Total Visits', Value: reportData.summary.totalVisits },\r\n      { Metric: 'Unique Students', Value: reportData.summary.uniqueStudents },\r\n      { Metric: 'Total Checkouts', Value: reportData.summary.totalCheckouts },\r\n    ];\r\n\r\n    // Add popular books\r\n    if (reportData.popularBooks?.length > 0) {\r\n      summaryData.push({ Metric: '', Value: '' });\r\n      summaryData.push({ Metric: 'Popular Books', Value: '' });\r\n      reportData.popularBooks.forEach((book: any, i: number) => {\r\n        summaryData.push({\r\n          Metric: `${i + 1}. ${book.title}`,\r\n          Value: book.count,\r\n        });\r\n      });\r\n    }\r\n\r\n    downloadCSV(summaryData, filename);\r\n  } else if (reportType === 'monthly' && reportData.summary) {\r\n    const data = [\r\n      { Metric: 'Month', Value: reportData.monthName },\r\n      { Metric: 'Year', Value: reportData.year },\r\n      { Metric: 'Total Visits', Value: reportData.summary.totalVisits },\r\n      { Metric: 'Unique Students', Value: reportData.summary.uniqueStudents },\r\n      { Metric: 'Books Borrowed', Value: reportData.summary.booksBorrowed },\r\n      { Metric: 'Books Returned', Value: reportData.summary.booksReturned },\r\n    ];\r\n    downloadCSV(data, filename);\r\n  } else if (reportType === 'custom' && reportData.summary) {\r\n    const data = [\r\n      { Metric: 'Start Date', Value: reportData.dateRange.start },\r\n      { Metric: 'End Date', Value: reportData.dateRange.end },\r\n      { Metric: 'Days', Value: reportData.dateRange.days },\r\n      { Metric: 'Total Check-Ins', Value: reportData.summary.totalCheckIns },\r\n      { Metric: 'Unique Students', Value: reportData.summary.uniqueStudents },\r\n      { Metric: 'Books Borrowed', Value: reportData.summary.booksBorrowed },\r\n      { Metric: 'Books Returned', Value: reportData.summary.booksReturned },\r\n    ];\r\n    downloadCSV(data, filename);\r\n  }\r\n}\r\n\r\n/**\r\n * Export fines data to CSV\r\n */\r\nexport function exportFinesToCSV(fines: any[]): void {\r\n  const timestamp = new Date().toISOString().split('T')[0];\r\n  const filename = `fines-report-${timestamp}`;\r\n\r\n  const data = fines.map((fine) => ({\r\n    'Student ID': fine.student?.studentId || '',\r\n    'Student Name':\r\n      `${fine.student?.firstName || ''} ${fine.student?.lastName || ''}`.trim(),\r\n    'Book Title': fine.book?.title || '',\r\n    'Accession No': fine.book?.accessionNo || '',\r\n    'Due Date': fine.dueDate ? new Date(fine.dueDate).toLocaleDateString() : '',\r\n    'Overdue Days': fine.overdueDays || 0,\r\n    'Fine Amount': fine.fineAmount || 0,\r\n    Status: fine.finePaid ? 'Paid' : 'Outstanding',\r\n  }));\r\n\r\n  downloadCSV(data, filename);\r\n}\r\n\r\n/**\r\n * Print report (opens print dialog)\r\n */\r\nexport function printReport(): void {\r\n  window.print();\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\icons.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\offline-queue.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[289,292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[289,292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4994,4997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4994,4997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5419,5422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5419,5422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":249,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":249,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7035,7038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7035,7038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":282,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":282,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7873,7876],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7873,7876],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { openDB, type IDBPDatabase } from 'idb';\r\nimport { apiClient } from './api';\r\n\r\n// Types for offline queue\r\ninterface QueueItem {\r\n  id: string;\r\n  type: 'api-call' | 'activity-log' | 'session-action';\r\n  endpoint?: string;\r\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';\r\n  data?: any;\r\n  timestamp: number;\r\n  retries: number;\r\n  maxRetries: number;\r\n}\r\n\r\n// IndexedDB setup\r\nclass OfflineQueue {\r\n  private db: IDBPDatabase | null = null;\r\n  private dbName = 'clms-offline-db';\r\n  private dbVersion = 1;\r\n  private isProcessing = false;\r\n\r\n  // Initialize IndexedDB\r\n  async init() {\r\n    if (this.db) {\r\n      return this.db;\r\n    }\r\n\r\n    this.db = await openDB(this.dbName, this.dbVersion, {\r\n      upgrade(db) {\r\n        // Create queue store\r\n        const queueStore = db.createObjectStore('queue', { keyPath: 'id' });\r\n        queueStore.createIndex('timestamp', 'timestamp');\r\n        queueStore.createIndex('type', 'type');\r\n\r\n        // Create activities store for local caching\r\n        const activitiesStore = db.createObjectStore('activities', {\r\n          keyPath: 'id',\r\n        });\r\n        activitiesStore.createIndex('timestamp', 'timestamp');\r\n        activitiesStore.createIndex('studentId', 'studentId');\r\n\r\n        // Create equipment store for local caching\r\n        const equipmentStore = db.createObjectStore('equipment', {\r\n          keyPath: 'id',\r\n        });\r\n        equipmentStore.createIndex('status', 'status');\r\n        equipmentStore.createIndex('type', 'type');\r\n\r\n        // Create students store for local caching\r\n        const studentsStore = db.createObjectStore('students', {\r\n          keyPath: 'id',\r\n        });\r\n        studentsStore.createIndex('gradeLevel', 'gradeLevel');\r\n        studentsStore.createIndex('barcode', 'barcode');\r\n      },\r\n    });\r\n\r\n    return this.db;\r\n  }\r\n\r\n  // Add item to queue\r\n  async addToQueue(\r\n    item: Omit<QueueItem, 'id' | 'timestamp' | 'retries' | 'maxRetries'>\r\n  ) {\r\n    const db = await this.init();\r\n    const queueItem: QueueItem = {\r\n      ...item,\r\n      id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      timestamp: Date.now(),\r\n      retries: 0,\r\n      maxRetries: 3,\r\n    };\r\n\r\n    await db.add('queue', queueItem);\r\n    this.processQueue();\r\n\r\n    return queueItem.id;\r\n  }\r\n\r\n  // Get all queue items\r\n  async getQueueItems(): Promise<QueueItem[]> {\r\n    const db = await this.init();\r\n    return db.getAll('queue');\r\n  }\r\n\r\n  // Get queue item by ID\r\n  async getQueueItem(id: string): Promise<QueueItem | undefined> {\r\n    const db = await this.init();\r\n    return db.get('queue', id);\r\n  }\r\n\r\n  // Remove queue item\r\n  async removeQueueItem(id: string) {\r\n    const db = await this.init();\r\n    await db.delete('queue', id);\r\n  }\r\n\r\n  // Update queue item\r\n  async updateQueueItem(item: QueueItem) {\r\n    const db = await this.init();\r\n    await db.put('queue', item);\r\n  }\r\n\r\n  // Process queue when online\r\n  async processQueue() {\r\n    if (this.isProcessing || !navigator.onLine) {\r\n      return;\r\n    }\r\n\r\n    this.isProcessing = true;\r\n\r\n    try {\r\n      const items = await this.getQueueItems();\r\n\r\n      for (const item of items) {\r\n        try {\r\n          await this.processQueueItem(item);\r\n          await this.removeQueueItem(item.id);\r\n        } catch (error) {\r\n          console.error('Failed to process queue item:', error);\r\n\r\n          // Update retry count\r\n          item.retries++;\r\n          if (item.retries >= item.maxRetries) {\r\n            // Max retries reached, remove from queue\r\n            await this.removeQueueItem(item.id);\r\n            console.error('Max retries reached for queue item:', item.id);\r\n          } else {\r\n            // Update item with increased retry count\r\n            await this.updateQueueItem(item);\r\n          }\r\n        }\r\n      }\r\n    } finally {\r\n      this.isProcessing = false;\r\n    }\r\n  }\r\n\r\n  // Process individual queue item\r\n  private async processQueueItem(item: QueueItem) {\r\n    if (item.type === 'api-call' && item.endpoint && item.method) {\r\n      switch (item.method.toLowerCase()) {\r\n        case 'get':\r\n          return await apiClient.get(item.endpoint);\r\n        case 'post':\r\n          return await apiClient.post(item.endpoint, item.data);\r\n        case 'put':\r\n          return await apiClient.put(item.endpoint, item.data);\r\n        case 'delete':\r\n          return await apiClient.delete(item.endpoint);\r\n        default:\r\n          throw new Error(`Unknown method: ${item.method}`);\r\n      }\r\n    } else if (item.type === 'activity-log') {\r\n      const response = await apiClient.post(\r\n        '/api/students/activity',\r\n        item.data\r\n      );\r\n      return response;\r\n    } else if (item.type === 'session-action' && item.endpoint) {\r\n      const response = await apiClient.post(item.endpoint, item.data);\r\n      return response;\r\n    }\r\n\r\n    throw new Error(`Unknown queue item type: ${item.type}`);\r\n  }\r\n\r\n  // Cache data locally\r\n  async cacheData(store: string, data: any) {\r\n    const db = await this.init();\r\n\r\n    if (Array.isArray(data)) {\r\n      for (const item of data) {\r\n        await db.put(store, { ...item, _cached: true, _cacheTime: Date.now() });\r\n      }\r\n    } else {\r\n      await db.put(store, { ...data, _cached: true, _cacheTime: Date.now() });\r\n    }\r\n  }\r\n\r\n  // Get cached data\r\n  async getCachedData(\r\n    store: string,\r\n    maxAge: number = 5 * 60 * 1000\r\n  ): Promise<any[]> {\r\n    const db = await this.init();\r\n    const allData = await db.getAll(store);\r\n    const now = Date.now();\r\n\r\n    return allData.filter(\r\n      (item) => item._cached && now - item._cacheTime < maxAge\r\n    );\r\n  }\r\n\r\n  // Clear old cache\r\n  async clearOldCache(store: string, maxAge: number = 30 * 60 * 1000) {\r\n    const db = await this.init();\r\n    const allData = await db.getAll(store);\r\n    const now = Date.now();\r\n\r\n    for (const item of allData) {\r\n      if (item._cached && now - item._cacheTime > maxAge) {\r\n        await db.delete(store, item.id);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Get queue size\r\n  async getQueueSize(): Promise<number> {\r\n    const db = await this.init();\r\n    return db.count('queue');\r\n  }\r\n\r\n  // Clear queue\r\n  async clearQueue() {\r\n    const db = await this.init();\r\n    await db.clear('queue');\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nexport const offlineQueue = new OfflineQueue();\r\n\r\n// Initialize offline queue and set up event listeners\r\nexport const initializeOfflineQueue = () => {\r\n  // Initialize the queue\r\n  offlineQueue.init();\r\n\r\n  // Listen for online/offline events\r\n  window.addEventListener('online', () => {\r\n    // App is online, processing queue...\r\n    offlineQueue.processQueue();\r\n  });\r\n\r\n  window.addEventListener('offline', () => {\r\n    // App is offline, queueing actions...\r\n  });\r\n\r\n  // Process queue on app start if online\r\n  if (navigator.onLine) {\r\n    offlineQueue.processQueue();\r\n  }\r\n};\r\n\r\n// Helper functions for common offline operations\r\nexport const offlineActions = {\r\n  // Log activity when offline\r\n  logActivity: (activityData: any) => {\r\n    return offlineQueue.addToQueue({\r\n      type: 'activity-log',\r\n      data: activityData,\r\n    });\r\n  },\r\n\r\n  // Start equipment session when offline\r\n  startSession: (\r\n    equipmentId: string,\r\n    studentId: string,\r\n    timeLimitMinutes: number\r\n  ) => {\r\n    return offlineQueue.addToQueue({\r\n      type: 'session-action',\r\n      endpoint: '/api/equipment/session',\r\n      data: { equipmentId, studentId, timeLimitMinutes },\r\n    });\r\n  },\r\n\r\n  // End equipment session when offline\r\n  endSession: (sessionId: string) => {\r\n    return offlineQueue.addToQueue({\r\n      type: 'session-action',\r\n      endpoint: `/api/equipment/session/${sessionId}/end`,\r\n      data: {},\r\n    });\r\n  },\r\n\r\n  // Generic API call when offline\r\n  apiCall: (\r\n    endpoint: string,\r\n    method: 'GET' | 'POST' | 'PUT' | 'DELETE',\r\n    data?: any\r\n  ) => {\r\n    return offlineQueue.addToQueue({\r\n      type: 'api-call',\r\n      endpoint,\r\n      method,\r\n      data,\r\n    });\r\n  },\r\n};\r\n\r\nexport default offlineQueue;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\performance-monitor.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":137,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4057,4060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4057,4060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4115,4118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4115,4118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4641,4644],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4641,4644],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Comprehensive Performance Monitoring System\r\n * Provides APM capabilities, structured logging, and performance metrics\r\n */\r\n\r\nexport interface PerformanceMetric {\r\n  name: string;\r\n  value: number;\r\n  timestamp: number;\r\n  tags?: Record<string, string> | undefined;\r\n  type: 'duration' | 'counter' | 'gauge' | 'histogram';\r\n  unit?: string | undefined;\r\n}\r\n\r\nexport interface CustomPerformanceEntry {\r\n  name: string;\r\n  startTime: number;\r\n  duration?: number | undefined;\r\n  metadata?: Record<string, unknown> | undefined;\r\n  status: 'started' | 'completed' | 'error';\r\n  error?: Error | undefined;\r\n}\r\n\r\nexport interface LogEntry {\r\n  level: 'debug' | 'info' | 'warn' | 'error';\r\n  message: string;\r\n  timestamp: number;\r\n  context?: Record<string, unknown>;\r\n  tags?: Record<string, string>;\r\n  userId?: string;\r\n  sessionId?: string;\r\n  requestId?: string;\r\n}\r\n\r\nexport interface PerformanceConfig {\r\n  enableConsoleLogging: boolean;\r\n  enableRemoteLogging: boolean;\r\n  remoteEndpoint?: string;\r\n  sampleRate: number; // 0.0 to 1.0\r\n  maxBufferSize: number;\r\n  flushInterval: number;\r\n  enableUserTiming: boolean;\r\n  enableResourceTiming: boolean;\r\n  enableNavigationTiming: boolean;\r\n  enablePaintTiming: boolean;\r\n  customMetrics: Record<string, (data: unknown) => number>;\r\n}\r\n\r\nclass PerformanceMonitor {\r\n  private config: PerformanceConfig;\r\n  private metrics: PerformanceMetric[] = [];\r\n  private logs: LogEntry[] = [];\r\n  private activeEntries: Map<string, CustomPerformanceEntry> = new Map();\r\n  private flushTimer: number | null = null;\r\n  private sessionId: string;\r\n  private userId: string | null = null;\r\n\r\n  constructor(config: Partial<PerformanceConfig> = {}) {\r\n    this.config = {\r\n      enableConsoleLogging: true,\r\n      enableRemoteLogging: false,\r\n      sampleRate: 1.0,\r\n      maxBufferSize: 1000,\r\n      flushInterval: 30000, // 30 seconds\r\n      enableUserTiming: true,\r\n      enableResourceTiming: true,\r\n      enableNavigationTiming: true,\r\n      enablePaintTiming: true,\r\n      customMetrics: {},\r\n      ...config,\r\n    };\r\n\r\n    this.sessionId = this.generateSessionId();\r\n    this.initializeMonitoring();\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private initializeMonitoring(): void {\r\n    // Start periodic flush\r\n    this.startFlushTimer();\r\n\r\n    // Collect initial performance metrics\r\n    this.collectNavigationTiming();\r\n    this.collectPaintTiming();\r\n    this.collectResourceTiming();\r\n\r\n    // Set up performance observers\r\n    if ('PerformanceObserver' in window) {\r\n      this.setupPerformanceObservers();\r\n    }\r\n\r\n    // Track page visibility changes\r\n    this.setupVisibilityTracking();\r\n\r\n    // Track errors\r\n    this.setupErrorTracking();\r\n\r\n    // Log initialization\r\n    this.info('Performance monitoring initialized', {\r\n      sessionId: this.sessionId,\r\n      config: this.config,\r\n    });\r\n  }\r\n\r\n  private setupPerformanceObservers(): void {\r\n    // Long task observer\r\n    if ('PerformanceObserver' in window) {\r\n      try {\r\n        const longTaskObserver = new PerformanceObserver((list) => {\r\n          for (const entry of list.getEntries()) {\r\n            this.recordMetric('long_task', entry.duration, {\r\n              type: 'duration',\r\n              unit: 'ms',\r\n              tags: { name: entry.name },\r\n            });\r\n          }\r\n        });\r\n        longTaskObserver.observe({ entryTypes: ['longtask'] });\r\n      } catch (e) {\r\n        // Long tasks might not be supported in all browsers\r\n      }\r\n\r\n      // Largest contentful paint observer\r\n      try {\r\n        const lcpObserver = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          const lastEntry = entries[entries.length - 1];\r\n          if (lastEntry) {\r\n            this.recordMetric('largest_contentful_paint', lastEntry.startTime, {\r\n              type: 'duration',\r\n              unit: 'ms',\r\n              tags: {\r\n                element:\r\n                  (lastEntry as any).element?.tagName ||\r\n                  (lastEntry as any).url ||\r\n                  'unknown',\r\n              },\r\n            });\r\n          }\r\n        });\r\n        lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      } catch (e) {\r\n        // LCP might not be supported in all browsers\r\n      }\r\n\r\n      // First input delay observer\r\n      try {\r\n        const fidObserver = new PerformanceObserver((list) => {\r\n          for (const entry of list.getEntries()) {\r\n            this.recordMetric(\r\n              'first_input_delay',\r\n              (entry as any).processingStart - entry.startTime,\r\n              {\r\n                type: 'duration',\r\n                unit: 'ms',\r\n              }\r\n            );\r\n          }\r\n        });\r\n        fidObserver.observe({ entryTypes: ['first-input'] });\r\n      } catch (e) {\r\n        // FID might not be supported in all browsers\r\n      }\r\n    }\r\n  }\r\n\r\n  private setupVisibilityTracking(): void {\r\n    let visibilityStart = performance.now();\r\n\r\n    document.addEventListener('visibilitychange', () => {\r\n      if (document.hidden) {\r\n        const visibilityDuration = performance.now() - visibilityStart;\r\n        this.recordMetric('page_visibility_duration', visibilityDuration, {\r\n          type: 'duration',\r\n          unit: 'ms',\r\n        });\r\n      } else {\r\n        visibilityStart = performance.now();\r\n      }\r\n    });\r\n  }\r\n\r\n  private setupErrorTracking(): void {\r\n    window.addEventListener('error', (event) => {\r\n      this.error('JavaScript error', {\r\n        message: event.message,\r\n        filename: event.filename,\r\n        lineno: event.lineno,\r\n        colno: event.colno,\r\n        stack: event.error?.stack,\r\n      });\r\n    });\r\n\r\n    window.addEventListener('unhandledrejection', (event) => {\r\n      this.error('Unhandled promise rejection', {\r\n        reason: event.reason,\r\n        stack: event.reason?.stack,\r\n      });\r\n    });\r\n  }\r\n\r\n  private collectNavigationTiming(): void {\r\n    if (!this.config.enableNavigationTiming) {\r\n      return;\r\n    }\r\n\r\n    const timing = performance.timing;\r\n    if (!timing) {\r\n      return;\r\n    }\r\n\r\n    const navigationStart = timing.navigationStart;\r\n    const metrics = [\r\n      {\r\n        name: 'dns_lookup',\r\n        start: timing.domainLookupStart,\r\n        end: timing.domainLookupEnd,\r\n      },\r\n      {\r\n        name: 'tcp_connection',\r\n        start: timing.connectStart,\r\n        end: timing.connectEnd,\r\n      },\r\n      {\r\n        name: 'request',\r\n        start: timing.requestStart,\r\n        end: timing.responseStart,\r\n      },\r\n      {\r\n        name: 'response',\r\n        start: timing.responseStart,\r\n        end: timing.responseEnd,\r\n      },\r\n      {\r\n        name: 'dom_processing',\r\n        start: timing.domLoading,\r\n        end: timing.domComplete,\r\n      },\r\n      {\r\n        name: 'load_event',\r\n        start: timing.loadEventStart,\r\n        end: timing.loadEventEnd,\r\n      },\r\n    ];\r\n\r\n    metrics.forEach((metric) => {\r\n      const duration = metric.end - metric.start;\r\n      if (duration > 0) {\r\n        this.recordMetric(metric.name, duration, {\r\n          type: 'duration',\r\n          unit: 'ms',\r\n        });\r\n      }\r\n    });\r\n\r\n    // Page load time\r\n    const pageLoadTime = timing.loadEventEnd - navigationStart;\r\n    this.recordMetric('page_load_time', pageLoadTime, {\r\n      type: 'duration',\r\n      unit: 'ms',\r\n    });\r\n  }\r\n\r\n  private collectPaintTiming(): void {\r\n    if (!this.config.enablePaintTiming) {\r\n      return;\r\n    }\r\n\r\n    const paintEntries = performance.getEntriesByType('paint');\r\n    paintEntries.forEach((entry) => {\r\n      this.recordMetric(entry.name, entry.startTime, {\r\n        type: 'duration',\r\n        unit: 'ms',\r\n      });\r\n    });\r\n  }\r\n\r\n  private collectResourceTiming(): void {\r\n    if (!this.config.enableResourceTiming) {\r\n      return;\r\n    }\r\n\r\n    const resourceEntries = performance.getEntriesByType(\r\n      'resource'\r\n    ) as PerformanceResourceTiming[];\r\n    resourceEntries.forEach((entry) => {\r\n      const duration = entry.responseEnd - entry.startTime;\r\n      const size = entry.transferSize || 0;\r\n\r\n      this.recordMetric('resource_duration', duration, {\r\n        type: 'duration',\r\n        unit: 'ms',\r\n        tags: {\r\n          name: entry.name,\r\n          type: this.getResourceType(entry.name),\r\n        },\r\n      });\r\n\r\n      if (size > 0) {\r\n        this.recordMetric('resource_size', size, {\r\n          type: 'gauge',\r\n          unit: 'bytes',\r\n          tags: {\r\n            name: entry.name,\r\n            type: this.getResourceType(entry.name),\r\n          },\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  private getResourceType(url: string): string {\r\n    if (url.match(/\\.(js|mjs)$/)) {\r\n      return 'script';\r\n    }\r\n    if (url.match(/\\.(css)$/)) {\r\n      return 'stylesheet';\r\n    }\r\n    if (url.match(/\\.(png|jpg|jpeg|gif|webp|svg)$/)) {\r\n      return 'image';\r\n    }\r\n    if (url.match(/\\.(woff|woff2|ttf|eot)$/)) {\r\n      return 'font';\r\n    }\r\n    return 'other';\r\n  }\r\n\r\n  private startFlushTimer(): void {\r\n    if (this.flushTimer) {\r\n      return;\r\n    }\r\n\r\n    this.flushTimer = window.setInterval(() => {\r\n      this.flush();\r\n    }, this.config.flushInterval);\r\n  }\r\n\r\n  private stopFlushTimer(): void {\r\n    if (this.flushTimer) {\r\n      clearInterval(this.flushTimer);\r\n      this.flushTimer = null;\r\n    }\r\n  }\r\n\r\n  private shouldSample(): boolean {\r\n    return Math.random() < this.config.sampleRate;\r\n  }\r\n\r\n  private flush(): void {\r\n    if (!this.shouldSample()) {\r\n      return;\r\n    }\r\n\r\n    const data = {\r\n      metrics: this.metrics.slice(),\r\n      logs: this.logs.slice(),\r\n      sessionId: this.sessionId,\r\n      userId: this.userId,\r\n      timestamp: Date.now(),\r\n      userAgent: navigator.userAgent,\r\n      url: window.location.href,\r\n    };\r\n\r\n    // Clear buffers\r\n    this.metrics = [];\r\n    this.logs = [];\r\n\r\n    // Send to remote endpoint if configured\r\n    if (this.config.enableRemoteLogging && this.config.remoteEndpoint) {\r\n      this.sendToRemote(data);\r\n    }\r\n\r\n    // Console logging for debugging\r\n    if (this.config.enableConsoleLogging) {\r\n      console.group('Performance Monitor Flush');\r\n      console.debug('Metrics:', data.metrics);\r\n      console.debug('Logs:', data.logs);\r\n      console.groupEnd();\r\n    }\r\n  }\r\n\r\n  private async sendToRemote(data: unknown): Promise<void> {\r\n    if (!this.config.remoteEndpoint) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await fetch(this.config.remoteEndpoint, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(data),\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to send performance data:', error);\r\n    }\r\n  }\r\n\r\n  // Public API\r\n\r\n  /**\r\n   * Start timing a performance entry\r\n   */\r\n  start(name: string, metadata?: Record<string, unknown>): string {\r\n    const id = `${name}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    const entry: CustomPerformanceEntry = {\r\n      name,\r\n      startTime: performance.now(),\r\n      metadata,\r\n      status: 'started',\r\n    };\r\n\r\n    this.activeEntries.set(id, entry);\r\n    return id;\r\n  }\r\n\r\n  /**\r\n   * End timing a performance entry\r\n   */\r\n  end(id: string, error?: Error): void {\r\n    const entry = this.activeEntries.get(id);\r\n    if (!entry) {\r\n      return;\r\n    }\r\n\r\n    const endTime = performance.now();\r\n    const duration = endTime - entry.startTime;\r\n\r\n    if (error) {\r\n      entry.status = 'error';\r\n      entry.error = error;\r\n      this.error(`Performance entry failed: ${entry.name}`, {\r\n        duration,\r\n        error: error.message,\r\n        metadata: entry.metadata,\r\n      });\r\n    } else {\r\n      entry.status = 'completed';\r\n      entry.duration = duration;\r\n      this.recordMetric(entry.name, duration, {\r\n        type: 'duration',\r\n        unit: 'ms',\r\n        tags: { status: 'success' },\r\n      });\r\n    }\r\n\r\n    this.activeEntries.delete(id);\r\n  }\r\n\r\n  /**\r\n   * Record a performance metric\r\n   */\r\n  recordMetric(\r\n    name: string,\r\n    value: number,\r\n    options?: {\r\n      type?: 'duration' | 'counter' | 'gauge' | 'histogram';\r\n      unit?: string;\r\n      tags?: Record<string, string>;\r\n    }\r\n  ): void {\r\n    if (!this.shouldSample()) {\r\n      return;\r\n    }\r\n\r\n    const metric: PerformanceMetric = {\r\n      name,\r\n      value,\r\n      timestamp: Date.now(),\r\n      type: options?.type || 'gauge',\r\n      unit: options?.unit,\r\n      tags: options?.tags,\r\n    };\r\n\r\n    this.metrics.push(metric);\r\n\r\n    // Apply custom metric transformations\r\n    if (this.config.customMetrics[name]) {\r\n      const transformedValue = this.config.customMetrics[name](value);\r\n      const metric: PerformanceMetric = {\r\n        name: `${name}_transformed`,\r\n        value: transformedValue,\r\n        timestamp: Date.now(),\r\n        type: 'gauge',\r\n      };\r\n      if (options?.tags) {\r\n        metric.tags = options.tags;\r\n      }\r\n      this.metrics.push(metric);\r\n    }\r\n\r\n    // Buffer management\r\n    if (this.metrics.length >= this.config.maxBufferSize) {\r\n      this.flush();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log a debug message\r\n   */\r\n  debug(message: string, context?: Record<string, unknown>): void {\r\n    this.log('debug', message, context);\r\n  }\r\n\r\n  /**\r\n   * Log an info message\r\n   */\r\n  info(message: string, context?: Record<string, unknown>): void {\r\n    this.log('info', message, context);\r\n  }\r\n\r\n  /**\r\n   * Log a warning message\r\n   */\r\n  warn(message: string, context?: Record<string, unknown>): void {\r\n    this.log('warn', message, context);\r\n  }\r\n\r\n  /**\r\n   * Log an error message\r\n   */\r\n  error(message: string, context?: Record<string, unknown>): void {\r\n    this.log('error', message, context);\r\n  }\r\n\r\n  private log(\r\n    level: LogEntry['level'],\r\n    message: string,\r\n    context?: Record<string, unknown>\r\n  ): void {\r\n    if (!this.shouldSample()) {\r\n      return;\r\n    }\r\n\r\n    const logEntry: LogEntry = {\r\n      level,\r\n      message,\r\n      timestamp: Date.now(),\r\n      sessionId: this.sessionId,\r\n    };\r\n\r\n    if (context) {\r\n      logEntry.context = context;\r\n    }\r\n    if (this.userId) {\r\n      logEntry.userId = this.userId;\r\n    }\r\n\r\n    this.logs.push(logEntry);\r\n\r\n    // Console logging\r\n    if (this.config.enableConsoleLogging) {\r\n      const consoleMethod =\r\n        level === 'error'\r\n          ? console.error\r\n          : level === 'warn'\r\n            ? console.warn\r\n            : level === 'info'\r\n              ? console.info\r\n              : console.debug;\r\n      consoleMethod(`[${level.toUpperCase()}] ${message}`, context);\r\n    }\r\n\r\n    // Buffer management\r\n    if (this.logs.length >= this.config.maxBufferSize) {\r\n      this.flush();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set the current user ID for tracking\r\n   */\r\n  setUserId(userId: string): void {\r\n    this.userId = userId;\r\n    this.info('User ID set', { userId });\r\n  }\r\n\r\n  /**\r\n   * Clear the current user ID\r\n   */\r\n  clearUserId(): void {\r\n    this.userId = null;\r\n    this.info('User ID cleared');\r\n  }\r\n\r\n  /**\r\n   * Force flush all buffered data\r\n   */\r\n  flushNow(): void {\r\n    this.flush();\r\n  }\r\n\r\n  /**\r\n   * Get current performance metrics\r\n   */\r\n  getMetrics(): PerformanceMetric[] {\r\n    return [...this.metrics];\r\n  }\r\n\r\n  /**\r\n   * Get current logs\r\n   */\r\n  getLogs(): LogEntry[] {\r\n    return [...this.logs];\r\n  }\r\n\r\n  /**\r\n   * Clear all buffered data\r\n   */\r\n  clear(): void {\r\n    this.metrics = [];\r\n    this.logs = [];\r\n    this.activeEntries.clear();\r\n  }\r\n\r\n  /**\r\n   * Destroy the performance monitor\r\n   */\r\n  destroy(): void {\r\n    this.stopFlushTimer();\r\n    this.flushNow();\r\n    this.clear();\r\n  }\r\n\r\n  /**\r\n   * Get performance summary\r\n   */\r\n  getSummary(): {\r\n    metricsCount: number;\r\n    logsCount: number;\r\n    activeEntriesCount: number;\r\n    sessionId: string;\r\n    userId: string | null;\r\n  } {\r\n    return {\r\n      metricsCount: this.metrics.length,\r\n      logsCount: this.logs.length,\r\n      activeEntriesCount: this.activeEntries.size,\r\n      sessionId: this.sessionId,\r\n      userId: this.userId,\r\n    };\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nexport const performanceMonitor = new PerformanceMonitor({\r\n  enableConsoleLogging: process.env.NODE_ENV === 'development',\r\n  enableRemoteLogging: process.env.NODE_ENV === 'production',\r\n  sampleRate: 0.1, // 10% sampling in production\r\n  maxBufferSize: 500,\r\n  flushInterval: 30000,\r\n});\r\n\r\n// Export class for custom instances\r\nexport { PerformanceMonitor };\r\nexport default performanceMonitor;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\query-client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\scanner.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'stopCamera'. Either include it or remove the dependency array.","line":107,"column":6,"nodeType":"ArrayExpression","endLine":107,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [setScanning, setLastScanResult, stopCamera]","fix":{"range":[3477,3509],"text":"[setScanning, setLastScanResult, stopCamera]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9161,9164],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9161,9164],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { BrowserMultiFormatReader } from '@zxing/browser';\r\nimport { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { useAppStore } from '@/store/useAppStore';\r\n\r\n// Types for scanner\r\nexport interface ScannerResult {\r\n  text: string;\r\n  format: string;\r\n  timestamp: number;\r\n}\r\n\r\nexport interface ScannerError {\r\n  message: string;\r\n  type: 'permission' | 'device' | 'decode' | 'unknown';\r\n}\r\n\r\n// Hook for camera scanner\r\nexport const useCameraScanner = () => {\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [isCameraActive, setIsCameraActive] = useState(false);\r\n  const [scannerError, setScannerError] = useState<ScannerError | null>(null);\r\n  const [lastResult, setLastResult] = useState<ScannerResult | null>(null);\r\n  const codeReaderRef = useRef<BrowserMultiFormatReader | null>(null);\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n\r\n  const setScanning = useAppStore((state) => state.setScanning);\r\n  const setLastScanResult = useAppStore((state) => state.setLastScanResult);\r\n\r\n  // Start camera scanning\r\n  const startCamera = useCallback(async () => {\r\n    try {\r\n      setScannerError(null);\r\n      setIsScanning(true);\r\n      setScanning(true);\r\n\r\n      // Initialize code reader\r\n      if (!codeReaderRef.current) {\r\n        codeReaderRef.current = new BrowserMultiFormatReader();\r\n      }\r\n\r\n      if (!videoRef.current) {\r\n        throw new Error('Video element not found');\r\n      }\r\n\r\n      // Start video stream\r\n      await codeReaderRef.current.decodeFromVideoDevice(\r\n        undefined, // Let browser choose device\r\n        videoRef.current,\r\n        (result, error) => {\r\n          if (result) {\r\n            const scanResult: ScannerResult = {\r\n              text: result.getText(),\r\n              format: result.getBarcodeFormat().toString(),\r\n              timestamp: Date.now(),\r\n            };\r\n\r\n            setLastResult(scanResult);\r\n            setLastScanResult(scanResult.text);\r\n            setIsScanning(false);\r\n            setScanning(false);\r\n\r\n            // Play success sound\r\n            playScanSound('success');\r\n\r\n            toast.success(`Barcode scanned: ${scanResult.text}`);\r\n\r\n            // Stop camera after successful scan\r\n            stopCamera();\r\n          }\r\n\r\n          if (\r\n            error &&\r\n            error.message.includes('No MultiFormat Readers were able')\r\n          ) {\r\n            // This is expected when no barcode is in view, don't treat as error\r\n            return;\r\n          }\r\n        }\r\n      );\r\n\r\n      setIsCameraActive(true);\r\n    } catch (error) {\r\n      setIsScanning(false);\r\n      setScanning(false);\r\n\r\n      let errorType: ScannerError['type'] = 'unknown';\r\n      let errorMessage = 'Failed to start camera scanner';\r\n\r\n      if (error instanceof Error) {\r\n        if (error.name === 'NotAllowedError') {\r\n          errorType = 'permission';\r\n          errorMessage =\r\n            'Camera permission denied. Please allow camera access.';\r\n        } else if (error.name === 'NotFoundError') {\r\n          errorType = 'device';\r\n          errorMessage = 'No camera found. Please connect a camera.';\r\n        } else if (error.name === 'NotReadableError') {\r\n          errorType = 'device';\r\n          errorMessage = 'Camera is already in use by another application.';\r\n        }\r\n      }\r\n\r\n      setScannerError({ message: errorMessage, type: errorType });\r\n      toast.error(errorMessage);\r\n    }\r\n  }, [setScanning, setLastScanResult]);\r\n\r\n  // Stop camera scanning\r\n  const stopCamera = useCallback(() => {\r\n    if (codeReaderRef.current) {\r\n      try {\r\n        // Reset the reader\r\n        codeReaderRef.current = null;\r\n      } catch (error) {\r\n        // Ignore stop errors\r\n      }\r\n    }\r\n    setIsCameraActive(false);\r\n    setIsScanning(false);\r\n    setScanning(false);\r\n  }, [setScanning]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      stopCamera();\r\n    };\r\n  }, [stopCamera]);\r\n\r\n  return {\r\n    isScanning,\r\n    isCameraActive,\r\n    scannerError,\r\n    lastResult,\r\n    videoRef,\r\n    startCamera,\r\n    stopCamera,\r\n  };\r\n};\r\n\r\n// Hook for USB scanner input (IMPROVED - Auto-activates on mount)\r\nexport const useUsbScanner = () => {\r\n  const [isListening, setIsListening] = useState(true); // Auto-start listening\r\n  const [currentInput, setCurrentInput] = useState('');\r\n  const [lastScannedCode, setLastScannedCode] = useState('');\r\n  const inputBufferRef = useRef('');\r\n  const timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  const setLastScanResult = useAppStore((state) => state.setLastScanResult);\r\n\r\n  // Process input as potential barcode\r\n  const processInput = useCallback(\r\n    (input: string) => {\r\n      const trimmedInput = input.trim();\r\n\r\n      // Check if input looks like a barcode (more permissive patterns)\r\n      const isBarcode =\r\n        trimmedInput.length >= 3 && // At least 3 characters\r\n        (/^[A-Z0-9]{3,}$/i.test(trimmedInput) || // Alphanumeric\r\n          /^\\d{3,}$/.test(trimmedInput) || // Numeric only\r\n          /^[A-Z]{2,}\\d+$/i.test(trimmedInput)); // Letters then numbers\r\n\r\n      if (isBarcode) {\r\n        const result: ScannerResult = {\r\n          text: trimmedInput,\r\n          format: 'USB Scanner',\r\n          timestamp: Date.now(),\r\n        };\r\n\r\n        setLastScannedCode(trimmedInput);\r\n        setLastScanResult(trimmedInput);\r\n        playScanSound('success');\r\n        toast.success(`Γ£ô Scanned: ${trimmedInput}`, {\r\n          duration: 3000,\r\n          position: 'top-center',\r\n        });\r\n        return result;\r\n      } else if (trimmedInput.length > 0) {\r\n        toast.error(`Invalid barcode format: ${trimmedInput}`, {\r\n          duration: 2000,\r\n        });\r\n        playScanSound('error');\r\n      }\r\n\r\n      return null;\r\n    },\r\n    [setLastScanResult]\r\n  );\r\n\r\n  // Handle keyboard input\r\n  const handleKeyDown = useCallback(\r\n    (event: KeyboardEvent) => {\r\n      if (!isListening) {\r\n        return;\r\n      }\r\n\r\n      // Ignore if user is typing in an input field (except our scanner input)\r\n      const target = event.target as HTMLElement;\r\n      const isInputField =\r\n        target.tagName === 'INPUT' ||\r\n        target.tagName === 'TEXTAREA' ||\r\n        target.isContentEditable;\r\n\r\n      // Allow scanning even in input fields if it's our dedicated scanner input\r\n      const isScannerInput = target.id === 'usb-scanner-input';\r\n\r\n      if (isInputField && !isScannerInput) {\r\n        return; // Don't intercept typing in other input fields\r\n      }\r\n\r\n      // Clear existing timeout\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n\r\n      // Handle enter key (most USB scanners send Enter after the barcode)\r\n      if (event.key === 'Enter') {\r\n        event.preventDefault(); // Prevent form submission\r\n        const input = inputBufferRef.current.trim();\r\n        if (input) {\r\n          processInput(input);\r\n          inputBufferRef.current = '';\r\n          setCurrentInput('');\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Handle backspace\r\n      if (event.key === 'Backspace') {\r\n        inputBufferRef.current = inputBufferRef.current.slice(0, -1);\r\n        setCurrentInput(inputBufferRef.current);\r\n        return;\r\n      }\r\n\r\n      // Only process printable characters\r\n      if (event.key.length === 1) {\r\n        inputBufferRef.current += event.key;\r\n        setCurrentInput(inputBufferRef.current);\r\n      }\r\n\r\n      // Set timeout to clear buffer if no more input (USB scanners type very fast)\r\n      timeoutRef.current = setTimeout(() => {\r\n        inputBufferRef.current = '';\r\n        setCurrentInput('');\r\n      }, 150); // 150ms delay - USB scanners typically complete in <50ms\r\n    },\r\n    [isListening, processInput]\r\n  );\r\n\r\n  // Start/stop listening\r\n  const toggleListening = useCallback(() => {\r\n    setIsListening((prev) => {\r\n      const newState = !prev;\r\n      if (newState) {\r\n        toast.success('≡ƒöî USB Scanner ACTIVATED - Ready to scan!', {\r\n          duration: 2000,\r\n          position: 'top-center',\r\n        });\r\n      } else {\r\n        toast.info('USB Scanner deactivated', {\r\n          duration: 2000,\r\n        });\r\n        inputBufferRef.current = '';\r\n        setCurrentInput('');\r\n      }\r\n      return newState;\r\n    });\r\n  }, []);\r\n\r\n  // Auto-activate on mount\r\n  useEffect(() => {\r\n    toast.success('≡ƒöî USB Scanner ready - Just scan a barcode!', {\r\n      duration: 3000,\r\n      position: 'top-center',\r\n    });\r\n  }, []);\r\n\r\n  // Set up keyboard listener\r\n  useEffect(() => {\r\n    if (isListening) {\r\n      window.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [isListening, handleKeyDown]);\r\n\r\n  return {\r\n    isListening,\r\n    currentInput,\r\n    lastScannedCode,\r\n    toggleListening,\r\n  };\r\n};\r\n\r\n// Play scan sound effect\r\nconst playScanSound = (type: 'success' | 'error' = 'success') => {\r\n  try {\r\n    const audioContext = new (window.AudioContext ||\r\n      (window as any).webkitAudioContext)();\r\n    const oscillator = audioContext.createOscillator();\r\n    const gainNode = audioContext.createGain();\r\n\r\n    oscillator.connect(gainNode);\r\n    gainNode.connect(audioContext.destination);\r\n\r\n    if (type === 'success') {\r\n      // Success sound: ascending beep\r\n      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);\r\n      oscillator.frequency.exponentialRampToValueAtTime(\r\n        1200,\r\n        audioContext.currentTime + 0.1\r\n      );\r\n    } else {\r\n      // Error sound: descending beep\r\n      oscillator.frequency.setValueAtTime(400, audioContext.currentTime);\r\n      oscillator.frequency.exponentialRampToValueAtTime(\r\n        200,\r\n        audioContext.currentTime + 0.2\r\n      );\r\n    }\r\n\r\n    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\r\n    gainNode.gain.exponentialRampToValueAtTime(\r\n      0.01,\r\n      audioContext.currentTime + 0.2\r\n    );\r\n\r\n    oscillator.start(audioContext.currentTime);\r\n    oscillator.stop(audioContext.currentTime + 0.2);\r\n  } catch (error) {\r\n    // Silently fail if audio is not supported\r\n  }\r\n};\r\n\r\n// Manual barcode entry\r\nexport const useManualEntry = () => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [input, setInput] = useState('');\r\n\r\n  const setLastScanResult = useAppStore((state) => state.setLastScanResult);\r\n\r\n  const handleSubmit = useCallback(() => {\r\n    const trimmedInput = input.trim();\r\n    if (trimmedInput.length >= 3) {\r\n      const result: ScannerResult = {\r\n        text: trimmedInput,\r\n        format: 'Manual Entry',\r\n        timestamp: Date.now(),\r\n      };\r\n\r\n      setLastScanResult(trimmedInput);\r\n      playScanSound('success');\r\n      toast.success(`Barcode entered: ${trimmedInput}`);\r\n      setIsOpen(false);\r\n      setInput('');\r\n      return result;\r\n    } else {\r\n      toast.error('Please enter at least 3 characters');\r\n      playScanSound('error');\r\n      return undefined;\r\n    }\r\n  }, [input, setLastScanResult]);\r\n\r\n  return {\r\n    isOpen,\r\n    input,\r\n    setIsOpen,\r\n    setInput,\r\n    handleSubmit,\r\n  };\r\n};\r\n\r\n// Barcode validation utilities\r\nexport const barcodeValidation = {\r\n  // Check if barcode looks like a student ID\r\n  isStudentBarcode: (barcode: string): boolean => {\r\n    return (\r\n      /^[A-Z]{2,4}\\d{3,6}$/.test(barcode) || // Letters + numbers\r\n      (barcode.length >= 6 && barcode.length <= 8)\r\n    ); // 6-8 digits\r\n  },\r\n\r\n  // Check if barcode looks like a book ISBN\r\n  isBookBarcode: (barcode: string): boolean => {\r\n    return (\r\n      /^(97[89])?\\d{9}(\\d|X)$/.test(barcode) || // ISBN format\r\n      /^\\d{10,13}$/.test(barcode)\r\n    ); // Generic 10-13 digit\r\n  },\r\n\r\n  // Check if barcode looks like equipment ID\r\n  isEquipmentBarcode: (barcode: string): boolean => {\r\n    return (\r\n      /^EQ\\d{3,}$/.test(barcode) || // EQ prefix\r\n      /^PC\\d{2,}$/.test(barcode) || // PC (computer) prefix\r\n      /^PS\\d{2,}$/.test(barcode) || // PS (playstation) prefix\r\n      /^AVR\\d{2,}$/.test(barcode)\r\n    ); // AVR prefix\r\n  },\r\n\r\n  // Get barcode type\r\n  getBarcodeType: (\r\n    barcode: string\r\n  ): 'student' | 'book' | 'equipment' | 'unknown' => {\r\n    // Check equipment first (most specific)\r\n    if (\r\n      /^EQ\\d/.test(barcode) ||\r\n      /^PC\\d/.test(barcode) ||\r\n      /^PS\\d/.test(barcode) ||\r\n      /^AVR\\d/.test(barcode)\r\n    ) {\r\n      return 'equipment';\r\n    }\r\n    // Check books next (ISBN patterns)\r\n    if (/^(97[89])?\\d{9}(\\d|X)$/.test(barcode) || /^\\d{10,13}$/.test(barcode)) {\r\n      return 'book';\r\n    }\r\n    // Check students last (most generic)\r\n    if (/^[A-Z]{2,4}\\d{3,6}$/.test(barcode) || barcode.length >= 6) {\r\n      return 'student';\r\n    }\r\n    return 'unknown';\r\n  },\r\n};\r\n\r\n// Export scanner utilities\r\nexport const scannerUtils = {\r\n  playScanSound,\r\n  barcodeValidation,\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\type-utils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1368,1371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1368,1371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1701,1704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1701,1704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3143,3146],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3143,3146],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3281,3284],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3281,3284],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3289,3292],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3289,3292],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3466,3469],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3466,3469],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3474,3477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3474,3477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":571,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":571,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13662,13665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13662,13665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Advanced TypeScript utility types for enhanced type safety\r\n\r\n/**\r\n * Create a type that requires all properties of T, including optional ones\r\n */\r\nexport type RequiredFields<T> = Required<T>;\r\n\r\n/**\r\n * Create a type that makes specified properties of T optional\r\n */\r\nexport type PartialBy<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;\r\n\r\n/**\r\n * Create a type that makes specified properties of T required\r\n */\r\nexport type RequiredBy<T, K extends keyof T> = T & Required<Pick<T, K>>;\r\n\r\n/**\r\n * Create a type that makes all properties of T readonly recursively\r\n */\r\nexport type DeepReadonly<T> = {\r\n  readonly [P in keyof T]: T[P] extends object ? DeepReadonly<T[P]> : T[P];\r\n};\r\n\r\n/**\r\n * Create a type that makes all properties of T partial recursively\r\n */\r\nexport type DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P];\r\n};\r\n\r\n/**\r\n * Create a type that allows for mutation of nested properties\r\n */\r\nexport type DeepMutable<T> = {\r\n  -readonly [P in keyof T]: T[P] extends object ? DeepMutable<T[P]> : T[P];\r\n};\r\n\r\n/**\r\n * Extract the type of array elements\r\n */\r\nexport type ArrayElement<T> = T extends (infer U)[] ? U : never;\r\n\r\n/**\r\n * Create a function type with the same parameters but different return type\r\n */\r\nexport type OverwriteReturnType<T, NewReturn> = T extends (\r\n  ...args: infer P\r\n) => any\r\n  ? (...args: P) => NewReturn\r\n  : never;\r\n\r\n/**\r\n * Create a type that represents a promise resolution\r\n */\r\nexport type UnwrapPromise<T> = T extends Promise<infer U> ? U : T;\r\n\r\n/**\r\n * Create a type that flattens nested promises\r\n */\r\nexport type DeepUnwrapPromise<T> =\r\n  T extends Promise<infer U>\r\n    ? U extends Promise<any>\r\n      ? DeepUnwrapPromise<U>\r\n      : U\r\n    : T;\r\n\r\n/**\r\n * Create a type that makes a specific property non-nullable\r\n */\r\nexport type NonNullableProperty<T, K extends keyof T> = T & {\r\n  [P in K]: NonNullable<T[P]>;\r\n};\r\n\r\n/**\r\n * Create a type that filters out nullable values from an array\r\n */\r\nexport type NonNullableArray<T> = T extends (infer U)[]\r\n  ? NonNullable<U>[]\r\n  : never;\r\n\r\n/**\r\n * Create a type that represents a key-value pair object\r\n */\r\nexport type KeyValue<T = string> = Record<string, T>;\r\n\r\n/**\r\n * Create a type that represents a numeric enum\r\n */\r\nexport type StringEnum<T extends string> = {\r\n  [K in T]: K;\r\n};\r\n\r\n/**\r\n * Create a type that represents the union of all values in an object\r\n */\r\nexport type ValueOf<T> = T[keyof T];\r\n\r\n/**\r\n * Create a type that represents the union of all keys in an object\r\n */\r\nexport type KeysOf<T> = keyof T;\r\n\r\n/**\r\n * Create a type that filters keys by their value type\r\n */\r\nexport type KeysOfType<T, V> = {\r\n  [K in keyof T]: T[K] extends V ? K : never;\r\n}[keyof T];\r\n\r\n/**\r\n * Create a type that picks keys that match a certain type\r\n */\r\nexport type PickByType<T, V> = Pick<T, KeysOfType<T, V>>;\r\n\r\n/**\r\n * Create a type that excludes keys that match a certain type\r\n */\r\nexport type OmitByType<T, V> = Omit<T, KeysOfType<T, V>>;\r\n\r\n/**\r\n * Create a type that represents a function with typed arguments\r\n */\r\nexport type TypedFunction<T extends Record<string, any>, R> = (args: T) => R;\r\n\r\n/**\r\n * Create a type that represents a constructor\r\n */\r\nexport type Constructor<T = unknown, Args extends any[] = any[]> = new (\r\n  ...args: Args\r\n) => T;\r\n\r\n/**\r\n * Create a type that represents an abstract constructor\r\n */\r\nexport type AbstractConstructor<\r\n  T = unknown,\r\n  Args extends any[] = any[],\r\n> = abstract new (...args: Args) => T;\r\n\r\n/**\r\n * Create a type that merges two objects\r\n */\r\nexport type Merge<T, U> = Omit<T, keyof U> & U;\r\n\r\n/**\r\n * Create a type that represents the intersection of multiple types\r\n */\r\nexport type Intersection<T> = T extends (infer U)[]\r\n  ? U extends object\r\n    ? Intersection<U>\r\n    : never\r\n  : T;\r\n\r\n/**\r\n * Create a type that represents the union of multiple types\r\n */\r\nexport type Union<T> = T extends (infer U)[] ? U : never;\r\n\r\n/**\r\n * Create a type that validates email format at compile time\r\n */\r\nexport type Email<T extends string> = T extends `${string}@${string}.${string}`\r\n  ? T\r\n  : never;\r\n\r\n/**\r\n * Create a type that validates URL format at compile time\r\n */\r\nexport type Url<T extends string> = T extends `http${'s' | ''}://${string}`\r\n  ? T\r\n  : never;\r\n\r\n/**\r\n * Create a type that represents ISO date string\r\n */\r\nexport type IsoDate<T extends string> =\r\n  T extends `${string}-${string}-${string}T${string}:${string}:${string}`\r\n    ? T\r\n    : never;\r\n\r\n/**\r\n * Create a type that represents UUID format\r\n */\r\nexport type UUID<T extends string> =\r\n  T extends `${string}-${string}-${string}-${string}-${string}` ? T : never;\r\n\r\n/**\r\n * Create a type that enforces minimum string length\r\n */\r\nexport type MinLength<T extends string, L extends number> = T extends {\r\n  length: infer U;\r\n}\r\n  ? U extends L\r\n    ? T\r\n    : never\r\n  : never;\r\n\r\n/**\r\n * Create a type that enforces maximum string length\r\n */\r\nexport type MaxLength<T extends string, L extends number> = T extends {\r\n  length: infer U;\r\n}\r\n  ? U extends L\r\n    ? T\r\n    : never\r\n  : never;\r\n\r\n/**\r\n * Create a type that represents a numeric string\r\n */\r\nexport type NumericString<T extends string> = T extends `${number}` ? T : never;\r\n\r\n/**\r\n * Create a type that represents a boolean string\r\n */\r\nexport type BooleanString<T extends string> = T extends 'true' | 'false'\r\n  ? T\r\n  : never;\r\n\r\n/**\r\n * Create a type for tagged strings (compile-time validation)\r\n */\r\nexport type TaggedString<T extends string, Tag extends string> = T & {\r\n  __tag: Tag;\r\n};\r\n\r\n/**\r\n * Create a type that represents a valid ID string\r\n */\r\nexport type IdString<T extends string> = TaggedString<T, 'id'>;\r\n\r\n/**\r\n * Create a type that represents a timestamp string\r\n */\r\nexport type TimestampString<T extends string> = TaggedString<T, 'timestamp'>;\r\n\r\n/**\r\n * Create a type guard function\r\n */\r\nexport type TypeGuard<T> = (value: unknown) => value is T;\r\n\r\n/**\r\n * Create a type for a validator function\r\n */\r\nexport type Validator<T> = (value: unknown) => ValidationResult<T>;\r\n\r\n/**\r\n * Create a type for validation results\r\n */\r\nexport type ValidationResult<T> =\r\n  | {\r\n      success: true;\r\n      data: T;\r\n    }\r\n  | {\r\n      success: false;\r\n      errors: string[];\r\n    };\r\n\r\n/**\r\n * Create a type for async validators\r\n */\r\nexport type AsyncValidator<T> = (\r\n  value: unknown\r\n) => Promise<ValidationResult<T>>;\r\n\r\n/**\r\n * Create a type that represents a branded type\r\n */\r\nexport type Branded<T, B> = T & { __brand: B };\r\n\r\n/**\r\n * Create a type that represents an entity with ID\r\n */\r\nexport type Entity<T> = T & { id: string };\r\n\r\n/**\r\n * Create a type that represents a paginated response\r\n */\r\nexport type Paginated<T> = {\r\n  data: T[];\r\n  total: number;\r\n  page: number;\r\n  pageSize: number;\r\n  totalPages: number;\r\n};\r\n\r\n/**\r\n * Create a type that represents API response structure\r\n */\r\nexport type ApiResponse<T> = {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: string;\r\n  message?: string;\r\n  timestamp: string;\r\n};\r\n\r\n/**\r\n * Create a type that represents a form field configuration\r\n */\r\nexport type FormField<T = unknown> = {\r\n  name: string;\r\n  label: string;\r\n  type: FormFieldType;\r\n  value: T;\r\n  required: boolean;\r\n  disabled?: boolean;\r\n  placeholder?: string;\r\n  validation?: ValidationRule[];\r\n  options?: FormOption[];\r\n};\r\n\r\n/**\r\n * Create a type for form field types\r\n */\r\nexport type FormFieldType =\r\n  | 'text'\r\n  | 'email'\r\n  | 'password'\r\n  | 'number'\r\n  | 'select'\r\n  | 'multiselect'\r\n  | 'checkbox'\r\n  | 'radio'\r\n  | 'textarea'\r\n  | 'date'\r\n  | 'file';\r\n\r\n/**\r\n * Create a type for validation rules\r\n */\r\nexport type ValidationRule =\r\n  | { type: 'required'; message: string }\r\n  | { type: 'minLength'; value: number; message: string }\r\n  | { type: 'maxLength'; value: number; message: string }\r\n  | { type: 'pattern'; value: RegExp; message: string }\r\n  | { type: 'custom'; validator: (value: unknown) => boolean; message: string };\r\n\r\n/**\r\n * Create a type for form options\r\n */\r\nexport type FormOption = {\r\n  label: string;\r\n  value: string | number;\r\n  disabled?: boolean;\r\n};\r\n\r\n/**\r\n * Runtime type guards and validators\r\n */\r\nexport const TypeGuards = {\r\n  /**\r\n   * Check if a value is a string\r\n   */\r\n  isString: (value: unknown): value is string => {\r\n    return typeof value === 'string';\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a number\r\n   */\r\n  isNumber: (value: unknown): value is number => {\r\n    return typeof value === 'number' && !isNaN(value);\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a boolean\r\n   */\r\n  isBoolean: (value: unknown): value is boolean => {\r\n    return typeof value === 'boolean';\r\n  },\r\n\r\n  /**\r\n   * Check if a value is an object\r\n   */\r\n  isObject: (value: unknown): value is Record<string, unknown> => {\r\n    return value !== null && typeof value === 'object' && !Array.isArray(value);\r\n  },\r\n\r\n  /**\r\n   * Check if a value is an array\r\n   */\r\n  isArray: <T = unknown>(value: unknown): value is T[] => {\r\n    return Array.isArray(value);\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a date\r\n   */\r\n  isDate: (value: unknown): value is Date => {\r\n    return value instanceof Date && !isNaN(value.getTime());\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a valid email\r\n   */\r\n  isEmail: (value: unknown): value is string => {\r\n    return (\r\n      typeof value === 'string' && /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value)\r\n    );\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a valid URL\r\n   */\r\n  isUrl: (value: unknown): value is string => {\r\n    return typeof value === 'string' && /^https?:\\/\\/.+/.test(value);\r\n  },\r\n\r\n  /**\r\n   * Check if a value is a UUID\r\n   */\r\n  isUUID: (value: unknown): value is string => {\r\n    return (\r\n      typeof value === 'string' &&\r\n      /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(\r\n        value\r\n      )\r\n    );\r\n  },\r\n\r\n  /**\r\n   * Check if a value is null or undefined\r\n   */\r\n  isNullable: (value: unknown): value is null | undefined => {\r\n    return value === null || value === undefined;\r\n  },\r\n\r\n  /**\r\n   * Check if a value is not null or undefined\r\n   */\r\n  isNonNullable: <T>(value: T): value is NonNullable<T> => {\r\n    return value !== null && value !== undefined;\r\n  },\r\n};\r\n\r\n/**\r\n * Runtime validators with detailed error messages\r\n */\r\nexport const Validators = {\r\n  /**\r\n   * Validate a string with optional constraints\r\n   */\r\n  string: (options?: {\r\n    minLength?: number;\r\n    maxLength?: number;\r\n    pattern?: RegExp;\r\n  }) => {\r\n    return (value: unknown): ValidationResult<string> => {\r\n      if (typeof value !== 'string') {\r\n        return {\r\n          success: false,\r\n          errors: ['Value must be a string'],\r\n        };\r\n      }\r\n\r\n      const errors: string[] = [];\r\n\r\n      if (options?.minLength && value.length < options.minLength) {\r\n        errors.push(\r\n          `String must be at least ${options.minLength} characters long`\r\n        );\r\n      }\r\n\r\n      if (options?.maxLength && value.length > options.maxLength) {\r\n        errors.push(\r\n          `String must be no more than ${options.maxLength} characters long`\r\n        );\r\n      }\r\n\r\n      if (options?.pattern && !options.pattern.test(value)) {\r\n        errors.push('String does not match required pattern');\r\n      }\r\n\r\n      if (errors.length > 0) {\r\n        return { success: false, errors };\r\n      }\r\n\r\n      return { success: true, data: value };\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Validate a number with optional constraints\r\n   */\r\n  number: (options?: { min?: number; max?: number; integer?: boolean }) => {\r\n    return (value: unknown): ValidationResult<number> => {\r\n      if (typeof value !== 'number' || isNaN(value)) {\r\n        return {\r\n          success: false,\r\n          errors: ['Value must be a valid number'],\r\n        };\r\n      }\r\n\r\n      const errors: string[] = [];\r\n\r\n      if (options?.integer && !Number.isInteger(value)) {\r\n        errors.push('Value must be an integer');\r\n      }\r\n\r\n      if (options?.min !== undefined && value < options.min) {\r\n        errors.push(`Value must be at least ${options.min}`);\r\n      }\r\n\r\n      if (options?.max !== undefined && value > options.max) {\r\n        errors.push(`Value must be no more than ${options.max}`);\r\n      }\r\n\r\n      if (errors.length > 0) {\r\n        return { success: false, errors };\r\n      }\r\n\r\n      return { success: true, data: value };\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Validate an email address\r\n   */\r\n  email: (value: unknown): ValidationResult<string> => {\r\n    if (!TypeGuards.isEmail(value)) {\r\n      return {\r\n        success: false,\r\n        errors: ['Value must be a valid email address'],\r\n      };\r\n    }\r\n\r\n    return { success: true, data: value };\r\n  },\r\n\r\n  /**\r\n   * Validate a UUID\r\n   */\r\n  uuid: (value: unknown): ValidationResult<string> => {\r\n    if (!TypeGuards.isUUID(value)) {\r\n      return {\r\n        success: false,\r\n        errors: ['Value must be a valid UUID'],\r\n      };\r\n    }\r\n\r\n    return { success: true, data: value };\r\n  },\r\n\r\n  /**\r\n   * Validate an array with optional constraints\r\n   */\r\n  array: <T>(\r\n    itemValidator: Validator<T>,\r\n    options?: { minLength?: number; maxLength?: number }\r\n  ) => {\r\n    return (value: unknown): ValidationResult<T[]> => {\r\n      if (!Array.isArray(value)) {\r\n        return {\r\n          success: false,\r\n          errors: ['Value must be an array'],\r\n        };\r\n      }\r\n\r\n      const errors: string[] = [];\r\n      const validItems: T[] = [];\r\n\r\n      for (let i = 0; i < value.length; i++) {\r\n        const result = itemValidator(value[i]);\r\n        if (result.success) {\r\n          validItems.push(result.data);\r\n        } else {\r\n          const resultAny = result as any;\r\n          errors.push(`Item at index ${i}: ${resultAny.errors.join(', ')}`);\r\n        }\r\n      }\r\n\r\n      if (options?.minLength && value.length < options.minLength) {\r\n        errors.push(`Array must have at least ${options.minLength} items`);\r\n      }\r\n\r\n      if (options?.maxLength && value.length > options.maxLength) {\r\n        errors.push(`Array must have no more than ${options.maxLength} items`);\r\n      }\r\n\r\n      if (errors.length > 0) {\r\n        return { success: false, errors };\r\n      }\r\n\r\n      return { success: true, data: validItems };\r\n    };\r\n  },\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\scripts\\performanceBenchmark.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":192,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":192,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5282,5285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5282,5285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5342,5345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5342,5345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6057,6060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6057,6060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance Benchmarking Script\r\n *\r\n * Automated performance testing and benchmarking utilities for CLMS frontend\r\n */\r\n\r\ninterface BenchmarkConfig {\r\n  name: string;\r\n  iterations: number;\r\n  warmupIterations: number;\r\n  timeout: number;\r\n  thresholds: {\r\n    renderTime: number;\r\n    memoryUsage: number;\r\n    bundleSize: number;\r\n    loadTime: number;\r\n  };\r\n}\r\n\r\ninterface BenchmarkResult {\r\n  name: string;\r\n  timestamp: number;\r\n  iterations: number;\r\n  results: {\r\n    renderTime: {\r\n      min: number;\r\n      max: number;\r\n      average: number;\r\n      median: number;\r\n      p95: number;\r\n      p99: number;\r\n    };\r\n    memoryUsage: {\r\n      min: number;\r\n      max: number;\r\n      average: number;\r\n      median: number;\r\n      p95: number;\r\n      p99: number;\r\n    };\r\n    bundleSize: number;\r\n    loadTime: {\r\n      min: number;\r\n      max: number;\r\n      average: number;\r\n      median: number;\r\n      p95: number;\r\n      p99: number;\r\n    };\r\n  };\r\n  passed: boolean;\r\n  violations: Array<{\r\n    metric: string;\r\n    threshold: number;\r\n    actual: number;\r\n    severity: 'warning' | 'error';\r\n  }>;\r\n  score: number;\r\n}\r\n\r\nclass PerformanceBenchmark {\r\n  private static instance: PerformanceBenchmark;\r\n  private results: BenchmarkResult[] = [];\r\n  private isRunning = false;\r\n\r\n  private constructor() {}\r\n\r\n  public static getInstance(): PerformanceBenchmark {\r\n    if (!PerformanceBenchmark.instance) {\r\n      PerformanceBenchmark.instance = new PerformanceBenchmark();\r\n    }\r\n    return PerformanceBenchmark.instance;\r\n  }\r\n\r\n  public async runBenchmark(config: BenchmarkConfig): Promise<BenchmarkResult> {\r\n    if (this.isRunning) {\r\n      throw new Error('Benchmark is already running');\r\n    }\r\n\r\n    this.isRunning = true;\r\n    console.debug(`≡ƒÜÇ Starting benchmark: ${config.name}`);\r\n\r\n    const renderTimes: number[] = [];\r\n    const memoryUsages: number[] = [];\r\n    const loadTimes: number[] = [];\r\n\r\n    try {\r\n      // Warmup phase\r\n      console.debug(`≡ƒöÑ Warming up (${config.warmupIterations} iterations)`);\r\n      for (let i = 0; i < config.warmupIterations; i++) {\r\n        await this.measureRender();\r\n        await this.measureMemory();\r\n        await this.measureLoadTime();\r\n        await new Promise((resolve) => setTimeout(resolve, 100));\r\n      }\r\n\r\n      // Main benchmark phase\r\n      console.debug(`≡ƒôè Running benchmark (${config.iterations} iterations)`);\r\n      for (let i = 0; i < config.iterations; i++) {\r\n        const startTime = performance.now();\r\n\r\n        // Measure render time\r\n        const renderTime = await this.measureRender();\r\n        renderTimes.push(renderTime);\r\n\r\n        // Measure memory usage\r\n        const memoryUsage = await this.measureMemory();\r\n        memoryUsages.push(memoryUsage);\r\n\r\n        // Measure load time\r\n        const loadTime = await this.measureLoadTime();\r\n        loadTimes.push(loadTime);\r\n\r\n        const iterationTime = performance.now() - startTime;\r\n        console.debug(\r\n          `  Iteration ${i + 1}/${config.iterations}: ${iterationTime.toFixed(2)}ms`\r\n        );\r\n\r\n        // Prevent timeout\r\n        if (iterationTime > config.timeout) {\r\n          console.warn(\r\n            `ΓÜá∩╕Å Iteration ${i + 1} exceeded timeout of ${config.timeout}ms`\r\n          );\r\n        }\r\n\r\n        // Small delay between iterations\r\n        await new Promise((resolve) => setTimeout(resolve, 50));\r\n      }\r\n\r\n      // Calculate statistics\r\n      const renderStats = this.calculateStatistics(renderTimes);\r\n      const memoryStats = this.calculateStatistics(memoryUsages);\r\n      const loadStats = this.calculateStatistics(loadTimes);\r\n\r\n      // Get bundle size\r\n      const bundleSize = await this.measureBundleSize();\r\n\r\n      // Check thresholds\r\n      const violations = this.checkThresholds(config, {\r\n        renderTime: renderStats.average,\r\n        memoryUsage: memoryStats.average,\r\n        bundleSize,\r\n        loadTime: loadStats.average,\r\n      });\r\n\r\n      const passed =\r\n        violations.filter((v) => v.severity === 'error').length === 0;\r\n      const score = this.calculateScore(violations);\r\n\r\n      const result: BenchmarkResult = {\r\n        name: config.name,\r\n        timestamp: Date.now(),\r\n        iterations: config.iterations,\r\n        results: {\r\n          renderTime: renderStats,\r\n          memoryUsage: memoryStats,\r\n          bundleSize,\r\n          loadTime: loadStats,\r\n        },\r\n        passed,\r\n        violations,\r\n        score,\r\n      };\r\n\r\n      this.results.push(result);\r\n      console.debug(\r\n        `Γ£à Benchmark completed: ${config.name} - Score: ${score.toFixed(1)}/100`\r\n      );\r\n\r\n      return result;\r\n    } catch (error) {\r\n      console.error(`Γ¥î Benchmark failed: ${config.name}`, error);\r\n      throw error;\r\n    } finally {\r\n      this.isRunning = false;\r\n    }\r\n  }\r\n\r\n  private async measureRender(): Promise<number> {\r\n    const startTime = performance.now();\r\n\r\n    // Simulate render measurement\r\n    // In a real app, this would measure actual component render times\r\n    await new Promise((resolve) =>\r\n      setTimeout(resolve, Math.random() * 50 + 10)\r\n    );\r\n\r\n    return performance.now() - startTime;\r\n  }\r\n\r\n  private async measureMemory(): Promise<number> {\r\n    if (window.performance && (window.performance as any).memory) {\r\n      const memory = (window.performance as any).memory;\r\n      return memory.usedJSHeapSize;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  private async measureLoadTime(): Promise<number> {\r\n    const startTime = performance.now();\r\n\r\n    // Simulate load time measurement\r\n    await new Promise((resolve) =>\r\n      setTimeout(resolve, Math.random() * 100 + 20)\r\n    );\r\n\r\n    return performance.now() - startTime;\r\n  }\r\n\r\n  private async measureBundleSize(): Promise<number> {\r\n    try {\r\n      // Get bundle size from performance entries\r\n      const entries = performance.getEntriesByType('resource');\r\n      const jsEntries = entries.filter((entry) => entry.name.endsWith('.js'));\r\n\r\n      return jsEntries.reduce((total, entry) => {\r\n        return total + (entry as any).transferSize || 0;\r\n      }, 0);\r\n    } catch (error) {\r\n      console.warn('Could not measure bundle size:', error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  private calculateStatistics(values: number[]) {\r\n    const sorted = [...values].sort((a, b) => a - b);\r\n    const sum = values.reduce((a, b) => a + b, 0);\r\n    const average = sum / values.length;\r\n\r\n    return {\r\n      min: Math.min(...values),\r\n      max: Math.max(...values),\r\n      average,\r\n      median: sorted[Math.floor(sorted.length / 2)] || 0,\r\n      p95: sorted[Math.floor(sorted.length * 0.95)] || 0,\r\n      p99: sorted[Math.floor(sorted.length * 0.99)] || 0,\r\n    };\r\n  }\r\n\r\n  private checkThresholds(\r\n    config: BenchmarkConfig,\r\n    metrics: {\r\n      renderTime: number;\r\n      memoryUsage: number;\r\n      bundleSize: number;\r\n      loadTime: number;\r\n    }\r\n  ) {\r\n    const violations: Array<{\r\n      metric: string;\r\n      threshold: number;\r\n      actual: number;\r\n      severity: 'warning' | 'error';\r\n    }> = [];\r\n\r\n    // Check render time\r\n    if (metrics.renderTime > config.thresholds.renderTime) {\r\n      violations.push({\r\n        metric: 'renderTime',\r\n        threshold: config.thresholds.renderTime,\r\n        actual: metrics.renderTime,\r\n        severity:\r\n          metrics.renderTime > config.thresholds.renderTime * 1.5\r\n            ? 'error'\r\n            : 'warning',\r\n      });\r\n    }\r\n\r\n    // Check memory usage\r\n    if (metrics.memoryUsage > config.thresholds.memoryUsage) {\r\n      violations.push({\r\n        metric: 'memoryUsage',\r\n        threshold: config.thresholds.memoryUsage,\r\n        actual: metrics.memoryUsage,\r\n        severity:\r\n          metrics.memoryUsage > config.thresholds.memoryUsage * 1.5\r\n            ? 'error'\r\n            : 'warning',\r\n      });\r\n    }\r\n\r\n    // Check bundle size\r\n    if (metrics.bundleSize > config.thresholds.bundleSize) {\r\n      violations.push({\r\n        metric: 'bundleSize',\r\n        threshold: config.thresholds.bundleSize,\r\n        actual: metrics.bundleSize,\r\n        severity:\r\n          metrics.bundleSize > config.thresholds.bundleSize * 1.2\r\n            ? 'error'\r\n            : 'warning',\r\n      });\r\n    }\r\n\r\n    // Check load time\r\n    if (metrics.loadTime > config.thresholds.loadTime) {\r\n      violations.push({\r\n        metric: 'loadTime',\r\n        threshold: config.thresholds.loadTime,\r\n        actual: metrics.loadTime,\r\n        severity:\r\n          metrics.loadTime > config.thresholds.loadTime * 2\r\n            ? 'error'\r\n            : 'warning',\r\n      });\r\n    }\r\n\r\n    return violations;\r\n  }\r\n\r\n  private calculateScore(\r\n    violations: Array<{ severity: 'warning' | 'error' }>\r\n  ): number {\r\n    let score = 100;\r\n\r\n    violations.forEach((violation) => {\r\n      if (violation.severity === 'error') {\r\n        score -= 20;\r\n      } else {\r\n        score -= 10;\r\n      }\r\n    });\r\n\r\n    return Math.max(0, Math.min(100, score));\r\n  }\r\n\r\n  public getResults(): BenchmarkResult[] {\r\n    return [...this.results];\r\n  }\r\n\r\n  public getLatestResult(): BenchmarkResult | null {\r\n    return this.results.length > 0\r\n      ? (this.results[this.results.length - 1] ?? null)\r\n      : null;\r\n  }\r\n\r\n  public compareResults(\r\n    benchmarkName: string,\r\n    limit: number = 10\r\n  ): {\r\n    trend: 'improving' | 'degrading' | 'stable';\r\n    changePercentage: number;\r\n    results: BenchmarkResult[];\r\n  } {\r\n    const relevantResults = this.results\r\n      .filter((result) => result.name === benchmarkName)\r\n      .slice(-limit);\r\n\r\n    if (relevantResults.length < 2) {\r\n      return {\r\n        trend: 'stable',\r\n        changePercentage: 0,\r\n        results: relevantResults,\r\n      };\r\n    }\r\n\r\n    const latest = relevantResults[relevantResults.length - 1];\r\n    const previous = relevantResults[relevantResults.length - 2];\r\n\r\n    if (!latest || !previous) {\r\n      return {\r\n        trend: 'stable' as const,\r\n        changePercentage: 0,\r\n        results: relevantResults,\r\n      };\r\n    }\r\n\r\n    const changePercentage =\r\n      ((latest.score - previous.score) / previous.score) * 100;\r\n\r\n    let trend: 'improving' | 'degrading' | 'stable';\r\n    if (changePercentage > 5) {\r\n      trend = 'improving';\r\n    } else if (changePercentage < -5) {\r\n      trend = 'degrading';\r\n    } else {\r\n      trend = 'stable';\r\n    }\r\n\r\n    return {\r\n      trend,\r\n      changePercentage,\r\n      results: relevantResults,\r\n    };\r\n  }\r\n\r\n  public exportResults(): string {\r\n    const exportData = {\r\n      timestamp: Date.now(),\r\n      results: this.results,\r\n      summary: {\r\n        totalBenchmarks: this.results.length,\r\n        averageScore:\r\n          this.results.reduce((sum, r) => sum + r.score, 0) /\r\n          this.results.length,\r\n        passedBenchmarks: this.results.filter((r) => r.passed).length,\r\n        failedBenchmarks: this.results.filter((r) => !r.passed).length,\r\n      },\r\n    };\r\n\r\n    return JSON.stringify(exportData, null, 2);\r\n  }\r\n\r\n  public clearResults(): void {\r\n    this.results = [];\r\n  }\r\n}\r\n\r\n// Predefined benchmark configurations\r\nexport const BENCHMARK_CONFIGS = {\r\n  // Component rendering benchmark\r\n  componentRender: {\r\n    name: 'Component Render Performance',\r\n    iterations: 50,\r\n    warmupIterations: 10,\r\n    timeout: 5000,\r\n    thresholds: {\r\n      renderTime: 16, // 16ms for 60fps\r\n      memoryUsage: 50 * 1024 * 1024, // 50MB\r\n      bundleSize: 1024 * 1024, // 1MB\r\n      loadTime: 3000, // 3 seconds\r\n    },\r\n  },\r\n\r\n  // Page load benchmark\r\n  pageLoad: {\r\n    name: 'Page Load Performance',\r\n    iterations: 10,\r\n    warmupIterations: 3,\r\n    timeout: 10000,\r\n    thresholds: {\r\n      renderTime: 100,\r\n      memoryUsage: 100 * 1024 * 1024, // 100MB\r\n      bundleSize: 2 * 1024 * 1024, // 2MB\r\n      loadTime: 5000, // 5 seconds\r\n    },\r\n  },\r\n\r\n  // Memory usage benchmark\r\n  memoryUsage: {\r\n    name: 'Memory Usage',\r\n    iterations: 30,\r\n    warmupIterations: 5,\r\n    timeout: 3000,\r\n    thresholds: {\r\n      renderTime: 50,\r\n      memoryUsage: 75 * 1024 * 1024, // 75MB\r\n      bundleSize: 1024 * 1024, // 1MB\r\n      loadTime: 2000, // 2 seconds\r\n    },\r\n  },\r\n\r\n  // API performance benchmark\r\n  apiPerformance: {\r\n    name: 'API Performance',\r\n    iterations: 20,\r\n    warmupIterations: 5,\r\n    timeout: 8000,\r\n    thresholds: {\r\n      renderTime: 25,\r\n      memoryUsage: 30 * 1024 * 1024, // 30MB\r\n      bundleSize: 512 * 1024, // 512KB\r\n      loadTime: 1500, // 1.5 seconds\r\n    },\r\n  },\r\n};\r\n\r\n// Run all benchmarks\r\nexport async function runAllBenchmarks(): Promise<BenchmarkResult[]> {\r\n  const benchmark = PerformanceBenchmark.getInstance();\r\n  const results: BenchmarkResult[] = [];\r\n\r\n  console.debug('≡ƒÜÇ Starting comprehensive performance benchmark suite...');\r\n\r\n  for (const config of Object.values(BENCHMARK_CONFIGS)) {\r\n    try {\r\n      const result = await benchmark.runBenchmark(config);\r\n      results.push(result);\r\n    } catch (error) {\r\n      console.error(`Γ¥î Failed to run benchmark: ${config.name}`, error);\r\n    }\r\n  }\r\n\r\n  console.debug('Γ£à All benchmarks completed');\r\n  return results;\r\n}\r\n\r\n// Export singleton instance\r\nexport const performanceBenchmark = PerformanceBenchmark.getInstance();\r\nexport default performanceBenchmark;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\scripts\\performanceTest.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[669,672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[669,672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1079,1082],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1079,1082],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":293,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":293,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8581,8584],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8581,8584],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance Test Script\r\n *\r\n * Automated performance testing for CLMS frontend with real-world scenarios\r\n */\r\n\r\nimport { performanceMonitoringService } from '@/services/performanceMonitoringService';\r\n\r\ninterface TestScenario {\r\n  name: string;\r\n  description: string;\r\n  steps: Array<{\r\n    action: string;\r\n    measure: boolean;\r\n    timeout?: number;\r\n  }>;\r\n  expectedResults: {\r\n    maxRenderTime: number;\r\n    maxMemoryUsage: number;\r\n    maxErrors: number;\r\n  };\r\n}\r\n\r\nclass PerformanceTest {\r\n  private static instance: PerformanceTest;\r\n  private testResults: Array<{\r\n    scenario: string;\r\n    passed: boolean;\r\n    duration: number;\r\n    metrics: any;\r\n    errors: string[];\r\n  }> = [];\r\n\r\n  private constructor() {}\r\n\r\n  public static getInstance(): PerformanceTest {\r\n    if (!PerformanceTest.instance) {\r\n      PerformanceTest.instance = new PerformanceTest();\r\n    }\r\n    return PerformanceTest.instance;\r\n  }\r\n\r\n  public async runTest(scenario: TestScenario): Promise<{\r\n    scenario: string;\r\n    passed: boolean;\r\n    duration: number;\r\n    metrics: any;\r\n    errors: string[];\r\n  }> {\r\n    console.debug(`≡ƒº¬ Running test: ${scenario.name}`);\r\n    console.debug(`≡ƒô¥ ${scenario.description}`);\r\n\r\n    const startTime = Date.now();\r\n    const errors: string[] = [];\r\n    let passed = true;\r\n\r\n    try {\r\n      // Start performance monitoring\r\n      performanceMonitoringService.startMonitoring();\r\n\r\n      const initialMetrics = performanceMonitoringService.getMetrics();\r\n\r\n      // Execute test steps\r\n      for (const step of scenario.steps) {\r\n        try {\r\n          console.debug(`  Γ₧í∩╕Å ${step.action}`);\r\n\r\n          if (step.measure) {\r\n            const stepStartTime = performance.now();\r\n            await this.executeStep(step.action);\r\n            const stepDuration = performance.now() - stepStartTime;\r\n\r\n            if (step.timeout && stepDuration > step.timeout) {\r\n              errors.push(\r\n                `Step timeout: ${step.action} took ${stepDuration.toFixed(2)}ms (limit: ${step.timeout}ms)`\r\n              );\r\n              passed = false;\r\n            }\r\n          } else {\r\n            await this.executeStep(step.action);\r\n          }\r\n        } catch (error) {\r\n          const errorMessage = `Step failed: ${step.action} - ${error instanceof Error ? error.message : String(error)}`;\r\n          errors.push(errorMessage);\r\n          console.error(`  Γ¥î ${errorMessage}`);\r\n          passed = false;\r\n        }\r\n      }\r\n\r\n      // Get final metrics\r\n      const finalMetrics = performanceMonitoringService.getMetrics();\r\n      const duration = Date.now() - startTime;\r\n\r\n      // Validate results\r\n      if (finalMetrics.renderTime > scenario.expectedResults.maxRenderTime) {\r\n        errors.push(\r\n          `Render time exceeded: ${finalMetrics.renderTime.toFixed(2)}ms (limit: ${scenario.expectedResults.maxRenderTime}ms)`\r\n        );\r\n        passed = false;\r\n      }\r\n\r\n      if (finalMetrics.memoryUsage > scenario.expectedResults.maxMemoryUsage) {\r\n        errors.push(\r\n          `Memory usage exceeded: ${finalMetrics.memoryUsage.toFixed(2)}MB (limit: ${(scenario.expectedResults.maxMemoryUsage / 1024 / 1024).toFixed(2)}MB)`\r\n        );\r\n        passed = false;\r\n      }\r\n\r\n      if (finalMetrics.errorCount > scenario.expectedResults.maxErrors) {\r\n        errors.push(\r\n          `Error count exceeded: ${finalMetrics.errorCount} (limit: ${scenario.expectedResults.maxErrors})`\r\n        );\r\n        passed = false;\r\n      }\r\n\r\n      const result = {\r\n        scenario: scenario.name,\r\n        passed,\r\n        duration,\r\n        metrics: {\r\n          initial: initialMetrics,\r\n          final: finalMetrics,\r\n          delta: {\r\n            renderTime: finalMetrics.renderTime - initialMetrics.renderTime,\r\n            memoryUsage: finalMetrics.memoryUsage - initialMetrics.memoryUsage,\r\n            errorCount: finalMetrics.errorCount - initialMetrics.errorCount,\r\n          },\r\n        },\r\n        errors,\r\n      };\r\n\r\n      this.testResults.push(result);\r\n\r\n      console.debug(\r\n        `${passed ? 'Γ£à' : 'Γ¥î'} Test ${scenario.name}: ${passed ? 'PASSED' : 'FAILED'} (${duration.toFixed(2)}ms)`\r\n      );\r\n\r\n      if (errors.length > 0) {\r\n        console.debug('  Errors:');\r\n        errors.forEach((error) => console.debug(`    - ${error}`));\r\n      }\r\n\r\n      return result;\r\n    } catch (error) {\r\n      const errorMessage =\r\n        error instanceof Error ? error.message : String(error);\r\n      const result = {\r\n        scenario: scenario.name,\r\n        passed: false,\r\n        duration: Date.now() - startTime,\r\n        metrics: {},\r\n        errors: [`Test execution failed: ${errorMessage}`],\r\n      };\r\n\r\n      this.testResults.push(result);\r\n      console.error(`Γ¥î Test ${scenario.name} FAILED: ${errorMessage}`);\r\n\r\n      return result;\r\n    } finally {\r\n      performanceMonitoringService.stopMonitoring();\r\n    }\r\n  }\r\n\r\n  private async executeStep(action: string): Promise<void> {\r\n    switch (action) {\r\n      case 'navigate_to_dashboard':\r\n        // Simulate navigation\r\n        window.location.hash = '#dashboard';\r\n        await new Promise((resolve) => setTimeout(resolve, 100));\r\n        break;\r\n\r\n      case 'load_students_list':\r\n        // Simulate loading students\r\n        await this.simulateApiCall('/api/students', 200);\r\n        break;\r\n\r\n      case 'search_students':\r\n        // Simulate search\r\n        await this.simulateUserInput();\r\n        break;\r\n\r\n      case 'load_books_catalog':\r\n        // Simulate loading books\r\n        await this.simulateApiCall('/api/books', 300);\r\n        break;\r\n\r\n      case 'filter_books':\r\n        // Simulate filtering\r\n        await this.simulateUserInput();\r\n        break;\r\n\r\n      case 'load_equipment':\r\n        // Simulate loading equipment\r\n        await this.simulateApiCall('/api/equipment', 150);\r\n        break;\r\n\r\n      case 'scan_barcode':\r\n        // Simulate barcode scanning\r\n        await this.simulateUserInput();\r\n        break;\r\n\r\n      case 'generate_report':\r\n        // Simulate report generation\r\n        await this.simulateApiCall('/api/reports', 500);\r\n        break;\r\n\r\n      case 'upload_file':\r\n        // Simulate file upload\r\n        await this.simulateFileUpload();\r\n        break;\r\n\r\n      case 'switch_theme':\r\n        // Simulate theme switching\r\n        document.body.classList.toggle('dark');\r\n        await new Promise((resolve) => setTimeout(resolve, 50));\r\n        break;\r\n\r\n      case 'resize_window':\r\n        // Simulate window resize\r\n        window.dispatchEvent(new Event('resize'));\r\n        await new Promise((resolve) => setTimeout(resolve, 100));\r\n        break;\r\n\r\n      case 'scroll_page':\r\n        // Simulate scrolling\r\n        window.scrollTo({ top: 500, behavior: 'smooth' });\r\n        await new Promise((resolve) => setTimeout(resolve, 200));\r\n        break;\r\n\r\n      case 'open_modal':\r\n        // Simulate modal opening\r\n        await this.simulateUserInteraction();\r\n        break;\r\n\r\n      case 'submit_form':\r\n        // Simulate form submission\r\n        await this.simulateApiCall('/api/submit', 300);\r\n        break;\r\n\r\n      default:\r\n        // Default simulation\r\n        await new Promise((resolve) =>\r\n          setTimeout(resolve, Math.random() * 100 + 50)\r\n        );\r\n    }\r\n  }\r\n\r\n  private async simulateApiCall(\r\n    endpoint: string,\r\n    delay: number\r\n  ): Promise<void> {\r\n    const startTime = performance.now();\r\n\r\n    // Simulate network latency\r\n    await new Promise((resolve) => setTimeout(resolve, delay));\r\n\r\n    const endTime = performance.now();\r\n    console.debug(\r\n      `    ≡ƒîÉ API call to ${endpoint} took ${(endTime - startTime).toFixed(2)}ms`\r\n    );\r\n  }\r\n\r\n  private async simulateUserInput(): Promise<void> {\r\n    // Simulate user interaction latency\r\n    await new Promise((resolve) =>\r\n      setTimeout(resolve, Math.random() * 200 + 100)\r\n    );\r\n  }\r\n\r\n  private async simulateUserInteraction(): Promise<void> {\r\n    // Simulate click or interaction\r\n    await new Promise((resolve) =>\r\n      setTimeout(resolve, Math.random() * 50 + 20)\r\n    );\r\n  }\r\n\r\n  private async simulateFileUpload(): Promise<void> {\r\n    // Simulate file upload progress\r\n    const steps = 10;\r\n    for (let i = 0; i < steps; i++) {\r\n      await new Promise((resolve) => setTimeout(resolve, 100));\r\n      console.debug(\r\n        `    ≡ƒôñ Upload progress: ${(((i + 1) / steps) * 100).toFixed(0)}%`\r\n      );\r\n    }\r\n  }\r\n\r\n  public async runAllTests(): Promise<\r\n    Array<{\r\n      scenario: string;\r\n      passed: boolean;\r\n      duration: number;\r\n      metrics: any;\r\n      errors: string[];\r\n    }>\r\n  > {\r\n    console.debug('≡ƒÜÇ Starting comprehensive performance test suite...');\r\n\r\n    const testScenarios: TestScenario[] = [\r\n      {\r\n        name: 'Dashboard Navigation',\r\n        description: 'Test dashboard navigation and initial load',\r\n        steps: [\r\n          { action: 'navigate_to_dashboard', measure: true },\r\n          { action: 'load_students_list', measure: true, timeout: 2000 },\r\n          { action: 'load_books_catalog', measure: true, timeout: 2000 },\r\n        ],\r\n        expectedResults: {\r\n          maxRenderTime: 1000,\r\n          maxMemoryUsage: 50 * 1024 * 1024,\r\n          maxErrors: 0,\r\n        },\r\n      },\r\n      {\r\n        name: 'Search Performance',\r\n        description: 'Test search functionality performance',\r\n        steps: [\r\n          { action: 'navigate_to_dashboard', measure: false },\r\n          { action: 'search_students', measure: true },\r\n          { action: 'search_students', measure: true },\r\n          { action: 'search_students', measure: true },\r\n        ],\r\n        expectedResults: {\r\n          maxRenderTime: 500,\r\n          maxMemoryUsage: 30 * 1024 * 1024,\r\n          maxErrors: 0,\r\n        },\r\n      },\r\n      {\r\n        name: 'Data Loading',\r\n        description: 'Test large dataset loading performance',\r\n        steps: [\r\n          { action: 'load_students_list', measure: true, timeout: 3000 },\r\n          { action: 'load_books_catalog', measure: true, timeout: 3000 },\r\n          { action: 'load_equipment', measure: true, timeout: 2000 },\r\n        ],\r\n        expectedResults: {\r\n          maxRenderTime: 2000,\r\n          maxMemoryUsage: 80 * 1024 * 1024,\r\n          maxErrors: 1,\r\n        },\r\n      },\r\n      {\r\n        name: 'User Interactions',\r\n        description: 'Test user interaction responsiveness',\r\n        steps: [\r\n          { action: 'switch_theme', measure: true },\r\n          { action: 'resize_window', measure: true },\r\n          { action: 'scroll_page', measure: true },\r\n          { action: 'open_modal', measure: true },\r\n          { action: 'submit_form', measure: true, timeout: 2000 },\r\n        ],\r\n        expectedResults: {\r\n          maxRenderTime: 300,\r\n          maxMemoryUsage: 40 * 1024 * 1024,\r\n          maxErrors: 0,\r\n        },\r\n      },\r\n      {\r\n        name: 'Error Handling',\r\n        description: 'Test error handling performance',\r\n        steps: [\r\n          { action: 'simulate_api_error', measure: true },\r\n          { action: 'simulate_network_error', measure: true },\r\n          { action: 'simulate_timeout', measure: true },\r\n        ],\r\n        expectedResults: {\r\n          maxRenderTime: 500,\r\n          maxMemoryUsage: 20 * 1024 * 1024,\r\n          maxErrors: 3,\r\n        },\r\n      },\r\n    ];\r\n\r\n    const results = [];\r\n\r\n    for (const scenario of testScenarios) {\r\n      try {\r\n        const result = await this.runTest(scenario);\r\n        results.push(result);\r\n      } catch (error) {\r\n        console.error(`Γ¥î Failed to run test: ${scenario.name}`, error);\r\n        const errorMessage =\r\n          error instanceof Error ? error.message : String(error);\r\n        results.push({\r\n          scenario: scenario.name,\r\n          passed: false,\r\n          duration: 0,\r\n          metrics: {},\r\n          errors: [`Test execution failed: ${errorMessage}`],\r\n        });\r\n      }\r\n\r\n      // Small delay between tests\r\n      await new Promise((resolve) => setTimeout(resolve, 500));\r\n    }\r\n\r\n    const passedTests = results.filter((r) => r.passed).length;\r\n    const totalTests = results.length;\r\n    const totalDuration = results.reduce((sum, r) => sum + r.duration, 0);\r\n\r\n    console.debug('≡ƒôè Test Results Summary:');\r\n    console.debug(\r\n      `  Passed: ${passedTests}/${totalTests} (${((passedTests / totalTests) * 100).toFixed(1)}%)`\r\n    );\r\n    console.debug(`  Total Duration: ${totalDuration.toFixed(2)}ms`);\r\n    console.debug(\r\n      `  Average Duration: ${(totalDuration / totalTests).toFixed(2)}ms`\r\n    );\r\n\r\n    return results;\r\n  }\r\n\r\n  public getTestResults() {\r\n    return [...this.testResults];\r\n  }\r\n\r\n  public clearResults() {\r\n    this.testResults = [];\r\n  }\r\n\r\n  public generateReport(): string {\r\n    const results = this.getTestResults();\r\n    const passedTests = results.filter((r) => r.passed).length;\r\n    const totalTests = results.length;\r\n\r\n    const report = {\r\n      timestamp: Date.now(),\r\n      summary: {\r\n        totalTests,\r\n        passedTests,\r\n        failedTests: totalTests - passedTests,\r\n        passRate: (passedTests / totalTests) * 100,\r\n        totalDuration: results.reduce((sum, r) => sum + r.duration, 0),\r\n      },\r\n      results,\r\n      recommendations: this.generateRecommendations(results),\r\n    };\r\n\r\n    return JSON.stringify(report, null, 2);\r\n  }\r\n\r\n  private generateRecommendations(\r\n    results: Array<{ passed: boolean; errors: string[] }>\r\n  ): string[] {\r\n    const recommendations: string[] = [];\r\n    const commonErrors = new Map<string, number>();\r\n\r\n    // Count common errors\r\n    results.forEach((result) => {\r\n      result.errors.forEach((error) => {\r\n        const count = commonErrors.get(error) || 0;\r\n        commonErrors.set(error, count + 1);\r\n      });\r\n    });\r\n\r\n    // Generate recommendations based on common errors\r\n    commonErrors.forEach((count, error) => {\r\n      if (count > results.length * 0.5) {\r\n        if (error.includes('Render time')) {\r\n          recommendations.push(\r\n            'Consider optimizing component rendering with React.memo and useMemo'\r\n          );\r\n        }\r\n        if (error.includes('Memory usage')) {\r\n          recommendations.push(\r\n            'Implement proper cleanup and memory management'\r\n          );\r\n        }\r\n        if (error.includes('timeout')) {\r\n          recommendations.push(\r\n            'Improve API response times and implement better loading states'\r\n          );\r\n        }\r\n        if (error.includes('Error count')) {\r\n          recommendations.push(\r\n            'Add proper error boundaries and improve error handling'\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    if (recommendations.length === 0) {\r\n      recommendations.push(\r\n        'All tests passed! Continue monitoring for performance regressions.'\r\n      );\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const performanceTest = PerformanceTest.getInstance();\r\nexport default performanceTest;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\backupApi.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\bookService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\context7.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2715,2718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2715,2718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":137,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3701,3704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3701,3704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4553,4556],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4553,4556],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4826,4829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4826,4829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5138,5141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5138,5141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useWebSocketContext } from '@/contexts/WebSocketContext';\r\nimport { utilitiesApi } from '@/lib/api';\r\nimport { toast } from 'sonner';\r\n\r\nexport interface DocumentationUpdate {\r\n  id: string;\r\n  type:\r\n    | 'content_change'\r\n    | 'structure_change'\r\n    | 'metadata_update'\r\n    | 'version_update';\r\n  timestamp: string;\r\n  source: string;\r\n  changes: {\r\n    file: string;\r\n    section?: string;\r\n    oldContent?: string;\r\n    newContent?: string;\r\n    changeType: 'added' | 'modified' | 'deleted' | 'moved';\r\n  }[];\r\n  version: {\r\n    major: number;\r\n    minor: number;\r\n    patch: number;\r\n    hash: string;\r\n  };\r\n  author: {\r\n    id: string;\r\n    name: string;\r\n    role: string;\r\n  };\r\n  metadata: {\r\n    affectedFiles: string[];\r\n    impactLevel: 'low' | 'medium' | 'high' | 'critical';\r\n    requiresReview: boolean;\r\n    autoApproved: boolean;\r\n  };\r\n}\r\n\r\nexport interface DocumentationState {\r\n  version: string;\r\n  lastUpdated: string;\r\n  isRealTimeEnabled: boolean;\r\n  pendingUpdates: DocumentationUpdate[];\r\n  appliedUpdates: DocumentationUpdate[];\r\n  syncStatus: 'synced' | 'syncing' | 'error' | 'offline';\r\n  conflictResolution: 'auto' | 'manual' | 'disabled';\r\n}\r\n\r\nexport interface Context7Config {\r\n  autoSync: boolean;\r\n  syncInterval: number;\r\n  maxPendingUpdates: number;\r\n  enableVersionControl: boolean;\r\n  enableChangeTracking: boolean;\r\n  enableRealTimeNotifications: boolean;\r\n  conflictResolution: 'auto' | 'manual' | 'disabled';\r\n  retryAttempts: number;\r\n  retryDelay: number;\r\n}\r\n\r\nclass Context7Service {\r\n  private static instance: Context7Service;\r\n  private config: Context7Config;\r\n  private state: DocumentationState;\r\n  private subscribers: Map<string, (update: DocumentationUpdate) => void>;\r\n  private syncTimer: NodeJS.Timeout | null = null;\r\n  private isInitialized = false;\r\n\r\n  private constructor() {\r\n    this.config = {\r\n      autoSync: true,\r\n      syncInterval: 30000, // 30 seconds\r\n      maxPendingUpdates: 100,\r\n      enableVersionControl: true,\r\n      enableChangeTracking: true,\r\n      enableRealTimeNotifications: true,\r\n      conflictResolution: 'auto',\r\n      retryAttempts: 3,\r\n      retryDelay: 1000,\r\n    };\r\n\r\n    this.state = {\r\n      version: '0.0.0',\r\n      lastUpdated: new Date().toISOString(),\r\n      isRealTimeEnabled: false,\r\n      pendingUpdates: [],\r\n      appliedUpdates: [],\r\n      syncStatus: 'offline',\r\n      conflictResolution: 'auto',\r\n    };\r\n\r\n    this.subscribers = new Map();\r\n  }\r\n\r\n  public static getInstance(): Context7Service {\r\n    if (!Context7Service.instance) {\r\n      Context7Service.instance = new Context7Service();\r\n    }\r\n    return Context7Service.instance;\r\n  }\r\n\r\n  public async initialize(webSocketContext?: any): Promise<void> {\r\n    if (this.isInitialized) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Load initial documentation state\r\n      await this.loadDocumentationState();\r\n\r\n      // Set up WebSocket subscriptions for real-time updates\r\n      if (webSocketContext) {\r\n        this.setupWebSocketSubscriptions(webSocketContext);\r\n      }\r\n\r\n      // Start auto-sync if enabled\r\n      if (this.config.autoSync) {\r\n        this.startAutoSync();\r\n      }\r\n\r\n      this.isInitialized = true;\r\n      this.state.isRealTimeEnabled = true;\r\n      this.state.syncStatus = 'synced';\r\n\r\n      console.debug('Context7 service initialized successfully');\r\n    } catch (error) {\r\n      console.error('Failed to initialize Context7 service:', error);\r\n      this.state.syncStatus = 'error';\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async loadDocumentationState(): Promise<void> {\r\n    try {\r\n      const response = await utilitiesApi.getDocumentation();\r\n      const docInfo = response.data as any;\r\n\r\n      if (docInfo && typeof docInfo === 'object') {\r\n        this.state.version = docInfo.version || '';\r\n        this.state.lastUpdated = docInfo.lastUpdated || '';\r\n      }\r\n\r\n      // Load any pending updates from local storage\r\n      const storedUpdates = localStorage.getItem('context7_pending_updates');\r\n      if (storedUpdates) {\r\n        this.state.pendingUpdates = JSON.parse(storedUpdates);\r\n      }\r\n\r\n      // Load applied updates history\r\n      const appliedUpdates = localStorage.getItem('context7_applied_updates');\r\n      if (appliedUpdates) {\r\n        this.state.appliedUpdates = JSON.parse(appliedUpdates).slice(-50); // Keep last 50\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load documentation state:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private setupWebSocketSubscriptions(webSocketContext: any): void {\r\n    // Subscribe to documentation updates\r\n    webSocketContext.subscribe('documentation_updates');\r\n\r\n    // Handle incoming documentation update messages\r\n    const originalOnMessage = webSocketContext.onMessage;\r\n    webSocketContext.onMessage = (message: any) => {\r\n      if (message.type === 'documentation_update') {\r\n        this.handleDocumentationUpdate(message.data);\r\n      }\r\n\r\n      // Call original message handler\r\n      if (originalOnMessage) {\r\n        originalOnMessage(message);\r\n      }\r\n    };\r\n  }\r\n\r\n  private handleDocumentationUpdate(updateData: any): void {\r\n    const update: DocumentationUpdate = {\r\n      id: updateData.id || this.generateUpdateId(),\r\n      type: updateData.type || 'content_change',\r\n      timestamp: updateData.timestamp || new Date().toISOString(),\r\n      source: updateData.source || 'external',\r\n      changes: updateData.changes || [],\r\n      version: updateData.version || this.incrementVersion(),\r\n      author: updateData.author || {\r\n        id: 'system',\r\n        name: 'System',\r\n        role: 'system',\r\n      },\r\n      metadata: {\r\n        affectedFiles: updateData.affectedFiles || [],\r\n        impactLevel: updateData.impactLevel || 'medium',\r\n        requiresReview: updateData.requiresReview || false,\r\n        autoApproved: updateData.autoApproved || true,\r\n      },\r\n    };\r\n\r\n    // Add to pending updates\r\n    this.state.pendingUpdates.push(update);\r\n\r\n    // Limit pending updates\r\n    if (this.state.pendingUpdates.length > this.config.maxPendingUpdates) {\r\n      this.state.pendingUpdates = this.state.pendingUpdates.slice(\r\n        -this.config.maxPendingUpdates\r\n      );\r\n    }\r\n\r\n    // Save to local storage\r\n    this.savePendingUpdates();\r\n\r\n    // Notify subscribers\r\n    this.notifySubscribers(update);\r\n\r\n    // Show real-time notification if enabled\r\n    if (this.config.enableRealTimeNotifications) {\r\n      this.showUpdateNotification(update);\r\n    }\r\n\r\n    // Auto-apply if configured\r\n    if (\r\n      update.metadata.autoApproved &&\r\n      this.config.conflictResolution === 'auto'\r\n    ) {\r\n      this.applyUpdate(update);\r\n    }\r\n  }\r\n\r\n  private generateUpdateId(): string {\r\n    return `update_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private incrementVersion(): {\r\n    major: number;\r\n    minor: number;\r\n    patch: number;\r\n    hash: string;\r\n  } {\r\n    const versionParts = this.state.version.split('.');\r\n    const major = parseInt(versionParts[0] || '0', 10) || 0;\r\n    const minor = parseInt(versionParts[1] || '0', 10) || 0;\r\n    const patch = parseInt(versionParts[2] || '0', 10) || 0;\r\n\r\n    return {\r\n      major,\r\n      minor,\r\n      patch: patch + 1,\r\n      hash: this.generateVersionHash(),\r\n    };\r\n  }\r\n\r\n  private generateVersionHash(): string {\r\n    return Math.random().toString(36).substr(2, 8);\r\n  }\r\n\r\n  private savePendingUpdates(): void {\r\n    localStorage.setItem(\r\n      'context7_pending_updates',\r\n      JSON.stringify(this.state.pendingUpdates)\r\n    );\r\n  }\r\n\r\n  private saveAppliedUpdates(): void {\r\n    localStorage.setItem(\r\n      'context7_applied_updates',\r\n      JSON.stringify(this.state.appliedUpdates)\r\n    );\r\n  }\r\n\r\n  private notifySubscribers(update: DocumentationUpdate): void {\r\n    this.subscribers.forEach((callback) => {\r\n      try {\r\n        callback(update);\r\n      } catch (error) {\r\n        console.error('Error notifying subscriber:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  private showUpdateNotification(update: DocumentationUpdate): void {\r\n    const message = `Documentation updated: ${update.changes.length} change(s) in ${update.changes[0]?.file || 'multiple files'}`;\r\n\r\n    switch (update.metadata.impactLevel) {\r\n      case 'critical':\r\n        toast.error('Critical Documentation Update', { description: message });\r\n        break;\r\n      case 'high':\r\n        toast.warning('Important Documentation Update', {\r\n          description: message,\r\n        });\r\n        break;\r\n      case 'medium':\r\n        toast.info('Documentation Update', { description: message });\r\n        break;\r\n      case 'low':\r\n        toast('Documentation Update', { description: message });\r\n        break;\r\n    }\r\n  }\r\n\r\n  public async applyUpdate(update: DocumentationUpdate): Promise<void> {\r\n    try {\r\n      this.state.syncStatus = 'syncing';\r\n\r\n      // Apply the update through the API\r\n      await this.applyUpdateToServer(update);\r\n\r\n      // Move from pending to applied\r\n      this.state.pendingUpdates = this.state.pendingUpdates.filter(\r\n        (u) => u.id !== update.id\r\n      );\r\n      this.state.appliedUpdates.push(update);\r\n\r\n      // Update version and timestamp\r\n      this.state.version = `${update.version.major}.${update.version.minor}.${update.version.patch}`;\r\n      this.state.lastUpdated = update.timestamp;\r\n\r\n      // Save state\r\n      this.savePendingUpdates();\r\n      this.saveAppliedUpdates();\r\n\r\n      this.state.syncStatus = 'synced';\r\n\r\n      console.debug(`Applied documentation update: ${update.id}`);\r\n    } catch (error) {\r\n      console.error('Failed to apply documentation update:', error);\r\n      this.state.syncStatus = 'error';\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async applyUpdateToServer(\r\n    _update: DocumentationUpdate\r\n  ): Promise<void> {\r\n    // This would typically make an API call to apply the update\r\n    // For now, we'll simulate the API call\r\n    await new Promise((resolve) => setTimeout(resolve, 100));\r\n\r\n    // In a real implementation, this would:\r\n    // 1. Send the update to the server\r\n    // 2. Validate the changes\r\n    // 3. Apply the changes to the documentation files\r\n    // 4. Update version control\r\n    // 5. Notify other clients\r\n  }\r\n\r\n  public async syncDocumentation(): Promise<void> {\r\n    try {\r\n      this.state.syncStatus = 'syncing';\r\n\r\n      // Refresh documentation from server\r\n      await utilitiesApi.refreshDocumentation();\r\n\r\n      // Apply any pending updates\r\n      for (const update of this.state.pendingUpdates) {\r\n        if (update.metadata.autoApproved) {\r\n          await this.applyUpdate(update);\r\n        }\r\n      }\r\n\r\n      this.state.syncStatus = 'synced';\r\n      console.debug('Documentation synchronized successfully');\r\n    } catch (error) {\r\n      console.error('Failed to sync documentation:', error);\r\n      this.state.syncStatus = 'error';\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  public subscribe(\r\n    id: string,\r\n    callback: (update: DocumentationUpdate) => void\r\n  ): void {\r\n    this.subscribers.set(id, callback);\r\n  }\r\n\r\n  public unsubscribe(id: string): void {\r\n    this.subscribers.delete(id);\r\n  }\r\n\r\n  public getState(): DocumentationState {\r\n    return { ...this.state };\r\n  }\r\n\r\n  public getConfig(): Context7Config {\r\n    return { ...this.config };\r\n  }\r\n\r\n  public updateConfig(newConfig: Partial<Context7Config>): void {\r\n    this.config = { ...this.config, ...newConfig };\r\n\r\n    // Restart auto-sync if interval changed\r\n    if (newConfig.syncInterval && this.config.autoSync) {\r\n      this.stopAutoSync();\r\n      this.startAutoSync();\r\n    }\r\n  }\r\n\r\n  public getPendingUpdates(): DocumentationUpdate[] {\r\n    return [...this.state.pendingUpdates];\r\n  }\r\n\r\n  public getAppliedUpdates(): DocumentationUpdate[] {\r\n    return [...this.state.appliedUpdates];\r\n  }\r\n\r\n  public async approveUpdate(updateId: string): Promise<void> {\r\n    const update = this.state.pendingUpdates.find((u) => u.id === updateId);\r\n    if (update) {\r\n      await this.applyUpdate(update);\r\n    }\r\n  }\r\n\r\n  public rejectUpdate(updateId: string): void {\r\n    this.state.pendingUpdates = this.state.pendingUpdates.filter(\r\n      (u) => u.id !== updateId\r\n    );\r\n    this.savePendingUpdates();\r\n  }\r\n\r\n  private startAutoSync(): void {\r\n    if (this.syncTimer) {\r\n      clearInterval(this.syncTimer);\r\n    }\r\n\r\n    this.syncTimer = setInterval(() => {\r\n      this.syncDocumentation().catch(console.error);\r\n    }, this.config.syncInterval);\r\n  }\r\n\r\n  private stopAutoSync(): void {\r\n    if (this.syncTimer) {\r\n      clearInterval(this.syncTimer);\r\n      this.syncTimer = null;\r\n    }\r\n  }\r\n\r\n  public destroy(): void {\r\n    this.stopAutoSync();\r\n    this.subscribers.clear();\r\n    this.isInitialized = false;\r\n    this.state.isRealTimeEnabled = false;\r\n    this.state.syncStatus = 'offline';\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const context7 = Context7Service.getInstance();\r\n\r\n// Export hook for React components\r\nexport const useContext7 = () => {\r\n  const webSocketContext = useWebSocketContext();\r\n\r\n  return {\r\n    ...context7,\r\n    initialize: () => context7.initialize(webSocketContext),\r\n  };\r\n};\r\n\r\nexport default context7;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\documentationVerification.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":13,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[391,394],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[391,394],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":625,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":625,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18082,18085],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18082,18085],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Documentation Verification Service\r\n * Ensures all documentation remains current and accurate through automated checks\r\n */\r\n\r\nexport interface VerificationRule {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  type: 'content' | 'structure' | 'links' | 'metadata' | 'consistency';\r\n  severity: 'error' | 'warning' | 'info';\r\n  enabled: boolean;\r\n  config?: Record<string, any>;\r\n}\r\n\r\nexport interface VerificationResult {\r\n  ruleId: string;\r\n  status: 'pass' | 'fail' | 'warning';\r\n  message: string;\r\n  details?: string;\r\n  location?: {\r\n    file: string;\r\n    line?: number;\r\n    column?: number;\r\n  };\r\n  suggestions?: string[];\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface VerificationReport {\r\n  id: string;\r\n  timestamp: Date;\r\n  status: 'pass' | 'fail' | 'warning';\r\n  totalRules: number;\r\n  passedRules: number;\r\n  failedRules: number;\r\n  warningRules: number;\r\n  results: VerificationResult[];\r\n  executionTime: number;\r\n  metadata: {\r\n    version: string;\r\n    environment: string;\r\n    triggeredBy: 'manual' | 'scheduled' | 'realtime' | 'webhook';\r\n  };\r\n}\r\n\r\nexport interface VerificationConfig {\r\n  enableAutoVerification: boolean;\r\n  verificationInterval: number; // in milliseconds\r\n  enableRealTimeVerification: boolean;\r\n  enableScheduledVerification: boolean;\r\n  scheduledVerificationCron: string;\r\n  enableWebhookVerification: boolean;\r\n  rules: VerificationRule[];\r\n  notifications: {\r\n    enableEmail: boolean;\r\n    enableSlack: boolean;\r\n    enableWebhook: boolean;\r\n    recipients: string[];\r\n  };\r\n}\r\n\r\nexport class DocumentationVerificationService {\r\n  private config: VerificationConfig;\r\n  private verificationHistory: VerificationReport[] = [];\r\n  private activeVerifications: Map<string, Promise<VerificationReport>> =\r\n    new Map();\r\n  private scheduledVerificationTimer?: NodeJS.Timeout | undefined;\r\n\r\n  constructor(config?: Partial<VerificationConfig>) {\r\n    this.config = {\r\n      enableAutoVerification: true,\r\n      verificationInterval: 300000, // 5 minutes\r\n      enableRealTimeVerification: true,\r\n      enableScheduledVerification: true,\r\n      scheduledVerificationCron: '0 */6 * * *', // Every 6 hours\r\n      enableWebhookVerification: true,\r\n      rules: this.getDefaultRules(),\r\n      notifications: {\r\n        enableEmail: false,\r\n        enableSlack: false,\r\n        enableWebhook: true,\r\n        recipients: [],\r\n      },\r\n      ...config,\r\n    };\r\n\r\n    this.initialize();\r\n  }\r\n\r\n  private getDefaultRules(): VerificationRule[] {\r\n    return [\r\n      {\r\n        id: 'content-freshness',\r\n        name: 'Content Freshness Check',\r\n        description: 'Ensures documentation content is not outdated',\r\n        type: 'metadata',\r\n        severity: 'warning',\r\n        enabled: true,\r\n        config: { maxAgeHours: 168 }, // 1 week\r\n      },\r\n      {\r\n        id: 'broken-links',\r\n        name: 'Broken Links Detection',\r\n        description: 'Checks for broken internal and external links',\r\n        type: 'links',\r\n        severity: 'error',\r\n        enabled: true,\r\n      },\r\n      {\r\n        id: 'structure-consistency',\r\n        name: 'Structure Consistency',\r\n        description: 'Validates documentation structure and format',\r\n        type: 'structure',\r\n        severity: 'error',\r\n        enabled: true,\r\n      },\r\n      {\r\n        id: 'api-documentation-sync',\r\n        name: 'API Documentation Sync',\r\n        description: 'Ensures API docs match actual API endpoints',\r\n        type: 'consistency',\r\n        severity: 'error',\r\n        enabled: true,\r\n      },\r\n      {\r\n        id: 'code-examples-validity',\r\n        name: 'Code Examples Validity',\r\n        description: 'Validates code examples in documentation',\r\n        type: 'content',\r\n        severity: 'warning',\r\n        enabled: true,\r\n      },\r\n      {\r\n        id: 'version-consistency',\r\n        name: 'Version Consistency',\r\n        description: 'Checks version information across all documentation',\r\n        type: 'metadata',\r\n        severity: 'error',\r\n        enabled: true,\r\n      },\r\n      {\r\n        id: 'completeness-check',\r\n        name: 'Documentation Completeness',\r\n        description: 'Ensures all required sections are present',\r\n        type: 'structure',\r\n        severity: 'warning',\r\n        enabled: true,\r\n      },\r\n    ];\r\n  }\r\n\r\n  private async initialize(): Promise<void> {\r\n    if (this.config.enableScheduledVerification) {\r\n      this.startScheduledVerification();\r\n    }\r\n  }\r\n\r\n  public async runVerification(\r\n    triggeredBy: 'manual' | 'scheduled' | 'realtime' | 'webhook' = 'manual'\r\n  ): Promise<VerificationReport> {\r\n    const verificationId = `verification-${Date.now()}`;\r\n    const startTime = Date.now();\r\n\r\n    // Check if verification is already running\r\n    const activeVerification = this.activeVerifications.get('current');\r\n    if (activeVerification) {\r\n      return await activeVerification;\r\n    }\r\n\r\n    const verificationPromise = this.executeVerification(\r\n      verificationId,\r\n      triggeredBy,\r\n      startTime\r\n    );\r\n    this.activeVerifications.set('current', verificationPromise);\r\n\r\n    try {\r\n      const result = await verificationPromise;\r\n      this.verificationHistory.push(result);\r\n\r\n      // Keep only last 50 reports\r\n      if (this.verificationHistory.length > 50) {\r\n        this.verificationHistory = this.verificationHistory.slice(-50);\r\n      }\r\n\r\n      await this.handleVerificationResult(result);\r\n      return result;\r\n    } finally {\r\n      this.activeVerifications.delete('current');\r\n    }\r\n  }\r\n\r\n  private async executeVerification(\r\n    verificationId: string,\r\n    triggeredBy: 'manual' | 'scheduled' | 'realtime' | 'webhook',\r\n    startTime: number\r\n  ): Promise<VerificationReport> {\r\n    const results: VerificationResult[] = [];\r\n    const enabledRules = this.config.rules.filter((rule) => rule.enabled);\r\n\r\n    for (const rule of enabledRules) {\r\n      try {\r\n        const ruleResult = await this.executeRule(rule);\r\n        results.push(ruleResult);\r\n      } catch (error) {\r\n        results.push({\r\n          ruleId: rule.id,\r\n          status: 'fail',\r\n          message: `Rule execution failed: ${\r\n            error instanceof Error ? error.message : 'Unknown error'\r\n          }`,\r\n          timestamp: new Date(),\r\n        });\r\n      }\r\n    }\r\n\r\n    const executionTime = Date.now() - startTime;\r\n    const passedRules = results.filter((r) => r.status === 'pass').length;\r\n    const failedRules = results.filter((r) => r.status === 'fail').length;\r\n    const warningRules = results.filter((r) => r.status === 'warning').length;\r\n\r\n    const overallStatus =\r\n      failedRules > 0 ? 'fail' : warningRules > 0 ? 'warning' : 'pass';\r\n\r\n    return {\r\n      id: verificationId,\r\n      timestamp: new Date(),\r\n      status: overallStatus,\r\n      totalRules: enabledRules.length,\r\n      passedRules,\r\n      failedRules,\r\n      warningRules,\r\n      results,\r\n      executionTime,\r\n      metadata: {\r\n        version: '1.0.0',\r\n        environment: process.env.NODE_ENV || 'development',\r\n        triggeredBy,\r\n      },\r\n    };\r\n  }\r\n\r\n  private async executeRule(\r\n    rule: VerificationRule\r\n  ): Promise<VerificationResult> {\r\n    const timestamp = new Date();\r\n\r\n    switch (rule.id) {\r\n      case 'content-freshness':\r\n        return await this.checkContentFreshness(rule, timestamp);\r\n\r\n      case 'broken-links':\r\n        return await this.checkBrokenLinks(rule, timestamp);\r\n\r\n      case 'structure-consistency':\r\n        return await this.checkStructureConsistency(rule, timestamp);\r\n\r\n      case 'api-documentation-sync':\r\n        return await this.checkApiDocumentationSync(rule, timestamp);\r\n\r\n      case 'code-examples-validity':\r\n        return await this.checkCodeExamplesValidity(rule, timestamp);\r\n\r\n      case 'version-consistency':\r\n        return await this.checkVersionConsistency(rule, timestamp);\r\n\r\n      case 'completeness-check':\r\n        return await this.checkDocumentationCompleteness(rule, timestamp);\r\n\r\n      default:\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'warning',\r\n          message: `Unknown rule: ${rule.id}`,\r\n          timestamp,\r\n        };\r\n    }\r\n  }\r\n\r\n  private async checkContentFreshness(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      const maxAgeHours = rule.config?.maxAgeHours || 168;\r\n      // Note: cutoffTime would be used for actual file modification time checks\r\n      // const cutoffTime = new Date(Date.now() - maxAge);\r\n\r\n      // This would typically check file modification times\r\n      // For now, we'll simulate the check\r\n      const outdatedFiles: string[] = [];\r\n\r\n      if (outdatedFiles.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'warning',\r\n          message: `${outdatedFiles.length} documentation files are older than ${maxAgeHours} hours`,\r\n          details: `Outdated files: ${outdatedFiles.join(', ')}`,\r\n          suggestions: [\r\n            'Update outdated documentation files',\r\n            'Review content for accuracy',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'All documentation files are within acceptable age limits',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Content freshness check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkBrokenLinks(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would typically scan documentation files for links and test them\r\n      // For now, we'll simulate the check\r\n      const brokenLinks: Array<{ file: string; link: string; line?: number }> =\r\n        [];\r\n\r\n      if (brokenLinks.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'fail',\r\n          message: `Found ${brokenLinks.length} broken links`,\r\n          details: brokenLinks\r\n            .map((link) => `${link.file}:${link.line || '?'} - ${link.link}`)\r\n            .join('\\n'),\r\n          suggestions: ['Fix or remove broken links', 'Update outdated URLs'],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'No broken links detected',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Broken links check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkStructureConsistency(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would check for consistent documentation structure\r\n      const structureIssues: string[] = [];\r\n\r\n      if (structureIssues.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'fail',\r\n          message: `Found ${structureIssues.length} structure inconsistencies`,\r\n          details: structureIssues.join('\\n'),\r\n          suggestions: [\r\n            'Standardize documentation structure',\r\n            'Follow documentation templates',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'Documentation structure is consistent',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Structure consistency check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkApiDocumentationSync(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would compare API documentation with actual API endpoints\r\n      const syncIssues: string[] = [];\r\n\r\n      if (syncIssues.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'fail',\r\n          message: `Found ${syncIssues.length} API documentation sync issues`,\r\n          details: syncIssues.join('\\n'),\r\n          suggestions: [\r\n            'Update API documentation',\r\n            'Regenerate API docs from code',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'API documentation is in sync with implementation',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `API documentation sync check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkCodeExamplesValidity(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would validate code examples in documentation\r\n      const invalidExamples: Array<{\r\n        file: string;\r\n        example: string;\r\n        error: string;\r\n      }> = [];\r\n\r\n      if (invalidExamples.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'warning',\r\n          message: `Found ${invalidExamples.length} invalid code examples`,\r\n          details: invalidExamples\r\n            .map((ex) => `${ex.file}: ${ex.error}`)\r\n            .join('\\n'),\r\n          suggestions: [\r\n            'Fix syntax errors in code examples',\r\n            'Test code examples before publishing',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'All code examples are valid',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Code examples validity check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkVersionConsistency(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would check version consistency across documentation\r\n      const versionIssues: string[] = [];\r\n\r\n      if (versionIssues.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'fail',\r\n          message: `Found ${versionIssues.length} version consistency issues`,\r\n          details: versionIssues.join('\\n'),\r\n          suggestions: [\r\n            'Update version information',\r\n            'Ensure consistent versioning',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'Version information is consistent',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Version consistency check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async checkDocumentationCompleteness(\r\n    rule: VerificationRule,\r\n    timestamp: Date\r\n  ): Promise<VerificationResult> {\r\n    try {\r\n      // This would check for required documentation sections\r\n      const missingSection: string[] = [];\r\n\r\n      if (missingSection.length > 0) {\r\n        return {\r\n          ruleId: rule.id,\r\n          status: 'warning',\r\n          message: `Missing ${missingSection.length} required documentation sections`,\r\n          details: `Missing sections: ${missingSection.join(', ')}`,\r\n          suggestions: [\r\n            'Add missing documentation sections',\r\n            'Follow documentation checklist',\r\n          ],\r\n          timestamp,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'pass',\r\n        message: 'Documentation is complete',\r\n        timestamp,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        ruleId: rule.id,\r\n        status: 'fail',\r\n        message: `Documentation completeness check failed: ${\r\n          error instanceof Error ? error.message : 'Unknown error'\r\n        }`,\r\n        timestamp,\r\n      };\r\n    }\r\n  }\r\n\r\n  private async handleVerificationResult(\r\n    report: VerificationReport\r\n  ): Promise<void> {\r\n    // Send notifications if configured\r\n    if (this.config.notifications.enableWebhook) {\r\n      await this.sendWebhookNotification(report);\r\n    }\r\n\r\n    // Log results\r\n    console.debug(`Documentation verification completed: ${report.status}`);\r\n    console.debug(\r\n      `Passed: ${report.passedRules}, Failed: ${report.failedRules}, Warnings: ${report.warningRules}`\r\n    );\r\n\r\n    if (report.status === 'fail') {\r\n      const failedResults = report.results.filter((r) => r.status === 'fail');\r\n      console.error(\r\n        'Failed verification rules:',\r\n        failedResults.map((r) => r.message)\r\n      );\r\n    }\r\n  }\r\n\r\n  private async sendWebhookNotification(\r\n    report: VerificationReport\r\n  ): Promise<void> {\r\n    try {\r\n      // This would send webhook notifications\r\n      // Implementation depends on webhook configuration\r\n      console.debug(\r\n        'Webhook notification sent for verification report:',\r\n        report.id\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to send webhook notification:', error);\r\n    }\r\n  }\r\n\r\n  private startScheduledVerification(): void {\r\n    if (this.scheduledVerificationTimer) {\r\n      clearInterval(this.scheduledVerificationTimer);\r\n    }\r\n\r\n    this.scheduledVerificationTimer = setInterval(async () => {\r\n      try {\r\n        await this.runVerification('scheduled');\r\n      } catch (error) {\r\n        console.error('Scheduled verification failed:', error);\r\n      }\r\n    }, this.config.verificationInterval);\r\n  }\r\n\r\n  public async onDocumentationUpdate(_updateInfo: any): Promise<void> {\r\n    // Update info parameter intentionally unused for now\r\n    void _updateInfo;\r\n    if (this.config.enableRealTimeVerification) {\r\n      try {\r\n        await this.runVerification('realtime');\r\n      } catch (error) {\r\n        console.error('Real-time verification failed:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  public getVerificationHistory(): VerificationReport[] {\r\n    return [...this.verificationHistory];\r\n  }\r\n\r\n  public getLatestReport(): VerificationReport | null {\r\n    return this.verificationHistory.length > 0\r\n      ? (this.verificationHistory[this.verificationHistory.length - 1] ?? null)\r\n      : null;\r\n  }\r\n\r\n  public updateConfig(newConfig: Partial<VerificationConfig>): void {\r\n    this.config = { ...this.config, ...newConfig };\r\n\r\n    if (newConfig.enableScheduledVerification !== undefined) {\r\n      if (newConfig.enableScheduledVerification) {\r\n        this.startScheduledVerification();\r\n      } else if (this.scheduledVerificationTimer) {\r\n        clearInterval(this.scheduledVerificationTimer);\r\n        this.scheduledVerificationTimer = undefined;\r\n      }\r\n    }\r\n  }\r\n\r\n  public async addCustomRule(rule: VerificationRule): Promise<void> {\r\n    this.config.rules.push(rule);\r\n  }\r\n\r\n  public async removeRule(ruleId: string): Promise<void> {\r\n    this.config.rules = this.config.rules.filter((rule) => rule.id !== ruleId);\r\n  }\r\n\r\n  public async enableRule(ruleId: string): Promise<void> {\r\n    const rule = this.config.rules.find((r) => r.id === ruleId);\r\n    if (rule) {\r\n      rule.enabled = true;\r\n    }\r\n  }\r\n\r\n  public async disableRule(ruleId: string): Promise<void> {\r\n    const rule = this.config.rules.find((r) => r.id === ruleId);\r\n    if (rule) {\r\n      rule.enabled = false;\r\n    }\r\n  }\r\n\r\n  public destroy(): void {\r\n    if (this.scheduledVerificationTimer) {\r\n      clearInterval(this.scheduledVerificationTimer);\r\n    }\r\n    this.activeVerifications.clear();\r\n    this.verificationHistory = [];\r\n  }\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\documentationVersionControl.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":239,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":239,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6026,6029],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6026,6029],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7719,7722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7719,7722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":310,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":310,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8243,8246],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8243,8246],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":322,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":322,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8551,8554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8551,8554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { utilitiesApi } from '@/lib/api';\r\nimport type { DocumentationUpdate } from './context7';\r\n\r\nexport interface VersionInfo {\r\n  major: number;\r\n  minor: number;\r\n  patch: number;\r\n  hash: string;\r\n  timestamp: string;\r\n  author: {\r\n    id: string;\r\n    name: string;\r\n    role: string;\r\n  };\r\n  description?: string;\r\n  tags: string[];\r\n}\r\n\r\nexport interface ChangeRecord {\r\n  id: string;\r\n  versionFrom: string;\r\n  versionTo: string;\r\n  timestamp: string;\r\n  author: {\r\n    id: string;\r\n    name: string;\r\n    role: string;\r\n  };\r\n  changes: Array<{\r\n    file: string;\r\n    section?: string;\r\n    changeType: 'added' | 'modified' | 'deleted' | 'moved' | 'renamed';\r\n    oldContent?: string;\r\n    newContent?: string;\r\n    lineNumbers?: {\r\n      old: { start: number; end: number };\r\n      new: { start: number; end: number };\r\n    };\r\n    metadata: {\r\n      size: {\r\n        old: number;\r\n        new: number;\r\n      };\r\n      complexity?: 'low' | 'medium' | 'high';\r\n      impact: 'low' | 'medium' | 'high' | 'critical';\r\n    };\r\n  }>;\r\n  statistics: {\r\n    filesChanged: number;\r\n    linesAdded: number;\r\n    linesRemoved: number;\r\n    linesModified: number;\r\n    totalChanges: number;\r\n  };\r\n  reviewStatus: 'pending' | 'approved' | 'rejected' | 'auto_approved';\r\n  reviewers?: Array<{\r\n    id: string;\r\n    name: string;\r\n    status: 'pending' | 'approved' | 'rejected';\r\n    timestamp?: string;\r\n    notes?: string;\r\n  }>;\r\n}\r\n\r\nexport interface ConflictInfo {\r\n  id: string;\r\n  file: string;\r\n  section?: string;\r\n  conflictType: 'content' | 'structure' | 'metadata' | 'version';\r\n  currentContent: string;\r\n  incomingContent: string;\r\n  baseContent?: string;\r\n  timestamp: string;\r\n  authors: Array<{\r\n    id: string;\r\n    name: string;\r\n    version: string;\r\n  }>;\r\n  resolutionStrategy?:\r\n    | 'accept_current'\r\n    | 'accept_incoming'\r\n    | 'merge_manual'\r\n    | 'merge_auto';\r\n  resolvedContent?: string;\r\n  resolvedBy?: {\r\n    id: string;\r\n    name: string;\r\n    timestamp: string;\r\n  };\r\n}\r\n\r\nexport interface BranchInfo {\r\n  id: string;\r\n  name: string;\r\n  description?: string;\r\n  baseVersion: string;\r\n  currentVersion: string;\r\n  author: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  createdAt: string;\r\n  lastModified: string;\r\n  status: 'active' | 'merged' | 'abandoned';\r\n  changes: ChangeRecord[];\r\n  conflicts: ConflictInfo[];\r\n}\r\n\r\nexport interface MergeRequest {\r\n  id: string;\r\n  sourceBranch: string;\r\n  targetBranch: string;\r\n  title: string;\r\n  description?: string;\r\n  author: {\r\n    id: string;\r\n    name: string;\r\n  };\r\n  createdAt: string;\r\n  status: 'open' | 'merged' | 'closed' | 'draft';\r\n  reviewers: Array<{\r\n    id: string;\r\n    name: string;\r\n    status: 'pending' | 'approved' | 'rejected';\r\n    timestamp?: string;\r\n    notes?: string;\r\n  }>;\r\n  conflicts: ConflictInfo[];\r\n  changes: ChangeRecord[];\r\n  mergeStrategy: 'fast_forward' | 'merge_commit' | 'squash' | 'rebase';\r\n}\r\n\r\nclass DocumentationVersionControl {\r\n  private static instance: DocumentationVersionControl;\r\n  private currentVersion: VersionInfo | null = null;\r\n  private changeHistory: ChangeRecord[] = [];\r\n  private branches: Map<string, BranchInfo> = new Map();\r\n  private conflicts: Map<string, ConflictInfo> = new Map();\r\n  private mergeRequests: Map<string, MergeRequest> = new Map();\r\n\r\n  private constructor() {}\r\n\r\n  public static getInstance(): DocumentationVersionControl {\r\n    if (!DocumentationVersionControl.instance) {\r\n      DocumentationVersionControl.instance = new DocumentationVersionControl();\r\n    }\r\n    return DocumentationVersionControl.instance;\r\n  }\r\n\r\n  // Version Management\r\n  public async getCurrentVersion(): Promise<VersionInfo | null> {\r\n    try {\r\n      const response = await utilitiesApi.getDocumentationVersion();\r\n      if (response.success && response.data) {\r\n        this.currentVersion = response.data as VersionInfo;\r\n        return this.currentVersion;\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Failed to get current version:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  public async createVersion(\r\n    versionType: 'major' | 'minor' | 'patch',\r\n    description?: string,\r\n    tags: string[] = []\r\n  ): Promise<VersionInfo | null> {\r\n    try {\r\n      if (!this.currentVersion) {\r\n        await this.getCurrentVersion();\r\n      }\r\n\r\n      const newVersion = this.calculateNextVersion(versionType);\r\n      const versionData = {\r\n        ...newVersion,\r\n        description,\r\n        tags,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n\r\n      // This would typically call an API to create the version\r\n      // For now, we'll simulate it\r\n      const response = await this.simulateVersionCreation(versionData);\r\n\r\n      if (response.success) {\r\n        this.currentVersion = response.data;\r\n        return this.currentVersion;\r\n      }\r\n\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Failed to create version:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private calculateNextVersion(\r\n    versionType: 'major' | 'minor' | 'patch'\r\n  ): Omit<VersionInfo, 'timestamp' | 'author' | 'description' | 'tags'> {\r\n    const current = this.currentVersion || {\r\n      major: 0,\r\n      minor: 0,\r\n      patch: 0,\r\n      hash: '',\r\n    };\r\n\r\n    switch (versionType) {\r\n      case 'major':\r\n        return {\r\n          major: current.major + 1,\r\n          minor: 0,\r\n          patch: 0,\r\n          hash: this.generateVersionHash(),\r\n        };\r\n      case 'minor':\r\n        return {\r\n          major: current.major,\r\n          minor: current.minor + 1,\r\n          patch: 0,\r\n          hash: this.generateVersionHash(),\r\n        };\r\n      case 'patch':\r\n        return {\r\n          major: current.major,\r\n          minor: current.minor,\r\n          patch: current.patch + 1,\r\n          hash: this.generateVersionHash(),\r\n        };\r\n    }\r\n  }\r\n\r\n  private generateVersionHash(): string {\r\n    return Math.random().toString(36).substr(2, 8);\r\n  }\r\n\r\n  private async simulateVersionCreation(\r\n    versionData: any\r\n  ): Promise<{ success: boolean; data: VersionInfo }> {\r\n    // Simulate API call\r\n    await new Promise((resolve) => setTimeout(resolve, 100));\r\n\r\n    return {\r\n      success: true,\r\n      data: {\r\n        ...versionData,\r\n        author: {\r\n          id: 'current_user',\r\n          name: 'Current User',\r\n          role: 'developer',\r\n        },\r\n      },\r\n    };\r\n  }\r\n\r\n  // Change Tracking\r\n  public async trackChange(update: DocumentationUpdate): Promise<ChangeRecord> {\r\n    const changeRecord: ChangeRecord = {\r\n      id: this.generateChangeId(),\r\n      versionFrom: this.currentVersion?.hash || 'unknown',\r\n      versionTo: update.version.hash,\r\n      timestamp: update.timestamp,\r\n      author: update.author,\r\n      changes: update.changes.map((change) => ({\r\n        ...change,\r\n        lineNumbers: this.calculateLineNumbers(change),\r\n        metadata: {\r\n          size: {\r\n            old: change.oldContent?.length || 0,\r\n            new: change.newContent?.length || 0,\r\n          },\r\n          complexity: this.calculateComplexity(change),\r\n          impact: update.metadata.impactLevel,\r\n        },\r\n      })),\r\n      statistics: this.calculateStatistics(update.changes),\r\n      reviewStatus: update.metadata.autoApproved ? 'auto_approved' : 'pending',\r\n    };\r\n\r\n    this.changeHistory.push(changeRecord);\r\n\r\n    // Keep only last 1000 changes in memory\r\n    if (this.changeHistory.length > 1000) {\r\n      this.changeHistory = this.changeHistory.slice(-1000);\r\n    }\r\n\r\n    return changeRecord;\r\n  }\r\n\r\n  private generateChangeId(): string {\r\n    return `change_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`;\r\n  }\r\n\r\n  private calculateLineNumbers(change: any): {\r\n    old: { start: number; end: number };\r\n    new: { start: number; end: number };\r\n  } {\r\n    // This would typically analyze the actual content to determine line numbers\r\n    // For now, we'll provide a simplified implementation\r\n    const oldLines = change.oldContent?.split('\\n').length || 0;\r\n    const newLines = change.newContent?.split('\\n').length || 0;\r\n\r\n    return {\r\n      old: { start: 1, end: oldLines },\r\n      new: { start: 1, end: newLines },\r\n    };\r\n  }\r\n\r\n  private calculateComplexity(change: any): 'low' | 'medium' | 'high' {\r\n    const contentLength = (change.newContent || change.oldContent || '').length;\r\n\r\n    if (contentLength < 100) {\r\n      return 'low';\r\n    }\r\n    if (contentLength < 500) {\r\n      return 'medium';\r\n    }\r\n    return 'high';\r\n  }\r\n\r\n  private calculateStatistics(changes: any[]): ChangeRecord['statistics'] {\r\n    let linesAdded = 0;\r\n    let linesRemoved = 0;\r\n    let linesModified = 0;\r\n\r\n    const uniqueFiles = new Set();\r\n\r\n    changes.forEach((change) => {\r\n      uniqueFiles.add(change.file);\r\n\r\n      const oldLines = change.oldContent?.split('\\n').length || 0;\r\n      const newLines = change.newContent?.split('\\n').length || 0;\r\n\r\n      switch (change.changeType) {\r\n        case 'added':\r\n          linesAdded += newLines;\r\n          break;\r\n        case 'deleted':\r\n          linesRemoved += oldLines;\r\n          break;\r\n        case 'modified':\r\n          linesModified += Math.max(oldLines, newLines);\r\n          break;\r\n      }\r\n    });\r\n\r\n    return {\r\n      filesChanged: uniqueFiles.size,\r\n      linesAdded,\r\n      linesRemoved,\r\n      linesModified,\r\n      totalChanges: changes.length,\r\n    };\r\n  }\r\n\r\n  // Change History\r\n  public async getChangeHistory(\r\n    options: {\r\n      limit?: number;\r\n      offset?: number;\r\n      since?: string;\r\n      author?: string;\r\n      file?: string;\r\n    } = {}\r\n  ): Promise<ChangeRecord[]> {\r\n    try {\r\n      const response = await utilitiesApi.getDocumentationHistory(options);\r\n      if (response.success && response.data) {\r\n        return response.data as ChangeRecord[];\r\n      }\r\n      return [];\r\n    } catch (error) {\r\n      console.error('Failed to get change history:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  public getLocalChangeHistory(): ChangeRecord[] {\r\n    return [...this.changeHistory];\r\n  }\r\n\r\n  // Conflict Management\r\n  public async detectConflicts(\r\n    update: DocumentationUpdate\r\n  ): Promise<ConflictInfo[]> {\r\n    const conflicts: ConflictInfo[] = [];\r\n\r\n    for (const change of update.changes) {\r\n      // Check for concurrent modifications\r\n      const existingChanges = this.changeHistory.filter(\r\n        (record) =>\r\n          record.changes.some((c) => c.file === change.file) &&\r\n          record.timestamp > (this.currentVersion?.timestamp || '0')\r\n      );\r\n\r\n      if (existingChanges.length > 0) {\r\n        const conflict: ConflictInfo = {\r\n          id: this.generateConflictId(),\r\n          file: change.file,\r\n          ...(change.section && { section: change.section }),\r\n          conflictType: 'content',\r\n          currentContent: change.oldContent || '',\r\n          incomingContent: change.newContent || '',\r\n          timestamp: new Date().toISOString(),\r\n          authors: [\r\n            {\r\n              id: update.author.id,\r\n              name: update.author.name,\r\n              version: `${update.version.major}.${update.version.minor}.${update.version.patch}`,\r\n            },\r\n            ...existingChanges.map((c) => ({\r\n              id: c.author.id,\r\n              name: c.author.name,\r\n              version: c.versionTo,\r\n            })),\r\n          ],\r\n        };\r\n\r\n        conflicts.push(conflict);\r\n        this.conflicts.set(conflict.id, conflict);\r\n      }\r\n    }\r\n\r\n    return conflicts;\r\n  }\r\n\r\n  private generateConflictId(): string {\r\n    return `conflict_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`;\r\n  }\r\n\r\n  public async resolveConflict(\r\n    conflictId: string,\r\n    resolution: {\r\n      strategy: 'accept_current' | 'accept_incoming' | 'merge_manual';\r\n      mergedContent?: string;\r\n      notes?: string;\r\n    }\r\n  ): Promise<boolean> {\r\n    try {\r\n      const response = await utilitiesApi.resolveDocumentationConflict(\r\n        conflictId,\r\n        resolution\r\n      );\r\n\r\n      if (response.success) {\r\n        const conflict = this.conflicts.get(conflictId);\r\n        if (conflict) {\r\n          conflict.resolutionStrategy = resolution.strategy;\r\n          conflict.resolvedContent =\r\n            resolution.mergedContent || conflict.currentContent;\r\n          conflict.resolvedBy = {\r\n            id: 'current_user',\r\n            name: 'Current User',\r\n            timestamp: new Date().toISOString(),\r\n          };\r\n        }\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    } catch (error) {\r\n      console.error('Failed to resolve conflict:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Rollback functionality\r\n  public async rollbackToVersion(\r\n    versionHash: string,\r\n    reason?: string\r\n  ): Promise<boolean> {\r\n    try {\r\n      const response = await utilitiesApi.rollbackDocumentation(versionHash, {\r\n        reason: reason || 'Manual rollback',\r\n      });\r\n\r\n      if (response.success) {\r\n        // Update current version\r\n        await this.getCurrentVersion();\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    } catch (error) {\r\n      console.error('Failed to rollback to version:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Comparison utilities\r\n  public compareVersions(\r\n    version1: string,\r\n    _version2: string\r\n  ): Promise<ChangeRecord[]> {\r\n    // This would typically call an API to get the diff between versions\r\n    return this.getChangeHistory({\r\n      since: version1,\r\n      limit: 100,\r\n    });\r\n  }\r\n\r\n  public async generateDiff(\r\n    _file: string,\r\n    _version1: string,\r\n    _version2: string\r\n  ): Promise<{\r\n    additions: string[];\r\n    deletions: string[];\r\n    modifications: Array<{ old: string; new: string; line: number }>;\r\n  }> {\r\n    // This would typically generate a detailed diff\r\n    // For now, we'll return a simplified structure\r\n    return {\r\n      additions: [],\r\n      deletions: [],\r\n      modifications: [],\r\n    };\r\n  }\r\n\r\n  // Validation\r\n  public async validateVersion(_versionHash: string): Promise<{\r\n    isValid: boolean;\r\n    errors: string[];\r\n    warnings: string[];\r\n  }> {\r\n    try {\r\n      const response = await utilitiesApi.validateDocumentationIntegrity();\r\n\r\n      if (response.success) {\r\n        return {\r\n          isValid: true,\r\n          errors: [],\r\n          warnings: [],\r\n        };\r\n      }\r\n\r\n      return {\r\n        isValid: false,\r\n        errors: ['Validation failed'],\r\n        warnings: [],\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        isValid: false,\r\n        errors: [error instanceof Error ? error.message : 'Unknown error'],\r\n        warnings: [],\r\n      };\r\n    }\r\n  }\r\n\r\n  // Cleanup\r\n  public clearHistory(): void {\r\n    this.changeHistory = [];\r\n    this.conflicts.clear();\r\n    this.branches.clear();\r\n    this.mergeRequests.clear();\r\n  }\r\n\r\n  // Export/Import\r\n  public exportHistory(): {\r\n    version: VersionInfo | null;\r\n    changes: ChangeRecord[];\r\n    conflicts: ConflictInfo[];\r\n  } {\r\n    return {\r\n      version: this.currentVersion,\r\n      changes: this.changeHistory,\r\n      conflicts: Array.from(this.conflicts.values()),\r\n    };\r\n  }\r\n\r\n  public importHistory(data: {\r\n    version?: VersionInfo;\r\n    changes?: ChangeRecord[];\r\n    conflicts?: ConflictInfo[];\r\n  }): void {\r\n    if (data.version) {\r\n      this.currentVersion = data.version;\r\n    }\r\n\r\n    if (data.changes) {\r\n      this.changeHistory = data.changes;\r\n    }\r\n\r\n    if (data.conflicts) {\r\n      this.conflicts.clear();\r\n      data.conflicts.forEach((conflict) => {\r\n        this.conflicts.set(conflict.id, conflict);\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const documentationVersionControl =\r\n  DocumentationVersionControl.getInstance();\r\n\r\nexport default documentationVersionControl;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\imageOptimizationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\notificationApi.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[471,474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[471,474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1938,1941],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1938,1941],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2441,2444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2441,2444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2945,2948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2945,2948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3218,3221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3218,3221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from './api';\r\n\r\nexport interface AppNotification {\r\n  id: string;\r\n  userId?: string;\r\n  type:\r\n    | 'OVERDUE_BOOK'\r\n    | 'FINE_ADDED'\r\n    | 'FINE_WAIVED'\r\n    | 'BOOK_DUE_SOON'\r\n    | 'EQUIPMENT_EXPIRING'\r\n    | 'SYSTEM_ALERT'\r\n    | 'INFO'\r\n    | 'WARNING'\r\n    | 'ERROR'\r\n    | 'SUCCESS';\r\n  title: string;\r\n  message: string;\r\n  priority: 'LOW' | 'NORMAL' | 'HIGH' | 'URGENT';\r\n  read: boolean;\r\n  readAt?: string;\r\n  actionUrl?: string;\r\n  metadata?: any;\r\n  createdAt: string;\r\n  expiresAt?: string;\r\n}\r\n\r\nexport interface NotificationResponse {\r\n  success: boolean;\r\n  data: {\r\n    notifications: AppNotification[];\r\n    total: number;\r\n    unreadCount: number;\r\n  };\r\n}\r\n\r\nexport interface NotificationStats {\r\n  success: boolean;\r\n  data: {\r\n    total: number;\r\n    unread: number;\r\n    byType: Array<{ type: string; _count: number }>;\r\n    byPriority: Array<{ priority: string; _count: number }>;\r\n  };\r\n}\r\n\r\nexport const notificationApi = {\r\n  // Get all notifications with filters\r\n  async getNotifications(params?: {\r\n    userId?: string;\r\n    unreadOnly?: boolean;\r\n    limit?: number;\r\n    offset?: number;\r\n    type?: string;\r\n  }): Promise<NotificationResponse> {\r\n    const response = await api.get('/notifications', { params });\r\n    return response.data;\r\n  },\r\n\r\n  // Get notification statistics\r\n  async getStats(userId?: string): Promise<NotificationStats> {\r\n    const response = await api.get('/notifications/stats', {\r\n      params: { userId },\r\n    });\r\n    return response.data;\r\n  },\r\n\r\n  // Create a notification\r\n  async createNotification(\r\n    data: Partial<AppNotification>\r\n  ): Promise<{ success: boolean; data: AppNotification }> {\r\n    const response = await api.post('/notifications', data);\r\n    return response.data;\r\n  },\r\n\r\n  // Create multiple notifications\r\n  async createBulkNotifications(\r\n    notifications: Partial<AppNotification>[]\r\n  ): Promise<{ success: boolean; data: any }> {\r\n    const response = await api.post('/notifications/bulk', { notifications });\r\n    return response.data;\r\n  },\r\n\r\n  // Mark notification as read\r\n  async markAsRead(\r\n    notificationId: string\r\n  ): Promise<{ success: boolean; data: AppNotification }> {\r\n    const response = await api.patch(`/notifications/${notificationId}/read`);\r\n    return response.data;\r\n  },\r\n\r\n  // Mark all notifications as read\r\n  async markAllAsRead(\r\n    userId?: string\r\n  ): Promise<{ success: boolean; data: any }> {\r\n    const response = await api.patch('/notifications/read-all', { userId });\r\n    return response.data;\r\n  },\r\n\r\n  // Delete a notification\r\n  async deleteNotification(\r\n    notificationId: string\r\n  ): Promise<{ success: boolean; message: string }> {\r\n    const response = await api.delete(`/notifications/${notificationId}`);\r\n    return response.data;\r\n  },\r\n\r\n  // Delete all read notifications\r\n  async deleteReadNotifications(\r\n    userId?: string\r\n  ): Promise<{ success: boolean; data: any; message: string }> {\r\n    const response = await api.delete('/notifications/read/all', {\r\n      params: { userId },\r\n    });\r\n    return response.data;\r\n  },\r\n\r\n  // Clean up expired notifications\r\n  async cleanupExpired(): Promise<{\r\n    success: boolean;\r\n    data: any;\r\n    message: string;\r\n  }> {\r\n    const response = await api.post('/notifications/cleanup');\r\n    return response.data;\r\n  },\r\n};\r\n\r\nexport default notificationApi;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\performanceMonitoringService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3578,3581],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3578,3581],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":144,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4008,4011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4008,4011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4066,4069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4066,4069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":174,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5170,5173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5170,5173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5318,5321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5318,5321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5868,5871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5868,5871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":241,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":241,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7127,7130],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7127,7130],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":246,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":246,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7250,7253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7250,7253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":403,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":403,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11885,11888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11885,11888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":404,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":404,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11965,11968],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11965,11968],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":581,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":581,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16671,16674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16671,16674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":582,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":582,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16699,16702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16699,16702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":587,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":587,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16832,16835],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16832,16835],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Frontend Performance Monitoring Service\r\n *\r\n * Comprehensive performance monitoring and benchmarking service for the CLMS frontend.\r\n * Tracks Core Web Vitals, component performance, and user interactions.\r\n */\r\n\r\ninterface PerformanceMetrics {\r\n  // Core Web Vitals\r\n  lcp: number; // Largest Contentful Paint\r\n  fid: number; // First Input Delay\r\n  cls: number; // Cumulative Layout Shift\r\n  fcp: number; // First Contentful Paint\r\n  ttfb: number; // Time to First Byte\r\n\r\n  // Navigation metrics\r\n  domContentLoaded: number;\r\n  loadComplete: number;\r\n\r\n  // Resource metrics\r\n  resourceCount: number;\r\n  totalResourceSize: number;\r\n  totalTransferSize: number;\r\n\r\n  // Runtime metrics\r\n  memoryUsage: number;\r\n  renderTime: number;\r\n  componentRenders: number;\r\n\r\n  // User interaction metrics\r\n  interactionTime: number;\r\n  errorCount: number;\r\n\r\n  // Custom metrics\r\n  routeChanges: number;\r\n  apiCalls: number;\r\n  apiResponseTime: number;\r\n}\r\n\r\ninterface PerformanceReport {\r\n  timestamp: number;\r\n  url: string;\r\n  userAgent: string;\r\n  connectionType: string;\r\n  deviceMemory: number;\r\n  hardwareConcurrency: number;\r\n  metrics: PerformanceMetrics;\r\n  grade: 'A' | 'B' | 'C' | 'D' | 'F';\r\n  recommendations: string[];\r\n  score: number;\r\n}\r\n\r\ninterface ComponentPerformance {\r\n  name: string;\r\n  renders: number;\r\n  totalTime: number;\r\n  averageTime: number;\r\n  slowestRender: number;\r\n  fastestRender: number;\r\n  lastRender: number;\r\n  mountTime: number;\r\n}\r\n\r\nclass PerformanceMonitoringService {\r\n  private static instance: PerformanceMonitoringService;\r\n  private metrics: PerformanceMetrics;\r\n  private componentMetrics: Map<string, ComponentPerformance>;\r\n  private observers: PerformanceObserver[] = [];\r\n  private isMonitoring = false;\r\n  private reports: PerformanceReport[] = [];\r\n  private maxReports = 100;\r\n\r\n  private constructor() {\r\n    this.metrics = this.getInitialMetrics();\r\n    this.componentMetrics = new Map();\r\n    this.initializeObservers();\r\n  }\r\n\r\n  public static getInstance(): PerformanceMonitoringService {\r\n    if (!PerformanceMonitoringService.instance) {\r\n      PerformanceMonitoringService.instance =\r\n        new PerformanceMonitoringService();\r\n    }\r\n    return PerformanceMonitoringService.instance;\r\n  }\r\n\r\n  private getInitialMetrics(): PerformanceMetrics {\r\n    return {\r\n      lcp: 0,\r\n      fid: 0,\r\n      cls: 0,\r\n      fcp: 0,\r\n      ttfb: 0,\r\n      domContentLoaded: 0,\r\n      loadComplete: 0,\r\n      resourceCount: 0,\r\n      totalResourceSize: 0,\r\n      totalTransferSize: 0,\r\n      memoryUsage: 0,\r\n      renderTime: 0,\r\n      componentRenders: 0,\r\n      interactionTime: 0,\r\n      errorCount: 0,\r\n      routeChanges: 0,\r\n      apiCalls: 0,\r\n      apiResponseTime: 0,\r\n    };\r\n  }\r\n\r\n  private initializeObservers(): void {\r\n    if (!window?.PerformanceObserver) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Observer for Largest Contentful Paint (LCP)\r\n      const lcpObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        const lastEntry = entries[entries.length - 1];\r\n        if (lastEntry) {\r\n          this.metrics.lcp = lastEntry.startTime;\r\n        }\r\n      });\r\n      lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });\r\n      this.observers.push(lcpObserver);\r\n\r\n      // Observer for First Input Delay (FID)\r\n      const fidObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (entry.name === 'first-input') {\r\n            this.metrics.fid = (entry as any).processingStart - entry.startTime;\r\n          }\r\n        });\r\n      });\r\n      fidObserver.observe({ entryTypes: ['first-input'] });\r\n      this.observers.push(fidObserver);\r\n\r\n      // Observer for Cumulative Layout Shift (CLS)\r\n      let clsValue = 0;\r\n      const clsObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        entries.forEach((entry) => {\r\n          if (!(entry as any).hadRecentInput) {\r\n            clsValue += (entry as any).value;\r\n            this.metrics.cls = clsValue;\r\n          }\r\n        });\r\n      });\r\n      clsObserver.observe({ entryTypes: ['layout-shift'] });\r\n      this.observers.push(clsObserver);\r\n\r\n      // Observer for First Contentful Paint (FCP)\r\n      const fcpObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        const fcpEntry = entries.find(\r\n          (entry) => entry.name === 'first-contentful-paint'\r\n        );\r\n        if (fcpEntry) {\r\n          this.metrics.fcp = fcpEntry.startTime;\r\n        }\r\n      });\r\n      fcpObserver.observe({ entryTypes: ['paint'] });\r\n      this.observers.push(fcpObserver);\r\n\r\n      // Observer for navigation timing\r\n      const navObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        const navEntry = entries[0] as PerformanceNavigationTiming;\r\n        if (navEntry) {\r\n          this.metrics.ttfb = navEntry.responseStart - navEntry.requestStart;\r\n          this.metrics.domContentLoaded =\r\n            navEntry.domContentLoadedEventEnd -\r\n            ((navEntry as any).navigationStart || navEntry.startTime);\r\n          this.metrics.loadComplete =\r\n            navEntry.loadEventEnd -\r\n            ((navEntry as any).navigationStart || navEntry.startTime);\r\n        }\r\n      });\r\n      navObserver.observe({ entryTypes: ['navigation'] });\r\n      this.observers.push(navObserver);\r\n\r\n      // Observer for resource timing\r\n      const resourceObserver = new PerformanceObserver((list) => {\r\n        const entries = list.getEntries();\r\n        this.metrics.resourceCount = entries.length;\r\n\r\n        entries.forEach((entry) => {\r\n          const resource = entry as PerformanceResourceTiming;\r\n          this.metrics.totalResourceSize +=\r\n            (resource as any).decodedBodySize || 0;\r\n          this.metrics.totalTransferSize += resource.transferSize;\r\n        });\r\n      });\r\n      resourceObserver.observe({ entryTypes: ['resource'] });\r\n      this.observers.push(resourceObserver);\r\n    } catch (error) {\r\n      console.warn('Failed to initialize performance observers:', error);\r\n    }\r\n  }\r\n\r\n  public startMonitoring(): void {\r\n    if (this.isMonitoring) {\r\n      return;\r\n    }\r\n\r\n    this.isMonitoring = true;\r\n    this.resetMetrics();\r\n\r\n    // Monitor memory usage\r\n    this.startMemoryMonitoring();\r\n\r\n    // Monitor route changes\r\n    this.startRouteMonitoring();\r\n\r\n    // Monitor API calls\r\n    this.startApiMonitoring();\r\n\r\n    // Monitor errors\r\n    this.startErrorMonitoring();\r\n\r\n    // Monitor user interactions\r\n    this.startInteractionMonitoring();\r\n\r\n    console.debug('≡ƒôè Performance monitoring started');\r\n  }\r\n\r\n  public stopMonitoring(): void {\r\n    if (!this.isMonitoring) {\r\n      return;\r\n    }\r\n\r\n    this.observers.forEach((observer) => observer.disconnect());\r\n    this.observers = [];\r\n    this.isMonitoring = false;\r\n\r\n    console.debug('≡ƒôè Performance monitoring stopped');\r\n  }\r\n\r\n  private startMemoryMonitoring(): void {\r\n    if (!window.performance || !(window.performance as any).memory) {\r\n      return;\r\n    }\r\n\r\n    const updateMemoryUsage = () => {\r\n      const memory = (window.performance as any).memory;\r\n      this.metrics.memoryUsage = memory.usedJSHeapSize / 1024 / 1024; // MB\r\n    };\r\n\r\n    // Update memory usage every 5 seconds\r\n    const interval = setInterval(updateMemoryUsage, 5000);\r\n\r\n    // Clean up on stop\r\n    const originalStopMonitoring = this.stopMonitoring.bind(this);\r\n    this.stopMonitoring = () => {\r\n      clearInterval(interval);\r\n      originalStopMonitoring();\r\n    };\r\n  }\r\n\r\n  private startRouteMonitoring(): void {\r\n    // This would integrate with your router to track route changes\r\n    // For now, we'll use the History API\r\n    const originalPushState = history.pushState;\r\n    const originalReplaceState = history.replaceState;\r\n\r\n    history.pushState = (...args) => {\r\n      this.metrics.routeChanges++;\r\n      return originalPushState.apply(history, args);\r\n    };\r\n\r\n    history.replaceState = (...args) => {\r\n      this.metrics.routeChanges++;\r\n      return originalReplaceState.apply(history, args);\r\n    };\r\n\r\n    window.addEventListener('popstate', () => {\r\n      this.metrics.routeChanges++;\r\n    });\r\n  }\r\n\r\n  private startApiMonitoring(): void {\r\n    // Monitor fetch API calls\r\n    const originalFetch = window.fetch;\r\n    window.fetch = async (...args) => {\r\n      const startTime = performance.now();\r\n      this.metrics.apiCalls++;\r\n\r\n      try {\r\n        const response = await originalFetch(...args);\r\n        const endTime = performance.now();\r\n        const duration = endTime - startTime;\r\n        this.metrics.apiResponseTime =\r\n          (this.metrics.apiResponseTime + duration) / 2;\r\n\r\n        return response;\r\n      } catch (error) {\r\n        const endTime = performance.now();\r\n        const duration = endTime - startTime;\r\n        this.metrics.apiResponseTime =\r\n          (this.metrics.apiResponseTime + duration) / 2;\r\n        throw error;\r\n      }\r\n    };\r\n  }\r\n\r\n  private startErrorMonitoring(): void {\r\n    window.addEventListener('error', () => {\r\n      this.metrics.errorCount++;\r\n    });\r\n\r\n    window.addEventListener('unhandledrejection', () => {\r\n      this.metrics.errorCount++;\r\n    });\r\n  }\r\n\r\n  private startInteractionMonitoring(): void {\r\n    let lastInteractionTime = 0;\r\n    const interactionThreshold = 50; // ms\r\n\r\n    const measureInteraction = () => {\r\n      const now = performance.now();\r\n      const interactionTime = now - lastInteractionTime;\r\n\r\n      if (interactionTime < interactionThreshold) {\r\n        this.metrics.interactionTime =\r\n          (this.metrics.interactionTime + interactionTime) / 2;\r\n      }\r\n\r\n      lastInteractionTime = now;\r\n    };\r\n\r\n    ['click', 'keydown', 'touchstart'].forEach((eventType) => {\r\n      document.addEventListener(eventType, measureInteraction, {\r\n        passive: true,\r\n      });\r\n    });\r\n  }\r\n\r\n  public recordComponentRender(\r\n    componentName: string,\r\n    renderTime: number\r\n  ): void {\r\n    if (!this.componentMetrics.has(componentName)) {\r\n      this.componentMetrics.set(componentName, {\r\n        name: componentName,\r\n        renders: 0,\r\n        totalTime: 0,\r\n        averageTime: 0,\r\n        slowestRender: 0,\r\n        fastestRender: Infinity,\r\n        lastRender: 0,\r\n        mountTime: 0,\r\n      });\r\n    }\r\n\r\n    const metrics = this.componentMetrics.get(componentName);\r\n    if (metrics) {\r\n      metrics.renders++;\r\n      metrics.totalTime += renderTime;\r\n      metrics.averageTime = metrics.totalTime / metrics.renders;\r\n      metrics.slowestRender = Math.max(metrics.slowestRender, renderTime);\r\n      metrics.fastestRender = Math.min(metrics.fastestRender, renderTime);\r\n      metrics.lastRender = renderTime;\r\n\r\n      this.metrics.componentRenders++;\r\n      this.metrics.renderTime = (this.metrics.renderTime + renderTime) / 2;\r\n    }\r\n  }\r\n\r\n  public recordComponentMount(componentName: string, mountTime: number): void {\r\n    if (!this.componentMetrics.has(componentName)) {\r\n      this.componentMetrics.set(componentName, {\r\n        name: componentName,\r\n        renders: 0,\r\n        totalTime: 0,\r\n        averageTime: 0,\r\n        slowestRender: 0,\r\n        fastestRender: Infinity,\r\n        lastRender: 0,\r\n        mountTime: 0,\r\n      });\r\n    }\r\n\r\n    const metrics = this.componentMetrics.get(componentName);\r\n    if (metrics) {\r\n      metrics.mountTime = mountTime;\r\n    }\r\n  }\r\n\r\n  public resetMetrics(): void {\r\n    this.metrics = this.getInitialMetrics();\r\n    this.componentMetrics.clear();\r\n  }\r\n\r\n  public generateReport(): PerformanceReport {\r\n    const now = Date.now();\r\n\r\n    const report: PerformanceReport = {\r\n      timestamp: now,\r\n      url: window.location.href,\r\n      userAgent: navigator.userAgent,\r\n      connectionType: (navigator as any).connection?.effectiveType || 'unknown',\r\n      deviceMemory: (navigator as any).deviceMemory || 0,\r\n      hardwareConcurrency: navigator.hardwareConcurrency || 0,\r\n      metrics: { ...this.metrics },\r\n      grade: this.calculateGrade(),\r\n      recommendations: this.generateRecommendations(),\r\n      score: this.calculateScore(),\r\n    };\r\n\r\n    // Store report\r\n    this.reports.push(report);\r\n    if (this.reports.length > this.maxReports) {\r\n      this.reports.shift();\r\n    }\r\n\r\n    return report;\r\n  }\r\n\r\n  private calculateGrade(): 'A' | 'B' | 'C' | 'D' | 'F' {\r\n    const score = this.calculateScore();\r\n\r\n    if (score >= 90) {\r\n      return 'A';\r\n    }\r\n    if (score >= 80) {\r\n      return 'B';\r\n    }\r\n    if (score >= 70) {\r\n      return 'C';\r\n    }\r\n    if (score >= 60) {\r\n      return 'D';\r\n    }\r\n    return 'F';\r\n  }\r\n\r\n  private calculateScore(): number {\r\n    let score = 100;\r\n\r\n    // LCP scoring (0-100ms = 100, 1000ms+ = 0)\r\n    if (this.metrics.lcp > 1000) {\r\n      score -= 25;\r\n    } else if (this.metrics.lcp > 500) {\r\n      score -= 15;\r\n    } else if (this.metrics.lcp > 250) {\r\n      score -= 8;\r\n    }\r\n\r\n    // FID scoring (0-100ms = 100, 300ms+ = 0)\r\n    if (this.metrics.fid > 300) {\r\n      score -= 20;\r\n    } else if (this.metrics.fid > 200) {\r\n      score -= 12;\r\n    } else if (this.metrics.fid > 100) {\r\n      score -= 6;\r\n    }\r\n\r\n    // CLS scoring (0-0.1 = 100, 0.25+ = 0)\r\n    if (this.metrics.cls > 0.25) {\r\n      score -= 25;\r\n    } else if (this.metrics.cls > 0.1) {\r\n      score -= 15;\r\n    } else if (this.metrics.cls > 0.05) {\r\n      score -= 8;\r\n    }\r\n\r\n    // Memory usage scoring\r\n    if (this.metrics.memoryUsage > 100) {\r\n      score -= 15;\r\n    } else if (this.metrics.memoryUsage > 50) {\r\n      score -= 8;\r\n    } else if (this.metrics.memoryUsage > 30) {\r\n      score -= 4;\r\n    }\r\n\r\n    // Error count scoring\r\n    if (this.metrics.errorCount > 5) {\r\n      score -= 15;\r\n    } else if (this.metrics.errorCount > 2) {\r\n      score -= 8;\r\n    } else if (this.metrics.errorCount > 0) {\r\n      score -= 4;\r\n    }\r\n\r\n    return Math.max(0, Math.min(100, score));\r\n  }\r\n\r\n  private generateRecommendations(): string[] {\r\n    const recommendations: string[] = [];\r\n\r\n    if (this.metrics.lcp > 2500) {\r\n      recommendations.push(\r\n        'Largest Contentful Paint is slow. Optimize images and reduce server response time.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.fid > 300) {\r\n      recommendations.push(\r\n        'First Input Delay is high. Reduce JavaScript execution time and break up long tasks.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.cls > 0.1) {\r\n      recommendations.push(\r\n        'Cumulative Layout Shift is high. Ensure images have dimensions and avoid inserting content above existing content.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.memoryUsage > 50) {\r\n      recommendations.push(\r\n        'Memory usage is high. Consider implementing component unloading and memory cleanup.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.componentRenders > 100) {\r\n      recommendations.push(\r\n        'High number of component renders. Consider using React.memo and useMemo/useCallback.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.apiResponseTime > 1000) {\r\n      recommendations.push(\r\n        'API response time is slow. Consider implementing caching and optimizing backend queries.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.errorCount > 0) {\r\n      recommendations.push(\r\n        'Errors detected. Implement proper error boundaries and improve error handling.'\r\n      );\r\n    }\r\n\r\n    if (this.metrics.resourceCount > 100) {\r\n      recommendations.push(\r\n        'High number of resources. Consider bundling and reducing HTTP requests.'\r\n      );\r\n    }\r\n\r\n    if (recommendations.length === 0) {\r\n      recommendations.push(\r\n        'Performance is excellent! Continue monitoring for regressions.'\r\n      );\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  public getMetrics(): PerformanceMetrics {\r\n    return { ...this.metrics };\r\n  }\r\n\r\n  public getComponentMetrics(): ComponentPerformance[] {\r\n    return Array.from(this.componentMetrics.values());\r\n  }\r\n\r\n  public getReports(): PerformanceReport[] {\r\n    return [...this.reports];\r\n  }\r\n\r\n  public getLatestReport(): PerformanceReport | null {\r\n    return this.reports.length > 0\r\n      ? (this.reports[this.reports.length - 1] ?? null)\r\n      : null;\r\n  }\r\n\r\n  public exportData(): string {\r\n    const exportData = {\r\n      timestamp: Date.now(),\r\n      currentMetrics: this.metrics,\r\n      componentMetrics: Array.from(this.componentMetrics.entries()),\r\n      reports: this.reports,\r\n      userAgent: navigator.userAgent,\r\n      url: window.location.href,\r\n    };\r\n\r\n    return JSON.stringify(exportData, null, 2);\r\n  }\r\n\r\n  public async runLighthouseAudit(): Promise<any> {\r\n    if (!(window as any).lighthouse) {\r\n      throw new Error('Lighthouse is not available');\r\n    }\r\n\r\n    try {\r\n      const result = await (window as any).lighthouse(window.location.href, {\r\n        only: ['performance', 'accessibility', 'best-practices', 'seo'],\r\n        port: 8080,\r\n      });\r\n\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Lighthouse audit failed:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  public getPerformanceInsights(): {\r\n    trends: Array<{\r\n      timestamp: number;\r\n      score: number;\r\n      lcp: number;\r\n      fid: number;\r\n      cls: number;\r\n    }>;\r\n    summary: {\r\n      averageScore: number;\r\n      averageLcp: number;\r\n      averageFid: number;\r\n      averageCls: number;\r\n      improvementAreas: string[];\r\n      strongAreas: string[];\r\n    };\r\n  } {\r\n    const recentReports = this.reports.slice(-10); // Last 10 reports\r\n\r\n    if (recentReports.length === 0) {\r\n      return {\r\n        trends: [],\r\n        summary: {\r\n          averageScore: 0,\r\n          averageLcp: 0,\r\n          averageFid: 0,\r\n          averageCls: 0,\r\n          improvementAreas: [],\r\n          strongAreas: [],\r\n        },\r\n      };\r\n    }\r\n\r\n    const trends = recentReports.map((report) => ({\r\n      timestamp: report.timestamp,\r\n      score: report.score,\r\n      lcp: report.metrics.lcp,\r\n      fid: report.metrics.fid,\r\n      cls: report.metrics.cls,\r\n    }));\r\n\r\n    const averageScore =\r\n      recentReports.reduce((sum, r) => sum + r.score, 0) / recentReports.length;\r\n    const averageLcp =\r\n      recentReports.reduce((sum, r) => sum + r.metrics.lcp, 0) /\r\n      recentReports.length;\r\n    const averageFid =\r\n      recentReports.reduce((sum, r) => sum + r.metrics.fid, 0) /\r\n      recentReports.length;\r\n    const averageCls =\r\n      recentReports.reduce((sum, r) => sum + r.metrics.cls, 0) /\r\n      recentReports.length;\r\n\r\n    const latestReport = recentReports[recentReports.length - 1];\r\n    const recommendations = latestReport?.recommendations || [];\r\n\r\n    return {\r\n      trends,\r\n      summary: {\r\n        averageScore,\r\n        averageLcp,\r\n        averageFid,\r\n        averageCls,\r\n        improvementAreas: recommendations.slice(0, 3),\r\n        strongAreas: latestReport\r\n          ? this.identifyStrongAreas(latestReport.metrics)\r\n          : [],\r\n      },\r\n    };\r\n  }\r\n\r\n  private identifyStrongAreas(metrics: PerformanceMetrics): string[] {\r\n    const strongAreas: string[] = [];\r\n\r\n    if (metrics.lcp < 2500) {\r\n      strongAreas.push('Fast Largest Contentful Paint');\r\n    }\r\n    if (metrics.fid < 100) {\r\n      strongAreas.push('Quick First Input Delay');\r\n    }\r\n    if (metrics.cls < 0.1) {\r\n      strongAreas.push('Low Layout Shift');\r\n    }\r\n    if (metrics.memoryUsage < 30) {\r\n      strongAreas.push('Efficient Memory Usage');\r\n    }\r\n    if (metrics.errorCount === 0) {\r\n      strongAreas.push('Error-Free Operation');\r\n    }\r\n    if (metrics.apiResponseTime < 500) {\r\n      strongAreas.push('Fast API Responses');\r\n    }\r\n\r\n    return strongAreas.length > 0\r\n      ? strongAreas\r\n      : ['Performance monitoring active'];\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const performanceMonitoringService =\r\n  PerformanceMonitoringService.getInstance();\r\nexport default performanceMonitoringService;\r\n\r\n// Export types\r\nexport type { PerformanceMetrics, PerformanceReport, ComponentPerformance };\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\selfServiceApi.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\services\\userApi.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\store\\state-manager.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1241,1244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1241,1244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1300,1303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1300,1303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1381,1384],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1381,1384],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1399,1402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1399,1402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1929,1932],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1929,1932],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2045,2048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2045,2048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2063,2066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2063,2066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2117,2120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2117,2120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2613,2616],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2613,2616],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2623,2626],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2623,2626],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2633,2636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2633,2636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2854,2857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2854,2857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2862,2865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2862,2865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3517,3520],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3517,3520],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":131,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3608,3611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3608,3611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":131,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3626,3629],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3626,3629],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":134,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3695,3698],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3695,3698],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4084,4087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4084,4087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":158,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4416,4419],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4416,4419],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":158,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":158,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4440,4443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4440,4443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6005,6008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6005,6008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":226,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6201,6204],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6201,6204],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":234,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6517,6520],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6517,6520],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":348,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9305,9308],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9305,9308],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":369,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":369,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9846,9849],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9846,9849],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":386,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":386,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10138,10141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10138,10141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":389,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":389,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10250,10253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10250,10253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":390,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":390,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10297,10300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10297,10300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":28,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Modern State Management System\r\n * Combines multiple state management patterns for optimal performance and developer experience\r\n */\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { create } from 'zustand';\r\nimport {\r\n  subscribeWithSelector,\r\n  persist,\r\n  createJSONStorage,\r\n} from 'zustand/middleware';\r\n\r\n// Types for our state management system\r\nexport type StateUpdater<T> = (updater: T | ((prev: T) => T)) => void;\r\nexport type StateSelector<T, R> = (state: T) => R;\r\nexport type StateEffect<T> = (state: T, previousState: T) => void;\r\nexport type StateMiddleware<T> = (state: T, setState: StateUpdater<T>) => void;\r\n\r\n/**\r\n * Enhanced state store with multiple management patterns\r\n */\r\nexport interface EnhancedStateStore<T> {\r\n  // Core state\r\n  state: T;\r\n\r\n  // State management\r\n  setState: StateUpdater<T>;\r\n  getState: () => T;\r\n  resetState: () => void;\r\n\r\n  // Selectors\r\n  select: <R>(selector: StateSelector<T, R>) => R;\r\n\r\n  // Effects\r\n  subscribe: (callback: (state: T, previousState: T) => void) => () => void;\r\n  effect: (effect: StateEffect<T>) => () => void;\r\n\r\n  // Batch operations\r\n  batch: (updates: Array<() => void>) => void;\r\n\r\n  // Computed values\r\n  computed: Record<string, any>;\r\n\r\n  // Actions\r\n  actions: Record<string, (...args: any[]) => void>;\r\n\r\n  // Async actions\r\n  asyncActions: Record<string, (...args: any[]) => Promise<any>>;\r\n}\r\n\r\n/**\r\n * Configuration options for the state store\r\n */\r\nexport interface StateStoreConfig<T> {\r\n  name: string;\r\n  initialState: T;\r\n  persist?: {\r\n    enabled: boolean;\r\n    storage?: 'localStorage' | 'sessionStorage' | 'custom';\r\n    customStorage?: Storage;\r\n    partialize?: (state: T) => Partial<T>;\r\n    onRehydrateStorage?: (state: T) => void;\r\n  };\r\n  middlewares?: StateMiddleware<T>[];\r\n  effects?: StateEffect<T>[];\r\n  actions?: Record<\r\n    string,\r\n    (state: T, setState: StateUpdater<T>) => (...args: any[]) => void\r\n  >;\r\n  asyncActions?: Record<\r\n    string,\r\n    (state: T, setState: StateUpdater<T>) => (...args: any[]) => Promise<any>\r\n  >;\r\n  computed?: Record<string, (state: T) => any>;\r\n}\r\n\r\n/**\r\n * Create an enhanced state store\r\n */\r\nexport function createStateStore<T>(\r\n  config: StateStoreConfig<T>\r\n): EnhancedStateStore<T> {\r\n  const {\r\n    name,\r\n    initialState,\r\n    persist: persistConfig,\r\n    middlewares = [],\r\n    effects: globalEffects = [],\r\n    actions: actionDefinitions = {},\r\n    asyncActions: asyncActionDefinitions = {},\r\n    computed: computedDefinitions = {},\r\n  } = config;\r\n\r\n  // Create Zustand store with middleware\r\n  const createStore = (set: any, get: any, api: any) => ({\r\n    state: initialState,\r\n\r\n    setState: (updater: T | ((prev: T) => T)) => {\r\n      set((prev: { state: T }) => ({\r\n        state:\r\n          typeof updater === 'function'\r\n            ? (updater as (state: any) => any)(prev.state)\r\n            : updater,\r\n      }));\r\n    },\r\n\r\n    getState: () => get().state,\r\n\r\n    resetState: () => set({ state: initialState }),\r\n\r\n    select: <R>(selector: StateSelector<T, R>) => selector(get().state),\r\n\r\n    subscribe: (callback: (state: T, previousState: T) => void) => {\r\n      return api.subscribe(\r\n        (s: { state: T }) => s.state,\r\n        (state: T, previousState: T) => callback(state, previousState)\r\n      );\r\n    },\r\n\r\n    batch: (updates: Array<() => void>) => {\r\n      set(() => {\r\n        updates.forEach((update) => update());\r\n      });\r\n    },\r\n\r\n    // Actions\r\n    actions: {} as Record<string, (...args: any[]) => void>,\r\n\r\n    // Async actions\r\n    asyncActions: {} as Record<string, (...args: any[]) => Promise<any>>,\r\n\r\n    // Computed values\r\n    computed: {} as Record<string, any>,\r\n  });\r\n\r\n  // Apply persistence middleware\r\n  let storeWithMiddleware = createStore;\r\n\r\n  if (persistConfig?.enabled) {\r\n    const storage =\r\n      persistConfig.storage === 'localStorage'\r\n        ? localStorage\r\n        : persistConfig.storage === 'sessionStorage'\r\n          ? sessionStorage\r\n          : persistConfig.customStorage || localStorage;\r\n\r\n    const persistOptions: any = {\r\n      name,\r\n      storage: createJSONStorage(() => storage),\r\n      partialize: persistConfig.partialize || ((state: T) => state),\r\n    };\r\n\r\n    if (persistConfig.onRehydrateStorage) {\r\n      persistOptions.onRehydrateStorage = persistConfig.onRehydrateStorage;\r\n    }\r\n\r\n    storeWithMiddleware = persist(createStore as any, persistOptions) as any;\r\n  }\r\n\r\n  // Apply selector middleware\r\n  storeWithMiddleware = subscribeWithSelector(storeWithMiddleware);\r\n\r\n  // Create the store\r\n  const useStore = create(storeWithMiddleware);\r\n\r\n  // Create enhanced store interface\r\n  const enhancedStore: EnhancedStateStore<T> = {\r\n    state: initialState,\r\n\r\n    setState: (updater) => {\r\n      const currentStore = useStore.getState();\r\n      currentStore.setState(updater);\r\n    },\r\n\r\n    getState: () => {\r\n      return useStore.getState().getState();\r\n    },\r\n\r\n    resetState: () => {\r\n      useStore.getState().resetState();\r\n    },\r\n\r\n    select: <R>(selector: StateSelector<T, R>) => {\r\n      return selector(useStore.getState().getState());\r\n    },\r\n\r\n    subscribe: (callback) => {\r\n      let previousState = useStore.getState().state;\r\n      return useStore.subscribe((storeState) => {\r\n        const currentState = storeState.state;\r\n        if (currentState !== previousState) {\r\n          callback(currentState, previousState);\r\n          previousState = currentState;\r\n        }\r\n      });\r\n    },\r\n\r\n    effect: (effect) => {\r\n      let previousState = useStore.getState().getState();\r\n\r\n      const unsubscribe = useStore.subscribe((state) => {\r\n        const currentState = state.state;\r\n        if (currentState !== previousState) {\r\n          effect(currentState, previousState);\r\n          previousState = currentState;\r\n        }\r\n      });\r\n\r\n      return unsubscribe;\r\n    },\r\n\r\n    batch: (updates) => {\r\n      useStore.getState().batch(updates);\r\n    },\r\n\r\n    computed: {} as Record<string, any>,\r\n\r\n    actions: {},\r\n\r\n    asyncActions: {},\r\n  };\r\n\r\n  // Initialize actions\r\n  Object.entries(actionDefinitions).forEach(([name, action]) => {\r\n    enhancedStore.actions[name] = (...args: any[]) => {\r\n      const currentStore = useStore.getState();\r\n      return action(currentStore.getState(), currentStore.setState)(...args);\r\n    };\r\n  });\r\n\r\n  // Initialize async actions\r\n  Object.entries(asyncActionDefinitions).forEach(([name, action]) => {\r\n    enhancedStore.asyncActions[name] = async (...args: any[]) => {\r\n      const currentStore = useStore.getState();\r\n      return await action(\r\n        currentStore.getState(),\r\n        currentStore.setState\r\n      )(...args);\r\n    };\r\n  });\r\n\r\n  // Initialize computed values\r\n  Object.entries(computedDefinitions).forEach(([name, computeFn]) => {\r\n    Object.defineProperty(enhancedStore.computed, name, {\r\n      get: () => computeFn(useStore.getState().getState()),\r\n      enumerable: true,\r\n    });\r\n  });\r\n\r\n  // Apply middlewares\r\n  middlewares.forEach((middleware) => {\r\n    middleware(enhancedStore.state, enhancedStore.setState);\r\n  });\r\n\r\n  // Apply global effects\r\n  globalEffects.forEach((effect) => {\r\n    enhancedStore.effect(effect);\r\n  });\r\n\r\n  return enhancedStore;\r\n}\r\n\r\n/**\r\n * Hook to use the state store\r\n */\r\nexport function useStateStore<T>(\r\n  store: EnhancedStateStore<T>\r\n): [T, StateUpdater<T>] {\r\n  const [state, setState] = useState(store.getState());\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe((newState) => {\r\n      setState(newState);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [store]);\r\n\r\n  return [state, store.setState];\r\n}\r\n\r\n/**\r\n * Hook to use a selector from the state store\r\n */\r\nexport function useStateStoreSelector<T, R>(\r\n  store: EnhancedStateStore<T>,\r\n  selector: StateSelector<T, R>\r\n): R {\r\n  const [selectedState, setSelectedState] = useState(() =>\r\n    selector(store.getState())\r\n  );\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe((newState) => {\r\n      const newSelectedState = selector(newState);\r\n      setSelectedState(newSelectedState);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [store, selector]);\r\n\r\n  return selectedState;\r\n}\r\n\r\n/**\r\n * Hook to use computed values from the state store\r\n */\r\nexport function useStateStoreComputed<T, R>(\r\n  store: EnhancedStateStore<T>,\r\n  computedKey: string\r\n): R {\r\n  const [computedValue, setComputedValue] = useState(\r\n    () => store.computed[computedKey]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = store.subscribe(() => {\r\n      const newComputedValue = store.computed[computedKey];\r\n      setComputedValue(newComputedValue);\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [store, computedKey]);\r\n\r\n  return computedValue;\r\n}\r\n\r\n/**\r\n * Hook to use actions from the state store\r\n */\r\nexport function useStateStoreActions<T>(store: EnhancedStateStore<T>) {\r\n  return useCallback(() => store.actions, [store]);\r\n}\r\n\r\n/**\r\n * Hook to use async actions from the state store\r\n */\r\nexport function useStateStoreAsyncActions<T>(store: EnhancedStateStore<T>) {\r\n  return useCallback(() => store.asyncActions, [store]);\r\n}\r\n\r\n/**\r\n * Store registry for managing multiple stores\r\n */\r\nexport class StoreRegistry {\r\n  private static instance: StoreRegistry;\r\n  private stores: Map<string, EnhancedStateStore<any>> = new Map();\r\n\r\n  static getInstance(): StoreRegistry {\r\n    if (!StoreRegistry.instance) {\r\n      StoreRegistry.instance = new StoreRegistry();\r\n    }\r\n    return StoreRegistry.instance;\r\n  }\r\n\r\n  register<T>(name: string, store: EnhancedStateStore<T>): void {\r\n    this.stores.set(name, store);\r\n  }\r\n\r\n  get<T>(name: string): EnhancedStateStore<T> | undefined {\r\n    return this.stores.get(name);\r\n  }\r\n\r\n  unregister(name: string): boolean {\r\n    return this.stores.delete(name);\r\n  }\r\n\r\n  getAll(): Map<string, EnhancedStateStore<any>> {\r\n    return new Map(this.stores);\r\n  }\r\n\r\n  clear(): void {\r\n    this.stores.clear();\r\n  }\r\n}\r\n\r\n/**\r\n * Utility functions for store management\r\n */\r\nexport const StoreUtils = {\r\n  /**\r\n   * Create a deep selector for nested state\r\n   */\r\n  deepSelect:\r\n    <T extends Record<string, any>, R>(path: Array<string | number>) =>\r\n    (state: T): R => {\r\n      return path.reduce(\r\n        (current: any, key) => current?.[key],\r\n        state as any\r\n      ) as R;\r\n    },\r\n\r\n  /**\r\n   * Create a memoized selector\r\n   */\r\n  memoSelect: <T, R>(\r\n    selector: StateSelector<T, R>,\r\n    equalityFn?: (a: R, b: R) => boolean\r\n  ): StateSelector<T, R> => {\r\n    let cachedValue: R;\r\n    let cachedState: T;\r\n\r\n    return (state: T): R => {\r\n      if (cachedState === state && equalityFn?.(cachedValue, selector(state))) {\r\n        return cachedValue;\r\n      }\r\n\r\n      cachedState = state;\r\n      cachedValue = selector(state);\r\n      return cachedValue;\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Create a selector with fallback\r\n   */\r\n  selectWithFallback: <T, R>(\r\n    selector: StateSelector<T, R>,\r\n    fallback: R\r\n  ): StateSelector<T, R> => {\r\n    return (state: T): R => {\r\n      try {\r\n        return selector(state);\r\n      } catch {\r\n        return fallback;\r\n      }\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Create a batch updater\r\n   */\r\n  batchUpdater: <T>(store: EnhancedStateStore<T>) => {\r\n    const batchedUpdates: Array<() => void> = [];\r\n\r\n    return {\r\n      update: (updater: () => void) => {\r\n        batchedUpdates.push(updater);\r\n      },\r\n\r\n      flush: () => {\r\n        if (batchedUpdates.length > 0) {\r\n          store.batch(batchedUpdates);\r\n          batchedUpdates.length = 0;\r\n        }\r\n      },\r\n    };\r\n  },\r\n};\r\n\r\nexport default createStateStore;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\store\\useAppStore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1905,1908],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1905,1908],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2474,2477],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2474,2477],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3218,3221],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3218,3221],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { devtools } from 'zustand/middleware';\r\n\r\n// Types for our application state\r\nexport interface Student {\r\n  id: string;\r\n  name: string;\r\n  gradeLevel: string;\r\n  gradeCategory: 'primary' | 'gradeSchool' | 'juniorHigh' | 'seniorHigh';\r\n  barcode?: string;\r\n}\r\n\r\nexport interface Equipment {\r\n  id: string;\r\n  type: 'computer' | 'gaming' | 'avr';\r\n  name: string;\r\n  status: 'available' | 'in-use' | 'maintenance' | 'offline';\r\n  currentSession?: EquipmentSession;\r\n}\r\n\r\nexport interface EquipmentSession {\r\n  id: string;\r\n  studentId: string;\r\n  startTime: Date;\r\n  endTime?: Date;\r\n  timeLimitMinutes: number;\r\n  status: 'active' | 'completed' | 'expired';\r\n}\r\n\r\nexport interface Activity {\r\n  id: string;\r\n  studentId: string;\r\n  studentName: string;\r\n  gradeLevel: string;\r\n  gradeCategory: string;\r\n  activityType:\r\n    | 'borrowing'\r\n    | 'returning'\r\n    | 'computer'\r\n    | 'gaming'\r\n    | 'avr'\r\n    | 'recreation'\r\n    | 'study'\r\n    | 'general';\r\n  equipmentId?: string;\r\n  startTime: Date;\r\n  endTime?: Date;\r\n  durationMinutes?: number;\r\n  timeLimitMinutes?: number;\r\n  status: 'active' | 'completed' | 'expired' | 'cancelled';\r\n}\r\n\r\nexport interface AutomationJob {\r\n  id: string;\r\n  name: string;\r\n  type: 'backup' | 'notification' | 'sync' | 'cleanup';\r\n  status: 'running' | 'completed' | 'failed' | 'queued';\r\n  lastRun?: Date;\r\n  nextRun?: Date;\r\n  duration?: number;\r\n  errorMessage?: string;\r\n}\r\n\r\nexport interface AppNotification {\r\n  id: string;\r\n  userId?: string;\r\n  type:\r\n    | 'OVERDUE_BOOK'\r\n    | 'FINE_ADDED'\r\n    | 'FINE_WAIVED'\r\n    | 'BOOK_DUE_SOON'\r\n    | 'EQUIPMENT_EXPIRING'\r\n    | 'SYSTEM_ALERT'\r\n    | 'INFO'\r\n    | 'WARNING'\r\n    | 'ERROR'\r\n    | 'SUCCESS';\r\n  title: string;\r\n  message: string;\r\n  priority: 'LOW' | 'NORMAL' | 'HIGH' | 'URGENT';\r\n  read: boolean;\r\n  readAt?: string;\r\n  actionUrl?: string;\r\n  metadata?: any;\r\n  createdAt: string;\r\n  expiresAt?: string;\r\n}\r\n\r\n// App store interface\r\ninterface AppStore {\r\n  // UI State\r\n  isOnline: boolean;\r\n  connectedToBackend: boolean;\r\n  isDarkMode: boolean;\r\n\r\n  // Offline Sync State\r\n  offlineQueueCount: number;\r\n  lastSyncTime: number | null;\r\n  syncInProgress: boolean;\r\n\r\n  // Data State\r\n  students: Student[];\r\n  equipment: Equipment[];\r\n  activities: Activity[];\r\n  automationJobs: AutomationJob[];\r\n  notifications: AppNotification[];\r\n\r\n  // Scanning State\r\n  isScanning: boolean;\r\n  lastScanResult: string;\r\n  scanQueue: any[];\r\n\r\n  // Actions\r\n  setOnlineStatus: (isOnline: boolean) => void;\r\n  setBackendConnection: (connected: boolean) => void;\r\n  setDarkMode: (isDark: boolean) => void;\r\n  toggleDarkMode: () => void;\r\n  setOfflineQueueCount: (count: number) => void;\r\n  setLastSyncTime: (time: number | null) => void;\r\n  setSyncInProgress: (inProgress: boolean) => void;\r\n  setStudents: (students: Student[]) => void;\r\n  setEquipment: (equipment: Equipment[]) => void;\r\n  setActivities: (activities: Activity[]) => void;\r\n  setAutomationJobs: (jobs: AutomationJob[]) => void;\r\n  setNotifications: (notifications: AppNotification[]) => void;\r\n  setScanning: (scanning: boolean) => void;\r\n  setLastScanResult: (result: string) => void;\r\n  addToScanQueue: (item: any) => void;\r\n  clearScanQueue: () => void;\r\n}\r\n\r\n// Create the store\r\nexport const useAppStore = create<AppStore>()(\r\n  devtools(\r\n    (set) => ({\r\n      // Initial state\r\n      isOnline: navigator.onLine,\r\n      connectedToBackend: false,\r\n      isDarkMode: false,\r\n      offlineQueueCount: 0,\r\n      lastSyncTime: null,\r\n      syncInProgress: false,\r\n      students: [],\r\n      equipment: [],\r\n      activities: [],\r\n      automationJobs: [],\r\n      notifications: [],\r\n      isScanning: false,\r\n      lastScanResult: '',\r\n      scanQueue: [],\r\n\r\n      // Actions\r\n      setOnlineStatus: (isOnline) => set({ isOnline }),\r\n      setBackendConnection: (connected) =>\r\n        set({ connectedToBackend: connected }),\r\n      setDarkMode: (isDark) => set({ isDarkMode: isDark }),\r\n      toggleDarkMode: () => set((state) => ({ isDarkMode: !state.isDarkMode })),\r\n      setOfflineQueueCount: (count) => set({ offlineQueueCount: count }),\r\n      setLastSyncTime: (time) => set({ lastSyncTime: time }),\r\n      setSyncInProgress: (inProgress) => set({ syncInProgress: inProgress }),\r\n      setStudents: (students) => set({ students }),\r\n      setEquipment: (equipment) => set({ equipment }),\r\n      setActivities: (activities) => set({ activities }),\r\n      setAutomationJobs: (automationJobs) => set({ automationJobs }),\r\n      setNotifications: (notifications) => set({ notifications }),\r\n      setScanning: (scanning) => set({ isScanning: scanning }),\r\n      setLastScanResult: (result) => set({ lastScanResult: result }),\r\n      addToScanQueue: (item) =>\r\n        set((state) => ({\r\n          scanQueue: [...state.scanQueue, item],\r\n        })),\r\n      clearScanQueue: () => set({ scanQueue: [] }),\r\n    }),\r\n    {\r\n      name: 'clms-store',\r\n    }\r\n  )\r\n);\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\App.test.tsx","messages":[{"ruleId":"@typescript-eslint/prefer-optional-chain","severity":1,"message":"Prefer using an optional chain expression instead, as it's more concise and easier to read.","line":507,"column":9,"nodeType":null,"messageId":"preferOptionalChain","endLine":507,"endColumn":45,"fix":{"range":[14205,14241],"text":"renderResult?.unmount"}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import * as React from 'react';\r\nimport { vi, beforeEach, afterEach, describe, it, expect } from 'vitest';\r\nimport App from '../App';\r\nimport { render, testScreen as testingScreen } from './react19-render';\r\nimport { TestProviders } from './TestProviders';\r\n\r\n// Mock the problematic Image component that uses canvas and Image constructor\r\nvi.mock('@/components/performance/Image', () => ({\r\n  default: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-image\" {...props}>\r\n      {children || 'Mock Image Component'}\r\n    </div>\r\n  ),\r\n  PerformanceImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-performance-image\" {...props}>\r\n      {children || 'Mock Performance Image'}\r\n    </div>\r\n  ),\r\n  AvatarImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-avatar-image\" {...props}>\r\n      {children || 'Mock Avatar Image'}\r\n    </div>\r\n  ),\r\n  StudentPhotoImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-student-photo-image\" {...props}>\r\n      {children || 'Mock Student Photo Image'}\r\n    </div>\r\n  ),\r\n  BookCoverImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-book-cover-image\" {...props}>\r\n      {children || 'Mock Book Cover Image'}\r\n    </div>\r\n  ),\r\n  EquipmentImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-equipment-image\" {...props}>\r\n      {children || 'Mock Equipment Image'}\r\n    </div>\r\n  ),\r\n  BarcodeImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-barcode-image\" {...props}>\r\n      {children || 'Mock Barcode Image'}\r\n    </div>\r\n  ),\r\n  BackgroundImage: ({\r\n    children,\r\n    useCase,\r\n    priority,\r\n    lazy,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-background-image\" {...props}>\r\n      {children || 'Mock Background Image'}\r\n    </div>\r\n  ),\r\n}));\r\n\r\n// Mock UI components that cause React 19 prop warnings\r\nvi.mock('@/components/ui/dropdown-menu', () => ({\r\n  DropdownMenu: ({ children }: any) => (\r\n    <div data-testid=\"mock-dropdown-menu\">{children}</div>\r\n  ),\r\n  DropdownMenuTrigger: ({ children, asChild }: any) => {\r\n    // When asChild is true, render children directly without wrapping in button\r\n    if (asChild) {\r\n      return children;\r\n    }\r\n    return <button data-testid=\"mock-dropdown-trigger\">{children}</button>;\r\n  },\r\n  DropdownMenuContent: ({\r\n    children,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-dropdown-content\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuItem: ({\r\n    children,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-dropdown-item\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuCheckboxItem: ({\r\n    children,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-dropdown-checkbox-item\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuRadioItem: ({\r\n    children,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-dropdown-radio-item\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuLabel: ({ children, ...props }: any) => (\r\n    <div data-testid=\"mock-dropdown-label\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuSeparator: ({ ...props }: any) => (\r\n    <hr data-testid=\"mock-dropdown-separator\" {...props} />\r\n  ),\r\n  DropdownMenuShortcut: ({ children, ...props }: any) => (\r\n    <span data-testid=\"mock-dropdown-shortcut\" {...props}>\r\n      {children}\r\n    </span>\r\n  ),\r\n  DropdownMenuGroup: ({ children, ...props }: any) => (\r\n    <div data-testid=\"mock-dropdown-group\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuPortal: ({ children }: any) => (\r\n    <div data-testid=\"mock-dropdown-portal\">{children}</div>\r\n  ),\r\n  DropdownMenuSub: ({ children }: any) => (\r\n    <div data-testid=\"mock-dropdown-sub\">{children}</div>\r\n  ),\r\n  DropdownMenuSubContent: ({\r\n    children,\r\n    sideOffset,\r\n    onOpenChange,\r\n    onValueChange,\r\n    ...props\r\n  }: any) => (\r\n    <div data-testid=\"mock-dropdown-sub-content\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DropdownMenuSubTrigger: ({ children, asChild, ...props }: any) => {\r\n    // When asChild is true, render children directly\r\n    if (asChild) {\r\n      return children;\r\n    }\r\n    return (\r\n      <div data-testid=\"mock-dropdown-sub-trigger\" {...props}>\r\n        {children}\r\n      </div>\r\n    );\r\n  },\r\n  DropdownMenuRadioGroup: ({ children, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-dropdown-radio-group\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n}));\r\n\r\n// Mock shadcn/ui Dialog components\r\nvi.mock('@/components/ui/dialog', () => ({\r\n  Dialog: ({ children, open, onOpenChange, ...props }: any) => (\r\n    <div data-testid=\"mock-dialog\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DialogContent: ({ children, onOpenChange, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-dialog-content\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DialogHeader: ({ children, ...props }: any) => (\r\n    <div data-testid=\"mock-dialog-header\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DialogTitle: ({ children, ...props }: any) => (\r\n    <h2 data-testid=\"mock-dialog-title\" {...props}>\r\n      {children}\r\n    </h2>\r\n  ),\r\n  DialogDescription: ({ children, ...props }: any) => (\r\n    <p data-testid=\"mock-dialog-description\" {...props}>\r\n      {children}\r\n    </p>\r\n  ),\r\n  DialogFooter: ({ children, ...props }: any) => (\r\n    <div data-testid=\"mock-dialog-footer\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  DialogTrigger: ({ children, asChild, ...props }: any) => {\r\n    if (asChild) {\r\n      return children;\r\n    }\r\n    return (\r\n      <button data-testid=\"mock-dialog-trigger\" {...props}>\r\n        {children}\r\n      </button>\r\n    );\r\n  },\r\n}));\r\n\r\n// Mock shadcn/ui Select components\r\nvi.mock('@/components/ui/select', () => ({\r\n  Select: ({ children, value, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-select\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  SelectContent: ({ children, onOpenChange, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-select-content\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  SelectItem: ({ children, value, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-select-item\" data-value={value} {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  SelectTrigger: ({ children, onOpenChange, onValueChange, ...props }: any) => (\r\n    <button data-testid=\"mock-select-trigger\" {...props}>\r\n      {children}\r\n    </button>\r\n  ),\r\n  SelectValue: ({ placeholder, onValueChange, ...props }: any) => (\r\n    <span data-testid=\"mock-select-value\" {...props}>\r\n      {placeholder}\r\n    </span>\r\n  ),\r\n}));\r\n\r\n// Mock shadcn/ui Tabs components\r\nvi.mock('@/components/ui/tabs', () => ({\r\n  Tabs: ({ children, value, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-tabs\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  TabsList: ({ children, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-tabs-list\" {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n  TabsTrigger: ({ children, value, onValueChange, ...props }: any) => (\r\n    <button data-testid=\"mock-tabs-trigger\" data-value={value} {...props}>\r\n      {children}\r\n    </button>\r\n  ),\r\n  TabsContent: ({ children, value, onValueChange, ...props }: any) => (\r\n    <div data-testid=\"mock-tabs-content\" data-value={value} {...props}>\r\n      {children}\r\n    </div>\r\n  ),\r\n}));\r\n\r\n// Mock the hooks that use API\r\nvi.mock('@/hooks/api-hooks', () => ({\r\n  useHealthCheck: () => ({\r\n    data: { success: true },\r\n    isLoading: false,\r\n  }),\r\n}));\r\n\r\n// Mock the problematic services that cause canvas and indexedDB errors\r\nvi.mock('@/services/imageOptimizationService', () => {\r\n  const mockImageOptimizationService = {\r\n    getInstance: () => mockImageOptimizationService,\r\n    detectSupportedFormats: () => ['webp', 'avif', 'jpeg', 'png'],\r\n    optimizeImage: async () => 'optimized-image-url',\r\n    getCompressionSettings: () => ({ quality: 80 }),\r\n    initialize: async () => {},\r\n    cleanup: () => {},\r\n    getOptimalFormat: () => 'webp',\r\n    generateOptimizedUrl: (baseUrl: string, config: any = {}) => {\r\n      const url = new URL(baseUrl, 'http://localhost:3000');\r\n      Object.entries(config).forEach(([key, value]) => {\r\n        if (value !== undefined && value !== null) {\r\n          url.searchParams.set(key, value.toString());\r\n        }\r\n      });\r\n      return url.toString();\r\n    },\r\n    generateSrcSet: (baseUrl: string, config: any = {}) => {\r\n      const sizes = [1, 2, 3];\r\n      return sizes\r\n        .map((size) => {\r\n          const width = config.width ? config.width * size : config.width;\r\n          const height = config.height ? config.height * size : config.height;\r\n          const url = new URL(baseUrl, 'http://localhost:3000');\r\n          if (width) {\r\n            url.searchParams.set('width', width.toString());\r\n          }\r\n          if (height) {\r\n            url.searchParams.set('height', height.toString());\r\n          }\r\n          if (config.quality) {\r\n            url.searchParams.set('quality', config.quality.toString());\r\n          }\r\n          if (config.format) {\r\n            url.searchParams.set('format', config.format);\r\n          }\r\n          return `${url.toString()} ${size}x`;\r\n        })\r\n        .join(', ');\r\n    },\r\n    generateSizes: () =>\r\n      '(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw',\r\n    preloadImage: async () => {\r\n      // Mock preloading by doing nothing\r\n      return Promise.resolve();\r\n    },\r\n    loadImageWithMetrics: async () => ({\r\n      optimizedUrl: 'test.jpg',\r\n      metrics: {\r\n        originalSize: 1000,\r\n        optimizedSize: 500,\r\n        compressionRatio: 2,\r\n        loadTime: 100,\r\n        format: 'webp',\r\n        dimensions: { width: 800, height: 600 },\r\n      },\r\n      savings: { size: 500, percentage: 50 },\r\n    }),\r\n    batchOptimizeImages: async () => [],\r\n    getImageMetrics: () => [],\r\n    getPerformanceStats: () => ({\r\n      totalImages: 0,\r\n      averageLoadTime: 0,\r\n      averageCompressionRatio: 0,\r\n      totalSavings: 0,\r\n      formatDistribution: {},\r\n    }),\r\n    clearCache: () => {},\r\n    generatePlaceholder: (\r\n      width: number = 300,\r\n      height: number = 200,\r\n      color: string = '#e5e7eb'\r\n    ) =>\r\n      `data:image/svg+xml,%3Csvg width='${width}' height='${height}' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100%25' height='100%25' fill='${color.replace(\r\n        '#',\r\n        '%23'\r\n      )}'/%3E%3C/svg%3E`,\r\n    generateBlurPlaceholder: async (width: number = 40, height: number = 40) =>\r\n      `data:image/svg+xml,%3Csvg width='${width}' height='${height}' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='100%25' height='100%25' fill='%23e5e7eb'/%3E%3C/svg%3E`,\r\n    isFormatSupported: () => true,\r\n    getSupportedFormats: () => ['webp', 'avif', 'jpeg', 'png'],\r\n  };\r\n\r\n  return {\r\n    ImageOptimizationService: {\r\n      getInstance: () => mockImageOptimizationService,\r\n    },\r\n    imageOptimizationService: mockImageOptimizationService,\r\n    default: mockImageOptimizationService,\r\n  };\r\n});\r\n\r\nvi.mock('@/hooks/useOfflineSync', () => ({\r\n  useOfflineSync: () => ({\r\n    isOnline: true,\r\n    syncData: async () => {},\r\n    isSyncing: false,\r\n    lastSyncTime: null,\r\n    pendingChanges: 0,\r\n  }),\r\n  OfflineSyncService: vi.fn().mockImplementation(() => ({\r\n    initializeDB: async () => {},\r\n    syncToServer: async () => {},\r\n    cacheData: async () => {},\r\n  })),\r\n}));\r\n\r\n// Mock WebSocket context\r\nvi.mock('@/contexts/WebSocketContext', () => {\r\n  const mockWebSocketProvider = ({ children }: { children: React.ReactNode }) =>\r\n    children;\r\n  const mockUseWebSocketContext = () => ({\r\n    isConnected: true,\r\n    sendMessage: vi.fn(),\r\n    lastMessage: null,\r\n    connect: vi.fn(),\r\n    disconnect: vi.fn(),\r\n    subscribe: vi.fn(),\r\n    unsubscribe: vi.fn(),\r\n    requestDashboardData: vi.fn(),\r\n    sendChatMessage: vi.fn(),\r\n    triggerEmergencyAlert: vi.fn(),\r\n    recentActivities: [],\r\n    equipmentStatus: {},\r\n    notifications: [],\r\n    dashboardData: {},\r\n    clearNotifications: vi.fn(),\r\n    refreshDashboard: vi.fn(),\r\n  });\r\n\r\n  return {\r\n    default: mockWebSocketProvider,\r\n    WebSocketProvider: mockWebSocketProvider,\r\n    useWebSocketContext: mockUseWebSocketContext,\r\n  };\r\n});\r\n\r\n// Mock usehooks-ts\r\nvi.mock('usehooks-ts', () => ({\r\n  useMediaQuery: vi.fn(() => false), // Default to false for all media queries\r\n  useWindowSize: vi.fn(() => ({ width: 1024, height: 768 })), // Default window size\r\n}));\r\n\r\n// Mock the AuthContext to provide test user\r\nvi.mock('../contexts/AuthContext', async () => {\r\n  const actual = await vi.importActual('../contexts/AuthContext');\r\n  return {\r\n    ...actual,\r\n    useAuth: () => ({\r\n      user: {\r\n        id: 'test-user-id',\r\n        username: 'test-user',\r\n        role: 'ADMIN',\r\n      },\r\n      isAuthenticated: true,\r\n      isLoading: false,\r\n      login: vi.fn().mockResolvedValue(true),\r\n      logout: vi.fn(),\r\n      checkAuth: vi.fn().mockResolvedValue(true),\r\n    }),\r\n  };\r\n});\r\n\r\ndescribe('App', () => {\r\n  let renderResult: any;\r\n\r\n  beforeEach(() => {\r\n    vi.clearAllMocks();\r\n  });\r\n\r\n  afterEach(() => {\r\n    if (renderResult && renderResult.unmount) {\r\n      renderResult.unmount();\r\n    }\r\n  });\r\n\r\n  it('renders without crashing with AuthProvider', () => {\r\n    renderResult = render(\r\n      <TestProviders>\r\n        <App />\r\n      </TestProviders>\r\n    );\r\n    // Check that the main app container is rendered\r\n    expect(testingScreen.getByRole('main')).toBeInTheDocument();\r\n    // Check that the header/banner is rendered\r\n    expect(testingScreen.getByRole('banner')).toBeInTheDocument();\r\n  });\r\n\r\n  it('displays authenticated user content', () => {\r\n    renderResult = render(\r\n      <TestProviders>\r\n        <App />\r\n      </TestProviders>\r\n    );\r\n    // The presence of header and main content proves AuthProvider is working\r\n    expect(testingScreen.getByRole('banner')).toBeInTheDocument();\r\n    expect(testingScreen.getByRole('main')).toBeInTheDocument();\r\n  });\r\n\r\n  it('has interactive elements', async () => {\r\n    renderResult = render(\r\n      <TestProviders>\r\n        <App />\r\n      </TestProviders>\r\n    );\r\n\r\n    // Wait a bit for components to render\r\n    await new Promise((resolve) => setTimeout(resolve, 100));\r\n\r\n    // Check for any interactive elements - be more flexible\r\n    const buttons = testingScreen.queryAllByRole('button');\r\n    const inputs = testingScreen.queryAllByRole('textbox');\r\n    const links = testingScreen.queryAllByRole('link');\r\n    const tabs = testingScreen.queryAllByRole('tab');\r\n\r\n    const totalInteractive =\r\n      buttons.length + inputs.length + links.length + tabs.length;\r\n\r\n    // If no interactive elements found, at least check that the main structure exists\r\n    if (totalInteractive === 0) {\r\n      const main = testingScreen.getByRole('main');\r\n      expect(main).toBeInTheDocument();\r\n    } else {\r\n      expect(totalInteractive).toBeGreaterThan(0);\r\n    }\r\n  });\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\TestProviders.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":7,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":7,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { AuthProvider } from '@/contexts/AuthContext';\nimport { ThemeProvider } from '@/contexts/ThemeContext';\n\n// Create a test query client with disabled retries and caching\nexport const createTestQueryClient = () =>\n  new QueryClient({\n    defaultOptions: {\n      queries: {\n        retry: false,\n        gcTime: 0,\n        staleTime: 0,\n      },\n      mutations: {\n        retry: false,\n      },\n    },\n  });\n\ninterface TestProvidersProps {\n  children: React.ReactNode;\n  queryClient?: QueryClient;\n}\n\nexport const TestProviders: React.FC<TestProvidersProps> = ({\n  children,\n  queryClient = createTestQueryClient(),\n}) => {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <ThemeProvider>{children}</ThemeProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\mocks\\services.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\setup-comprehensive.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\setup-minimal.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\test-utils.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":28,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":28,"endColumn":29},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"This rule can't verify that `export *` only exports components.","line":42,"column":1,"nodeType":"ExportAllDeclaration","messageId":"exportAll","endLine":42,"endColumn":40},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":43,"column":26,"nodeType":"Identifier","messageId":"namedExport","endLine":43,"endColumn":32},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":44,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":44,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, type RenderOptions } from '@testing-library/react';\nimport type { ReactElement } from 'react';\nimport { vi } from 'vitest';\nimport { QueryClient } from '@tanstack/react-query';\nimport { TestProviders, createTestQueryClient } from './TestProviders';\n\n// Custom render function that includes all providers\nconst customRender = (\n  ui: ReactElement,\n  options?: Omit<RenderOptions, 'wrapper'> & {\n    queryClient?: QueryClient;\n  }\n) => {\n  const { queryClient, ...renderOptions } = options || {};\n\n  return render(ui, {\n    wrapper: ({ children }) =>\n      queryClient ? (\n        <TestProviders queryClient={queryClient}>{children}</TestProviders>\n      ) : (\n        <TestProviders>{children}</TestProviders>\n      ),\n    ...renderOptions,\n  });\n};\n\n// Mock auth context for testing\nexport const mockAuthContext = {\n  user: {\n    id: 'test-user-id',\n    username: 'test-user',\n    role: 'ADMIN',\n  },\n  isAuthenticated: true,\n  isLoading: false,\n  login: vi.fn().mockResolvedValue(true),\n  logout: vi.fn(),\n  checkAuth: vi.fn().mockResolvedValue(true),\n};\n\n// Re-export everything from testing-library\nexport * from '@testing-library/react';\nexport { customRender as render };\nexport { createTestQueryClient };\nexport { TestProviders };\n\n// Export types for test utilities\nexport type { RenderOptions };\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\test\\utils\\barcodeValidation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\utils\\error-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\utils\\errorHandling.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\utils\\imageUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\jmbar\\Desktop\\ALL REPOS\\Pia_REPOS\\CLMS\\Frontend\\src\\utils\\pwa-helpers.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[936,939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[936,939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":350,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":350,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9952,9955],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9952,9955],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":351,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":351,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9992,9995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9992,9995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":352,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":352,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10035,10038],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10035,10038],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":370,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":370,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10468,10471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10468,10471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":371,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":371,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10508,10511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10508,10511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":372,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10551,10554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10551,10554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":394,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":394,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11094,11097],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11094,11097],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":404,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":404,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11504,11507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11504,11507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":405,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":405,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11544,11547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11544,11547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":406,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":406,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11587,11590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11587,11590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":435,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":435,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12389,12392],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12389,12392],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":436,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":436,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12447,12450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12447,12450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":437,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":437,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12500,12503],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12500,12503],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// PWA Helper Utilities for CLMS\r\n// Provides utilities for PWA features, offline support, and mobile optimization\r\n\r\nexport interface PWAInstallPrompt {\r\n  platforms: string[];\r\n  prompt(): Promise<void>;\r\n  userChoice: Promise<{\r\n    outcome: 'accepted' | 'dismissed';\r\n    platform: string;\r\n  }>;\r\n}\r\n\r\nexport interface PWAInfo {\r\n  isInstalled: boolean;\r\n  isStandalone: boolean;\r\n  isOnline: boolean;\r\n  supportsInstall: boolean;\r\n  installPrompt?: PWAInstallPrompt;\r\n  platform?: 'ios' | 'android' | 'desktop' | 'unknown';\r\n}\r\n\r\nexport interface CacheStats {\r\n  size: number;\r\n  entries: number;\r\n  lastCleared: number | null;\r\n  types: Record<string, number>;\r\n}\r\n\r\n// Get PWA installation and device information\r\nexport const getPWAInfo = async (): Promise<PWAInfo> => {\r\n  // Check if running in standalone mode\r\n  const isStandalone =\r\n    window.matchMedia('(display-mode: standalone)').matches ||\r\n    (window.navigator as any).standalone === true ||\r\n    document.referrer.includes('android-app://');\r\n\r\n  // Check if app is installed\r\n  const isInstalled =\r\n    isStandalone || localStorage.getItem('pwa-installed') === 'true';\r\n\r\n  // Detect platform\r\n  const userAgent = navigator.userAgent.toLowerCase();\r\n  let platform: 'ios' | 'android' | 'desktop' | 'unknown' = 'unknown';\r\n\r\n  if (/iphone|ipad|ipod/.test(userAgent)) {\r\n    platform = 'ios';\r\n  } else if (/android/.test(userAgent)) {\r\n    platform = 'android';\r\n  } else if (!/mobile|tablet/.test(userAgent)) {\r\n    platform = 'desktop';\r\n  }\r\n\r\n  // Check online status\r\n  const isOnline = navigator.onLine;\r\n\r\n  // Check if install is supported (will be updated by beforeinstallprompt event)\r\n  const supportsInstall = !isInstalled && platform !== 'unknown';\r\n\r\n  return {\r\n    isInstalled,\r\n    isStandalone,\r\n    isOnline,\r\n    supportsInstall,\r\n    platform,\r\n  };\r\n};\r\n\r\n// Get browser and device information for PWA optimization\r\nexport const getDeviceInfo = () => {\r\n  const userAgent = navigator.userAgent;\r\n  const platform = navigator.platform;\r\n\r\n  // Detect browser\r\n  let browser = 'unknown';\r\n  let version = 'unknown';\r\n\r\n  if (userAgent.includes('Chrome')) {\r\n    browser = 'chrome';\r\n    const match = userAgent.match(/Chrome\\/(\\d+)/);\r\n    version = match?.[1] || 'unknown';\r\n  } else if (userAgent.includes('Firefox')) {\r\n    browser = 'firefox';\r\n    const match = userAgent.match(/Firefox\\/(\\d+)/);\r\n    version = match?.[1] || 'unknown';\r\n  } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {\r\n    browser = 'safari';\r\n    const match = userAgent.match(/Version\\/(\\d+)/);\r\n    version = match?.[1] || 'unknown';\r\n  } else if (userAgent.includes('Edge')) {\r\n    browser = 'edge';\r\n    const match = userAgent.match(/Edge\\/(\\d+)/);\r\n    version = match?.[1] || 'unknown';\r\n  }\r\n\r\n  // Detect device capabilities\r\n  const capabilities = {\r\n    serviceWorker: 'serviceWorker' in navigator,\r\n    pushManager: 'PushManager' in window,\r\n    notifications: 'Notification' in window,\r\n    bluetooth: 'bluetooth' in navigator,\r\n    usb: 'usb' in navigator,\r\n    camera:\r\n      'mediaDevices' in navigator && 'getUserMedia' in navigator.mediaDevices,\r\n    geolocation: 'geolocation' in navigator,\r\n    vibration: 'vibrate' in navigator,\r\n    fullscreen: 'fullscreenEnabled' in document,\r\n    webShare: 'share' in navigator,\r\n    webAuthn: 'credentials' in navigator,\r\n    indexedDB: 'indexedDB' in window,\r\n    localStorage: 'localStorage' in window,\r\n    sessionStorage: 'sessionStorage' in window,\r\n  };\r\n\r\n  // Screen and viewport info\r\n  const screenInfo = {\r\n    width: window.screen.width,\r\n    height: window.screen.height,\r\n    availWidth: window.screen.availWidth,\r\n    availHeight: window.screen.availHeight,\r\n    colorDepth: window.screen.colorDepth,\r\n    pixelDepth: window.screen.pixelDepth,\r\n  };\r\n\r\n  const viewport = {\r\n    width: window.innerWidth,\r\n    height: window.innerHeight,\r\n    devicePixelRatio: window.devicePixelRatio,\r\n  };\r\n\r\n  return {\r\n    browser: { name: browser, version },\r\n    platform,\r\n    capabilities,\r\n    screen: screenInfo,\r\n    viewport,\r\n    userAgent,\r\n  };\r\n};\r\n\r\n// Cache management utilities\r\nexport const cacheUtils = {\r\n  // Get cache statistics\r\n  async getStats(): Promise<CacheStats> {\r\n    if (!('caches' in window)) {\r\n      return { size: 0, entries: 0, lastCleared: null, types: {} };\r\n    }\r\n\r\n    try {\r\n      const cacheNames = await caches.keys();\r\n      let totalSize = 0;\r\n      let totalEntries = 0;\r\n      const types: Record<string, number> = {};\r\n\r\n      for (const cacheName of cacheNames) {\r\n        const cache = await caches.open(cacheName);\r\n        const keys = await cache.keys();\r\n        const entries = keys.length;\r\n\r\n        totalEntries += entries;\r\n\r\n        // Categorize cache types\r\n        if (cacheName.includes('api')) {\r\n          types.api = (types.api || 0) + entries;\r\n        } else if (cacheName.includes('image')) {\r\n          types.images = (types.images || 0) + entries;\r\n        } else if (cacheName.includes('font')) {\r\n          types.fonts = (types.fonts || 0) + entries;\r\n        } else {\r\n          types.static = (types.static || 0) + entries;\r\n        }\r\n\r\n        // Estimate size (rough calculation)\r\n        for (const request of keys.slice(0, 10)) {\r\n          // Sample first 10 entries\r\n          try {\r\n            const response = await cache.match(request);\r\n            if (response) {\r\n              const blob = await response.blob();\r\n              totalSize += blob.size;\r\n            }\r\n          } catch (error) {\r\n            // Skip if we can't read the response\r\n          }\r\n        }\r\n\r\n        // Extrapolate size based on sample\r\n        if (keys.length > 10) {\r\n          totalSize = Math.round(totalSize * (keys.length / 10));\r\n        }\r\n      }\r\n\r\n      const lastCleared = localStorage.getItem('cache-last-cleared');\r\n\r\n      return {\r\n        size: totalSize,\r\n        entries: totalEntries,\r\n        lastCleared: lastCleared ? parseInt(lastCleared) : null,\r\n        types,\r\n      };\r\n    } catch (error) {\r\n      console.error('[CacheUtils] Failed to get cache stats:', error);\r\n      return { size: 0, entries: 0, lastCleared: null, types: {} };\r\n    }\r\n  },\r\n\r\n  // Clear specific cache\r\n  async clearCache(pattern: string): Promise<boolean> {\r\n    if (!('caches' in window)) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const cacheNames = await caches.keys();\r\n      const regex = new RegExp(pattern);\r\n\r\n      for (const cacheName of cacheNames) {\r\n        if (regex.test(cacheName)) {\r\n          await caches.delete(cacheName);\r\n        }\r\n      }\r\n\r\n      localStorage.setItem('cache-last-cleared', Date.now().toString());\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[CacheUtils] Failed to clear cache:', error);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  // Clear all caches\r\n  async clearAll(): Promise<boolean> {\r\n    if (!('caches' in window)) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const cacheNames = await caches.keys();\r\n      await Promise.all(cacheNames.map((name) => caches.delete(name)));\r\n      localStorage.setItem('cache-last-cleared', Date.now().toString());\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[CacheUtils] Failed to clear all caches:', error);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  // Warm up cache with specific URLs\r\n  async warmup(urls: string[]): Promise<void> {\r\n    if (!('caches' in window)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const cache = await caches.open('pwa-warmup');\r\n      const promises = urls.map(async (url) => {\r\n        try {\r\n          const response = await fetch(url);\r\n          if (response.ok) {\r\n            await cache.put(url, response);\r\n          }\r\n        } catch (error) {\r\n          console.warn(\r\n            `[CacheUtils] Failed to warm up cache for ${url}:`,\r\n            error\r\n          );\r\n        }\r\n      });\r\n\r\n      await Promise.all(promises);\r\n    } catch (error) {\r\n      console.error('[CacheUtils] Cache warmup failed:', error);\r\n    }\r\n  },\r\n};\r\n\r\n// Notification utilities\r\nexport const notificationUtils = {\r\n  // Request notification permission\r\n  async requestPermission(): Promise<NotificationPermission> {\r\n    if (!('Notification' in window)) {\r\n      throw new Error('Notifications not supported');\r\n    }\r\n\r\n    if (Notification.permission === 'granted') {\r\n      return 'granted';\r\n    }\r\n\r\n    if (Notification.permission === 'denied') {\r\n      return 'denied';\r\n    }\r\n\r\n    return await Notification.requestPermission();\r\n  },\r\n\r\n  // Show notification\r\n  async show(title: string, options?: NotificationOptions): Promise<void> {\r\n    if (!('Notification' in window)) {\r\n      throw new Error('Notifications not supported');\r\n    }\r\n\r\n    if (Notification.permission !== 'granted') {\r\n      throw new Error('Notification permission not granted');\r\n    }\r\n\r\n    const notification = new Notification(title, {\r\n      icon: '/pwa-192x192.png',\r\n      badge: '/pwa-192x192.png',\r\n      tag: 'clms-notification',\r\n      requireInteraction: false,\r\n      ...options,\r\n    });\r\n\r\n    // Auto-close after 5 seconds\r\n    setTimeout(() => {\r\n      notification.close();\r\n    }, 5000);\r\n\r\n    // Handle click\r\n    notification.onclick = () => {\r\n      window.focus();\r\n      notification.close();\r\n      if (options?.data?.url) {\r\n        window.location.href = options.data.url;\r\n      }\r\n    };\r\n  },\r\n\r\n  // Schedule notification (for when app is in background)\r\n  async schedule(\r\n    title: string,\r\n    options?: NotificationOptions & { delay?: number }\r\n  ): Promise<void> {\r\n    const delay = options?.delay || 0;\r\n\r\n    if (delay > 0) {\r\n      setTimeout(() => {\r\n        this.show(title, options);\r\n      }, delay);\r\n    } else {\r\n      await this.show(title, options);\r\n    }\r\n  },\r\n};\r\n\r\n// Network utilities\r\nexport const networkUtils = {\r\n  // Check network quality\r\n  getConnectionType(): string {\r\n    const connection =\r\n      (navigator as any).connection ||\r\n      (navigator as any).mozConnection ||\r\n      (navigator as any).webkitConnection;\r\n\r\n    if (!connection) {\r\n      return 'unknown';\r\n    }\r\n\r\n    return connection.effectiveType || connection.type || 'unknown';\r\n  },\r\n\r\n  // Check if network is slow\r\n  isSlowConnection(): boolean {\r\n    const type = this.getConnectionType();\r\n    return type === 'slow-2g' || type === '2g' || type === '3g';\r\n  },\r\n\r\n  // Get network information\r\n  getInfo() {\r\n    const connection =\r\n      (navigator as any).connection ||\r\n      (navigator as any).mozConnection ||\r\n      (navigator as any).webkitConnection;\r\n\r\n    if (!connection) {\r\n      return {\r\n        type: 'unknown',\r\n        effectiveType: 'unknown',\r\n        downlink: 0,\r\n        rtt: 0,\r\n        saveData: false,\r\n      };\r\n    }\r\n\r\n    return {\r\n      type: connection.type || 'unknown',\r\n      effectiveType: connection.effectiveType || 'unknown',\r\n      downlink: connection.downlink || 0,\r\n      rtt: connection.rtt || 0,\r\n      saveData: connection.saveData || false,\r\n    };\r\n  },\r\n\r\n  // Monitor network changes\r\n  onChange(callback: (online: boolean, info: any) => void): () => void {\r\n    const handleOnline = () => callback(true, this.getInfo());\r\n    const handleOffline = () => callback(false, this.getInfo());\r\n    const handleConnectionChange = () =>\r\n      callback(navigator.onLine, this.getInfo());\r\n\r\n    window.addEventListener('online', handleOnline);\r\n    window.addEventListener('offline', handleOffline);\r\n\r\n    const connection =\r\n      (navigator as any).connection ||\r\n      (navigator as any).mozConnection ||\r\n      (navigator as any).webkitConnection;\r\n\r\n    if (connection) {\r\n      connection.addEventListener('change', handleConnectionChange);\r\n    }\r\n\r\n    // Return cleanup function\r\n    return () => {\r\n      window.removeEventListener('online', handleOnline);\r\n      window.removeEventListener('offline', handleOffline);\r\n      if (connection) {\r\n        connection.removeEventListener('change', handleConnectionChange);\r\n      }\r\n    };\r\n  },\r\n};\r\n\r\n// Performance utilities\r\nexport const performanceUtils = {\r\n  // Measure load time\r\n  getLoadTime(): number {\r\n    if ('performance' in window && performance.timing) {\r\n      const { navigationStart, loadEventEnd } = performance.timing;\r\n      return loadEventEnd - navigationStart;\r\n    }\r\n    return 0;\r\n  },\r\n\r\n  // Get memory usage (if available)\r\n  getMemoryUsage(): any {\r\n    if ('performance' in window && (performance as any).memory) {\r\n      const memory = (performance as any).memory;\r\n      return {\r\n        used: Math.round(memory.usedJSHeapSize / 1048576), // MB\r\n        total: Math.round(memory.totalJSHeapSize / 1048576), // MB\r\n        limit: Math.round(memory.jsHeapSizeLimit / 1048576), // MB\r\n      };\r\n    }\r\n    return null;\r\n  },\r\n\r\n  // Log performance metrics\r\n  logMetrics(): void {\r\n    console.debug('[Performance] Load time:', this.getLoadTime() + 'ms');\r\n\r\n    const memory = this.getMemoryUsage();\r\n    if (memory) {\r\n      console.debug(\r\n        '[Performance] Memory:',\r\n        memory.used + '/' + memory.total + 'MB'\r\n      );\r\n    }\r\n\r\n    const network = networkUtils.getInfo();\r\n    console.debug('[Performance] Network:', network.effectiveType);\r\n  },\r\n\r\n  // Create performance observer\r\n  createObserver(\r\n    type: string,\r\n    callback: (entries: PerformanceEntryList) => void\r\n  ): PerformanceObserver | null {\r\n    if (!('PerformanceObserver' in window)) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const observer = new PerformanceObserver((list) => {\r\n        callback(list.getEntries());\r\n      });\r\n\r\n      observer.observe({ type, buffered: true });\r\n      return observer;\r\n    } catch (error) {\r\n      console.error('[Performance] Failed to create observer:', error);\r\n      return null;\r\n    }\r\n  },\r\n};\r\n\r\n// Install prompt utilities\r\nexport const installUtils = {\r\n  // Show install instructions for iOS\r\n  getIOSInstructions(): string[] {\r\n    return [\r\n      'Tap the Share button at the bottom of the screen',\r\n      'Scroll down and tap \"Add to Home Screen\"',\r\n      'Tap \"Add\" to install the app',\r\n    ];\r\n  },\r\n\r\n  // Show install instructions for Android\r\n  getAndroidInstructions(): string[] {\r\n    return [\r\n      'Tap the menu button (Γï«) in the browser',\r\n      'Tap \"Add to Home screen\" or \"Install app\"',\r\n      'Tap \"Install\" to add to your home screen',\r\n    ];\r\n  },\r\n\r\n  // Get platform-specific instructions\r\n  getInstructions(platform: string): string[] {\r\n    switch (platform) {\r\n      case 'ios':\r\n        return this.getIOSInstructions();\r\n      case 'android':\r\n        return this.getAndroidInstructions();\r\n      default:\r\n        return [\r\n          'Look for the install icon in your browser toolbar',\r\n          'Click to add the app to your device',\r\n          'Launch from your home screen',\r\n        ];\r\n    }\r\n  },\r\n\r\n  // Check if can show install prompt\r\n  canShowPrompt(): boolean {\r\n    const wasDismissed =\r\n      localStorage.getItem('pwa-install-dismissed') === 'true';\r\n    const wasInstalled = localStorage.getItem('pwa-installed') === 'true';\r\n\r\n    return !wasDismissed && !wasInstalled;\r\n  },\r\n\r\n  // Mark prompt as dismissed\r\n  markDismissed(): void {\r\n    localStorage.setItem('pwa-install-dismissed', 'true');\r\n  },\r\n\r\n  // Mark app as installed\r\n  markInstalled(): void {\r\n    localStorage.setItem('pwa-installed', 'true');\r\n  },\r\n\r\n  // Reset install state (for testing)\r\n  resetState(): void {\r\n    localStorage.removeItem('pwa-install-dismissed');\r\n    localStorage.removeItem('pwa-installed');\r\n  },\r\n};\r\n\r\n// Theme utilities\r\nexport const themeUtils = {\r\n  // Get preferred theme\r\n  getPreferredTheme(): 'light' | 'dark' | 'system' {\r\n    const stored = localStorage.getItem('theme') as 'light' | 'dark' | 'system';\r\n    return stored || 'system';\r\n  },\r\n\r\n  // Set theme\r\n  setTheme(theme: 'light' | 'dark' | 'system'): void {\r\n    localStorage.setItem('theme', theme);\r\n    this.applyTheme(theme);\r\n  },\r\n\r\n  // Apply theme to document\r\n  applyTheme(theme: 'light' | 'dark' | 'system'): void {\r\n    const root = document.documentElement;\r\n\r\n    if (theme === 'system') {\r\n      const prefersDark = window.matchMedia(\r\n        '(prefers-color-scheme: dark)'\r\n      ).matches;\r\n      root.classList.toggle('dark', prefersDark);\r\n    } else {\r\n      root.classList.toggle('dark', theme === 'dark');\r\n    }\r\n  },\r\n\r\n  // Watch for system theme changes\r\n  watchSystemTheme(callback: (isDark: boolean) => void): () => void {\r\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n\r\n    const handleChange = (e: MediaQueryListEvent) => {\r\n      callback(e.matches);\r\n    };\r\n\r\n    mediaQuery.addEventListener('change', handleChange);\r\n\r\n    return () => {\r\n      mediaQuery.removeEventListener('change', handleChange);\r\n    };\r\n  },\r\n};\r\n\r\n// Main PWA helper object\r\nexport const pwa = {\r\n  info: getPWAInfo,\r\n  device: getDeviceInfo,\r\n  cache: cacheUtils,\r\n  notifications: notificationUtils,\r\n  network: networkUtils,\r\n  performance: performanceUtils,\r\n  install: installUtils,\r\n  theme: themeUtils,\r\n};\r\n\r\nexport default pwa;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]
